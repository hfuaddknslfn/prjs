"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3024],{78121:function(e,n,i){i.d(n,{C:function(){return m},W:function(){return o}});var a=i(81278),l=i(37654),d=i(28089),t=i(61811);function*m(){const e=yield(0,a.select)(d.u);null!==e&&void 0!==e&&e.length||(yield(0,a.call)(t.u))}function*o(){yield(0,a.takeLatest)(l.F.type,m)}},98876:function(e,n,i){i.d(n,{h:function(){return a},g:function(){return l}});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MoviePreviewUserData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Movie"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folders"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"public"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"voting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"votedAt"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"MoviePreviewCard"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"movieId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Long"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actorsLimit"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"withUserData"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"regionId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"213"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"movie"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"movieId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"contentId"}},{kind:"Field",name:{kind:"Name",value:"title"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"russian"}},{kind:"Field",name:{kind:"Name",value:"original"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Film"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productionYear"}},{kind:"Field",name:{kind:"Name",value:"isShortFilm"}},{kind:"Field",name:{kind:"Name",value:"top250"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TvSeries"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"releaseYears"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"end"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MiniSeries"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"releaseYears"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"end"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TvShow"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"releaseYears"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"end"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Video"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"productionYear"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"isTicketsAvailable"},arguments:[{kind:"Argument",name:{kind:"Name",value:"regionId"},value:{kind:"Variable",name:{kind:"Name",value:"regionId"}}}]},{kind:"Field",name:{kind:"Name",value:"viewOption"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"buttonText"}},{kind:"Field",name:{kind:"Name",value:"originalButtonText"}},{kind:"Field",alias:{kind:"Name",value:"isAvailableOnline"},name:{kind:"Name",value:"isWatchable"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"anyDevice"},value:{kind:"BooleanValue",value:!1}},{kind:"ObjectField",name:{kind:"Name",value:"anyRegion"},value:{kind:"BooleanValue",value:!1}}]}}]},{kind:"Field",name:{kind:"Name",value:"purchasabilityStatus"}},{kind:"Field",name:{kind:"Name",value:"promotionIcons"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarsUrl"}},{kind:"Field",name:{kind:"Name",value:"fallbackUrl"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionPurchaseTag"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"rightholderLogoUrlForPoster"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",alias:{kind:"Name",value:"actors"},name:{kind:"Name",value:"members"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"actorsLimit"}}},{kind:"Argument",name:{kind:"Name",value:"role"},value:{kind:"ListValue",values:[{kind:"EnumValue",value:"ACTOR"},{kind:"EnumValue",value:"CAMEO"},{kind:"EnumValue",value:"UNCREDITED"}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"person"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"originalName"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"total"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",alias:{kind:"Name",value:"directors"},name:{kind:"Name",value:"members"},arguments:[{kind:"Argument",name:{kind:"Name",value:"role"},value:{kind:"EnumValue",value:"DIRECTOR"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"4"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"person"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"originalName"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"rating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"kinopoisk"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isActive"}},{kind:"Field",name:{kind:"Name",value:"count"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"expectation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isActive"}},{kind:"Field",name:{kind:"Name",value:"count"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"Field",name:{kind:"Name",value:"poster"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarsUrl"}},{kind:"Field",name:{kind:"Name",value:"fallbackUrl"}},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"MoviePreviewUserData"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"withUserData"}}}]}]},{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}},...a.definitions]}},43879:function(e,n,i){i.d(n,{bC:function(){return d},bK:function(){return t}});var a=i(74211);let l;!function(e){e.SetMovieUserFolderEffect="preview-card-popover-content/SET_MOVIE_USER_FOLDER_EFFECT",e.SetMovieUserRatingEffect="preview-card-popover-content/SET_MOVIE_USER_RATING_EFFECT"}(l||(l={}));const d=(0,a.PH)(l.SetMovieUserRatingEffect),t=(0,a.PH)(l.SetMovieUserFolderEffect)},83024:function(e,n,i){i.d(n,{D:function(){return U}});var a=i(78121),l=i(45999),d=i(43879);var t=i(81278),m=i(72095),o=i(44046),k=i(99980),u=i(77044),v=i(98876),r=i(62442),s=i(47762),c=i(38467),N=i(97872);function*p({payload:{movieId:e,folderId:n,typeName:i,operation:a}}){var l,d;yield(0,t.call)(o.K);const p=yield(0,t.select)((e=>(0,k.S)(e,{entityId:n}))),F=(0,c.u)(i)({id:e}),y=yield(0,t.call)(u.R),S=y.readFragment({id:F,fragment:v.h}),f=null===S||void 0===S||null===(l=S.userData)||void 0===l||null===(d=l.folders)||void 0===d?void 0:d.some((e=>(null===e||void 0===e?void 0:e.id)===n));let _=null;a!==m.Y.Add||f||(_=(0,r.C)({userData:S,folder:p,typeName:i})),a===m.Y.Remove&&f&&(_=(0,s.Z)({userData:S,folder:p,typeName:i})),_&&(0,N.g)({apolloClient:y,cacheObjectId:F,data:_,fragment:v.h})}var F=i(89145),y=i(93802),S=i(21846);const f={[F.v.Film]:y.MovieTypes.Film,[F.v.TvSeries]:y.MovieTypes.TvSeries,[F.v.Video]:y.MovieTypes.Video,[F.v.TvShow]:y.MovieTypes.TvShow,[F.v.MiniSeries]:y.MovieTypes.MiniSeries};function*_({payload:e}){const{movieId:n,folderId:i,operation:a,typeName:l}=e;return yield(0,S.K)({movieId:n,folderId:i,operation:a,movieType:f[l]})}var g=i(72310);function b(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,a)}return i}function I(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?b(Object(i),!0).forEach((function(n){(0,g.Z)(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function*D({payload:e}){const{operation:n}=e,i=(0,d.bK)(I(I({},e),{},{operation:n===m.Y.Add?m.Y.Remove:m.Y.Add}));yield(0,t.call)(p,i)}function*T(){yield(0,l.f)(200,(({payload:e})=>`${e.movieId}${e.folderId}`),d.bK.type,p,_,D)}var V=i(45247),O=i(21175);function E({movieId:e,value:n,voteAt:i,typeName:a,apolloClient:l}){const d=(0,c.u)(a)({id:e}),t=function({ratingValue:e,userData:n,typeName:i,voteAt:a=(new Date).toISOString()}){return(0,V.ZP)(n,(n=>((n=n||{__typename:i,userData:null}).userData=n.userData||{__typename:F.v.MovieUserData,folders:null,voting:null},n.userData.voting=n.userData.voting||{__typename:F.v.Vote,value:null,votedAt:null},n.userData.voting.value=e===O.UF?null:e,n.userData.voting.votedAt=a,n)))}({ratingValue:n,voteAt:i,userData:l.readFragment({id:d,fragment:v.h}),typeName:a});(0,N.g)({apolloClient:l,cacheObjectId:d,data:t,fragment:v.h})}function*h({payload:{movieId:e,value:n,typeName:i}}){yield(0,t.call)(o.K);E({apolloClient:yield(0,t.call)(u.R),movieId:e,value:n,typeName:i})}var A=i(22809);function*C({payload:e}){const{movieId:n,value:i}=e,a=yield function*({movieId:e,value:n}){const i=yield(0,t.call)(A.z);return yield(0,t.call)({context:i,fn:i.setUserVote},{id:e,value:n})}({movieId:n,value:i});return a}function*w({payload:{movieId:e,typeName:n,rollbackVote:i}}){E({apolloClient:yield(0,t.call)(u.R),movieId:e,value:(null===i||void 0===i?void 0:i.value)||null,typeName:n,voteAt:null===i||void 0===i?void 0:i.votedAt})}function*M(){yield(0,l.f)(200,(({payload:e})=>String(e.movieId)),d.bC.type,h,C,w)}const U=()=>[{id:"previewCardPopoverContent",sagas:[a.W,T,M]}]}}]);
//# sourceMappingURL=https://kinopoisk-frontend-internal.s3.mds.yandex.net/frontend-www/release/_next/static/chunks/3024-52eba80036787e5b.js.map