/*! For license information please see player.v2.modern.js.LICENSE.txt */
(()=>{function e(i){var s=r[i];if(void 0!==s)return s.exports;var n=r[i]={id:i,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.exports}var t={7050:(e,t,r)=>{function i(e){var t=s(e);return r(t)}function s(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}var n={"./be.ts":5506,"./en.ts":7520,"./id.ts":823,"./kk.ts":2987,"./ru.ts":4072,"./tr.ts":1578,"./tt.ts":4606,"./uk.ts":2468,"./uz.ts":6185};i.keys=function(){return Object.keys(n)},i.resolve=s,e.exports=i,i.id=7050},4661:(e,t,r)=>{(t=e.exports=r(870)(!1)).push([e.id,"._1gZJUfw{user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;position:relative;background:#000;background-position:center;background-size:contain;background-repeat:no-repeat;width:100%;height:100%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;overflow:hidden;text-align:left;outline:0}._2jlIyxK{width:100%;height:100%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;overflow:hidden;user-select:none;text-align:left;outline:0;position:absolute;top:0;left:0;pointer-events:none;background:0 0}._1gZJUfw ._17DR8Wz{display:none!important}._1gZJUfw>iframe.KNlHF8r{position:absolute;width:100%;height:100%;border:0}._1gZJUfw .xDBHr4L{position:absolute;width:100%;height:100%;pointer-events:none}._1gZJUfw video{width:100%;height:100%}._1gZJUfw video::-webkit-media-controls-start-playback-button{z-index:2147483647!important}._1gZJUfw video._33stY3F::-webkit-media-controls-start-playback-button{display:none!important}",""]),t.locals={StreamPlayer:"_1gZJUfw",StreamPlayer_ui:"_2jlIyxK",hidden:"_17DR8Wz",container:"KNlHF8r",adSkin:"xDBHr4L","hide-native-play-button":"_33stY3F"}},8024:(e,t,r)=>{var i=r(3379),s=r(866);"string"===typeof(s=s.__esModule?s.default:s)&&(s=[[e.id,s,""]]);var n={injectType:"singletonStyleTag",attributes:{"data-ya-player-style":"data-ya-player-style"},insert:"head",singleton:!0};i(s,n);e.exports=s.locals||{}},3379:(e,t,r)=>{"use strict";function i(e){for(var t=-1,r=0;r<p.length;r++)if(p[r].identifier===e){t=r;break}return t}function s(e,t){for(var r={},s=[],n=0;n<e.length;n++){var a=e[n],o=t.base?a[0]+t.base:a[0],d=r[o]||0,c="".concat(o," ").concat(d);r[o]=d+1;var u=i(c),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==u?(p[u].references++,p[u].updater(h)):p.push({identifier:c,updater:l(h,t),references:1}),s.push(c)}return s}function n(e){var t=document.createElement("style"),i=e.attributes||{};if("undefined"===typeof i.nonce){var s=r.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"===typeof e.insert)e.insert(t);else{var n=h(e.insert||"head");if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(t)}return t}function a(e,t,r,i){var s=r?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=f(t,s);else{var n=document.createTextNode(s),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(n,a[t]):e.appendChild(n)}}function o(e,t,r){var i=r.css,s=r.media,n=r.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),n&&"undefined"!==typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function l(e,t){var r,i,s;if(t.singleton){var l=g++;r=m||(m=n(t)),i=a.bind(null,r,l,!1),s=a.bind(null,r,l,!0)}else r=n(t),i=o.bind(null,r,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else s()}}var d,c,u=function(){return"undefined"===typeof d&&(d=Boolean(window&&document&&document.all&&!window.atob)),d},h=function(){var e={};return function(t){if("undefined"===typeof e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(i){r=null}e[t]=r}return e[t]}}(),p=[],f=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")}),m=null,g=0;e.exports=function(e,t){(t=t||{}).singleton||"boolean"===typeof t.singleton||(t.singleton=u());var r=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<r.length;n++){var a=i(r[n]);p[a].references--}for(var o=s(e,t),l=0;l<r.length;l++){var d=i(r[l]);0===p[d].references&&(p[d].updater(),p.splice(d,1))}r=o}}}},5506:(e,t,r)=>{"use strict";r.r(t),r.d(t,{be:()=>i});const i={TRACK_AUTO:"\u0410\u045e\u0442\u0430"}},7520:(e,t,r)=>{"use strict";r.r(t),r.d(t,{en:()=>i});const i={TRACK_AUTO:"Auto"}},823:(e,t,r)=>{"use strict";r.r(t),r.d(t,{id:()=>i});const i={TRACK_AUTO:"Otomatis"}},2987:(e,t,r)=>{"use strict";r.r(t),r.d(t,{kk:()=>i});const i={TRACK_AUTO:"\u0410\u0432\u0442\u043e"}},4072:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ru:()=>i});const i={TRACK_AUTO:"\u0410\u0432\u0442\u043e"}},1578:(e,t,r)=>{"use strict";r.r(t),r.d(t,{tr:()=>i});const i={TRACK_AUTO:"Oto"}},4606:(e,t,r)=>{"use strict";r.r(t),r.d(t,{tt:()=>i});const i={TRACK_AUTO:"\u0410\u0432\u0442\u043e"}},2468:(e,t,r)=>{"use strict";r.r(t),r.d(t,{uk:()=>i});const i={TRACK_AUTO:"\u0410\u0432\u0442\u043e"}},6185:(e,t,r)=>{"use strict";r.r(t),r.d(t,{uz:()=>i});const i={TRACK_AUTO:"Avto"}},1247:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=window);try{return(e.navigator||{}).userAgent||""}catch(t){return""}}r.d(t,{i:()=>i})},2988:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});const i=r(6386),s=function(e){void 0===e&&(e=window);const t=i(e);return"boolean"===typeof t?-1:t}},1076:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});const i=(void 0===s&&(s=window),/firefox/.test(s.navigator.userAgent.toLowerCase()));var s},2483:(e,t,r)=>{"use strict";r.d(t,{E:()=>s});var i=r(2988);const s=function(e){return void 0===e&&(e=window),-1!==(0,i.N)(e)}},2905:(e,t,r)=>{"use strict";r.d(t,{w:()=>i});const i=(0,r(2483).E)()},6487:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=window);const t=e.navigator.userAgent.toLowerCase();return/ipad|iphone|ipod/.test(t)&&!e.MSStream&&!function(e){void 0===e&&(e=window);return e.navigator.userAgent.indexOf("UCBrowser")>-1}(e)}r.d(t,{P:()=>i})},9298:(e,t,r)=>{"use strict";r.d(t,{g:()=>i});const i=(0,r(6487).P)()},1585:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});var i=r(1247);const s=function(e){void 0===e&&(e=window);const t=(0,i.i)(e).toLowerCase();if(t.indexOf("android")>-1)return!1;const r=t.replace(/\(.+?\)/gi,"").split(" ").map(e=>e.trim().split("/")[0]).filter(e=>e&&"mobile"!==e);return 4===r.length&&"mozilla"===r[0]&&"applewebkit"===r[1]&&"version"===r[2]&&"safari"===r[3]}},9317:(e,t,r)=>{"use strict";r.d(t,{G:()=>i});const i=(0,r(1585).B)()},3211:(e,t,r)=>{"use strict";r.d(t,{$:()=>a});var i=r(5940),s=r(6487),n=r(1585);const a=(void 0===o&&(o=window),(0,n.B)(o)||(0,s.P)(o)||function(e){return void 0===e&&(e=window),/Apple/.test(e.navigator.vendor)&&(0,i.b)(e)}(o));var o},9201:(e,t,r)=>{"use strict";r.d(t,{b:()=>i});const i=(0,r(5940).b)()},5940:(e,t,r)=>{"use strict";function i(e){return function(e){return Boolean(e.PointerEvent)}(e)&&function(e){const t=e.navigator||{},{msMaxTouchPoints:r,maxTouchPoints:i}=t;return r||i||0}(e)>0&&!function(e){void 0===e&&(e=window);return(0,a.N)(e)>11}(e)}function s(e,t){if(!(0,l.m)(e.matchMedia))return!1;const r=e.matchMedia(t);return(0,d.K)(r)&&Boolean(r.matches)}function n(e){return void 0===e&&(e=window),i(e)||function(e){return s(e,c)}(e)||function(e){return s(e,u)}(e)||function(e){const{DocumentTouch:t}=e;return Boolean(t)&&e.document instanceof t}(e)||function(e){return"ontouchstart"in e}(e)}r.d(t,{b:()=>n});var a=r(2988);const o=["","-webkit-","-ms-","-moz-","-o-"];var l=r(6351),d=r(3770);const c=o.map(e=>"("+e+"any-pointer:coarse)").join(","),u=o.map(e=>"("+e+"touch-enabled)").join(",")},4013:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=window);const t=(0,s.i)(e).toLowerCase();return/windows/.test(t)}r.d(t,{U:()=>i});var s=r(1247)},3089:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});const i=(0,r(4013).U)()},7047:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=window);const t=(0,s.i)(e).toLowerCase(),r=/windows nt (\d+\.\d+)/.exec(t);if(r){const e=Number(r[1]);return e>0?e:-1}return-1}r.d(t,{j:()=>i});var s=r(1247)},8274:(e,t,r)=>{"use strict";r.d(t,{c:()=>i});const i=(0,r(7047).j)()},4021:(e,t,r)=>{"use strict";let i;r.d(t,{t:()=>i}),function(e){e.ALL="*",e.PLAY="play",e.START_SCREEN_PLAY="startScreenPlay",e.VOLUME="sound",e.VOLUME_SLIDER="volumeSlider",e.SETTINGS="settings",e.SETTINGS_ITEM="settingsItem",e.FULLSCREEN="fullscreen",e.TIMELINE="timeline",e.TIMELINE_PREVIEW="timelinePreview",e.LIVE="live",e.POSTER="poster",e.START_POSITION_CONFIRM="startPositionConfirm",e.TIME_DISPLAY="time",e.TITLE_DISPLAY="titleDisplay",e.REPORT="report",e.FORWARD="forward",e.BACKWARD="backward",e.LOGO="logo",e.PRELOADER="preloader",e.CONTEXT_MENU="contextMenu",e.START_SCREEN="startScreen",e.PLAYBACK_RATE="playbackRate",e.SKIPPABLE_FRAGMENTS="skippableFragments",e.EXTERNAL_PLAYBACK="externalPlayback",e.RECOMMENDATIONS="recommendations",e.CLOSE_BUTTON="closeButton",e.NEXT_AD_INFO="nextAdInfo",e.SUBTITLES_TOGGLE="subtitlesToggle",e.LOGO_WIDGET="logoWidget",e.SKIP_AD="skipAd",e.MOBILE_SEEK_BUTTONS="mobileSeekButtons",e.TITLE="title"}(i||(i={}))},228:(e,t,r)=>{"use strict";let i;r.d(t,{W:()=>i}),function(e){e.fairplay="fairplay",e.playready="playready",e.widevine="widevine",e.none="none"}(i||(i={}))},7951:(e,t,r)=>{"use strict";let i;r.d(t,{o:()=>i}),function(e){e.init="init",e.waitForUserPlay="waitForUserPlay",e.waitForDocumentVisibility="waitForDocumentVisibility",e.starting="starting",e.started="started",e.broken="broken",e.destroyed="destroyed"}(i||(i={}))},8107:(e,t,r)=>{"use strict";let i;r.d(t,{$:()=>i}),function(e){e.NATIVE="NATIVE",e.HLS="HLS",e.MPD="MPD",e.MP4="MP4",e.YANDEX="YANDEX",e.YASP="YASP"}(i||(i={}))},7746:(e,t,r)=>{"use strict";let i;r.d(t,{X:()=>i}),function(e){e.PLAY="play",e.PAUSE="pause",e.BUFFERING="buffering",e.END="end"}(i||(i={}))},4651:(e,t,r)=>{"use strict";let i;r.d(t,{Z:()=>i}),function(e){e.LIVE="LIVE",e.EVENT="EVENT",e.VOD="VOD"}(i||(i={}))},1541:(e,t,r)=>{"use strict";r.d(t,{m:()=>s});var i=r(6789);const s=Date&&(0,i.m)(Date.now)?()=>Date.now():()=>(new Date).getTime()},9951:(e,t,r)=>{"use strict";r.d(t,{M:()=>n});const i={}.toString,s=/\[object (\w+)\]/,n=e=>{const t=i.call(e);if(!t)return null;const r=t.match(s);if(!r)return null;const n=r[1];return n||null}},6789:(e,t,r)=>{"use strict";function i(e){return"function"===typeof e||"Function"===(0,s.M)(e)}r.d(t,{m:()=>i});var s=r(9951)},4849:(e,t,r)=>{"use strict";r.d(t,{no:()=>d});var i=r(1541),s=r(6789);const n="undefined"===typeof window?void 0:window.performance,a=n&&(0,s.m)(n.now),o=n&&n.timing&&n.timing.navigationStart?n.timing.navigationStart:(0,i.m)();let l=0;const d=a?()=>n.now():()=>(()=>{const e=(0,i.m)()-o;return l=Math.max(e,l),l})()},6538:(e,t,r)=>{"use strict";r.d(t,{th:()=>s.t,uM:()=>n});var i=r(5999),s=r(4021);const n=(0,i.Z)(s.t).map(e=>s.t[e])},4513:(e,t,r)=>{"use strict";r.d(t,{M:()=>s});var i=r(9329);class s extends i.v{destroy(){this.emit("Destroy"),this.off("Destroy"),Object.keys(this.handlers).forEach(e=>{this.off(e)}),Object.keys(this.onceHandlers).forEach(e=>{this.off(e)})}}},6:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});var i=r(6538);const s=e=>i.uM.every(t=>e.includes(t))},3942:(e,t,r)=>{"use strict";r.d(t,{R:()=>i});r(7881);const i=e=>null===e?1/0:void 0===e?720:e},5921:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{u:()=>p});var s=r(7880),n=r(8139),a=r.n(n),o=r(2818),l=r(8833),d=r(3234),c=r(3770),u=r(6377),h=r(6971);class p extends Error{constructor(e,t){const r="object"===typeof e?e:{message:String(e),code:0};if(super(String(r.message)),this.message=void 0,this.messageDetails=void 0,this.code=void 0,this.category=void 0,this.isFatal=void 0,this.details=void 0,this.stack=void 0,this.vsid=void 0,a()(this,p.prototype),this.message=r.message||this.message,this.messageDetails=r.messageDetails,this.code=r.code,this.category=null!=r&&r.category&&(null==r?void 0:r.category)!==h.q.DEFAULT?r.category:(0,d.W)(this.code),this.details=r.details,this.isFatal=void 0===r.isFatal||r.isFatal,this.stack=r.stack&&"?:?:?"!==r.stack?r.stack:this.details&&this.details.stack||((e,t)=>{const{url:r,line:i,col:s,fileName:n,columnNumber:a,lineNumber:o}=e;return String(t||(r||n||"?")+":"+(i||o||"?")+":"+(s||a||"?"))})(r,this.stack),!this.stack||this.stack===s.J.stack)try{throw new Error(this.message)}catch(i){(0,c.K)(i)&&(this.stack=i.stack||s.J.stack)}this.vsid=t||r.vsid}static from(e,t){var r,s;if(void 0===t&&(t={}),e instanceof p)return e;const n=null!=(r=null!=(s=t.code)?s:(0,o.Y)(()=>e.code))?r:0;return(0,u.V)(e)?new p(i({},e,t,{code:n})):(0,l.H)(e)?new p(i({message:e},t,{code:n})):new p(i({message:"UNEXPECTED_ERROR_TYPE"},t,{code:n}))}toString(){return JSON.stringify(this.toJSON())}toJSON(){const e={message:this.message,messageDetails:this.messageDetails,code:this.code,category:this.category,isFatal:this.isFatal,details:this.details,stack:this.stack,vsid:this.vsid};return i({},e,{raw:JSON.stringify(e)})}}},8614:(e,t,r)=>{"use strict";let i;r.d(t,{c:()=>i}),function(e){e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.BUFFER_STALLED_ERROR="bufferStalledError",e.SHAKA_VIDEO_ERROR_3016="shaka.VIDEO_ERROR_3016",e.FRAG_PARSING_ERROR="fragParsingError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.PIPELINE_ERROR_DECODE="PIPELINE_ERROR_DECODE",e.DECODER_ERROR_NOT_SUPPORTED="DECODER_ERROR_NOT_SUPPORTED",e.SHAKA_CONTENT_UNSUPPORTED_BY_BROWSER_4032="shaka.CONTENT_UNSUPPORTED_BY_BROWSER_4032",e.BUFFER_APPEND_ERROR="bufferAppendError",e.SHAKA_MEDIA_SOURCE_OPERATION_THREW_3015="shaka.MEDIA_SOURCE_OPERATION_THREW_3015",e.MEDIA_ELEMENT_ERROR_FORMAT_ERROR="MEDIA_ELEMENT_ERROR: Format error",e.REMUX_ALLOC_ERROR="remuxAllocError",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.DEMUXER_ERROR_COULD_NOT_OPEN="DEMUXER_ERROR_COULD_NOT_OPEN",e.NS_ERROR_DOM_INVALID_STATE_ERR="NS_ERROR_DOM_INVALID_STATE_ERR",e.SHAKA_DASH_INVALID_XML_4001="shaka.DASH_INVALID_XML_4001",e.SHAKA_QUOTA_EXCEEDED_ERROR_3017="shaka.QUOTA_EXCEEDED_ERROR_3017",e.CHUNK_DEMUXER_ERROR_APPEND_FAILED="CHUNK_DEMUXER_ERROR_APPEND_FAILED",e.FAILED_TO_INIT_DECODER="Failed to init decoder",e.PIPELINE_ERROR_INITIALIZATION_FAILED="PIPELINE_ERROR_INITIALIZATION_FAILED",e.NS_ERROR_FAILURE="NS_ERROR_FAILURE",e.SHAKA_MEDIA_SOURCE_OPERATION_FAILED_3014="shaka.MEDIA_SOURCE_OPERATION_FAILED_3014",e.REQUEST_FAILED="2147500036: Request failed",e.PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED="PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED",e.PIPELINE_ERROR_COULD_NOT_RENDER="PIPELINE_ERROR_COULD_NOT_RENDER",e.MEDIA_ELEMENT_ERROR_EMPTY_SRC_ATTRIBUTE="MEDIA_ELEMENT_ERROR: Empty src attribute",e.NS_ERROR_DOM_MEDIA_METADATA_ERR="NS_ERROR_DOM_MEDIA_METADATA_ERR",e.NS_ERROR_DOM_MEDIA_FATAL_ERR="NS_ERROR_DOM_MEDIA_FATAL_ERR",e.SHAKA_RESTRICTIONS_CANNOT_BE_MET_4012="shaka.RESTRICTIONS_CANNOT_BE_MET_4012",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.FRAG_LOAD_ERROR="fragLoadError",e.SHAKA_BAD_HTTP_STATUS_1001_MANIFEST="shaka.BAD_HTTP_STATUS_1001_MANIFEST",e.SHAKA_HTTP_ERROR_1002_SEGMENT="shaka.HTTP_ERROR_1002_SEGMENT",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.LEVEL_LOAD_ERROR="levelLoadError",e.SHAKA_HTTP_ERROR_1002_MANIFEST="shaka.HTTP_ERROR_1002_MANIFEST",e.SHAKA_BAD_HTTP_STATUS_1001_SEGMENT="shaka.BAD_HTTP_STATUS_1001_SEGMENT",e.SHAKA_UNSUPPORTED_SCHEME_1000="shaka.UNSUPPORTED_SCHEME_1000",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.SHAKA_TIMEOUT_1003_SEGMENT="shaka.TIMEOUT_1003_SEGMENT",e.FRAG_LOAD_TIME_OUT="fragLoadTimeOut",e.MANIFEST_LOAD_TIME_OUT="manifestLoadTimeOut",e.LEVEL_LOAD_TIME_OUT="levelLoadTimeOut",e.SHAKA_TIMEOUT_1003_MANIFEST="shaka.TIMEOUT_1003_MANIFEST",e.SHAKA_TIMEOUT_1003_LICENSE="shaka.TIMEOUT_1003_LICENSE",e.AUDIO_TRACK_LOAD_TIME_OUT="audioTrackLoadTimeOut",e.INTERNAL_EXCEPTION="internalException",e.SHAKA_OPERATION_ABORTED_7001="shaka.OPERATION_ABORTED_7001",e.ON_PLAYER_INIT_ERROR_INTERNAL="ON_PLAYER_INIT_ERROR_INTERNAL",e.UNABLE_TO_LOAD_PLAYER_IFRAME="UNABLE_TO_LOAD_PLAYER_IFRAME",e.ON_PLAYER_INIT_ERROR="ON_PLAYER_INIT_ERROR",e.LOADER_INIT_ERROR="LoaderInitError",e.UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT="UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT",e.FAILED_TO_DOWNLOAD_DEBUG_INFO="FAILED_TO_DOWNLOAD_DEBUG_INFO",e.SHAKA_REQUEST_FILTER_ERROR_1006="shaka.REQUEST_FILTER_ERROR_1006",e.PLAYER_CONTAINER_NOT_FOUND="PLAYER_CONTAINER_NOT_FOUND",e.KEY_LOAD_ERROR="keyLoadError",e.FEATURE_HANDLER_ERROR="FEATURE_HANDLER_ERROR",e.SHAKA_NO_LICENSE_SERVER_GIVEN_6012="shaka.NO_LICENSE_SERVER_GIVEN_6012",e.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER="InvalidConfigElementInCreatePlayer",e.INVALID_CONFIG_LANG_IN_CREATE_PLAYER="InvalidConfigLangInCreatePlayer",e.INVALID_CONFIG_IN_CREATE_PLAYER="InvalidConfigInCreatePlayer",e.INVALID_CONFIG_IN_SET_SOURCE="InvalidConfigInSetSource",e.INVALID_CONFIG_IN_SOURCE_UPDATE="InvalidConfigInSourceUpdate",e.IFRAME_DOES_NOT_ALLOW_DRM="IframeDoesNotAllowDrm",e.DRM_IS_NOT_ALLOWED="DrmIsNotAllowed",e.SHAKA_FAILED_TO_CREATE_CDM_6002="shaka.FAILED_TO_CREATE_CDM_6002",e.SHAKA_HTTP_ERROR_1002_LICENSE="shaka.HTTP_ERROR_1002_LICENSE",e.SHAKA_LICENSE_REQUEST_FAILED_6007="shaka.LICENSE_REQUEST_FAILED_6007",e.SHAKA_FAILED_TO_GENERATE_LICENSE_REQUEST_6006="shaka.FAILED_TO_GENERATE_LICENSE_REQUEST_6006",e.SHAKA_REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001="shaka.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001",e.SHAKA_FAILED_TO_ATTACH_TO_VIDEO_6003="shaka.FAILED_TO_ATTACH_TO_VIDEO_6003",e.SHAKA_LICENSE_RESPONSE_REJECTED_6008="shaka.LICENSE_RESPONSE_REJECTED_6008",e.SHAKA_INVALID_SERVER_CERTIFICATE_6004="shaka.INVALID_SERVER_CERTIFICATE_6004",e.SHAKA_EXPIRED_6014="shaka.EXPIRED_6014",e.SHAKA_BAD_HTTP_STATUS_1001_LICENSE="shaka.BAD_HTTP_STATUS_1001_LICENSE",e.EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR="EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR",e.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR="INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR",e.LOAD_SKIN_ERROR="LOAD_SKIN_ERROR",e.INSERT_INTO_WITH_SECURE_FRAME="INSERT_INTO_WITH_SECURE_FRAME",e.PLAY_AD_VIEWERS_WITH_SECURE_FRAME="PLAY_AD_VIEWERS_WITH_SECURE_FRAME",e.ELEMENT_NOT_IN_DOM="ELEMENT_NOT_IN_DOM",e.ERROR_SCREEN_LOAD_ERROR="ERROR_SCREEN_LOAD_ERROR",e.REQUEST_SOURCE_ERROR="REQUEST_SOURCE_ERROR"}(i||(i={}))},7985:(e,t,r)=>{"use strict";let i;r.d(t,{x:()=>i}),function(e){e.DEFAULT_ERROR="DEFAULT_ERROR",e.YANDEX_RPC_ERROR="YANDEX_RPC_ERROR",e.BROADCAST_AD_BLOCK_INIT_ERROR="BROADCAST_AD_BLOCK_INIT_ERROR",e.AD_TYPE_IS_NOT_RECOGNIZED="AD_TYPE_IS_NOT_RECOGNIZED",e.INVALID_METADATA="INVALID_METADATA",e.INVALID_STREAM_URL="INVALID_STREAM_URL",e.UNSUPPORTED_MEDIA_TYPE="UNSUPPORTED_MEDIA_TYPE",e.SCRIPT_INIT_ERROR="SCRIPT_INIT_ERROR",e.MPD_WIDEVINE_CERT_LOAD_ERROR="MPD_WIDEVINE_CERT_LOAD_ERROR",e.MPD_SHAKA_INIT_ERROR="MPD_SHAKA_INIT_ERROR",e.NATIVE_HLS_NOT_SUPPORTED_ERROR="NATIVE_HLS_NOT_SUPPORTED_ERROR",e.HLS_JS_NOT_SUPPORTED_ERROR="HLS_JS_NOT_SUPPORTED_ERROR",e.REFRESH_SUBTITLES_ERROR="REFRESH_SUBTITLES_ERROR",e.ON_TICK_ERROR="ON_TICK_ERROR",e.FAIRPLAY_NOT_SUPPORTED="FAIRPLAY_NOT_SUPPORTED",e.FAIRPLAY_CERT_LOAD_ERROR="FAIRPLAY_CERT_LOAD_ERROR",e.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR="FAIRPLAY_CREATE_MEDIA_KEYS_ERROR",e.FAIRPLAY_CREATE_KEY_SESSION_ERROR="FAIRPLAY_CREATE_KEY_SESSION_ERROR",e.FAIRPLAY_SPC_LOAD_ERROR="FAIRPLAY_SPC_LOAD_ERROR",e.FAIRPLAY_CREATE_KEY_ERROR="FAIRPLAY_CREATE_KEY_ERROR",e.FAIRPLAY_INVALID_CONTENT_ID="FAIRPLAY_INVALID_CONTENT_ID",e.DRM_PROXY_ERROR="DRM_PROXY_ERROR",e.DRM_PROXY_ERROR_SIGNATURE_EXPIRED="DRM_PROXY_ERROR_SIGNATURE_EXPIRED",e.DRM_INIT_ERROR="DRM_INIT_ERROR",e.DRM_NO_INIT_DATA="DRM_NO_INIT_DATA",e.DRM_CERT_LOAD_ERROR="DRM_CERT_LOAD_ERROR",e.DRM_NO_SUPPORTED_KEY_SYSTEM="DRM_NO_SUPPORTED_KEY_SYSTEM",e.DRM_FAILED_TO_CREATE_CDM="DRM_FAILED_TO_CREATE_CDM",e.DRM_FAILED_TO_SET_MEDIA_KEYS="DRM_FAILED_TO_SET_MEDIA_KEYS",e.DRM_NO_LICENSE_SERVER="DRM_NO_LICENSE_SERVER",e.DRM_FAILED_TO_CREATE_SESSION="DRM_FAILED_TO_CREATE_SESSION",e.DRM_SESSION_ERROR="DRM_SESSION_ERROR",e.DRM_FAILED_TO_GENERATE_REQUEST="DRM_FAILED_TO_GENERATE_REQUEST",e.DRM_UNKNOWN_ERROR="DRM_UNKNOWN_ERROR",e.NO_HLS_JS_INSTANCE="NO_HLS_JS_INSTANCE",e.AD_IS_ALREADY_PLAYING="AD_IS_ALREADY_PLAYING",e.META_INFO_REQUEST_FAILED="META_INFO_REQUEST_FAILED",e.MULTIROLL_INIT_ERROR="MULTIROLL_INIT_ERROR",e.REACT_COMPONENT_DID_CATCH_ERROR_INFO="REACT_COMPONENT_DID_CATCH_ERROR_INFO",e.PLAY_AD_VIEWERS_ERROR="PLAY_AD_VIEWERS_ERROR",e.SAGA_ERROR="SAGA_ERROR",e.STRM_ABD_INVALID_RESPONSE="STRM_ABD_INVALID_RESPONSE",e.REPRESENTATION_CHANGE="REPRESENTATION_CHANGE",e.RECOVER_TASK_ERROR="RECOVER_TASK_ERROR",e.PRELOAD_SOURCE_FAILED="PRELOAD_SOURCE_FAILED",e.REGIONAL_LIMITATION_MANIFEST="REGIONAL_LIMITATION_MANIFEST",e.REGIONAL_LIMITATION_LEVEL="REGIONAL_LIMITATION_LEVEL",e.REGIONAL_LIMITATION_SEGMENT="REGIONAL_LIMITATION_SEGMENT",e.SIGNATURE_EXPIRED_MANIFEST="SIGNATURE_EXPIRED_MANIFEST",e.SIGNATURE_EXPIRED_LEVEL="SIGNATURE_EXPIRED_LEVEL",e.SIGNATURE_EXPIRED_SEGMENT="SIGNATURE_EXPIRED_SEGMENT",e.BANNED_MANIFEST="BANNED_MANIFEST",e.BANNED_LEVEL="BANNED_LEVEL",e.BANNED_SEGMENT="BANNED_SEGMENT",e.MANIFEST_NOT_FOUND="MANIFEST_NOT_FOUND",e.NO_STREAMS="NO_STREAMS",e.NO_CODECS="NO_CODECS",e.NO_MSE="NO_MSE",e.NO_DRM_CONFIG="NO_DRM_CONFIG",e.NO_DRM="NO_DRM",e.NO_PLAYABLE_STREAMS="NO_PLAYABLE_STREAMS",e.SHAKA_FILTER_ERROR="SHAKA_FILTER_ERROR",e.SHAKA_CONFIGURE_ERROR="SHAKA_CONFIGURE_ERROR",e.SHAKA_LOAD_SOURCE_ERROR="SHAKA_LOAD_SOURCE_ERROR",e.MEDIA_ERR_CUSTOM="MEDIA_ERR_CUSTOM",e.MEDIA_ERR_ABORTED="MEDIA_ERR_ABORTED",e.MEDIA_ERR_NETWORK="MEDIA_ERR_NETWORK",e.MEDIA_ERR_DECODE="MEDIA_ERR_DECODE",e.MEDIA_ERR_SRC_NOT_SUPPORTED="MEDIA_ERR_SRC_NOT_SUPPORTED",e.MEDIA_ERR_ENCRYPTED="MEDIA_ERR_ENCRYPTED"}(i||(i={}))},3234:(e,t,r)=>{"use strict";function i(e){if(void 0===e)return s.q.DEFAULT;const t=function(e){switch(e){case a.x.DEFAULT_ERROR:return s.q.DEFAULT;case a.x.BROADCAST_AD_BLOCK_INIT_ERROR:case a.x.AD_TYPE_IS_NOT_RECOGNIZED:case a.x.AD_IS_ALREADY_PLAYING:case a.x.MULTIROLL_INIT_ERROR:case a.x.PLAY_AD_VIEWERS_ERROR:return s.q.ADS;case a.x.INVALID_METADATA:case a.x.NO_STREAMS:case a.x.INVALID_STREAM_URL:case a.x.NO_DRM_CONFIG:return s.q.CONFIG;case a.x.YANDEX_RPC_ERROR:case a.x.ON_TICK_ERROR:case a.x.SAGA_ERROR:case a.x.SHAKA_FILTER_ERROR:case a.x.SHAKA_CONFIGURE_ERROR:case a.x.SHAKA_LOAD_SOURCE_ERROR:case a.x.REFRESH_SUBTITLES_ERROR:case a.x.NO_HLS_JS_INSTANCE:case a.x.REACT_COMPONENT_DID_CATCH_ERROR_INFO:case a.x.RECOVER_TASK_ERROR:case a.x.PRELOAD_SOURCE_FAILED:case a.x.MEDIA_ERR_ABORTED:return s.q.EXCEPTION;case a.x.UNSUPPORTED_MEDIA_TYPE:case a.x.NATIVE_HLS_NOT_SUPPORTED_ERROR:case a.x.HLS_JS_NOT_SUPPORTED_ERROR:case a.x.MEDIA_ERR_SRC_NOT_SUPPORTED:case a.x.MEDIA_ERR_CUSTOM:case a.x.MEDIA_ERR_DECODE:case a.x.REPRESENTATION_CHANGE:return s.q.MEDIA;case a.x.SCRIPT_INIT_ERROR:case a.x.MPD_SHAKA_INIT_ERROR:case a.x.META_INFO_REQUEST_FAILED:case a.x.STRM_ABD_INVALID_RESPONSE:case a.x.MANIFEST_NOT_FOUND:return s.q.NETWORK_PLAYER;case a.x.MEDIA_ERR_NETWORK:return s.q.NETWORK_MEDIA;case a.x.MPD_WIDEVINE_CERT_LOAD_ERROR:case a.x.FAIRPLAY_CERT_LOAD_ERROR:case a.x.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR:case a.x.FAIRPLAY_CREATE_KEY_SESSION_ERROR:case a.x.FAIRPLAY_SPC_LOAD_ERROR:case a.x.FAIRPLAY_CREATE_KEY_ERROR:case a.x.FAIRPLAY_INVALID_CONTENT_ID:case a.x.DRM_PROXY_ERROR:case a.x.DRM_PROXY_ERROR_SIGNATURE_EXPIRED:case a.x.MEDIA_ERR_ENCRYPTED:case a.x.FAIRPLAY_NOT_SUPPORTED:case a.x.NO_DRM:case a.x.DRM_INIT_ERROR:case a.x.DRM_NO_INIT_DATA:case a.x.DRM_CERT_LOAD_ERROR:case a.x.DRM_NO_SUPPORTED_KEY_SYSTEM:case a.x.DRM_FAILED_TO_CREATE_CDM:case a.x.DRM_FAILED_TO_SET_MEDIA_KEYS:case a.x.DRM_NO_LICENSE_SERVER:case a.x.DRM_FAILED_TO_CREATE_SESSION:case a.x.DRM_SESSION_ERROR:case a.x.DRM_FAILED_TO_GENERATE_REQUEST:case a.x.DRM_UNKNOWN_ERROR:return s.q.DRM;case a.x.REGIONAL_LIMITATION_MANIFEST:case a.x.REGIONAL_LIMITATION_LEVEL:case a.x.REGIONAL_LIMITATION_SEGMENT:return s.q.REGIONAL;case a.x.SIGNATURE_EXPIRED_MANIFEST:case a.x.SIGNATURE_EXPIRED_LEVEL:case a.x.SIGNATURE_EXPIRED_SEGMENT:return s.q.ACCESS;case a.x.BANNED_MANIFEST:case a.x.BANNED_LEVEL:case a.x.BANNED_SEGMENT:return s.q.BANNED;case a.x.NO_CODECS:return s.q.NO_CODECS;case a.x.NO_PLAYABLE_STREAMS:return s.q.CANNOT_PLAY;case a.x.NO_MSE:return s.q.UNSUPPORTED_ENV}return s.q.DEFAULT}(e);if(t!==s.q.DEFAULT)return t;switch(e){case n.c.BUFFER_FULL_ERROR:case n.c.BUFFER_NUDGE_ON_STALL:case n.c.BUFFER_STALLED_ERROR:case n.c.SHAKA_VIDEO_ERROR_3016:case n.c.FRAG_PARSING_ERROR:case n.c.BUFFER_SEEK_OVER_HOLE:case n.c.BUFFER_APPENDING_ERROR:case n.c.PIPELINE_ERROR_DECODE:case n.c.DECODER_ERROR_NOT_SUPPORTED:case n.c.BUFFER_APPEND_ERROR:case n.c.SHAKA_MEDIA_SOURCE_OPERATION_THREW_3015:case n.c.MEDIA_ELEMENT_ERROR_FORMAT_ERROR:case n.c.REMUX_ALLOC_ERROR:case n.c.BUFFER_ADD_CODEC_ERROR:case n.c.DEMUXER_ERROR_COULD_NOT_OPEN:case n.c.NS_ERROR_DOM_INVALID_STATE_ERR:case n.c.SHAKA_DASH_INVALID_XML_4001:case n.c.SHAKA_QUOTA_EXCEEDED_ERROR_3017:case n.c.CHUNK_DEMUXER_ERROR_APPEND_FAILED:case n.c.FAILED_TO_INIT_DECODER:case n.c.PIPELINE_ERROR_INITIALIZATION_FAILED:case n.c.NS_ERROR_FAILURE:case n.c.SHAKA_MEDIA_SOURCE_OPERATION_FAILED_3014:case n.c.REQUEST_FAILED:case n.c.PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED:case n.c.PIPELINE_ERROR_COULD_NOT_RENDER:case n.c.NS_ERROR_DOM_MEDIA_METADATA_ERR:case n.c.MEDIA_ELEMENT_ERROR_EMPTY_SRC_ATTRIBUTE:case n.c.NS_ERROR_DOM_MEDIA_FATAL_ERR:case n.c.SHAKA_RESTRICTIONS_CANNOT_BE_MET_4012:case n.c.MANIFEST_PARSING_ERROR:return s.q.MEDIA;case n.c.FRAG_LOAD_ERROR:case n.c.SHAKA_BAD_HTTP_STATUS_1001_MANIFEST:case n.c.SHAKA_HTTP_ERROR_1002_SEGMENT:case n.c.MANIFEST_LOAD_ERROR:case n.c.LEVEL_LOAD_ERROR:case n.c.SHAKA_HTTP_ERROR_1002_MANIFEST:case n.c.SHAKA_BAD_HTTP_STATUS_1001_SEGMENT:case n.c.SHAKA_UNSUPPORTED_SCHEME_1000:case n.c.AUDIO_TRACK_LOAD_ERROR:return s.q.NETWORK_MEDIA;case n.c.SHAKA_TIMEOUT_1003_SEGMENT:case n.c.FRAG_LOAD_TIME_OUT:case n.c.MANIFEST_LOAD_TIME_OUT:case n.c.LEVEL_LOAD_TIME_OUT:case n.c.SHAKA_TIMEOUT_1003_MANIFEST:case n.c.SHAKA_TIMEOUT_1003_LICENSE:case n.c.AUDIO_TRACK_LOAD_TIME_OUT:return s.q.NETWORK_TIMEOUT;case n.c.INTERNAL_EXCEPTION:case n.c.SHAKA_OPERATION_ABORTED_7001:case n.c.ON_PLAYER_INIT_ERROR_INTERNAL:case n.c.EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR:case n.c.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR:case n.c.LOAD_SKIN_ERROR:case n.c.INSERT_INTO_WITH_SECURE_FRAME:case n.c.PLAY_AD_VIEWERS_WITH_SECURE_FRAME:case n.c.ERROR_SCREEN_LOAD_ERROR:return s.q.EXCEPTION;case n.c.UNABLE_TO_LOAD_PLAYER_IFRAME:case n.c.ON_PLAYER_INIT_ERROR:case n.c.LOADER_INIT_ERROR:case n.c.UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT:case n.c.FAILED_TO_DOWNLOAD_DEBUG_INFO:case n.c.SHAKA_REQUEST_FILTER_ERROR_1006:case n.c.REQUEST_SOURCE_ERROR:return s.q.NETWORK_PLAYER;case n.c.PLAYER_CONTAINER_NOT_FOUND:case n.c.KEY_LOAD_ERROR:case n.c.FEATURE_HANDLER_ERROR:case n.c.SHAKA_NO_LICENSE_SERVER_GIVEN_6012:case n.c.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER:case n.c.INVALID_CONFIG_LANG_IN_CREATE_PLAYER:case n.c.INVALID_CONFIG_IN_CREATE_PLAYER:case n.c.INVALID_CONFIG_IN_SET_SOURCE:case n.c.INVALID_CONFIG_IN_SOURCE_UPDATE:case n.c.IFRAME_DOES_NOT_ALLOW_DRM:case n.c.DRM_IS_NOT_ALLOWED:case n.c.ELEMENT_NOT_IN_DOM:return s.q.CONFIG;case n.c.SHAKA_FAILED_TO_CREATE_CDM_6002:case n.c.SHAKA_HTTP_ERROR_1002_LICENSE:case n.c.SHAKA_LICENSE_REQUEST_FAILED_6007:case n.c.SHAKA_FAILED_TO_GENERATE_LICENSE_REQUEST_6006:case n.c.SHAKA_REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE_6001:case n.c.SHAKA_FAILED_TO_ATTACH_TO_VIDEO_6003:case n.c.SHAKA_LICENSE_RESPONSE_REJECTED_6008:case n.c.SHAKA_INVALID_SERVER_CERTIFICATE_6004:case n.c.SHAKA_EXPIRED_6014:case n.c.SHAKA_BAD_HTTP_STATUS_1001_LICENSE:return s.q.DRM;case n.c.SHAKA_CONTENT_UNSUPPORTED_BY_BROWSER_4032:return s.q.NO_CODECS}return s.q.DEFAULT}r.d(t,{W:()=>i});var s=r(6971),n=r(8614),a=r(7985)},5543:(e,t,r)=>{"use strict";function i(e){g.flagsInited||(g.flagsInited=!0,(0,f.K)(e)&&(0,f.K)(e.flags)&&(0,m.Y)(()=>{(0,p.M)(e.flags,(e,t)=>{g.flags[t]=String(e)})}))}function s(e){(0,f.K)(e)&&(0,m.Y)(()=>{i({flags:JSON.parse(e.flags)})})}function n(){return u(),g.flags||{}}function a(e){return u(e),g.flags[e]}function o(e){return"true"===e||"1"===e||"false"!==e&&"0"!==e&&void 0}function l(e,t){const r=o(a(e));if("undefined"===typeof r){if("boolean"===typeof t)return t;return o(v[e])}return r}function d(e){if("undefined"===typeof e)return;const t=parseFloat(e);return(0,h.z)(t)?t:void 0}function c(e){const t=d(a(e));if("undefined"===typeof t){return d(v[e])}return t}function u(e){if(g.flagsInited)return;const t=new Error(e?"Unexpected usage of player's flag "+e+" before any flag configuration":"Unexpected usage of player's getFlagsJson before any flag configuration");setTimeout(()=>{throw t})}r.d(t,{RW:()=>l,Vc:()=>i,ZP:()=>s,jS:()=>c,qm:()=>n,r0:()=>a});var h=r(7187),p=r(141),f=r(3770),m=r(2818);const g=(0,r(9278).I)("object"===typeof self?self:window),v={web_debug_log_calls:"false",web_debug_log_events:"false",web_debug_log_internals:"false",web_debug_panel:"false",web_disable_dpi:"false",web_disable_dynamic_buffer:"false",web_disable_yandex_engine:"false",web_forbid_allow_muted_autoplay:"false",web_pass_credentials:"false",web_sdk_normalize_time:"false",web_skin_load_timeout:"60000",web_wait_volumechange:"false",web_yasp_back_watch:"10",web_yasp_back_watch_mse:"10",web_yasp_buffer:"30",web_yasp_clear_useless_on_seek:"false",web_yasp_cmaf:"false",web_yasp_enable:"true",web_yasp_enable_network_traces:"false",web_yasp_enable_worker:"false",web_yasp_expected_time_to_load_multiplier:"1",web_yasp_fast_ewma_half_life:"0.25",web_yasp_live:"false",web_yasp_live_kal:"false",web_yasp_min_ttfb:"false",web_yasp_override_ewma_half_life:"false",web_yasp_parallel_downloads:"false",web_yasp_slow_ewma_half_life:"5",web_yasp_timeout_buffer:"default",web_yasp_ttfb_min_sample_count:"6",web_yasp_use_currenttime_for_fake_videostate:"false"};g.flags||(g.flags={})},7369:(e,t,r)=>{"use strict";function i(e){return"string"===typeof e?e.split(";"):[]}var s=r(9201),n=r(5357),a=r(4519);const o=Math.random()<=.05;!function(){const e=window;if(!e.Ya||!e.Ya.Rum){r(7323),r(8058),r(7790),r(4491),r(1917),r(6260),r(2927),r(6212);try{const e={project:"video-player-iframe-api",env:"production",platform:s.b?"touch":"desktop",version:"1.0-10769".replace("1.0-",""),from:"unknown"},t=location.hash.indexOf("#",1),r=location.hash.substr(1,-1===t?location.hash.length:t).split("&");for(let i=0;i<r.length;i++){const t=r[i].split("=");e[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}(e=>{const{project:t,env:r,platform:o,version:l,from:d,from_block:c,reqid:u,vsid:h}=e;(0,a.I8)({vsid:h,from_block:c}),window.Ya.Rum.init({sendClientUa:!0,sendUrlInResTiming:!0,sendFirstRaf:!0,beacon:!0,clck:"https://yandex.ru/clck/click",slots:i(e.slots),crossOrigin:"",reqid:u||h,longTaskMetric:!0,maxLongTaskCounters:1/0},{"-project":t,"-version":l,"-env":r,"-platform":o,"-service":d,"-page":"stream-player/main",143:s.b?"28.3413.584.64":"28.3413.2048.64","-blocker":n.I?1:void 0,"-additional":decodeURIComponent((0,a.B6)())})})(e),(e=>{const{project:t,env:r,platform:s,version:l,from:d,slots:c,reqid:u,vsid:h}=e;window.Ya.Rum.initErrors({project:t,env:r,platform:s,version:l,slots:i(c),unhandledRejection:!0,traceUnhandledRejection:o,debug:!1,reqid:u||h,service:d,page:"stream-player/main",blocker:n.I?1:void 0,additional:(0,a.Vk)(),filters:{message:{0:/window\.webkit\.messageHandlers/,1:/Unhandled\srejection:\sFetch\sis\saborted/}}})})(e)}catch(t){}}}()},4489:(e,t,r)=>{"use strict";r.d(t,{O:()=>i});const i=r(3211).$?"":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},1410:(e,t,r)=>{"use strict";function i(e){return"function"===typeof e}function s(e){const t=typeof e;return Boolean(e)&&("object"===t||"function"===t)}function n(e,t){const r=e.style;for(const i in t)if(t.hasOwnProperty(i)){r[mi(i)]=t[i]}}function a(e){const t=[...e],r=t.pop();if(!r||0===t.length)throw new Error("memoizeSingle need at least 2 functions as arg");return{preparers:t,resolver:r}}function o(e){return(0,li.H)(e.className)?e.className:e.namespaceURI===wi.svg&&e.getAttribute("class")||""}function l(e,t){(0,li.H)(e.className)?e.className=t:e.namespaceURI===wi.svg&&e.setAttributeNS("","class",t)}function d(e,t){void 0===t&&(t=""),0!==e.className.length?Pi(e)?Oi(e,t):function(e,t){let r=o(e).split(" ").concat(t.split(" "));r=function(e){const t={};for(let r=0;r<e.length;r++)t[e[r]]=r;return(0,Ai.Z)(t)}((0,Si.h)(r,(function(e){return""!==e}))),l(e,r.join(" "))}(e,t):e.className=t}function c(e,t){const r=function(e){void 0===e&&(e=window);const{document:t={}}=e;return Mi.filter(e=>{let{enabled:r}=e;return r in t})}(e);if(r.length>0)return r[0];const i=function(e,t){return void 0===e&&(e=window),void 0===t&&(t=e.HTMLVideoElement&&e.HTMLVideoElement.prototype||{}),Mi.filter(e=>{let{enabled:r}=e;return r in t})}(e,t);return i.length>0?i[0]:void 0}function u(e,t){const r=c(e,t);if(!r)return null;let i=e.document[r.element];return t&&t[r.element]&&(i=t),i||null}function h(e){if(void 0===e&&(e=window),!e.navigator)return Qi;const{connection:t={}}=e.navigator;return(0,Bi.z)(t.rtt)?t.rtt:Qi}function p(e,t){return e.map(e=>({adViewer:e,additionalData:{},adType:t}))}function f(e){return e.reduce((e,t)=>e+t.getAdDuration(),0)}function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function g(e){return Boolean(e&&e.adType===es.inroll)}function v(e,t){const{ad:{originalBroadcastAdCues:r}}=e,i=r[t];if(i){const{start:e}=i;if(void 0===e)return;const{end:t=e+ds}=i;return{start:e,end:t}}}function y(e){const{ad:{originalBroadcastAdCues:t,adInfo:r}}=e;return g(r)?r.params.cueId:(0,Ai.Z)(t).find(t=>function(e,t){const{controller:{currentTime:r,programDateTime:i}}=e;if(void 0===i)return!1;const s=i/1e3+r,n=v(e,t);if(!n)return!1;const{start:a,end:o}=n;return a<=s&&s<=o}(e,t))}function E(e){const{controller:{currentTime:t,programDateTime:r}}=e;return void 0===r?r:r+1e3*t}function S(e,t){return Math.max(e+1e4,t+5e3)}function A(e){let{cue_id:t,pts:r,offset:i,cutoff:s}=e;const n=r+i;return{start:n,isEndReceived:void 0!==s,cueId:t,end:void 0!==s?r+s:S(r,n),isValid:!0,invalidateReason:void 0}}function T(){return(T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function R(e){void 0===e&&(e=window);try{return e.ya.videoAd.getBundleVersion()}catch(t){return"none"}}function w(e){void 0===e&&(e=window);try{return e.ya.videoAd.getModuleVersion()}catch(t){return"none"}}function _(e){return(0,li.H)(e)&&e.length>0}function k(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=Es(t,Boolean);if(0!==i.length)return i.join(";")}function P(e){if(void 0!==e){if(!(0,li.H)(e))throw new Error("testIdsString is not a string or undefined ["+e+"]");if(0!==e.length){for(const t of e.split(";")){const r=t.split(",");if(3!==r.length)throw new Error("testIdParts length error ["+e+"]");const[i,,s]=r;if(0===i.trim().length)throw new Error("testId length error ["+e+"]");if(0===s.trim().length)throw new Error("testId bucket length error ["+e+"]")}return e}}}function I(e){if(!Boolean(null===e||void 0===e?void 0:e.toString))return!1;try{const t=e.toString();return/\[native code\]/.test(t)||/\/\* source code not available \*\//.test(t)}catch(t){return!1}}function C(e){return JSON.stringify(e,function(){const e=[],t=function(){const e="undefined"===typeof WeakMap?void 0:new WeakMap,t=[];return{set:(r,i)=>{if(void 0!==e)try{e.set(r,i)}catch(s){t.push({path:i,value:r})}else t.push({path:i,value:r})},get:r=>{const i=Ts(t,e=>e.value===r);return void 0!==e&&void 0===i?e.get(r):i?i.path:void 0}}}();return(r,n)=>{if(i(n))return(0,li.H)(n.name)?n.name:"[Function]";if((0,Ss.V)(n))return{name:(a=n).name,message:a.message,stack:a.stack};var a;if(!s(n))return n;if((e=>{try{return"display"in(t=e,void 0===r&&(r=window),("function"===typeof r.getComputedStyle?r.getComputedStyle(t,null):t.currentStyle)||{})}catch(i){return!1}var t,r})(n))return function(e){if(e.id)return e.id;if(e.className)return e.className;return"HTML Element"}(n);const o=t.get(n);if(_(o))return"[Circular "+o+"]";for(;e.length>0&&e[e.length-1].value[r]!==n;)e.pop();const l=(e.length>0?e[e.length-1].path:"")+(r?"/"+r:"~");return e.push({path:l,value:n}),t.set(n,l),n}}())}function O(){}function D(e){let t=function(){let r;return t=()=>r,r=e.apply(this,arguments),r};return function(){return t.apply(this,arguments)}}function N(e,t){try{return e()}catch(r){"function"===typeof t&&t(r)}}function L(e){const t=function(e,t){if(void 0===t&&(t=!0),Ls.$&&t)return[];{const t=[];let i=e;for(;;)try{if(i=i.ownerDocument.defaultView.frameElement,!i)return t;t.push(i)}catch(r){return t}}}(e.documentElement).map(e=>e.ownerDocument);return t.unshift(e),t.map(e=>({location:(0,Kr.b)(e.defaultView),referrer:e.referrer}))}function M(e){let t="",r="";if(e){L(e).reverse().forEach(e=>{let{location:i,referrer:s}=e;t=t||i,r=r||s})}return{location:t,referrer:r}}function x(e,t){var r,i,s;return null!==(s=null!==(i=null!==(r=Us(e,t))&&void 0!==r?r:function(e,t){const r=function(e){var t,r;const i=[e.document];let s=e.document;for(;s;)s=null===(r=null===(t=s.defaultView)||void 0===t?void 0:t.frameElement)||void 0===r?void 0:r.ownerDocument,s&&i.push(s);return i}(e);for(let i=0;i<r.length;i++){const e=new URLSearchParams(r[i].location.search).get(t);if(null!==e)return e}return}(e,t))&&void 0!==i?i:((e,t)=>{var r,i;for(const s of(0,ti.T)(e)){const e=null===(i=null===(r=s.Ya)||void 0===r?void 0:r.hardcodedParams)||void 0===i?void 0:i[t];if(e)return String(e)}return})(e,t))&&void 0!==s?s:void 0}function V(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function F(){return(F=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function U(e,t){var r,i,s;return null===(s=null===(i=null===(r=t.ya)||void 0===r?void 0:r.videoAd)||void 0===i?void 0:i.loadedModules)||void 0===s?void 0:s[e]}function B(){return(B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function H(e){return Js||function(e){return""+en+e+"/"}(e)}function j(e){return function(e){const{src:t,win:r,onBeforeLoad:i=O}=e,s=new Is(new Error,{});let n=O;return{promise:new Promise((e,a)=>{const o=r.document.createElement("script");let l=!1;n=()=>{l=!0,function(e){if(!e)return;const{parentElement:t}=e;t&&t.removeChild(e)}(o)};o.type="text/javascript",o.async=!0,o.onload=()=>{l||e()},o.onerror=e=>{l||(a(new Is(s,{message:"Failed to load script ["+t+"]",details:{src:t,isSelfWindow:r===window,event:e}})),n())},o.src=t,o.charset=tn.j,i(o),(0,zr.c)(r).appendChild(o)}),teardown:n}}(e)}function Y(e,t,r){void 0===r&&(r=" ");const i=t-e.length;if(i>0){let t=r;for(;t.length<i;)t+=t;return(t.length>i?t.substr(0,i):t)+e}return e}function W(){return(W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function G(e){const t=(0,un.bk)();return hn.subpageIndex!==t?(hn.subpageIndex=t,hn.deltas={},!1):Boolean(hn.deltas[e])}function K(e){G(e)||(0,$r.iW)(e)}function q(e,t){var r;(void 0===t&&(t={}),G(e))||((0,$r.vG)(e,t),r=e,hn.deltas[r]=!0)}function z(){return(z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}async function X(e,t,r){var s;void 0===e&&(e=window);const n=e===window;n&&K("adsdk.multiroll.full");const a=(e=>{var t;0;const{win:r,config:{vasUaasConfig:s,activeTestIds:n,additionalCustomRootFields:a,vh_sid:o},moduleName:l,serviceName:d,serviceVersion:c,productTheme:u,pageId:h,impId:p}=e,f=null!==(t=null===a||void 0===a?void 0:a.vsid)&&void 0!==t?t:ln,m=(e=>{let{serviceName:t,serviceVersion:r,vsid:i}=e;const s=new Fs({rnd:Ys,vsid:i,defaultProbability:js,serviceName:t,serviceVersion:r});return{event:e=>s.log(e),error:e=>s.error(e)}})({serviceName:d,serviceVersion:c,vsid:f}),g=W({},a),v=_(o)?o:void 0;!_(g.vh_sid)&&v&&(g.vh_sid=v);const y=N(()=>P(null===g||void 0===g?void 0:g.testIds),e=>{m.error({error:new Is({code:"LOAD_VAS_MODULE_INVALID_TEST_IDS",details:{message:e.message}})})});return(e=>{const t=new Ns;return{promise:new Promise((r,i)=>{e({resolve:r,reject:i,subscribeForTeardown:e=>{t.subscribe(e)}})}),teardown:()=>t.dispatch(void 0)}})(e=>{let{resolve:t,reject:a,subscribeForTeardown:o}=e,d=!1;o(()=>{d=!0,a(new Error("Teardown called"))}),(e=>{let{externalUaasConfig:t,loaderFunctionsStatsWrapper:r}=e;return new Promise((e,i)=>{var s,n;const a=zs(t);t?a.parseUaasConfigError?r.error({error:new Is({code:"LOAD_VAS_MODULE_PARSE_EXTERNAL_UAAS_CONFIG_ERROR",details:{message:a.parseUaasConfigError.message,vasUaasConfig:t}})}):void 0===(null===(n=null===(s=a.parsedUaasConfig)||void 0===s?void 0:s.flags)||void 0===n?void 0:n.VAS_STABLE_VERSION)&&r.error({error:new Is({code:"LOAD_VAS_MODULE_NO_VAS_STABLE_VERSION_IN_EXTERNAL_AB_FLAGS",details:{vasUaasConfig:t}})}):r.event({name:"LoadVasModule_NoUAAS",data:{}}),a.version?e({uaasConfig:a.parsedUaasConfig,rawUaasConfig:t,version:a.version}):rn().then(t=>{var i,s,n;const a=zs(t);a.parseUaasConfigError?r.error({error:new Is({code:"LOAD_VAS_MODULE_PARSE_LOADED_UAAS_CONFIG_ERROR",details:{message:a.parseUaasConfigError.message,vasUaasConfig:t}})}):void 0===(null===(s=null===(i=a.parsedUaasConfig)||void 0===i?void 0:i.flags)||void 0===s?void 0:s.VAS_STABLE_VERSION)&&r.error({error:new Is({code:"LOAD_VAS_MODULE_NO_VAS_STABLE_VERSION_IN_LOADED_AB_FLAGS",details:{vasUaasConfig:t}})}),e({uaasConfig:a.parsedUaasConfig,rawUaasConfig:t,version:null!==(n=a.version)&&void 0!==n?n:String(t.stableVersion),stableVersion:t.stableVersion})}).catch(i)})})({externalUaasConfig:s,loaderFunctionsStatsWrapper:m}).then(e=>{let{uaasConfig:s,rawUaasConfig:c,version:v,stableVersion:E}=e;var S,A;if(d)return;if((e=>{if((e=>{const t=e.document;return"documentMode"in t&&"undefined"!==typeof t.documentMode})(e)||(e=>{const t=e.navigator.userAgent;if(t.indexOf("MSIE ")>0)return!0;if(t.indexOf("Trident/")>0)return!0;if(t.indexOf("Edge/")>0)return!0;return!1})(e))return!0;return!1})(r))return m.event({name:"LoadVasModule_brokeInIE11",probability:js,data:{bundleName:l}}),t(void 0);const T={AB_FLAGS_STORE:void 0,AB_FLAGS:null!==(S=null===s||void 0===s?void 0:s.flags)&&void 0!==S?S:{},ICOOKIE:null===s||void 0===s?void 0:s.iCookie,TEST_IDS:k(y,null===s||void 0===s?void 0:s.testIds),VAS_UAAS_CONFIG:s,ActiveTestIds:n,AdditionalStatsRootFields:g,VSID:f,VAS_USER_SESSION_RANDOM:Ys,STATS_ROOT_PARAMS:{},loaderLoadedFromAnYandexRu:void 0,grWasSent:void 0,productTheme:u,pageId:h,impId:p},b=e=>{const{promise:t,teardown:s}=(e=>{let{moduleName:t,version:r,win:s,scriptSessionParams:n}=e;var a;const o=U(t,s);if(o)return{promise:Promise.resolve(o),teardown:O};const l=(e=>{let{bundleName:t,win:r,ecmaVersion:s,version:n}=e;const a=Qs[s],o=ai(r),l=(e=>Zs[e]+".bundle.js")(t),d=""+H(n)+a+"/"+l;return i(o)?o(d):d})({version:r,bundleName:t,win:s,ecmaVersion:null!==(a=Hs.adsdkecmaver)&&void 0!==a?a:Xs}),{promise:d,teardown:c}=j({src:l,win:s,onBeforeLoad:e=>{(e=>{e.crossOrigin="anonymous"})(e),((e,t)=>{e.__AD_SDK_SCRIPT_SESSION_PARAMETERS__=t})(e,n)}});return{promise:d.then(()=>U(t,s)),teardown:c}})({moduleName:l,scriptSessionParams:T,version:e,win:r});return o(s),t},R=e=>{m.event({name:"LoadVasModule_ModuleLoaded",probability:js,data:{bundleName:l}}),t(e)},w=null!==(A=Hs.adsdkver)&&void 0!==A?A:v;b(w).then(R).catch(e=>{if(w===String(E))throw e;return m.error({error:new Is({code:"LOAD_VAS_MODULE_CANNOT_LOAD_MODULE_WITH_UAAS_VERSION",details:{vasUaasConfig:c}})}),E?b(String(E)).then(R):rn().then(e=>String(e.stableVersion)).then(b).then(R)}).catch(a)}).catch(a)})})({serviceName:"player",serviceVersion:"1.0-10769",config:z({},t,{additionalCustomRootFields:{vsid:r,contentPlayerVersion:"1.0-10769",testIds:null==(s=t.additionalParams)?void 0:s.slots}}),win:e,moduleName:"Multiroll"}).promise;return a.then(()=>{n&&q("adsdk.multiroll.full")}).catch(cn.Z),a}function Q(e){const{audioTrackValue:t,audioTracks:r}=e.controller;return r.find(e=>{let{value:r}=e;return r===t})}function Z(e){const{textTrackValue:t,textTracks:r}=e.controller;return r.find(e=>{let{value:r}=e;return r===t})}function J(){return(J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function $(e){const{videoTrackValue:t,videoTracks:r,isAbrEnabled:i}=e.controller,s=r.find(e=>{let{value:r}=e;return r===t});if(s)return J({},s,{auto:i})}function ee(e){let{controller:{videoType:t,currentTime:r},skin:{skinDVRStartTime:i,skinDVRDuration:s}}=e;return function(e){let{videoType:t,currentTime:r,dvrStartTime:i,dvrDuration:s}=e;if(void 0===t||t===bn.Z.VOD)return wn;const n=i+s-Rn.W;return s===1/0||r>n?kn:t!==bn.Z.LIVE?wn:i+(0===r?0:10)>r?_n:wn}({videoType:t,currentTime:r,dvrStartTime:i,dvrDuration:s})}function te(){return(te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function re(e,t){if(!e||!e.height||!e.width||!t)return"unknown";const r=t.getMaxCapAllowedVideoTrack();return r&&r.height&&r.width?r.width===e.width&&r.height===e.height?"same":r.width>e.width||r.height>e.height?"smaller":r.width<e.width||r.height<e.height?"larger":"unknown":"unknown"}function ie(e){return e.supported&&void 0!==e.engine}function se(e){return ie(e.supportInfo)}function ne(e){return!(t=e.supportInfo).supported&&void 0!==t.noSupportReason;var t}function ae(){return(ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function oe(e){const t=function(e){return e.filter(ne).map(e=>{let{supportInfo:t}=e;return t.noSupportReason})}(e),r={details:{streams:e},isFatal:!0};if(qn(t,e=>e===Xn.INVALID_STREAM_URL))return new ss.u(ae({},r,{code:ns.x.INVALID_STREAM_URL}));if(qn(t,e=>e===Xn.NO_SUPPORTED_DRM))return new ss.u(ae({},r,{code:ns.x.NO_DRM}));if(qn(t,e=>e===Xn.NO_CODECS))return new ss.u(ae({},r,{code:ns.x.NO_CODECS}));return qn(t,e=>e===Xn.NO_MSE)?zn.x?new ss.u(ae({},r,{code:ns.x.NO_PLAYABLE_STREAMS})):new ss.u(ae({},r,{code:ns.x.NO_MSE})):new ss.u(ae({},r,{code:ns.x.NO_PLAYABLE_STREAMS}))}function le(e,t){void 0===t&&(t=ra);const{hostname:r}=(0,ta.en)(e),i=function(e){const{hostname:t}=(0,ta.en)(e),r=t.split(".");return r.length<=2?t:r.slice(-2).join(".")}(e),s=t.includes(r)||t.includes(i);return s}function de(e){if(void 0===e||!(0,Hi.K)(e))return!1;const{servers:t,advanced:r}=e;return(0,Hi.K)(t)&&(0,li.H)(t["com.apple.fps.1_0"])&&(0,Hi.K)(r)&&(0,Hi.K)(r["com.apple.fps.1_0"])&&(0,li.H)(r["com.apple.fps.1_0"].processSPCPath)}function ce(e){return e.preferNative||ca||Ls.$||de(e.stream.drmConfig)?Gn.$.NATIVE:Gn.$.HLS}function ue(e,t){return-1!==function(e,t,r,i){void 0===r&&(r=0);void 0===i&&(i=fa);for(let s=r;s<e.length;s++)if(i(e[s],t))return s;return-1}(e,t)}function he(e){void 0===e&&(e=window);const{userAgent:t=""}=e.navigator,r=/Android/.test(t),i=function(e){void 0===e&&(e=window);return/Windows Phone/i.test(e.navigator.userAgent)}(e),s=/com\.yandex\.mobile\.metrica\.ads\.sdk.*?Android/.test(t);return r&&!i||s}function pe(e,t){void 0===t&&(t=window);const r=(0,vi.i)(t),i=new RegExp("\\b"+e+"/((?:\\d+)(?:\\.\\d+)*)\\b","i"),s=r.match(i);if(s)return s[1].split(".").map(e=>parseInt(e,10))}function fe(e){return pe("YaBrowser",e)}function me(){return(me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}async function ge(){const e=[];return await Promise.all(Ra.map(async t=>{try{await window.navigator.requestMediaKeySystemAccess(t,_a._),e.push(t)}catch(r){}})),e}function ve(){const e=[];return Ra.forEach(t=>{window.MSMediaKeys.isTypeSupported(t)&&e.push(t)}),e}function ye(e){let{video:t}=e;const r=[];return Ra.forEach(e=>{t.canPlayType("video/mp4",e)&&r.push(e)}),r}function Ee(){const e=[];return[Ta.h9,Ta.oo].forEach(t=>{window.WebKitMediaKeys.isTypeSupported(t,"video/mp4")&&e.push(t)}),e}async function Se(e){return ya&&!(ga.v||ma||oa)?{supportedDrmSystems:[],detectionMethod:ka.YandexBrowserLinux}:function(e){if(!aa(e))return!1;const t=(0,va.P)(e);if(t&&Ea(e))return!1;const r=fe(e);if(void 0===r)return!1;const[i,s,n,a]=r;if(i<18)return!0;if(18===i){if(s>4)return!1;if(t&&n<3)return!0;if(he(e)&&(n<1||!a||a<=526))return!0}return!1}()?{supportedDrmSystems:[],detectionMethod:ka.OldYandexBrowser}:window.WebKitMediaKeys?{supportedDrmSystems:Ee(),detectionMethod:ka.WebKitMediaKeys}:"function"===typeof window.navigator.requestMediaKeySystemAccess?{supportedDrmSystems:await ge(),detectionMethod:ka.requestMediaKeySystemAccess}:"function"===typeof window.MSMediaKeys?{supportedDrmSystems:ve(),detectionMethod:ka.MSMediaKeys}:e.video.webkitGenerateKeyRequest?{supportedDrmSystems:ye(e),detectionMethod:ka.GenerateKeyRequest}:{supportedDrmSystems:[],detectionMethod:ka.NotAvailable}}function Ae(){return Da.canPlayType('video/mp4;codecs="avc1.4D481F"')?{supported:!0,engine:Gn.$.MP4}:Zn}function Te(e){try{return Boolean(e.yandexPlayerSupported)}catch(t){return!1}}function be(){const e=(0,Wr.Y)(()=>parseInt(Ma.ZP.getItem("videoplayer-yandex-player-last-fatal")||"",10))||NaN;if(isNaN(e))return!0;return Date.now()-e>2592e5}async function Re(e){return!(0,xa.RW)("web_disable_yandex_engine")&&(!!Te(e.video)&&(!!be()&&async function(e){try{return(0,qr.m)(La.f.isYandexPlayerSupported)||await new Promise((e,t)=>{La.f.onYandexPlayerSupportedAvailable=e,setTimeout(t,5e3)}),La.f.isYandexPlayerSupported(e)}catch(t){return!1}}(e)))}function we(e){var t,r;if(!Va())return!1;const i=void 0!==e.stream.drmConfig,s=Ta.Ql in((null==(t=e.stream.drmConfig)?void 0:t.servers)||{}),n=Ta.xE in((null==(r=e.stream.drmConfig)?void 0:r.servers)||{});if(i&&!(s||n))return!1;const{pathname:a}=(0,ta.en)(e.stream.url),o=(0,ia.DZ)(e.stream.url);if(Fa())return o;const l=Boolean(Ua())&&a.startsWith("/kal/");return o&&(a.startsWith("/vod/")||/^\/vh-[^/]+\/vod/.test(a)||a.startsWith("/streams/vod-dash-news/")||a.startsWith("/vh-ott-converted/ott-content/")||a.startsWith("/vh-playertest/dash-best-offer/")||l)}function _e(){return(_e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}async function ke(e){const{stream:t,video:r,preferNative:i,disableAndroidPlayer:s}=e,{drmConfig:n,url:a}=t;if(!(e=>function(e){const t=e.trim();return"//"===t.substr(0,2)||"http://"===t.substr(0,7)||"https://"===t.substr(0,8)}(e)&&le(e))(a))return ea;const o=(0,ia.DZ)(a),l=(0,ia.dA)(a);if((0,ia.OI)(a))return Ae();if(!o&&!l)return $n;let d;if(d=o?Ba||(Ba=await da().then(()=>Na).catch(()=>Qn)):await async function(e){try{0,void 0===pa&&(pa=await da());return pa.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')?zn.x?{supported:!0,engine:ce(e)}:de(e.stream.drmConfig)?Jn:ha:zn.x?ua:Zn}catch(t){return zn.x?ua:Qn}}({stream:t,preferNative:i}),!d.supported)return d;if(!s&&Te(r)){if(await Re({video:r,stream:t,playerVersion:"1.0-10769"})&&ie(d))return _e({},d,{engine:Gn.$.YANDEX})}if(void 0===n||!(0,Hi.K)(n))return we({stream:t})?_e({},d,{engine:Gn.$.YASP}):d;return await async function(e,t){const{servers:r={}}=e,i=(0,Ai.Z)(r);if(0===i.length)return!1;const s=await Oa({video:t});return qn(i,e=>ue(s,e))}(n,r)?we({stream:t})?_e({},d,{engine:Gn.$.YASP}):d:Jn}function Pe(e){const t=e.filter(se);if(0===t.length)return;const r=t.find(e=>{let{supportInfo:t}=e;return t.engine===Gn.$.NATIVE}),i=t.find(e=>{let{supportInfo:t}=e;return t.engine===Gn.$.MPD||t.engine===Gn.$.YASP});if(Ya&&qa>=17)return r;const s=ja>=15&&!Ya&&!((Wa||Ga)&&(e=>{let t=!1;e&&(t=qn(Ka.T,t=>e.startsWith("https://"+t+"/live/")||e.startsWith("https://"+t+"/kal/")));return t})(null==i?void 0:i.stream.url));if(Ls.$&&!s&&r)return r;if(i)return i;const n=t.find(e=>{let{supportInfo:t}=e;return t.engine!==Gn.$.MP4});return n||t[0]}async function Ie(e){if(0===e.streams.length)return{status:"error",error:new ss.u({code:ns.x.NO_STREAMS,details:{},isFatal:!0}),streamsWithSupportInfo:[]};const t=await function(e){let{streams:t,video:r,preferNative:i,disableAndroidPlayer:s}=e;return Promise.all(t.map(async e=>({stream:e,supportInfo:await ke({stream:e,video:r,preferNative:i,disableAndroidPlayer:s})})))}(e),r=Pe(t);return r?{status:"success",supportedStream:r,streamsWithSupportInfo:t}:{status:"error",error:oe(t),streamsWithSupportInfo:t}}function Ce(e){return Ka.T.indexOf((0,ta.en)(e).hostname)>-1}async function Oe(e,t){const r=function(e){if(!Ce(e))return;const{protocol:t,host:r}=(0,Qa.en)(e);return t+"//"+r+"/ping"}(e);return async function(e,t){try{return await(0,pn.W)({url:e,withCredentials:t,method:"GET",checkStatus:e=>0!==e,retries:3}),!1}catch(r){return!0}}(r||(0,ta.Ou)((0,Xa.c)(e),"abd","1"),!(0,li.H)(r)&&t)}function De(){return(De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ne(e){const{additionalParams:t=Nn}=e;if(!(0,Hi.K)(e.adConfig))return;const{partnerId:r,adBreaks:i}=e.adConfig;return r||i?De({},e.adConfig,{additionalParams:t}):void 0}function Le(e){if(void 0===e||isNaN(e))return"unknown";for(let t=0;t<Ja.length;t++)if(e<Ja[t].end)return Ja[t].name;return"unknown"}function Me(e){const t=(0,ta.en)(e),r=(0,ta.dD)(t.search),i=(()=>{const e=void 0!==r.start,t=void 0!==r.end;return e||t?"?"+(e?"start="+r.start:"")+(t?(e?"&":"")+"end="+r.end:""):""})();return t.originalPath+i}function xe(e,t){return t&&"boolean"===typeof t.withCredentials?t.withCredentials:!!Ce(e.url)||Ln.withCredentials}function Ve(e){if(void 0===e||isNaN(e))return"unknown";for(let t=0;t<$a.length;t++)if(e<$a[t].end)return $a[t].name;return"unknown"}function Fe(e){const{stream:t,sourceParams:r}=e,i=(0,ta.en)(t.url),s=(0,ta.dD)(i.search);return JSON.stringify([i.pathname,s.start,s.end,null==r?void 0:r.startPosition])}function Ue(e){return e[0]}function Be(e){return Array.isArray(e)}function He(e){const t=so.getItem("playerapi-numbers-session-storage-key"),r=(0,Wr.Y)(()=>JSON.parse(t||""));return function(e,t){const r=e.find(e=>!!Be(e)&&Ue(e)===t);return void 0===r?void 0:r[1]}(Array.isArray(r)?r:[],e)}function je(e,t){const r=so.getItem("playerapi-numbers-session-storage-key"),i=(0,Wr.Y)(()=>JSON.parse(r||"")),s=Array.isArray(i)?i:[];so.setItem("playerapi-numbers-session-storage-key",JSON.stringify(function(e,t,r){const i=function(e,t){return[e,t]}(t,r),s=e.findIndex(e=>!!Be(e)&&Ue(e)===t);for(0===s?e[0]=i:(s>0&&e.splice(s,1),e.splice(0,0,i));10<e.length;)e.pop();return e}(s,e,t)))}function Ye(e,t){try{e.details||(e.details={}),e.details.stage=t}catch(r){}}function We(e,t){return aa(e)?function(e){void 0===e&&(e=window);const t=(0,vi.i)(e).match(/YaBrowser\/([\d.]+)/),r=t&&t[1]||"";return r?parseFloat(r):-1}(e)<18.6?"pip":"x-yandex-pip":"disablePictureInPicture"in t?"disablePictureInPicture":void 0}function Ge(e,t,r){const i=We(e,r);i&&(t?r.removeAttribute(i):r.setAttribute(i,"true"))}function Ke(e,t){return e.responseStart-t.responseStart}function qe(e){return e.responseStart-e.requestStart}function ze(){if("undefined"===typeof window.performance)return NaN;const e=lo.B.reduce((e,t)=>(0,oo.Z)(e,function(e){try{return e.performance.getEntriesByType("resource").filter(e=>{let{name:t,transferSize:r,responseStart:i,requestStart:s}=e;return"string"===typeof t&&r>0&&i>0&&s>0})}catch(t){return[]}}(t),Ke),[]).filter(e=>{let{name:t}=e;return co.l.test(t)});return 0===e.length?NaN:e.reduce((e,t)=>(1.3*e+.7*qe(t))/2,qe(e[0]))}function Xe(e){const t=(0,ta.en)(e).pathname;return 0===t.indexOf("/vod/")||0===t.indexOf("/live/")||0===t.indexOf("/kal/")}function Qe(e){if(e.type===Hls.ErrorTypes.NETWORK_ERROR)return e.networkDetails?e.networkDetails.status:void 0}function Ze(e){if(e.type===Hls.ErrorTypes.NETWORK_ERROR)return e.networkDetails?e.networkDetails.readyState:void 0}function Je(e){if(void 0===e)return;const{level:t,start:r,duration:i,url:s,relurl:n,sn:a,programDateTime:o,deltaPTS:l,dropped:d,endDTS:c,endPTS:u,startDTS:h,startPTS:p}=e;return{level:t,start:r,duration:i,url:s,relurl:n,sn:a,programDateTime:o,deltaPTS:l,dropped:d,endDTS:c,endPTS:u,startDTS:h,startPTS:p}}function $e(){return($e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function et(e){try{return JSON.parse((0,So.Y)($e({},e,{networkDetails:void 0,frag:Je(e.frag)})))}catch(t){return{message:(0,Wr.Y)(()=>t.message)||"Cannot serialize hlsJsError"}}}function tt(){return(tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function rt(e){let{details:t,networkDetails:r}=e;const i=r?r.status:NaN,s=t===Hls.ErrorDetails.MANIFEST_LOAD_ERROR,n=t===Hls.ErrorDetails.LEVEL_LOAD_ERROR;return i===Ao.Ah?s?ns.x.REGIONAL_LIMITATION_MANIFEST:n?ns.x.REGIONAL_LIMITATION_LEVEL:ns.x.REGIONAL_LIMITATION_SEGMENT:Ao.PO.includes(i)?s?ns.x.SIGNATURE_EXPIRED_MANIFEST:n?ns.x.SIGNATURE_EXPIRED_LEVEL:ns.x.SIGNATURE_EXPIRED_SEGMENT:i===Ao.RR?s?ns.x.BANNED_MANIFEST:n?ns.x.BANNED_LEVEL:ns.x.BANNED_SEGMENT:void 0}function it(e){const{details:t,fatal:r}=e;return t?!_o.includes(t)&&(void 0!==rt(e)||Boolean(r)):Boolean(r)}function st(e,t){return void 0===e.err||void 0===e.err.message?"MISSED_STACK__"+t:e.err.message}function nt(e){if(void 0===e)return;const{details:t}=e;if(t===Hls.ErrorDetails.BUFFER_STALLED_ERROR)return;const r=it(e)&&!at(e),i=rt(e)||t||ns.x.DEFAULT_ERROR,{err:{stack:s=new Error(st(e,i)).stack}={stack:void 0}}=e;return new ss.u({code:i,isFatal:r,details:tt({},et(e),{networkErrorStatus:Qe(e),xhrReadyState:Ze(e)}),stack:s})}function at(e){return void 0===rt(e)&&(!!e.details&&bo.includes(e.details))}function ot(e){const{details:t}=e;return!!t&&wo.includes(t)}function lt(e){const t=e.split("x");if(t.length<2)return;const r={rows:parseInt(t[0],10),columns:parseInt(t[1],10)};return isNaN(r.rows)||isNaN(r.columns)?void 0:r}function dt(e,t){const{rows:r,columns:i}=e;if(!r||!i)return null;const{width:s,height:n}=t;return{width:s/i,height:n/r}}function ct(e,t){return 0===e.rows||0===e.columns?0:t/(e.rows*e.columns)}function ut(e,t){if(0===Object.keys(e).length)return;const{uri:r,duration:i,resolution:s,tiles:n}=e;if([r,i,s,n].some(e=>!e))return void(t&&t("NonValidHLSThumbnailTileSessionData"));const a=lt(n),o=function(e){if(""===e)return;const[t,r]=e.split("x"),i={width:parseInt(t,10),height:parseInt(r,10)};return isNaN(i.width)||isNaN(i.height)?void 0:i}(s),l=parseFloat(i);if(void 0===a||void 0===o||isNaN(l))return void(t&&t("MapTileSessionDataParseError"));return{tiles:a,uriTemplate:r,spriteDuration:l,resolution:o,tileSize:dt(a,o),tileDuration:ct(a,l)}}function ht(e,t,r){const i=t===ko.LOWRES?Po:Io,{VALUE:s=""}=e[i.tiles]||{},{VALUE:n=""}=e[i.duration]||{},{VALUE:a=""}=e[i.resolution]||{},{VALUE:o=""}=e[i.uri]||{},l=[s,n,a,o];if(!l.every(e=>""===e)){if(!l.some(e=>""===e))return{tiles:s,duration:n,resolution:a,uri:o};r&&r("NonValidHLSSessionData")}}function pt(e){if(void 0!==e)return{name:e.name,value:String(e.id),lang:e.lang||""}}function ft(e){if(void 0!==e)return{name:e.name,value:String(e.id),lang:e.lang||""}}function mt(e){let{width:t,height:r,bitrate:i}=e;return t+"x"+r+"@"+i}function gt(e){return e+"p"}function vt(e){let{width:t,height:r}=e;const i=!(0,Bi.z)(r)||r<=0;if(!(0,Bi.z)(t)||t<=0||i)return i?"":gt(r);const s=Math.max(t,r),n=Math.min(t,r);let a=Oo[0];for(let o=0;o<Oo.length;o++){if(Oo[o]===n)return gt(Oo[o]);if(s>=Do*Math.floor(16*Oo[o]/9)||n>=Do*Oo[o])return gt(a);a=Oo[o]}return gt(Oo[Oo.length-1])}function yt(e,t){const{attrs:r={},width:i,height:s}=e;if(!(0,Bi.z)(s))return"";const n=vt(e);if(!(0,Bi.z)(i))return n;const a=mt({width:i,height:s,bitrate:r["AVERAGE-BANDWIDTH"]?parseInt(r["AVERAGE-BANDWIDTH"],10):e.bitrate}),o=t.get(a);return void 0===o?n:o}function Et(e,t){if(void 0===e)return;const{height:r,width:i,url:s,bitrate:n}=e;return Array.isArray(s)?{name:yt(e,t),value:s[0],width:i,height:r,bitrate:n?n/1e3:Co.A}:void 0}function St(e,t){const r=function(e,t,r){const i={};return e.filter(e=>Boolean(r(e))).forEach(e=>{const s=t(e);(!i[s]||r(i[s])<r(e))&&(i[s]=e)}),(0,Sa.z)(i)}(e,e=>{let{height:t}=e;return t},e=>{let{bitrate:t}=e;return t}),i=[];return r.forEach(e=>{const r=Et(e,t);r&&i.push(r)}),i}function At(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}function Tt(e){return void 0!==e&&(0,Bi.z)(e)&&e>=0}function bt(e){const{type:t}=e;return t===bn.Z.VOD||!1===e.live?bn.Z.VOD:t===bn.Z.EVENT?bn.Z.EVENT:bn.Z.LIVE}function Rt(e){const t=function(e){let t;void 0===e&&(e=window);try{t=e.devicePixelRatio}catch(r){}return t||1}();return{width:(e.width||e.clientWidth||e.offsetWidth)*t,height:(e.height||e.clientHeight||e.offsetHeight)*t}}function wt(e){const t=e.match(Fo);if(t)return{width:parseInt(t[1],10),height:parseInt(t[2],10),bitrate:parseInt(t[3],10)}}function _t(){return(_t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function kt(e,t){return t.code!==e.util.Error.Code.BAD_HTTP_STATUS?0:t.data[1]||0}function Pt(e,t){if(t.code!==e.util.Error.Code.BAD_HTTP_STATUS)return;const r=kt(e,t),i=t.data[t.data.length-1]===e.net.NetworkingEngine.RequestType.MANIFEST;return(0,Qo.X)(r,i)}function It(e,t){if(!t)return;const r=t,{code:i,severity:s,category:n,data:a}=r;let o="shaka."+function(e,t){let r;for(r in e.util.Error.Code)if(e.util.Error.Code.hasOwnProperty(r)&&t.code===e.util.Error.Code[r])return r;return"ERROR"}(e,r)+"_"+i,l=a,d=s===e.util.Error.Severity.CRITICAL;switch(n){case e.util.Error.Category.NETWORK:l.networkErrorStatus=kt(e,r);const t=Pt(e,r);void 0===t?o+=function(e,t){switch(t.code){case e.util.Error.Code.BAD_HTTP_STATUS:case e.util.Error.Code.HTTP_ERROR:case e.util.Error.Code.TIMEOUT:const r=function(e,t){const{RequestType:r}=e.net.NetworkingEngine;switch(t){case r.APP:return"APP";case r.LICENSE:return"LICENSE";case r.MANIFEST:return"MANIFEST";case r.SEGMENT:return"SEGMENT";case r.TIMING:return"TIMING";default:return}}(e,t.data[t.data.length-1]);return void 0===r?"_UNKNOWN":"_"+r;default:return""}}(e,r):(d=!0,o=t);break;case e.util.Error.Category.DRM:const s=a[0];if(!s||!Ko(s))break;const n=(0,Xo.t)(zo(s));o=String(n.code),l=n.details,d=d||n.isFatal;break;case e.util.Error.Category.PLAYER:if(i===e.util.Error.Code.LOAD_INTERRUPTED)return;break;case e.util.Error.Category.CAST:case e.util.Error.Category.STORAGE:}return new ss.u({code:o,isFatal:d,details:l,message:t.message||o,stack:t.stack})}function Ct(e){return!!(0,Hi.K)(e)&&(!!(0,Bi.z)(e.severity)&&(!!(0,Bi.z)(e.category)&&(!!(0,Bi.z)(e.code)&&!!(0,Zo.k)(e.data))))}function Ot(e,t){return function(e,t){const r=t===ko.HIGHRES?sl:nl,i=e.querySelector(r.version);if(!i||"2"!==i.getAttribute("value"))return;const s=e.querySelector(r.tiles),n=e.querySelector(r.uriTemplate),a=e.querySelector(r.spriteDuration),o=e.querySelector(r.resolution);if(!s||!n||!a||!o)return;const l=s.getAttribute("value"),d=n.getAttribute("value"),c=parseFloat(a.getAttribute("value")||""),u=o.getAttribute("value");if(!l||!u||!d||isNaN(c))return;const h=function(e){const t=e.split("x");if(t.length<2)return;const r={width:parseInt(t[0],10),height:parseInt(t[1],10)};return isNaN(r.width)||isNaN(r.height)?void 0:r}(u);if(!h)return;const p=lt(l);if(!p)return;const f=dt(p,h),m=ct(p,c);return{tiles:p,uriTemplate:d,spriteDuration:c,resolution:h,tileSize:f,tileDuration:m}}(e,t)||function(e,t){const r=(0,ho.w)(e.querySelectorAll('AdaptationSet[mimeType="image/jpeg"]'));let i=r[0];if(!i)return;if(t===ko.LOWRES){let e;if(r.forEach(t=>{t.querySelector('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:type"][value="'+ko.LOWRES+'"]')&&(e=t)}),!e)return;i=e}const s=i.querySelector("SegmentTemplate"),n=i.querySelector("Representation"),a=i.querySelector("EssentialProperty");if(!s||!n||!a)return;const o=a.getAttribute("value"),l=s.getAttribute("media"),d=parseFloat(s.getAttribute("duration")||""),c=parseFloat(n.getAttribute("width")||""),u=parseFloat(n.getAttribute("height")||""),h={width:c,height:u};if(!o||!l||!d||!c||!u)return;const p=lt(o);if(!p)return;const f=dt(p,h),m=ct(p,d);return{tiles:p,uriTemplate:l,spriteDuration:d,resolution:h,tileSize:f,tileDuration:m}}(e,t)}function Dt(e,t){const r=function(e,t){let{stream:r}=e,{audio:i=0,video:s=0}=t;if(!r||!ml())return;const{type:n}=r;switch(n){case"audio":return(0,fl.R)(i,3);case"video":return(0,fl.R)(s,3);default:return}}(e,t);void 0!==r&&(e.uris=e.uris.map(e=>function(e,t){const{hostname:r}=(0,ta.en)(e);return r.match(gl)?(0,ta.Sr)(e,{bufsize:String(t)}):e}(e,r)))}function Nt(e){return(e.getAttribute("id")||"")+"@"+(e.getAttribute("width")||"")+"x"+(e.getAttribute("height")||"")+";"}function Lt(e){return(0,ho.w)(e.querySelectorAll("Representation")).map(Nt).sort()}function Mt(e,t,r){void 0===e&&(e=[]);const i=e.find(e=>{var i,s;const n=(null==(i=e.video)?void 0:i.originalId)===t,a=(null==(s=e.audio)?void 0:s.originalId)===r;return n&&a});if(void 0!==i)return i.id;const s=function(e,t,r){void 0===t&&(t=e=>Boolean(e));void 0===r&&(r=e.length-1);for(let i=r;i>=0;i--)if(t(e[i],i,e))return i;return-1}(e,e=>{var r;return(null==(r=e.video)?void 0:r.originalId)===t});return-1===s?void 0:e[s].id}function xt(e,t){if(!t||!e)return;const r='AdaptationSet > Representation[id="'+t+'"]',i=e.querySelector(r);if(!i)return;const s=i.parentElement;if(!s)return;const n=s.getAttribute("lang");return n?n.toLowerCase():void 0}function Vt(e){const t=function(){if(void 0!==Ca)return Ca.supportedDrmSystems}();return void 0!==e&&(0,Hi.K)(e.servers)&&void 0!==t&&t.filter(t=>(0,wl.n)(e.servers,t)).map(e=>{for(const t in ba)if((0,wl.n)(ba,t)&&ba[t].includes(e))return t;return!1}).filter(Boolean).join("|")||"none"}function Ft(e,t){const{width:r,height:i,bandwidth:s}=e;if(!(0,Bi.z)(i))return"";const n=vt(e);if(!(0,Bi.z)(r)||!(0,Bi.z)(s))return n;const a=mt({width:r,height:i,bitrate:s}),o=t.get(a);return void 0===o?n:o}function Ut(){return(Ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Bt(){return(Bt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ht(){return(Ht=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function jt(e){let t,r=Hl.Z,i=0;const s=e=>{i=e.status,t=e.response};return{promise:new Promise((t,i)=>{(0,Ms.W)(Ht({},e,{onSuccess:e=>{s(e),t(e)},onError:(e,t)=>{s(t),i(e)},onAbort:i,onSetup:e=>{let{abort:t}=e;return r=t}}))}),abort:e=>r(e),getStatus:()=>i,getResponse:()=>t}}function Yt(){return(Yt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Wt(e){return String.fromCharCode(...Array.from(e))}function Gt(e){return e.charCodeAt(0)}function Kt(e){return Array.from(e,Gt)}function qt(){return(qt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function zt(e){return"number"!==typeof(t=Math.floor(2*e)/2)||isNaN(t)||!isFinite(t)?0:t;var t}function Xt(e){return void 0===e?[]:(e.testIds||"").split(",").map(e=>parseInt(e,10)).filter(Bi.z)}function Qt(){return(Qt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Zt(e){return!!(0,qr.m)(La.f.isYandexPlayerFeatureEnabled)&&La.f.isYandexPlayerFeatureEnabled(Qt({},e,{browserVersion:ad,browserType:nd,playerVersion:"1.0-10769"}))}function Jt(){return(Jt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function $t(e){if(e in gd)return gd[e];const t=document.createElement("link");return t.rel="preload",t.as="script",gd[e]=new Promise((r,i)=>{t.onload=r,t.onerror=i,t.href=e,t.crossOrigin="anonymous",md.appendChild(t)}).then(()=>{gd[e]=Promise.resolve()}).catch(()=>{delete gd[e],md.removeChild(t)}),gd[e]}function er(){return(er=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function tr(e){return"videoplayer-iframe-api-raa-cache-"+e.autoplay+"-"+e.allowMuted+"-"+e.muted}function rr(e){return(0,Wr.Y)(()=>{const t=JSON.parse(na.t.getItem(tr(e))),{time:r,cacheVersion:i}=t,s=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(t,Td);return 2!==i?null:Date.now()-r<2592e5?s:null})||null}function ir(e){const t=e.navigator;if(!t)return;const{userActivation:r}=t;if(!(0,Hi.K)(r))return;const{isActive:i,hasBeenActive:s}=r;return{isActive:i,hasBeenActive:s}}function sr(e){const t=()=>Rd.forEach(e=>window.removeEventListener(e,r)),r=r=>{"pagehide"===r.type&&r.persisted||(e(r),t())};return Rd.forEach(e=>window.addEventListener(e,r)),t}function nr(e){return"ya-video-player-"+e}function ar(e,t){const r=t.getElementById(nr(e));let i=r&&r.parentElement;return i=i&&i.parentElement,i||void 0}function or(e,t){if(void 0===t&&(t=window),!t||!t[e]||!t[e].prototype)return;const{play:r}=t[e].prototype;return r&&(0,bi.E)(r)?r:void 0}function lr(){return(lr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function dr(e){let{canPlayUnMuted:t,canPlayMuted:r,detectionMethod:i}=e;return{canPlayUnMuted:t,canPlayMuted:r,requireMute:!t&&r,requireUserGesture:!t&&!r,detectionMethod:i}}function cr(e){if("boolean"===typeof e.allowedToPlay)return Promise.resolve(function(e){const t=Md(e);return e.muted=!1,e.volume=1,e.allowedToPlay?(t(),dr({canPlayUnMuted:!0,canPlayMuted:!0,detectionMethod:kd.YaBroAllowedToPlay})):(e.muted=!0,e.volume=0,e.allowedToPlay?(t(),dr({canPlayUnMuted:!1,canPlayMuted:!0,detectionMethod:kd.YaBroAllowedToPlay})):(t(),dr({canPlayUnMuted:!1,canPlayMuted:!1,detectionMethod:kd.YaBroAllowedToPlay})))}(e));return Bl.g&&qa<=9?Promise.resolve(lr({},Vd,{detectionMethod:kd.IOS9OrLess})):Yr.Y?xd?Promise.resolve(lr({},Fd,{detectionMethod:kd.OldIE})):void 0:Promise.resolve(lr({},Vd,{detectionMethod:kd.HTML5VideoIsNotSupported}))}function ur(e){let t,r,{videoSlot:i,autoplay:s,muted:n,allowMuted:a}=e;if(!s){const e={autoplay:!1,muted:n,detectionMethod:Bd.AutoplayDisabled};return{promise:Promise.resolve(e),abort:cn.Z}}return{promise:new Promise(async e=>{t=e;const{promise:s,stop:o}=function(e,t){let{checkSoundEnabled:r=!0}=void 0===t?{}:t;const i=cr(e),s=new Ud(e,{checkSoundEnabled:r,promise:i});return{promise:s.promise,stop:s.stop}}(i,{checkSoundEnabled:!n});r=o;const{requireMute:l,requireUserGesture:d,detectionMethod:c}=await s.catch(()=>Fd);e(function(e){let{requireUserGesture:t,requireMute:r,muted:i,allowMuted:s,detectionMethod:n}=e;return t?{autoplay:!1,muted:i,autoplayImpossible:!0,detectionMethod:n}:r?i||s?{autoplay:!0,muted:!0,detectionMethod:n}:{autoplay:!1,muted:i,autoplayImpossible:!0,requireAllowMutedToAutoplay:!0,detectionMethod:n}:{autoplay:!0,muted:i,detectionMethod:n}}({requireUserGesture:d,requireMute:l,muted:n,allowMuted:a,detectionMethod:c}))}),abort:()=>{r(),t({autoplay:!0,muted:n,detectionMethod:Bd.RASAborted})}}}function hr(e,t){return void 0===e?void 0===t:"auto"in e&&!0===e.auto?t===xl.A:e.value===t}function pr(e,t,r){void 0===r&&(r=yl());let i=t;return function(){var t;if(0===arguments.length)return;const s=(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],n=r(s,i)||Number.isNaN(s)&&Number.isNaN(i);return n?void 0:(i=s,e(...arguments))}}function fr(e,t){const{controller:{textTrackValue:r,textTracks:i,userTextTrackName:s,userTextTrackLang:n}}=e.getState();if(r)return void t.setTextTrack(r);const a=(0,Wd.Y)(i,{name:s,lang:n})||function(e){if(0===e.length)return;const t=function(e,t){if("string"!==typeof t)return;const r=t.split("-")[0].toLowerCase();for(let i=0;i<e.length;i++){const t=e[i];if(t.name.toLowerCase()===r)return t}}(e,navigator.language);return void 0!==t?t:e[0]}(i);void 0===a?is.Y.error("No text tracks to enable"):t.setTextTrack(a.value)}function mr(e,t){const r=e.getState(),{skin:{nativeControlsVisibility:i},controller:{textTrackEnabled:s,nativeTextTrackVisible:n,isPip:a}}=r,o=void 0===n||n||a||Boolean(i&&s);t.toggleNativeSubtitles(o)}function gr(e,t){const{skin:{hiddenControls:r}}=e.getState();t.setHiddenControls(r)}function vr(e,t){const r=e.getState(),{controller:{videoType:i,playbackRate:s,encoderState:n}}=r;i!==bn.Z.VOD&&n===Sn.y.Attached&&((0,Pn.I)(r)||(s>1+ic._?function(e){const{controller:{currentTime:t,bufferingRanges:r,engine:i},skin:{skinDVRStartTime:s,skinDVRDuration:n}}=e;if(0===r.length)return!1;const a=i===Gn.$.NATIVE?5:0;return n===1/0||t>s+n-a}(r)&&t.setPlaybackRate(1):!function(e){const{controller:{currentTime:t,dvrStartTime:r,dvrDuration:i}}=e;return t<r||t>r+i}(r)&&function(e){const{controller:{videoType:t}}=e;if(t!==bn.Z.LIVE)return!1;const{controller:{currentTime:r},skin:{skinDVRStartTime:i}}=e;return i+(0===r?0:Rn.W)>r}(r)&&t.setPlaybackRate(1)))}async function yr(e,t){const{controller:{autoplay:r,encoderState:i}}=e.getState();r&&i===Sn.y.Attached&&await Promise.all([new Promise(t=>{e.setControllerStateField(Cn.jY.autoplay,!1),t()}),t.play()])}function Er(e){const t=function(e){return Ce(e)&&(0,ta.en)(e).pathname.slice(1).split("/")[1]||""}(e);return{channel:t,metaInfoUrl:"https://strm.yandex.net/kal/"+t+"/break/last?start_ts={{video-timestamp}}"}}function Sr(e,t){const r=e.height||0;return(t.height||0)-r}function Ar(){return(Ar=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Tr(e){void 0===e&&(e=window);const t=(0,vi.i)(e).match(/YaBrowser\/([\d]+)\.([\d]+)/);if(!t)return{major:-1,minor:-1};const[,r,i]=t;return{major:parseInt(r,10),minor:parseInt(i,10)}}function br(){return aa(window)&&!Bl.g&&!Wa}function Rr(e,t){return Mi.some(r=>{if(!e[r.element])return!1;let i=t;for(;i;){if(e[r.element]===i)return!0;i=i.parentElement}return!1})}function wr(e){let{url:t,adConfig:r,additionalParams:i}=e;t=((e,t)=>{if(!e||!t)return e;const r={"partner-id":"number"===typeof t.partnerId?String(t.partnerId):t.partnerId,"video-category-id":"number"===typeof t.category?String(t.category):t.category,"imp-id":String(t.impId),gzip:"1"};return(0,ta.Sr)(e,r,{override:!0,saveOriginalPath:!0})})(t,r);const{from:s,vsid:n}=i,a=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(i,Dc);return t=(0,ta.Sr)(t,{from:s,vsid:n},{override:!0,saveOriginalPath:!0}),(0,ta.Sr)(t,a,{override:!1,saveOriginalPath:!0})}function _r(){return(_r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function kr(e,t){var r,i;if(!e.servers)return e;const s={};(0,Nc.J)(e.servers).forEach(e=>{let[r,i]=e;!function(e){const{hostname:t}=(0,ta.en)(e);return-1!==Lc.indexOf(t)}(i)?s[r]=i:s[r]=(0,ta.Ou)(i,"vsid",t)});const n=_r({},e);n.servers=s;const a=n;return null!=(r=a.advanced)&&null!=(i=r[Ta.Ql])&&i.serverCertificateUrl&&(a.advanced=_r({},a.advanced,{[Ta.Ql]:_r({},a.advanced[Ta.Ql],{serverCertificateUrl:(0,ta.Ou)(a.advanced[Ta.Ql].serverCertificateUrl,"vsid",t)})})),function(e){if(!(0,Hi.K)(e))return!1;if(!(0,Hi.K)(e.servers)||!("com.apple.fps.1_0"in e.servers))return!1;if(!(0,Hi.K)(e.advanced)||!("com.apple.fps.1_0"in e.advanced))return!1;const t=e.advanced["com.apple.fps.1_0"];if(!(0,Hi.K)(t))return!1;const{processSPCPath:r}=t;return(0,li.H)(r)}(n)&&(n.advanced=_r({},n.advanced,{[Ta.h9]:_r({},n.advanced[Ta.h9],{processSPCPath:(0,ta.Ou)(n.advanced[Ta.h9].processSPCPath,"vsid",t)})})),n}function Pr(){return(Pr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ir(e){void 0===e&&(e={});const t={};for(const r in e){const i=e[r],s=typeof i;"string"!==s&&"number"!==s&&"boolean"!==s||(t[r]=i)}return t}function Cr(){const{plugins:e}=window.navigator;return void 0===e||0===e.length?[]:((e,t,r)=>{const i=new Array(e.length);for(let s=0;s<e.length;s++)i[s]=t.call(r,e[s],s,e);return i})(e,Ir)}function Or(){const e=window.navigator||{},t=window.performance||{},{location:r,referrer:i}=M(document);return{navigator:Pr({},Ir(e),{connection:Ir(e.connection),plugins:Cr()}),performance:{memory:Ir(t.memory)},playerLocation:location.href,iframeApiLocation:r,iframeApiReferrer:i}}function Dr(e){return[...e.hash.substr(1).split("&"),...e.search.substr(1).split("&")].reduce((e,t)=>{const[r,i]=t.split("=");return void 0!==i&&(e[r]=decodeURIComponent(i.replace(/\+/g," "))),e},{})}function Nr(){return(Nr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Lr(e){return(0,qr.m)(e.toJSON)?e.toJSON():e}function Mr(){return(Mr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function xr(e,t,r){if(void 0===r&&(r=window),!r.history)return;if(Pd>-1&&Pd<=15)return;const i=((e,t,r)=>{const i=Mr({},Dr(e));i.mq_url=void 0,i.lq_url=void 0,i.hq_url=void 0,i.hd_url=void 0,i.stream_url=r?(0,Qa.Hn)(r,["vsid","partner-id","video-category-id","imp-id","gzip"]):"",i.additional_params="object"===typeof t.additionalParams?JSON.stringify(t.additionalParams):void 0;const{adConfig:s={}}=t;return i.partner_id=Bc(s.partnerId),i.category=Bc(s.category),i.imp_id=Bc(s.impId),i.distr_id=Bc(s.distrId),i.video_content_id=Bc(s.videoContentId),i.video_content_name=Bc(s.videoContentName),i.video_publisher_id=Bc(s.videoPublisherId),i.video_publisher_name=Bc(s.videoPublisherName),i.video_genre_id=Bc(s.videoGenreId),i.video_genre_name=Bc(s.videoGenreName),i.start_position=Bc(t.startPosition),i.loop=Bc(t.loop),i.with_credentials=Bc(t.withCredentials),i.preview=Bc(t.preview),i.host=e.hostname,i})(r.location,e,t),s=(0,Qa.Sr)(r.location.href.split("?")[0].split("#")[0],i);try{r.history.replaceState(void 0,"",s)}catch(n){}}function Vr(){return(Vr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Fr(e){const t=e.getVideoType(),r=e.getTimelineInfo();if(!1===Gc())return r;if(t!==bn.Z.LIVE)return r;const{currentTime:i,utcStartTime:s,dvrStartTime:n,dvrDuration:a}=r;return{dvrDuration:a,dvrStartTime:(s||0)+n,utcStartTime:0,duration:1/0,currentTime:(s||0)+i}}function Ur(e,t){if(!1===Gc())return t;if(e.getVideoType()!==bn.Z.LIVE)return t;const{utcStartTime:r=0}=e.getTimelineInfo();return t.map(e=>{let{start:t,end:i}=e;return{start:r+t,end:r+i}})}function Br(e,t){if(!1===Gc())return t;if(e.getVideoType()!==bn.Z.LIVE)return t;const{utcStartTime:r=0}=e.getTimelineInfo();return t-r}function Hr(){return Kc?Kc.getSourceId():NaN}r(7369);var jr=r(4230),Yr=r(4506);(function(){function e(){const e=t.apply(this);return(0,jr.v)(e),e}if(!Yr.Y)return;const t=HTMLMediaElement.prototype.play;e.__yaMuffleVideoPlayPromiseOriginalPlay=t,HTMLMediaElement.prototype.play=e})();var Wr=r(2818);"toJSON"in Error.prototype||Object.defineProperty(Error.prototype,"toJSON",{value(){const e={};return(0,Wr.Y)(()=>{Object.getOwnPropertyNames(this).forEach((function(t){e[t]=this[t]}),this)}),e},configurable:!0,writable:!0});var Gr=r(4586),Kr=r(2239),qr=r(6351);r(5235),r(7873),r(9418),function(e){void 0===e&&(e=(0,Kr.b)(window));try{if("1"===localStorage.getItem("rumdebug"))return console&&(0,qr.m)(console.warn)&&console.warn("using rumdebug=1 from localStorage"),!0}catch(t){}return/[?&#]rumdebug=1(?:[&#]|$)/.test(e)}()&&(0,Gr.v)({win:window,src:"https://yastatic.net/s3/home/rum/debug/blockstat.js"});var zr=r(8194),Xr=r(5357),Qr=r(3120);const Zr="3036",Jr="2923";var $r=r(5865),ei=r(4334),ti=r(3424);const ri=(e,t)=>{for(const r of t.split(".")){if(!s(e)){e=void 0;break}e=e[r]}return e},ii="__ADB_CONFIG__",si=s(ii)&&ii.fn&&i(ii.fn.encodeUrl)?ii.fn.encodeUrl:void 0,ni=void 0===si?void 0:e=>si(e),ai=e=>{if(ni)return ni;const t=(0,ti.T)(e);for(;t.length;){const e=t.pop();if(!e)continue;const r=ri(e,"ya.videoAd.encodeUrl");if(i(r))return r}};var oi=r(2420),li=r(8833);let di;const ci=(void 0===(ui=window)&&(ui=window),di||(di=ui.document.createElement("div")),di);var ui;const hi=(e,t)=>{const r="undefined"!==typeof ci.style[e];if(r&&t&&(0,li.H)(t))try{ci.style.cssText=e+": "+t+";";const r=Boolean(ci.style.cssText);return ci.style.cssText="",r}catch(i){return!1}return r},pi=["","webkit","moz","o","ms"],fi={},mi=function(e){return void 0===e&&(e=""),fi[e]||function(e){const t=""+e[0].toUpperCase()+e.slice(1);for(let r=0;r<pi.length;r++){const i=pi[r],s=i?""+i+t:e;if(hi(s))return fi[e]=s}return fi[e]=e}(e)};var gi=r(2905),vi=r(1247);const yi=function(e){return void 0===e&&(e=window),(0,vi.i)(e).indexOf("SamsungBrowser")>-1}();var Ei=r(3945),Si=r(2055),Ai=r(5999);const Ti=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const{resolver:i,preparers:s}=a(t);let n,o=null,l=null;return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(o&&o.every((e,r)=>t[r]===e))return n;const a=s.map(e=>e(...t));if(l&&l.every((e,t)=>a[t]===e))return o=t,n;const d=i(...a);return o=t,l=a,n=d,d}};var bi=r(5638),Ri=r(141);const wi={xml:"http://www.w3.org/XML/1998/namespace",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"},_i={};(0,Ri.M)({xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type"},(function(e,t){const r=e.split(":"),i=wi[r[0]];i&&(_i[t]=i)}));const ki="classList"in document.documentElement,Pi=Ti(e=>e.classList&&e.classList.add,bi.E),Ii=(Ti(e=>e.classList&&e.classList.remove,bi.E),Ti(e=>e.classList&&e.classList.toggle,bi.E),(()=>{const e=document.createElement("p");return!!ki&&(e.classList.add("c1","c2"),!!e.classList.contains("c2")&&(e.classList.toggle("c3",!1),!e.classList.contains("c3")))})()),Ci=((()=>{const e=document.createElement("p");!!ki&&(e.classList.toggle("a",!1),e.classList.contains("a"))})(),e=>e.split(" ").filter(e=>Boolean(e))),Oi=Ii?(e,t)=>{const r=Ci(t);e.classList.add(...r)}:(e,t)=>{const r=Ci(t);for(let i=0;i<r.length;i++)e.classList.add(r[i])};var Di=r(2439),Ni=r(9738),Li=r(1725);const Mi=[{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}},{enabled:"webkitSupportsFullscreen",element:"webkitDisplayingFullscreen",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}}];var xi=r(8692),Vi=r(5386),Fi=r(8062);const Ui=e=>(e=>e instanceof Promise||"Promise"===(0,Fi.M)(e)&&Boolean((0,Wr.Y)(()=>(0,bi.E)(e.constructor))))(e)||(e=>Boolean((0,Wr.Y)(()=>(0,qr.m)(e.then)&&(0,qr.m)(e.catch))))(e);var Bi=r(7187),Hi=r(3770),ji=r(4343),Yi=r(5595),Wi=r(5779),Gi=r(7746),Ki=(r(7881),r(6538)),qi=r(6),zi=r(4489),Xi=r(5636);const Qi=NaN;var Zi=r(9329),Ji=r(1122);let $i,es;!function(e){e.BroadcastAdReceived="BroadcastAdReceived",e.BroadcastAdInit="BroadcastAdInit",e.StreamPlayerReceivedMetadata="StreamPlayerReceivedMetadata",e.StreamPlayerChooseMetadata="StreamPlayerChooseMetadata",e.PlayWithoutRAAResults="PlayWithoutRAAResults",e.CanPlay="CanPlay",e.ContentImpression="ContentImpression",e.WaitForPlayCompleted="WaitForPlayCompleted",e.DrmSystemsSupportDetected="DrmSystemsSupportDetected",e.InrollAdStart="InrollAdStart",e.InrollAdPodStart="InrollAdPodStart",e.InrollAdPodEnd="InrollAdPodEnd",e.InrollAdEnd="InrollAdEnd",e.PlayAdViewers="PlayAdViewers",e.AdStart="AdStart",e.AdPodImpression="AdPodImpression",e.AdPodLoading="AdPodLoading",e.AdPodError="AdPodError",e.AdPodStart="AdPodStart",e.AdPodEnd="AdPodEnd",e.AdEnd="AdEnd",e.AdClickThru="AdClickThru",e.NoAdPodsToPlayAd="NoAdPodsToPlayAd",e.Stalled="Stalled",e.NudgeStalledFailed="NudgeStalledFailed",e.LoadSource="LoadSource",e.PrerollInit="PrerollInit",e.WaitForUserGesture="WaitForUserGesture",e.WaitForDocumentVisibility="WaitForDocumentVisibility",e.CallPublicApiAfterDestroy="CallPublicApiAfterDestroy",e.HiddenAutoplayPrevented="HiddenAutoplayPrevented",e.PlayVideoOnVisibilityChange="PlayVideoOnVisibilityChange",e.PauseVideoOnVisibilityChange="PauseVideoOnVisibilityChange",e.StreamStopWhileLoadingMultiroll="StreamStopWhileLoadingMultiroll",e.StreamStopWhileChoosingStream="StreamStopWhileChoosingStream",e.StreamStopWhileDestroyVideoController="StreamStopWhileDestroyVideoController",e.StreamStopDuringDefineAutoplaySettings="StreamStopDuringDefineAutoplaySettings",e.StreamStopWhileWaitingForPlay="StreamStopWhileWaitingForPlay",e.StreamStopWhileWaitingForDocumentVisibility="StreamStopWhileWaitingForDocumentVisibility",e.StreamStopWhileLoadingPreroll="StreamStopWhileLoadingPreroll",e.StreamStopWhilePreloadingPreroll="StreamStopWhilePreloadingPreroll",e.SkippableFragmentWidgetDrawn="SkippableFragmentWidgetDrawn",e.SkippableFragmentWidgetHidden="SkippableFragmentWidgetHidden",e.HlsJsLoadSourceCalledTwice="HlsJsLoadSourceCalledTwice",e.PreloadSource="PreloadSource",e.UsePreloadedHlsJs="UsePreloadedHlsJs",e.PlayAfterWaitingForDocumentVisibility="PlayAfterWaitingForDocumentVisibility",e.ResourcesIdle="ResourcesIdle",e.ClientInfo="ClientInfo",e.HlsJsForceCappingStart="HlsJsForceCappingStart",e.CanRenderSkinCalledBeforeSkinIsReady="CanRenderSkinCalledBeforeSkinIsReady",e.ExternalPlaybackOpenButtonClick="ExternalPlaybackOpenButtonClick",e.ExternalPlaybackCloseButtonClick="ExternalPlaybackCloseButtonClick",e.ExternalPlayerListVisibleStatusChange="ExternalPlayerListVisibleStatusChange",e.ExternalPlaybackPlayerCsrfFetching="ExternalPlaybackPlayerCsrfFetching",e.ExternalPlaybackPlayerCsrfFetchSuccess="ExternalPlaybackPlayerCsrfFetchSuccess",e.ExternalPlaybackPlayerCsrfFetchError="ExternalPlaybackPlayerCsrfFetchError",e.ExternalPlaybackPlayerListHasAnyDevice="ExternalPlaybackPlayerListHasAnyDevice",e.ExternalPlaybackPlayerListFetching="ExternalPlaybackPlayerListFetching",e.ExternalPlaybackPlayerListFetchSuccess="ExternalPlaybackPlayerListFetchSuccess",e.ExternalPlaybackPlayerListFetchError="ExternalPlaybackPlayerListFetchError",e.ExternalPlaybackPlayerListAboutInfoClick="ExternalPlaybackPlayerListAboutInfoClick",e.ExternalPlaybackPlayerListRefresh="ExternalPlaybackPlayerListRefresh",e.ExternalPlaybackPlayerActivate="ExternalPlaybackPlayerActivate",e.ExternalPlaybackPlayerActivateSucceed="ExternalPlaybackPlayerActivateSucceed",e.ExternalPlaybackPlayerActivateFailed="ExternalPlaybackPlayerActivateFailed",e.ExternalPlaybackCsrfTokenExpired="ExternalPlaybackCsrfTokenExpired",e.YandexRpcError="YandexRpcError",e.Seek="Seek",e.MediaInternalsHistoryOnFatal="MediaInternalsHistoryOnFatal",e.PlayInrollAd="PlayInrollAd",e.ShareButtonClick="ShareButtonClick",e.FPSControllerRestrictions="FPSControllerRestrictions",e.NativeVideoTypeChange="NativeVideoTypeChange"}($i||($i={})),function(e){e.preroll="preroll",e.midroll="midroll",e.postPauseroll="postPauseroll",e.postroll="postroll",e.inroll="inroll"}(es||(es={}));var ts=r(9730);let rs;!function(e){e.AdCompleted="AdCompleted",e.LoadSource="LoadSource",e.PlayerDestroy="PlayerDestroy",e.CutOff="CutOff",e.PlayerError="PlayerError",e.AdTypeChange="AdTypeChange",e.InsertIntoCalled="InsertIntoCalled",e.AdSkipped="AdSkipped"}(rs||(rs={}));var is=r(7182),ss=r(5921),ns=r(7985);const as={play:Gi.X.PLAY,pause:Gi.X.PAUSE,end:Gi.X.END,idle:Gi.X.PAUSE};class os extends Ji.V{constructor(e){super(),this.params=e,this.destroyPromise=new Promise(e=>{this.addDestroyHandler(()=>{e()})}),this.currentAdPlaybackController=void 0,this.playbackQueue=[],this.logAdStart=(0,Vi.I)(()=>{const e=this.getAdTypeForLogs(),t=this.playbackQueue.length,{logEvent:r}=this.params;r({event:$i.AdStart,params:{adPodsCount:t,adType:e}}),e===es.inroll&&r({event:$i.InrollAdStart,params:{adPodsCount:t}})}),this.logAdEnd=(0,Vi.I)(()=>{const e=this.getAdTypeForLogs(),t=this.playbackQueue.length,{logEvent:r}=this.params;e===es.inroll&&r({event:$i.InrollAdEnd,params:{adPodsCount:t}}),r({event:$i.AdEnd,params:{stopAdReason:this.destroyReason||rs.AdCompleted,adPodsCount:t,adType:e}})}),this.adPodIndex=0,this.startPlayingAd=(0,Vi.I)(async()=>{for(this.logAdStart();this.adPodIndex<this.playbackQueue.length&&!this.isDestroyed;)await this.playAdPod(this.playbackQueue[this.adPodIndex]),this.adPodIndex++;this.logAdEnd();const e=this.playbackQueue[this.playbackQueue.length-1];this.isDestroyed||void 0===e||(0,Wr.Y)(()=>{this.params.onLastAdPodStopped({adType:e.adViewer.getAdBreakType()})}),this.destroy(rs.AdCompleted)}),this.dispatchOnFirstAdPodStarted=(0,Vi.I)(()=>{this.params.onFirstAdPodStarted()}),this.updateAdPodCloseState=e=>{this.params.onAdPodCloseStateChange(e.getAdPodCloseState())},this.updateAdVolumeAvailabilityStateChange=e=>{this.params.onAdVolumeAvailabilityStateChange(e.getAdVolumeAvailabilityState())},this.updateAdPodTimeToSkip=e=>{const t=e.getAdPodTimeToSkip();this.params.onAdPodTimeToSkipChange((0,Bi.z)(t)?Math.ceil(t):void 0)},this.playAdPod=async e=>{let{adType:t,adViewer:r,additionalData:i,adDisplayConfig:s,posterUrl:n,adElement:a}=e;if(0===r.getAdPodsCount())return void is.Y.log("AdViewer is empty");const{logEvent:o}=this.params;if(o({event:$i.AdPodLoading,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}}),t===es.inroll){const{cueId:e}=i;o({event:$i.InrollAdPodStart,params:{adPodsCount:this.playbackQueue.length,cueId:e}}),r.setStatsRootFields({cueid:e})}const l=m({videoSlotCanAutoPlay:!0,controlsSettings:this.params.getControlsSettings(),visibilitySlot:this.params.playerContainer,lang:this.params.lang,contentAfterAd:this.getContentAfterAd(t,n),enableNewSkin:!0,adSequence:{index:this.adPodIndex,count:this.playbackQueue.length},requestFullscreenStateChange:this.params.onRequestFullscreenStateChange},s),d=r.createPlaybackController(this.params.video,a,l);this.currentAdPlaybackController=d,this.updateAdPodDuration(d),this.params.onAdPodCurrentTimeChange(0),this.params.onAdSkippableStateChange(d.getAdSkippableState()),this.updateAdPodCloseState(d),this.updateAdVolumeAvailabilityStateChange(d),d.subscribe("AdPlayingStateChange",()=>{this.updateAdPodPlayingStateChange()}),d.subscribe("AdMediaStateChange",()=>{this.updateAdPodPlayingStateChange()}),d.subscribe("AdRemainingTimeChange",()=>{const e=d.getAdPodRemainingTime(),t=this.updateAdPodDuration(d);this.params.onAdPodCurrentTimeChange(t-e),this.updateAdPodTimeToSkip(d),this.updateAdPodPlayingStateChange()}),d.subscribe("AdPodError",()=>{this.params.onAdPodError()}),d.subscribe("AdInteraction",()=>{this.params.onAdInteraction()}),d.subscribe("AdSkippableStateChange",e=>{this.updateAdPodTimeToSkip(d),this.params.onAdSkippableStateChange(e.skippableState)}),d.subscribe("AdStartRejected",e=>{this.params.onAdStartRejected(new Error("AdStartRejected"))}),d.subscribe("AdPodDurationChange",()=>{this.updateAdPodDuration(d)}),d.subscribe("AdPodStartRequest",()=>{this.params.onBeforeAdPodStart({adPlaybackController:d})}),d.subscribe("AdPodStarted",()=>{var e;const t=null==(e=d.getCurrentViewerAssets())?void 0:e.isFullyClickable;o({event:$i.AdPodStart,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i,isFullyClickable:t}}),this.dispatchOnFirstAdPodStarted(),this.params.onAdPodStarted({isFullyClickable:t}),this.updateAdPodPlayingStateChange(),this.updateAdPodDuration(d)});const c=()=>{this.params.onAdPodDurationChange(void 0),this.params.onAdPodCurrentTimeChange(void 0),this.params.onAdSkippableStateChange(!1),this.params.onAdPodTimeToSkipChange(void 0),this.params.onAdPodCloseStateChange(void 0)};d.subscribe("AdPodStopped",()=>{c(),this.params.onAdPodStopped()}),d.subscribe("AdPodSkipped",()=>{c(),this.params.onAdPodSkipped()}),d.subscribe("AdContentSizeChange",()=>{const e=d.getAdContentSize();if(void 0===e)return;const{width:t,height:r}=e;this.params.onAdSizeChange({width:(0,Bi.z)(t)?t:NaN,height:(0,Bi.z)(r)?r:NaN})}),d.subscribe("AdPodImpression",()=>{o({event:$i.AdPodImpression,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}})}),d.subscribe("AdPodError",e=>{o({event:"AdPodError",params:m({},e,{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i})})}),d.subscribe("AdClickThru",()=>{this.params.onAdClickThru(),o({event:"AdClickThru",params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}})}),this.shouldSkipAllAdPods()&&d.subscribe("AdPodSkipped",()=>{this.destroy(rs.AdSkipped)}),d.subscribe("AdPodCloseStateChange",()=>{this.updateAdPodCloseState(d)}),d.subscribe("AdVolumeAvailabilityStateChange",()=>{this.updateAdVolumeAvailabilityStateChange(d)}),await new Promise(e=>{d.subscribe("AdStopped",e),d.playAd(),this.params.onAdPodPlayingStateChange({adType:t,playingState:Gi.X.BUFFERING,expectedStalledReason:0===this.adPodIndex?ts.k.AdStart:ts.k.AdBetween})}),this.currentAdPlaybackController=void 0,o({event:$i.AdPodEnd,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}}),t===es.inroll&&(o({event:$i.InrollAdPodEnd,params:{adPodsCount:this.playbackQueue.length,cueId:i.cueId}}),r.setStatsRootFields({cueid:void 0}))},this.addDestroyHandler(()=>{this.currentAdPlaybackController&&(this.currentAdPlaybackController.stopAd(),this.currentAdPlaybackController=void 0)})}getUtcPositionBeforeAd(){return this.params.utcPositionBeforeAd}getQueueDuration(){return f(this.playbackQueue.map(e=>{let{adViewer:t}=e;return t}))}playAdViewers(e){this.isDestroyed||(this.playbackQueue.push(e),this.addDestroyHandler(()=>{e.adViewer.destroy()}),Promise.resolve().then(()=>this.startPlayingAd()))}resumeAd(){this.currentAdPlaybackController&&(this.currentAdPlaybackController.resumeAd(),this.updateAdPodPlayingStateChange())}pauseAd(){this.currentAdPlaybackController&&(this.currentAdPlaybackController.pauseAd(),this.updateAdPodPlayingStateChange())}skipAdPod(){this.currentAdPlaybackController&&this.currentAdPlaybackController.skipAd()}setVolume(e){this.currentAdPlaybackController&&this.currentAdPlaybackController.setAdVolume(e)}getDestroyPromise(){return this.destroyPromise}getAdTypeForLogs(){const[e]=this.playbackQueue;return e?e.adType:(this.params.onError(new ss.u({code:ns.x.AD_TYPE_IS_NOT_RECOGNIZED,isFatal:!1})),"unrecognized")}updateAdPodPlayingStateChange(){if(!this.currentAdPlaybackController)return;const e=this.currentAdPlaybackController.getAdMediaState(),t=this.currentAdPlaybackController.getAdPlayingState(),r=this.playbackQueue[this.adPodIndex].adPodType,i=this.params.video.src,s="stalled"===(null==e?void 0:e.name)&&i?{adType:r,playingState:Gi.X.BUFFERING,expectedStalledReason:ts.k.AdOther}:{adType:r,playingState:as[t],expectedStalledReason:void 0};this.params.onAdPodPlayingStateChange(s)}updateAdPodDuration(e){const t=e.getAdPodDuration();return this.params.onAdPodDurationChange(t),t}shouldSkipAllAdPods(){var e;return Boolean(null==(e=this.params.adConfig)?void 0:e.skipAllAdPods)||!1}getContentAfterAd(e,t){const r=this.playbackQueue.length-1===this.adPodIndex,i=this.shouldSkipAllAdPods(),s=t?[{url:t}]:[];switch(e){case es.preroll:return r||i?{type:"startVideo",poster:s}:{type:"nextAd",poster:[]};case es.postroll:return{poster:[]};case es.midroll:case es.postPauseroll:case es.inroll:return r||i?{type:"continueVideo",poster:s}:{type:"nextAd",poster:[]};default:return{poster:[]}}}}var ls=r(4513);const ds=900;var cs=r(4532);let us;!function(e){e.original="original"}(us||(us={}));class hs{constructor(e,t){this.parent=e,this.element=document.createElement("div");const{style:r}=this.element;r.backgroundColor=function(e){switch(e){case us.original:return"rgba(0, 255, 0, 0.5)";default:throw new Error("Unexpected BroadcastAdType ["+e+"]")}}(t),r.width="10px",r.height="10px",r.cssFloat="left",r.marginRight="1px"}setVisibility(e){e?this.show():this.hide()}show(){this.parent.appendChild(this.element)}hide(){(0,cs.L)(this.element)}}class ps{constructor(e){this.element=document.createElement("div"),e.appendChild(this.element);const{style:t}=this.element;t.position="absolute",t.bottom="1px",t.left="1px"}createIndicator(e){return new hs(this.element,e)}}let fs;!function(e){e.INVALID_INROLL_FRAME="INVALID_INROLL_FRAME",e.INVALID_START="INVALID_START",e.CROSSED_BY_INVALID="CROSSED_BY_INVALID",e.MAX_DURATION="MAX_DURATION"}(fs||(fs={}));class ms extends Zi.v{constructor(){super(...arguments),this.adIntervals=[]}handleInrollFrame(e){if(!function(e){if(e.offset<-6e5||e.offset>63e4)return!1;if(void 0===e.cutoff)return!0;if(e.cutoff<-6e5||e.cutoff>63e4)return!1;const t=e.cutoff-e.offset;return t>=5e3&&t<=6e5}(e))return is.Y.warn("invalid inroll frame:",e),void this.handleInvalidInrollFrame(e,fs.INVALID_INROLL_FRAME);const t=this.adIntervals.find(t=>{let{cueId:r}=t;return r===e.cue_id});if(!t)return this.addAdIntervalByFastFrame(e);this.updateAdIntervalByInrollFrame(t,e)}validateAdIntervalsByTimestamp(e){for(let t=0;t<this.adIntervals.length;t++){const r=this.adIntervals[t];if(r.start>e)return;if(!r.isValid||r.isEndReceived)continue;if(e-r.start>6e5){this.invalidateAdInterval(r,fs.MAX_DURATION);continue}const i=this.adIntervals[t+1];if(!i)return;i.start<=e&&this.invalidateAdInterval(r,fs.CROSSED_BY_INVALID)}}handleInvalidInrollFrame(e,t){const r=this.adIntervals.find(t=>{let{cueId:r}=t;return r===e.cue_id});if(r)return this.invalidateAdInterval(r,t),void this.updateAdIntervalByInrollFrame(r,e);const i=A(e);this.invalidateAdInterval(i,t),this.pushAdInterval(i)}addAdIntervalByFastFrame(e){const t=A(e);return this.pushAdInterval(t),t.isValid?t:void 0}updateAdIntervalByInrollFrame(e,t){const r=t.pts+t.offset;if(Math.abs(e.start-r)>1e3)return void this.invalidateAdInterval(e,fs.INVALID_START);if(e.isEndReceived)return;const i=void 0!==t.cutoff,s=i?t.pts+t.cutoff:S(t.pts,e.start);e.isEndReceived=i,e.end=s,this.handleUpdatedAdInterval(e)}findCrossedAdIntervals(e){return this.adIntervals.filter(t=>e!==t&&(e.start<t.start?e.end>t.start:t.end>e.start))}pushAdInterval(e){const t=this.findCrossedAdIntervals(e);t.length&&this.invalidateAdInterval(e,fs.CROSSED_BY_INVALID),this.adIntervals.push(e),this.adIntervals.sort((e,t)=>{let{start:r}=e,{start:i}=t;return r-i}),this.invalidate(t,fs.CROSSED_BY_INVALID),e.isValid&&this.emit("AdIntervalUpdated",e)}handleUpdatedAdInterval(e){const t=this.findCrossedAdIntervals(e);if(t.length)return t.push(e),void this.invalidate(t,fs.CROSSED_BY_INVALID);e.isValid&&this.emit("AdIntervalUpdated",e)}invalidate(e,t){e.forEach(e=>{this.invalidateAdInterval(e,t)})}invalidateAdInterval(e,t){e.isValid&&(e.isValid=!1,e.invalidateReason=t,this.emit("InvalidAdInterval",{reason:t,cueId:e.cueId}))}}class gs{constructor(){this.ads=[],this.postAdsIds=[]}add(e){if(this.postAdsIds.indexOf(e.cueId)>-1)return;const t=this.findById(e.cueId);t?t.startTime=e.startTime:this.ads.push(T({},e,{adViewers:e.adViewers.reduce((e,t)=>e.concat(t.separateAdPods()),[])}))}getAdViewers(e,t){const[r,i]=function(e,t){const r=[],i=[];return((e,t,r)=>{for(let i=0;i<e.length;i++)t.call(r,e[i],i,e)})(e,(s,n)=>{t(s,n,e)?r.push(s):i.push(s)}),[r,i]}(this.ads,r=>{let{startTime:i,endTime:s,cueId:n,adViewers:a}=r;if(n!==t)return!1;if(e<i)return!1;if(s-15e3<e)return!1;for(const t of a){if(e+1e3*t.getAdDuration()<s)return!0}return!1});if(0===r.length)return[];this.postAdsIds.push(...r.map(e=>{let{cueId:t}=e;return t})),this.ads=i,r.sort((e,t)=>e.startTime-t.startTime);let s=0;const n=[];for(const{adViewers:a,endTime:o,cueId:l}of r)for(const t of a){const r=e+1e3*s;if(o-15e3<r)break;o<r+1e3*t.getAdDuration()||(n.push({adViewer:t,additionalData:{cueId:l},adType:es.inroll}),s+=t.getAdDuration())}return n}findById(e){return this.ads.find(t=>{let{cueId:r}=t;return r===e})}}class vs extends ls.M{constructor(e){let t,{video:r,slot:i,playerApi:s,playerStore:n,stateController:a,onError:o}=e;super(),this.adIntervalStorage=new ms,this.isEnabled=!0,this.adIndicators=void 0,this.inrolls=new gs,this.playerApi=void 0,this.playerStore=void 0,this.stateController=void 0,this.onError=void 0,this.adIndicators=new ps(i),this.playerApi=s,this.playerStore=n,this.stateController=a,this.onError=o;const l=this.adIndicators.createIndicator(us.original);r.addEventListener("timeupdate",()=>{const e=this.playerStore.getState(),i=y(e);if(t!==i){const e=void 0!==i;l.setVisibility(e),t=i}const s=E(e);s&&(this.adIntervalStorage.validateAdIntervalsByTimestamp(s),this.isEnabled&&!r.paused&&(this.stateController.updateOriginalAdState(),this.handleInrolls()))}),this.adIntervalStorage.on("AdIntervalUpdated",e=>{this.emit("AdIntervalUpdated",{cueId:e.cueId,start:e.start,end:e.end})}),this.adIntervalStorage.on("InvalidAdInterval",e=>{let{cueId:t,reason:r}=e;is.Y.warn("invalid ad interval: [cueId="+t+"] [reason="+r+"]"),this.onError(new ss.u({code:ns.x.INVALID_METADATA,details:{cueId:t,reason:r},isFatal:!1})),this.emit("AdIntervalRemoved",t)})}handleInrollFrame(e){const t=this.adIntervalStorage.handleInrollFrame(e);if(!t)return Promise.resolve();const{cueId:r,start:i,end:s,isEndReceived:n}=t,a=n?s+15e3:i+6e5;return this.addInroll(r,i,a,{inrollFrame:e})}setEnabled(e){this.isEnabled=e}async addInroll(e,t,r,i){let{inrollFrame:s}=i;this.playerApi.callbacks.logEvent({event:$i.BroadcastAdReceived,params:{cueId:e,podStart:t,adType:es.inroll}});const n=this.playerApi.getMultiroll(),a=await n.inroll.loadViewers(b({},s));if(0===a.length)return;const o=f(a);this.playerApi.callbacks.logEvent({event:$i.BroadcastAdInit,params:{cueId:e,podStart:t,duration:o,adPodsCount:a.length,adType:es.inroll}}),this.inrolls.add({adViewers:a,cueId:e,startTime:t,endTime:r})}handleInrolls(){const e=this.playerStore.getState(),t=E(e);if(!t)return;const r=y(e);if(!r)return;const i=this.inrolls.getAdViewers(t,r);i.length&&this.emit("InrollAdPlayRequest",i)}}class ys{constructor(){this.stopReasonInternal=void 0,this.stopDeferred=new Xi.B}stop(e){this.stopReasonInternal=e,this.stopDeferred.resolve(e)}get stopReason(){return this.stopReasonInternal}get stopPromise(){return this.stopDeferred.promise}}const Es=(e,t,r)=>{const i=[];for(let s=0;s<e.length;s++){const n=e[s];t.call(r,n,s,e)&&i.push(n)}return i};var Ss=r(6377);const As=[].find,Ts=I(As)?(e,t)=>As.call(e,t):(e,t)=>{for(let r=0;r<e.length;r++){const i=e[r];if(t(i,r,e))return i}};var bs=r(8139),Rs=r.n(bs);const ws="DEFAULT_ERROR_MESSAGE",_s="0",ks="",Ps="?:?:?";class Is extends Error{constructor(){const e=2===arguments.length?arguments.length<=0?void 0:arguments[0]:void 0,t=2===arguments.length?arguments.length<=1?void 0:arguments[1]:arguments.length<=0?void 0:arguments[0],r=s(i=e)&&(0,li.H)(i.name)&&(0,li.H)(i.message)||"object"===typeof e&&e&&"code"in e&&"details"in e?e:{message:String(e||ws)};var i;super(),Object.defineProperty(this,"originalError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toString",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toJSON",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.originalError="object"===typeof e&&e?e:{unknown:e,unknownStr:String(e)},Rs()(this,Is.prototype);const n=t.code||r.code||r.id||_s,a=t.message||r.message||ws;this.message="VAS Error ["+n+"]"+(a?"["+a+"]":""),this.code=n,this.details=t.details||r.details||ks;const o=r.stack||function(e){const{url:t,line:r,col:i,fileName:s,columnNumber:n,lineNumber:a}=e;return(t||s||"?")+":"+(r||a||"?")+":"+(i||n||"?")}(r);let l=o===Ps?this.stack:o;if(l&&l!==Ps)this.stack=l;else if(!this.stack)try{throw new Error(this.message)}catch(d){this.stack=l=d.stack||Ps}this.toString=()=>C(this.toJSON()),this.toJSON=()=>({originalError:this.originalError,message:this.message,code:this.code,details:this.details,stack:l})}}const Cs=(e,t,r)=>{for(let i=0;i<e.length;i++)t.call(r,e[i],i,e)},Os=function(e,t){let r=e[t];if(!I(r)){const s=r;try{delete e[t];const i=e[t];"function"===typeof i&&(r=i),e[t]=s}catch(i){}}return r}(Array,"isArray"),Ds=Boolean(Os)?e=>Os.call(Array,e):e=>"Array"===(0,Fi.M)(e);class Ns{constructor(e){Object.defineProperty(this,"dispatch",{enumerable:!0,configurable:!0,writable:!0,value:D(e=>{this.value=e,this._isDispatched=!0,function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];Ds(e)&&Cs(e,e=>{"function"===typeof e&&e(...r)})}(this.callbacks,e),this.callbacks.length=0})}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_isDispatched",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i(e)&&this.callbacks.push(e)}subscribe(e){return this._isDispatched?(e(this.value),O):(this.callbacks.push(e),()=>{this.callbacks=Es(this.callbacks,t=>t!==e)})}getDispatched(){return this._isDispatched}getValue(){return this.value}wait(){return new Promise(e=>{this.subscribe(e)})}}var Ls=r(3211),Ms=r(874);const xs=e=>(0,bi.E)(e.navigator.sendBeacon),Vs=xs(window);class Fs{constructor(e){let{defaultProbability:t,rnd:r,vsid:i,serviceName:s,serviceVersion:n}=e;Object.defineProperty(this,"rnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vsid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultProbability",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:e=>{let{error:t}=e;this.push({eventName:String(t.code),eventType:"error",eventData:t,probability:1})}}),this.rnd=r,this.vsid=i,this.defaultProbability=t,this.serviceName=s,this.serviceVersion=n}log(e){let{name:t,probability:r,data:i}=e;this.push({eventType:"event",eventName:t,probability:r,eventData:i})}push(e){let{eventType:t,eventName:r,probability:i=this.defaultProbability,eventData:s}=e;if(this.rnd<i){const e="https://log.strm.yandex.ru/log?"+t+"="+r,i=JSON.stringify({service:"VAS",eventType:t,eventName:r,rnd:this.rnd,vsid:this.vsid,data:s,topLocation:M(document).location,version:"loadVasModule_"+(this.serviceName||"unknown")+"_"+(this.serviceVersion||"unknown")});0;if(function(e,t){return!!Vs&&window.navigator.sendBeacon(e,t)}(e,i))return;(0,Ms.W)({url:e,data:i,method:"POST"})}}}const Us=(e,t)=>{try{return e.localStorage.getItem(t)}catch(r){return null}},Bs=(e,t)=>{const r=x(e,t);return"false"!==r&&Boolean(r)},Hs=function(e){let t,r,i=!1,s=!1,n=!1;return N(()=>{t=function(e){const t=x(e,"adsdkecmaver");if("ES2017"===t||"ES5"===t)return t;return}(e)}),N(()=>{n=Boolean(x(e,"adsdkdebug"))}),N(()=>{r=x(e,"adsdkver")}),N(()=>{i=Boolean(x(e,"vasnetworklogs"))}),N(()=>{s=Bs(e,"vasfulldebug")}),n&&(console.warn("adsdkdebug is deprecated, use vasfulldebug instead"),s=!0),s&&(i=!0),{adsdkecmaver:t,vasfulldebug:s,vasnetworklogs:i,adsdkver:r,adsdkdebug:n}}(window),js=Hs.vasnetworklogs?1:.05;const Ys=(0,r(2447).M)();var Ws=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]])}return r};const Gs=e=>{const{expFlags:t}=e,r=Ws(e,["expFlags"]),i={},n={};return Cs(e.expFlags,e=>{Cs(e,e=>{let{CONTEXT:{FLAGS:t},TESTID:r}=e;s(t)&&Cs(function(e){if("function"===typeof Object.keys)return Object.keys(e);const t=[];for(const r in e)V(e,r)&&t.push(r);return t}(t),e=>{var s;const a=t[e];i[e]=a,n[e]=null!==(s=n[e])&&void 0!==s?s:[],n[e].push({value:a,testId:r[0]})})})}),F({flags:i,flagsMap:n},r)},Ks={testIds:"",flags:{}};D(()=>{try{return __UAAS_CFG__}catch(e){return e}});const qs=e=>{if((0,Ss.V)(e))return{error:e,config:Ks};try{const t=s(e)?e:JSON.parse(""+(e||"")),r=(e=>!!s(e)&&!(!("expFlags"in e)||!Ds(e.expFlags)))(t)?Gs(t):t;if(!((e,t)=>{if(!s(t))throw new Error("Parsed replaced macro is not an object: "+e);if(P(t.testIds),!("flags"in t)||!s(t.flags))throw new Error("Parsed replaced macro has no flags field: "+e);return!0})(String(e),r))throw new Error("UAAS config is not valid: "+e);return{error:void 0,config:r}}catch(t){return{error:t,config:Ks}}},zs=e=>{var t;const{error:r,config:i}=qs(e);if(!r){const e=i.flags,r=null!==(t=e.ADSDKVER)&&void 0!==t?t:e.VAS_STABLE_VERSION,s=_(r)?r:void 0;if(_(s))return{version:s,parsedUaasConfig:i,parseUaasConfigError:void 0}}return{version:void 0,parsedUaasConfig:void 0,parseUaasConfigError:r}},Xs=(e=>(e=>{try{if("noModule"in e.HTMLScriptElement.prototype)return!0}catch(t){}return!1})(e)&&xs(e))(window)?"ES2017":"ES5",Qs={ES5:"bundles",ES2017:"bundles-es2017"},Zs=B(B({},{InPage:"inpage",AdLoader:"loader",VideoBannerAd:"videobannerad",Multiroll:"multiroll",YaMusicAPI:"ya-music-api",VpaidPlayer:"vpaid_player",Rum:"rum"}),{MotionTailor:"motion_ad_creative",Survey:"survey"}),Js="undefined"===typeof BUNDLES_PATH?"":BUNDLES_PATH,$s=("undefined"===typeof BUNDLE_NAME||BUNDLE_NAME,"undefined"===typeof BUILD_TIME||BUILD_TIME,["a","n.ya","nd","ex.ru"].join(""),["y","a","nde","x.ru"].join(""),["ya","sta","tic.net"].join("")),en=(["ver","ify.y","a","nde","x.ru"].join(""),"https://"+$s+"/vas-bundles/");var tn=r(6794);const rn=()=>new Promise((e,t)=>{(0,Ms.W)({method:"GET",url:"https://yandex.ru/ads/system/video-ads-sdk/vas_uaas",responseType:"json",retries:2,onSuccess:t=>{e(t.response)},onError:()=>{t(new Error("Cannot load uaas"))}})});var sn=r(6838);let nn;try{nn=BUILD_VERSION}catch(tu){nn="INVALID_BUILD_VERSION"}const an="VAS",on=e=>Y(e.substr(-4),4,"0"),ln=(void 0===(dn="1")&&(dn=nn),[(0,sn.a)(44),an,on(dn),Y(Date.now().toString().slice(0,10),10,"0")].join("x"));var dn;var cn=r(55),un=r(959);const hn={subpageIndex:(0,un.bk)(),deltas:{}};var pn=r(897),fn=r(5809);const mn={inStreamPlayingState:void 0,adConfig:void 0,adInfo:void 0,originalBroadcastAdCueId:void 0,originalBroadcastAdCues:{},adblockDetected:!1,hasPreroll:!1,adSyncInit:!1,nextAdInfo:void 0,nativeAdControlsVisibility:!0},gn=Math.max(0,0);var vn=r(2843);const yn="0000000000000000000000000000000000000000000000000000000000000000";var En=r(1062),Sn=r(675);const An={autoplay:!1,initialAutoplay:!1,allowMuted:!0,autoplayImpossible:!1,startStage:En.o.init,preload:!0,from:void 0,encoderState:Sn.y.Detached,vsid:yn,streams:[],stream:void 0,sourceParams:void 0,sourceId:0,volume:1,muted:!1,userVolume:NaN,duration:NaN,currentTime:gn,currentTimeLowGranularity:gn,watchedTime:0,startPosition:{},programDateTime:void 0,fragmentDuration:vn.D,dvrStartTime:0,dvrDuration:NaN,videoType:void 0,playingState:Gi.X.PAUSE,bufferingRanges:[],preview:void 0,isFullscreen:!1,isPip:!1,isVisible:void 0,togglePlaybackOnVisibilityChangeSetting:void 0,errorInfo:{},lastRecoverPosition:void 0,isOnline:!0,isDocumentVisible:!0,lastKnownBandwidthEstimate:{value:NaN,source:"default"},isAbrSupported:!1,isAbrEnabled:!1,defaultQuality:720,feed:!1,videoTrackValue:void 0,videoTracks:[],userVideoTrackName:void 0,userVideoTrackHeight:void 0,audioTrackValue:void 0,audioTracks:[],userAudioTrackName:void 0,userAudioTrackLang:void 0,textTrackEnabled:!1,nativeTextTrackVisible:void 0,textTrackValue:void 0,textTracks:[],userTextTrackEnabled:void 0,userTextTrackLang:void 0,userTextTrackName:void 0,playbackRate:1,expectedStalled:{reason:ts.k.Init,details:{}},videoWidth:0,videoHeight:0,playerConfig:void 0,preloadDetails:void 0},Tn={hiddenControls:[],useNativeSubtitles:!1,nativeControlsVisibility:!0,skinDVRStartTime:0,skinDVRDuration:0};var bn=r(4651),Rn=r(1291);const wn={min:0,max:1/0},_n={min:1,max:1/0},kn={min:0,max:1};var Pn=r(492),In=r(9004),Cn=r(9696);let On;!function(e){e.ApiPlay="ApiPlay",e.VolumeChange="VolumeChange",e.MuteChange="MuteChange"}(On||(On={}));var Dn=r(7588);const Nn={from:Dn.K,reqid:void 0,hash:void 0,vsid:yn},Ln={startPosition:{},additionalParams:Nn,adConfig:void 0,withCredentials:!1,loop:!1,preview:"",videoInfo:{}};const Mn=r(6620)._;var xn=r(4885);let Vn;!function(e){e.VideoIsNotPausedOnInit="VideoIsNotPausedOnInit",e.DetectByInterval="DetectByInterval",e.VideoPlayEvent="VideoPlayEvent",e.PlayCallback="PlayCallback"}(Vn||(Vn={}));var Fn=r(4519),Un=r(7382);var Bn=r(3992);let Hn,jn;!function(e){e[e.PLAYING=1]="PLAYING",e[e.NOT_PLAYING=2]="NOT_PLAYING"}(Hn||(Hn={})),function(e){e.INIT="INIT",e.SET_SOURCE="SET_SOURCE"}(jn||(jn={}));var Yn=r(9908);let Wn;!function(e){e.setSource="setSource",e.destroy="destroy",e.end="end"}(Wn||(Wn={}));var Gn=r(3486);let Kn;!function(e){e.SetMuted="SetMuted",e.SetVolume="SetVolume",e.RequestAutoplaySettings="RequestAutoplaySettings",e.VolumeChangeEvent="VolumeChangeEvent",e.RestoreSavedMuted="RestoreSavedMuted"}(Kn||(Kn={}));const qn=(e,t)=>{for(let r=0;r<e.length;r++)if(t(e[r],r,e))return!0;return!1};var zn=r(7018);let Xn;!function(e){e.NO_MSE="NO_MSE",e.NO_CODECS="NO_CODECS",e.NO_SUPPORTED_DRM="NO_SUPPORTED_DRM",e.NO_SUPPORTED_FORMAT="NO_SUPPORTED_FORMAT",e.INVALID_STREAM_URL="INVALID_STREAM_URL"}(Xn||(Xn={}));const Qn={supported:!1,noSupportReason:Xn.NO_MSE},Zn={supported:!1,noSupportReason:Xn.NO_CODECS},Jn={supported:!1,noSupportReason:Xn.NO_SUPPORTED_DRM},$n={supported:!1,noSupportReason:Xn.NO_SUPPORTED_FORMAT},ea={supported:!1,noSupportReason:Xn.INVALID_STREAM_URL};var ta=r(222);const ra=["yandex.ru","yandex.net","yastatic.net","yandex-team.ru","kinopoisk.ru","strm-ott.akamaized.net"].concat([]);var ia=r(4055);const sa=function(e){void 0===e&&(e=window);const t=e.MediaSource||e.WebKitMediaSource;return t&&(0,qr.m)(t.isTypeSupported)&&!function(e){void 0===e&&(e=window);const t=e.SourceBuffer||e.WebKitSourceBuffer;return!!t&&!(t.prototype&&(0,qr.m)(t.prototype.appendBuffer)&&(0,qr.m)(t.prototype.remove))}(e)?t:void 0}();var na=r(6612);const aa=function(e){return void 0===e&&(e=window),/YaBrowser/.test((0,vi.i)(e))},oa=aa(),la="detect.probe_mse_support.success",da=(0,Vi.I)(()=>{if(void 0===sa)return Promise.reject(new Error("MSE is not supported"));if(function(){if(!oa)return!1;try{return void 0!==window.top.WEB_NTP_VERSION}catch(e){return!1}}())return Promise.resolve(sa);(0,$r.iW)(la),(0,$r.iW)("detect.probe_mse_support.fail");if(function(){try{const e=na.t.getItem("videoplayer-supported-mse");if(null===e)return;const{value:t,time:r,version:i}=JSON.parse(e);if(Date.now()-r>2592e5)return void na.t.removeItem("videoplayer-supported-mse");if("1"!==i)return;return t||void 0}catch(e){return}}())return(0,$r.vG)(la),Promise.resolve(sa);const e=document.createElement("video"),t=new sa,r=URL.createObjectURL(t);let i,s;const n=new Promise((n,a)=>{i=()=>{n(sa);try{na.t.setItem("videoplayer-supported-mse",JSON.stringify({value:!0,time:Date.now(),version:"1"}))}catch(e){}},s=()=>a(new Error("MSE is not supported")),t.addEventListener("sourceopen",i),e.addEventListener("error",s),e.addEventListener("durationchange",s),e.src=r});return n.then(()=>(0,$r.vG)(la)).catch(()=>(0,$r.vG)("detect.probe_mse_support.fail")).then(()=>{URL.revokeObjectURL(r),t.removeEventListener("sourceopen",i),e.removeEventListener("error",s),e.removeEventListener("durationchange",s)}),n});(0,jr.v)(da());const ca=function(e){void 0===e&&(e=window);const t=(0,vi.i)(e).toLowerCase();return/yandexstation.*yandexio/.test(t)||/station.*crosswalk/.test(t)}(),ua={supported:!0,engine:Gn.$.NATIVE},ha={supported:!0,engine:Gn.$.HLS};let pa;const fa=(e,t)=>e===t,ma=function(e){return void 0===e&&(e=window),/Chrome/.test(e.navigator.userAgent)&&/Google Inc/.test(e.navigator.vendor)&&!aa(e)}();var ga=r(1076),va=r(6487);const ya=function(e){void 0===e&&(e=window);const t=(0,vi.i)(e).toLowerCase();return/linux/.test(t)&&!he(e)}(),Ea=function(e){return void 0===e&&(e=window),/YandexSearch|YaSearchBrowser|YaApp_iOS|YaApp_Android/i.test((0,vi.i)(e))};var Sa=r(5269),Aa=r(228),Ta=r(7922);const ba={[Aa.W.fairplay]:[Ta.D,Ta.h9,Ta.oo],[Aa.W.widevine]:[Ta.Ql],[Aa.W.playready]:[Ta.xE],[Aa.W.none]:[]},Ra=(wa=(0,Sa.z)(ba),[].concat.apply([],wa));var wa,_a=r(4956);let ka,Pa;!function(e){e.YandexBrowserLinux="YandexBrowserLinux",e.OldYandexBrowser="OldYandexBrowser",e.WebKitMediaKeys="WebKitMediaKeys",e.requestMediaKeySystemAccess="requestMediaKeySystemAccess",e.MSMediaKeys="MSMediaKeys",e.GenerateKeyRequest="GenerateKeyRequest",e.Constant="Constant",e.NotAvailable="NotAvailable",e.LiteMode="LiteMode"}(ka||(ka={}));const Ia=[];let Ca;const Oa=(0,Vi.I)(async e=>{let{video:t}=e;const r=function(){try{const e=na.t.getItem("videoplayer-supported-drm-systems");if(null===e)return;const{value:t,time:r,version:i}=JSON.parse(e);if(Date.now()-r>2592e5)return void na.t.removeItem("videoplayer-supported-drm-systems");if("5cf106bd72fcbae675ee9e1a47da14ea"!==i)return void na.t.removeItem("videoplayer-supported-drm-systems");if(0===t.supportedDrmSystems.length)return;return t}catch(e){return}}();(0,$r.iW)("detect.drm");const i=r||await async function(e){void 0===Pa&&(Pa=Se(e));const t=await Pa;return me({},t,{supportedDrmSystems:[...t.supportedDrmSystems]})}({video:t});return Ia.forEach(e=>e(i)),Ia.length=0,Ca=i,void 0===r&&function(e){if(0!==e.supportedDrmSystems.length)try{na.t.setItem("videoplayer-supported-drm-systems",JSON.stringify({value:e,time:Date.now(),version:"5cf106bd72fcbae675ee9e1a47da14ea"}))}catch(t){}}(i),(0,$r.vG)("detect.drm"),i.supportedDrmSystems}),Da=document.createElement("video"),Na={supported:!0,engine:Gn.$.MPD};var La=r(9278),Ma=r(2741);var xa=r(5543);const Va=(0,Vi.I)(()=>(0,xa.RW)("web_yasp_enable")),Fa=(0,Vi.I)(()=>(0,xa.RW)("web_yasp_live")),Ua=(0,Vi.I)(()=>(0,xa.RW)("web_yasp_live_kal"));let Ba;var Ha=r(9317);const ja=function(e){if(void 0===e&&(e=window),Ha.G&&e.navigator&&e.navigator.userAgent){const t=e.navigator.userAgent.match(/version\/(\d+)/i);if(t){const e=Number(t[1]);if(e)return e}}return-1}(),Ya=function(e){return void 0===e&&(e=window),(0,va.P)(e)&&(0,vi.i)(e).toLowerCase().indexOf("iphone")>-1}(),Wa=navigator&&"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,Ga=function(e){void 0===e&&(e=window);const t=e.navigator.userAgent.toLowerCase();return/ipad/.test(t)&&(0,va.P)(e)}();var Ka=r(2248);const qa=function(e){if(void 0===e&&(e=window),(0,va.P)(e)&&e.navigator){const t=e.navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);if(t)return parseInt(t[1],10)}return-1}();var za=r(5334),Xa=r(3564),Qa=r(5946);const Za={destroy:cn.Z,setStatsRootFields:cn.Z,dispatchEvent:cn.Z,getNextAdInfo:()=>{},preroll:{loadViewers:()=>Promise.resolve([])},midroll:{loadViewers:()=>Promise.resolve([])},inroll:{loadViewers:()=>Promise.resolve([]),schedule:cn.Z},postroll:{loadViewers:()=>Promise.resolve([])},postPauseroll:{loadViewers:()=>Promise.resolve([])}},Ja=[{end:0,name:"invalid"},{end:750,name:"750)"},{end:1250,name:"[750-1250)"},{end:2e3,name:"[1250-2000)"},{end:3500,name:"[2000-3500)"},{end:5500,name:"[3500-5500)"},{end:9e3,name:"[5500-9000)"},{end:1e6,name:"[9000"},{end:1/0,name:"infinity"}],$a=[{end:0,name:"invalid"},{end:100,name:"100"},{end:250,name:"250"},{end:500,name:"500"},{end:750,name:"750"},{end:1e3,name:"1000"},{end:1500,name:"1500"},{end:2500,name:"2500"},{end:5e3,name:"5000"},{end:1/0,name:"infinity"}];var eo=r(2786),to=r(4929);class ro extends Ji.V{constructor(e){super(),this.history=new to.y(100),this.addDestroyHandler((0,Ei.O)(e,"logposted",e=>{is.Y.log("chrome://media-internals event",e.data),this.history.push(e.data)})),this.addDestroyHandler(()=>{this.history=null})}getHistory(){return this.history?[...this.history.getAll()]:["MediaInternalsHistory is destroyed"]}}class io extends Zi.v{constructor(){super(),this.once("Destroy",(0,Ei.O)(window,"online",()=>{this.emit("Online")})),this.once("Destroy",(0,Ei.O)(window,"offline",()=>{this.emit("Offline")}))}destroy(){this.emit("Destroy")}}const so={setItem(e,t){try{sessionStorage.setItem(e,t)}catch(tu){}},getItem(e){try{return sessionStorage.getItem(e)}catch(tu){return null}},removeItem(e){try{sessionStorage.removeItem(e)}catch(tu){}}};class no{constructor(){this.videoContentId=void 0,this.lastProgress=void 0}setVideoContentId(e){this.lastProgress=void 0,this.videoContentId=e}clearVideoContentId(){this.lastProgress=void 0,this.videoContentId=void 0}getProgress(){if(!this.videoContentId)return;const e=He(this.videoContentId);return(0,Bi.z)(e)?e:void 0}saveProgress(e){this.videoContentId&&("number"===typeof this.lastProgress&&Math.abs(this.lastProgress-e)<1||(this.lastProgress=e,je(this.videoContentId,e)))}}var ao=r(9304);var oo=r(6197),lo=r(2440),co=r(7841),uo=r(6902),ho=r(7469),po=r(6567),fo=r(7554),mo=r(6636);const{isSupported:go}=r(1673),vo=go();var yo=r(442),Eo=r(2613);var So=r(8468),Ao=r(6432);const{ErrorDetails:To}=r(7179),bo=[To.FRAG_LOAD_ERROR,To.FRAG_LOAD_TIMEOUT,To.FRAG_PARSING_ERROR,To.BUFFER_APPEND_ERROR,To.INTERNAL_EXCEPTION,To.LEVEL_LOAD_TIMEOUT,To.MANIFEST_LOAD_ERROR,To.MANIFEST_LOAD_TIMEOUT],Ro=[To.FRAG_LOAD_ERROR,To.FRAG_LOAD_TIMEOUT,To.FRAG_PARSING_ERROR,To.LEVEL_LOAD_TIMEOUT],wo=[To.MANIFEST_LOAD_ERROR,To.MANIFEST_LOAD_TIMEOUT],_o=[To.FRAG_DECRYPT_ERROR,To.FRAG_PARSING_ERROR,To.BUFFER_STALLED_ERROR,To.BUFFER_NUDGE_ON_STALL];let ko;!function(e){e.LOWRES="lowres",e.HIGHRES="highres"}(ko||(ko={}));const Po={tiles:"com.yandex.video.thumbnail.lowres.tiles",duration:"com.yandex.video.thumbnail.lowres.duration",resolution:"com.yandex.video.thumbnail.lowres.resolution",uri:"com.yandex.video.thumbnail.lowres.uri"},Io={tiles:"com.yandex.video.thumbnail.tiles",duration:"com.yandex.video.thumbnail.duration",resolution:"com.yandex.video.thumbnail.resolution",uri:"com.yandex.video.thumbnail.uri"};var Co=r(1991);const Oo=[4320,2880,2160,1440,1080,720,576,480,360,240,144],Do=Math.min(...Oo.slice(1).map((e,t)=>Oo[t]/e));var No=r(8559),Lo=r(267),Mo=r(1042);let xo;!function(e){e.WAS_WORKER_INTERNAL_ERROR="YANDEX_PLAYER_HLS_WAS_WORKER_INTERNAL_ERROR"}(xo||(xo={}));let Vo;!function(e){e.HasAd="HasAd",e.NoAd="NoAd",e.NoData="NoData"}(Vo||(Vo={}));const Fo=/^(\d+)x(\d+)@(\d+)$/;var Uo=r(2178),Bo=r(7889),Ho=r(4849);class jo extends Bo.L{initInternalSubscribe(){super.initInternalSubscribe(),this.on("VideoPlayingStateChange",e=>{e===Gi.X.PLAY?this.recoverHelper.reset("play"):e===Gi.X.END?this.stopLoad():e===Gi.X.BUFFERING&&this.tryRecoverOnBuffering()}),this.subscribeVideoBuffering()}constructor(e){super(e),this.props=e,this.engine=Gn.$.HLS,this.preloadSourceHLSEncoder=void 0,this.preloadSourceHandlers=[],this.preloadPosition={},this.HLSEncoder=void 0,this.lastKnownLevelDetails=void 0,this.HLSEncoderAttachTime=1/0,this.loadStarted=!1,this.recoverOnBufferingReason=null,this.initHlsEncoderPromise=void 0,this.maxHeightCapping=void 0,this.levelForcingInterval=void 0,this.bufferGoalUpdateInterval=void 0,this.updateBufferGoal=()=>{this.HLSEncoder&&(this.HLSEncoder.config.maxMaxBufferLength=this.getMaxBufferLength())},this.restoreUserTracksWhenPossible=()=>{const{HLSEncoder:e}=this;if(!e)return;if(!e.levels||0===e.levels.length)return void e.once(Hls.Events.MANIFEST_LOADED,this.restoreUserTracksWhenPossible);(0,Bi.z)(this.HLSEncoderAttachTime)?this.restoreUserTracks():e.once(Hls.Events.MEDIA_ATTACHED,this.restoreUserTracks)},this.onLevelUpdated=()=>{this.emit("VideoTypeChange",this.getVideoType());const e=this.getHlsEncoderLevelDetails();if(e&&e.fragments&&e.fragments.length>0){const[t]=e.fragments;t.programDateTime&&this.emit("ProgramDateTimeChange",1e3*this.getUtcStartTime())}},this.onSubtitleTracksUpdated=()=>{this.HLSEncoder&&this.emit("TextTracksChange",function(e){const t=[];return Array.isArray(e)&&e.forEach(e=>{const r=ft(e);r&&t.push(r)}),t}(this.HLSEncoder.subtitleTracks))},this.onAudioTracksUpdated=()=>{const{HLSEncoder:e}=this;if(!e)return;const{audioTracks:t}=e;e.config.maxBufferSize=t.length>0?12e6:Hls.DefaultConfig.maxBufferSize,this.emit("AudioTracksChange",function(e){const t=[];return Array.isArray(e)?(e.forEach(e=>{const r=pt(e);r&&t.push(r)}),t):[]}(t))},(0,jr.v)((0,Uo.NF)()),this.playerStore.setIsAbrSupported(!0)}getEngine(){return Gn.$.HLS}getFragmentsData(){const e=this.getHlsEncoderLevelDetails();if(!e)return super.getFragmentsData();const{totalduration:t,targetduration:r,fragments:i}=e,[s]=i;return s?{totalDuration:Math.min(t,this.getDuration()),fragmentDuration:r,startTime:s.start}:super.getFragmentsData()}onOnline(){this.startLoadOnce(this.video.currentTime)}onOffline(){this.stopLoad()}play(){return this.startLoadOnce(),super.play()}getUtcStartTime(){const e=this.getHlsEncoderLevelDetails();if(!e||!e.hasProgramDateTime)return 0;const[t]=e.fragments;return t&&t.programDateTime?t.programDateTime/1e3-t.start:0}getUtcPosition(){const e=this.getUtcStartTime();return e>0?e+this.getCurrentTime():super.getUtcPosition()}setVideoTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const{levels:r}=t;if(void 0===r)return;const i=e.value===xn.R.value?-1:r.findIndex(t=>t.url.some(t=>t===e.value));-1===i?this.startLevelForcingWithSizeCap():this.stopLevelForcingWithSizeCap();const s=this.isPaused();t.currentLevel=i,!s&&this.isPaused()&&(this.wasPausedAfterQualityChanged=!0,this.emit("InternalPlayingStateChange",Gi.X.BUFFERING))}setAudioTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const r=t.audioTracks.find(t=>e.value===String(t.id));r&&(t.audioTrack=Number(r.id))}setTextTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const r=this.getHlsTextTrack(e);r&&(this.emit("InternalTextTrackValueChange",e&&e.value),t.subtitleTrack=r.id)}disableTextTrack(){this.emit("InternalTextTrackValueChange",void 0)}toggleNativeSubtitles(e){super.toggleNativeSubtitles(e);const{HLSEncoder:t}=this;void 0!==t&&(t.subtitleDisplay=e)}async preloadSource(){let e=!1;const t=()=>{e=!0};this.once("Destroy",t),this.once("Detach",t);try{await(0,Uo.NF)()}catch(tu){return void this.props.onError(ss.u.from(tu,{code:ns.x.SCRIPT_INIT_ERROR,isFatal:!1}))}if(e||this.HLSEncoder||this.initHlsEncoderPromise||this.preloadSourceHLSEncoder)return;const r=_t({},this.getHlsJsConfig(),{liveSyncDuration:vn.D}),i=window.hls=this.preloadSourceHLSEncoder=new Hls(r),s=(e,t)=>{this.preloadSourceHandlers.push([e,t]),i.once(e,t)};((e,t)=>{this.preloadSourceHandlers.push([e,t]),i.on(e,t)})(Hls.Events.ERROR,(e,t)=>{if(!t)return;const r=it(t),s=nt(t);void 0!==s&&(this.props.onError(new ss.u(_t({},s,{isFatal:!1}))),r&&(this.props.onError(new ss.u({code:ns.x.PRELOAD_SOURCE_FAILED,isFatal:!1,details:{reason:s}})),this.unsubscribePreloadSourceHandlers(),i.destroy(),this.clearPreloadSourceHlsEncoder()))});const n=()=>{this.preloadPosition=this.state.controller.startPosition,i.config.startFragPrefetch=!0,this.loadStarted=!0};s(Hls.Events.MANIFEST_PARSED,(e,t)=>{let{levels:r=[],audioTracks:a=[]}=t;const o=this.getStartVideoLevelIndex(r);i.startLevel=o,this.state.controller.isAbrEnabled||(i.loadLevel=o);this.getStartAudioTrackIndex(a)>-1&&(i.audioTrack=this.getStartAudioTrackIndex(a));const l=this.getStartLoadPosition();s(Hls.Events.LEVEL_UPDATED,(e,t)=>{let{details:r}=t;const s=this.getStartLoadPosition(r);l!==s&&void 0!==s&&i.streamController.startLoad(s),n()}),i.startLoad(l)}),i.loadSource(this.getStreamUrl())}async attachEncoder(){if(await super.attachEncoder(),!vo){const e=ns.x.HLS_JS_NOT_SUPPORTED_ERROR;return this.props.onError(new ss.u({code:e})),Promise.reject((0,Qr.e)(e,this.state.ad.adblockDetected))}return this.initHlsEncoderPromise=this.initHlsEncoder(),await this.initHlsEncoderPromise,this.initHlsEncoderPromise=void 0,this.subscribeContentImpression(),this.startLevelForcingWithSizeCap(),this.attachMedia()}async destroyUnsafe(){await super.destroyUnsafe(),this.preloadSourceHLSEncoder&&this.preloadSourceHLSEncoder.destroy(),this.HLSEncoder&&this.HLSEncoder.destroy()}canSeek(){return void 0!==this.HLSEncoder&&Boolean(this.HLSEncoder.media)&&super.canSeek()}async detachEncoder(){if((0,ho.w)(this.video.textTracks).forEach(At),this.stopLevelForcingWithSizeCap(),this.stopBufferGoalAutoUpdate(),await super.detachEncoder(),this.loadStarted=!1,this.preloadSourceHLSEncoder&&(this.preloadSourceHLSEncoder.destroy(),this.clearPreloadSourceHlsEncoder()),!this.HLSEncoder){if(!this.initHlsEncoderPromise)return;await this.initHlsEncoderPromise}const{video:e,HLSEncoder:t}=this;if(void 0!==t)return this.recoverOnBufferingReason=null,new Promise(r=>{t.media?t.once(Hls.Events.MEDIA_DETACHED,()=>{this.HLSEncoderAttachTime=1/0,r()}):r(),this.lastKnownLevelDetails=void 0,(0,Mo.s)(e,()=>{t.destroy(),this.HLSEncoder=void 0})})}getMaxCapAllowedVideoTrack(){const{HLSEncoder:e}=this;if(!e||!e.levels||!e.autoLevelEnabled)return;const t=e.levels[e.autoLevelCapping];if(!t)return;const r=this.state.controller.videoTracks.find(e=>{let{value:r}=e;return r===t.url[0]});return r&&r.width&&r.height?{width:r.width,height:r.height}:void 0}onVideoTagError(e){if(super.onVideoTagError(e),!this.video.error||(0,Pn.I)(this.state))return;const t=(0,po.Q)(this.video);if(t.code!==fo.y.MEDIA_ERR_DECODE&&t.code!==fo.y.MEDIA_ERR_SRC_NOT_SUPPORTED)return;const r=t.code===fo.y.MEDIA_ERR_SRC_NOT_SUPPORTED,i=new ss.u({code:fo.y[t.code],details:t,isFatal:r});if(this.props.onError(i),r)return;const s="VideoTagError MEDIA_ERR_DECODE";is.Y.log(s),this.props.onExpectedStalledChange({reason:ts.k.MediaError,details:void 0}),this.isPaused()&&this.recoverHelper.planTask(()=>this.recoverCurrentFrag(),{reason:s,delay:1e3})}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e===bn.Z.VOD||void 0===e)return super.calculateDVRParams();const{fragmentDuration:t,startTime:r,totalDuration:i}=this.getFragmentsData(),{liveOffset:s}=this.props,n=t*Rn.m,a=e===bn.Z.EVENT?s:n+s;return{fragmentDuration:t,dvrStartTime:r,dvrDuration:i,skinDVRStartTime:e===bn.Z.EVENT?r:n+r,skinDVRDuration:i-a}}onTick(e){super.onTick(e),this.updateSkinDvrParameters(e)}getStreamUrl(){const e=super.getStreamUrl(),t={session_data:"1"};return Xe(e)||(t.preview="1"),(0,ta.Sr)(e,t,{saveOriginalPath:!0})}getBandwidthEstimate(){if(!this.HLSEncoder)return super.getBandwidthEstimate();const e=(0,Wr.Y)(()=>this.HLSEncoder.abrController._bwEstimator.getEstimate());return(0,Bi.z)(e)?{value:e,source:"hlsjs"}:super.getBandwidthEstimate()}getUtcEndTime(){const e=this.getUtcStartTime();return e?e+this.getDuration():0}stopLoad(){this.HLSEncoder&&(this.HLSEncoder.stopLoad(),this.loadStarted=!1)}tryRecoverOnBuffering(){if(!this.recoverOnBufferingReason)return;const{type:e,url:t,details:r,frag:i}=this.recoverOnBufferingReason,{controller:{bufferingRanges:s,fragmentDuration:n}}=this.state,a=this.getCurrentTime();if(s.some(e=>{let{start:t,end:r}=e;return t+n<a&&r-n>a}))return void is.Y.log("skip recover",{currentTime:a,bufferingRanges:s});const{recoverHelper:o}=this;o.planTask(()=>this.recoverCurrentFrag(),{reason:"HlsJs "+e,rawData:{details:r,type:e,url:t,isFatal:!0,frag:Je(i)},delay:100})}getHlsJsConfig(){const e="true"!==na.t.getItem(xo.WAS_WORKER_INTERNAL_ERROR);return{manifestLoadingTimeOut:yo.d4,levelLoadingTimeOut:yo.e8,fragLoadingTimeOut:yo.C,fragLoadingMaxRetry:5,debug:this.props.debug,enableWorker:e,autoStartLoad:!1,capLevelToPlayerSize:!1,liveSyncDuration:this.props.liveOffset,levelLoadingMaxRetry:25,levelLoadingMaxRetryTimeout:100,enableCEA708Captions:!1,xhrSetup:(e,t)=>{this.withCredentials&&(e.withCredentials=!0);const r=(0,ta.lm)(t);("m3u8"===r||"ts"===r)&&e.open("GET",(0,Xa.c)(t),!0)},fetchSetup:(e,t)=>(this.withCredentials&&(t.credentials="include"),new Request(e.url,t)),maxMaxBufferLength:this.getMaxBufferLength()}}preparePreloadSourceHlsEncoderToAttach(){const e=this.preloadSourceHLSEncoder;if(!e)return;this.HLSEncoder=e;const{preloadPosition:t}=this;if(this.unsubscribePreloadSourceHandlers(),this.clearPreloadSourceHlsEncoder(),e.config.liveSyncDuration=this.props.liveOffset,!e.levels||0===e.levels.length)return e;this.onLevelsUpdated(),this.onLevelUpdated(),this.updateThumbnailTileMeta(),this.onAudioTracksUpdated(),this.onAudioTrackUpdated(e.audioTrack),this.onSubtitleTracksUpdated();const{videoTime:r,utc:i}=this.state.controller.startPosition;if(!(t.utc!==i||t.videoTime!==r))return e;const s=this.getStartLoadPosition(this.getHlsEncoderLevelDetails());return void 0!==s&&e.streamController.startLoad(s),e}async initHlsEncoder(){if(this.HLSEncoder)return;if(this.HLSEncoder=this.preparePreloadSourceHlsEncoderToAttach(),this.HLSEncoder)this.props.logEvent({event:$i.UsePreloadedHlsJs,params:{}});else{try{await(0,Uo.NF)()}catch(tu){const t=ss.u.from(tu,{code:ns.x.SCRIPT_INIT_ERROR});throw this.props.onError(t),t}this.HLSEncoder=new Hls(this.getHlsJsConfig())}const{HLSEncoder:e}=this;window.hls=e,this.subscribeHlsEncoderEvents(e),this.restoreUserTracksWhenPossible(),this.initBufferGoalAutoUpdate();const t=r=>{r!==Gi.X.BUFFERING&&r!==Gi.X.PLAY||(e.config.maxMaxBufferLength=this.getMaxBufferLength(),this.off("VideoPlayingStateChange",t))};this.on("VideoPlayingStateChange",t)}subscribeHlsEncoderEvents(e){e.subtitleDisplay=this.state.skin.useNativeSubtitles;const t=t=>{if(!e.levels)return;const r=e.levels[t];if(!r)return;const i=Et(r,this.videoTrackLabels);i&&this.emit("InternalVideoTrackValueChange",i.value)};e.on(Hls.Events.LEVEL_SWITCHING,(e,r)=>{t(r.level)}),e.on(Hls.Events.LEVEL_SWITCHED,(e,r)=>{t(r.level)}),e.levels&&0!==e.levels.length||e.on(Hls.Events.MANIFEST_PARSED,(r,i)=>{let{levels:s=[],audioTracks:n=[]}=i;this.onLevelsUpdated(),this.updateThumbnailTileMeta();const a=this.getStartVideoLevelIndex(s);e.startLevel=a,this.state.controller.isAbrEnabled||(e.loadLevel=a);this.getStartAudioTrackIndex(n)>-1&&(e.audioTrack=this.getStartAudioTrackIndex(n)),e.once(Hls.Events.LEVEL_LOADED,(e,r)=>{let{level:i}=r;t(i)})}),e.on(Hls.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated),e.on(Hls.Events.AUDIO_TRACK_SWITCHING,(e,t)=>{this.onAudioTrackUpdated(t.id)}),e.on(Hls.Events.AUDIO_TRACK_SWITCHED,(e,t)=>{this.onAudioTrackUpdated(t.id)}),e.on(Hls.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated),e.on(Hls.Events.SUBTITLE_TRACK_SWITCH,(t,r)=>{const{subtitleTrack:i}=e;if(i>-1){const t=ft(e.subtitleTracks.find(e=>e.id===r.id));if(!t)return;this.emit("InternalTextTrackValueChange",t.value)}else this.emit("InternalTextTrackValueChange",void 0)}),e.on(Hls.Events.FRAG_PARSING_METADATA,async(e,t)=>{const{samples:r,frag:i}=t;if(!r||0===r.length)return;const s=r.map(e=>{let{data:t}=e;return(0,mo.parseV2Tag)(t)}).filter(e=>!1!==e&&void 0!==e.writer).map(e=>e.writer).filter(e=>void 0!==e),{data:n,index:a,reason:o}=function(e){const[t,r]=e.reduce((e,t)=>{let[r,i]=e;try{return!function(e){return"object"===typeof e&&e.id&&"number"===typeof e.offset&&(void 0===e.cutoff||"number"===typeof e.cutoff)}(JSON.parse(t))?i.push(t):r.push(t),[r,i]}catch(s){return[r,i]}},[[],[]]);if(t.length>0){const r=t[t.length-1];return{data:r,index:e.indexOf(r),reason:Vo.HasAd}}if(r.length>0){const t=r[r.length-1];return{data:t,index:e.indexOf(t),reason:Vo.NoAd}}return{data:"",index:-1,reason:Vo.NoData}}(s);is.Y.log("choose metadata: ",n,a,o);Math.random()<.01&&this.props.logEvent({event:$i.StreamPlayerChooseMetadata,params:{fragmentMetadataArray:n,chosenIndex:a,chosenReason:o}}),this.emit("MetadataChange",{fragmentMetadataArray:[n],fragmentStart:i.start,fragmentDuration:i.duration,src:i?i.url:this.getStreamUrl()})}),e.on(Hls.Events.MANIFEST_LOADED,()=>{this.onLevelsUpdated(),this.forceLevel(),this.onAudioTracksUpdated(),this.onSubtitleTracksUpdated()}),e.on(Hls.Events.LEVEL_UPDATED,this.onLevelUpdated),e.on(Hls.Events.ERROR,(e,t)=>{t&&this.onEncoderError(t)}),e.on(Hls.Events.FRAG_PARSED,(e,t)=>this.handleFragParsed(e,t)),this.on("VideoPlayingStateChange",e=>{"play"!==e&&"buffering"!==e||this.startLoadOnce()})}initBufferGoalAutoUpdate(){this.stopBufferGoalAutoUpdate(),this.bufferGoalUpdateInterval=window.setInterval(()=>{this.updateBufferGoal()},1e3)}stopBufferGoalAutoUpdate(){window.clearInterval(this.bufferGoalUpdateInterval)}getStartVideoLevelIndex(e){const{userVideoTrackHeight:t,userVideoTrackName:r}=this.playerStore.getState().controller,i=(0,Lo.G)(e,{name:r,height:t});if(i){const t=e.indexOf(i);return is.Y.log("User level found, start loading by index=["+t+"]"),t}return function(e){let{video:t,maxHeightCapping:r,levels:i=[],bandwidth:s}=e;const n=i.slice().filter(Boolean).sort((e,t)=>t.bitrate-e.bitrate);if(0===n.length)return-1;const{width:a,height:o}=Rt(t),[l]=n.filter(e=>!(s&&e.bitrate>s)&&(!(r&&e.height>r)&&(e.width<=a||e.height<=o)));return void 0===l?i.indexOf(n.pop()):i.indexOf(l)}({levels:e,maxHeightCapping:this.maxHeightCapping,video:this.video,bandwidth:this.state.controller.isAbrEnabled?this.getBandwidthEstimate().value:1/0})}getStartAudioTrackIndex(e){const{userAudioTrackName:t,userAudioTrackLang:r}=this.playerStore.getState().controller,i=(0,No.x)(e,{name:t,lang:r});if(!i)return-1;const s=e.indexOf(i);return is.Y.log("User audio track found, start loading by index=["+s+"]"),s}handleFragParsed(e,t){let{frag:r}=t;const{duration:i}=r;if(0===i&&this.state.controller.videoType===bn.Z.VOD){const e=this.getHlsEncoderLevelDetails(),t=e?e.fragments:[];if(t[t.length-1]===r)return}(i<=0||i>=this.fragDuration*Eo.O)&&this.props.logEvent({event:"InvalidFragDuration",params:Je(r)})}startLoadOnce(e){const{HLSEncoder:t}=this;!this.loadStarted&&void 0!==t&&this.state.controller.isOnline&&(t.levels&&t.levels.length>0?(t.startLoad(e),this.loadStarted=!0):t.once(Hls.Events.MANIFEST_PARSED,()=>{this.startLoadOnce(e)}))}getHlsEncoderLevelDetails(){const{HLSEncoder:e}=this;if(void 0===e)return;const{currentLevel:t,levels:r}=e;if(!r)return;const i=r[t];if(i&&i.details)return this.lastKnownLevelDetails=i.details,this.lastKnownLevelDetails;const s=r.find(e=>{let{details:t}=e;return Boolean(t)});if(s){const{details:e}=s;this.lastKnownLevelDetails=e}return this.lastKnownLevelDetails}computeRecoverJumpGap(){const{controller:{bufferingRanges:e}}=this.state,t=this.getCurrentTime();return Math.max(...e.map(e=>{let{end:t}=e;return t}))+1.1*this.fragDuration<t?(is.Y.log("use 0 as recoverJumpGap",{currentTime:t,bufferingRanges:e}),0):1.1*this.fragDuration}computeRecoverPositionFromStartPosition(){const{startPosition:e}=this.state.controller,t={},r=this.computeRecoverJumpGap();return void 0!==e.utc&&e.utc>0&&(t.utc=e.utc+r),t.videoTime=(e.videoTime||0)+r,t}computeRecoverPositionFromCurrentTime(){const e={},{lastRecoverPosition:t}=this.state.controller,r=this.getCurrentTime(),i=this.getUtcPosition(),s=this.computeRecoverJumpGap(),{utc:n=0,videoTime:a=0}=t||{};return(i>0||n>0)&&(e.utc=Math.max(i,n)+s),e.videoTime=Math.max(r,a)+s,e}async recoverCurrentFrag(){const{lastRecoverPosition:e,bufferingRanges:t}=this.state.controller,r=this.getDuration()>0||void 0!==e?this.computeRecoverPositionFromCurrentTime():this.computeRecoverPositionFromStartPosition();this.playerStore.setControllerStateField(Cn.jY.lastRecoverPosition,r),this.playerStore.setControllerStateField(Cn.jY.startPosition,r),await this.detachEncoder(),this.emit("BufferingRangesChange",t),await this.attachEncoder()}attachMedia(){is.Y.log("attachMedia"),this.logLoadToRum();const{video:e,HLSEncoder:t}=this;if(void 0===t){const e=new ss.u({code:ns.x.NO_HLS_JS_INSTANCE,isFatal:!1});return this.props.onError(e),Promise.reject(e)}const r=new Promise(e=>{t.once(Hls.Events.MEDIA_ATTACHED,()=>{this.HLSEncoderAttachTime=(0,Ho.no)(),t.url||t.loadSource(this.getStreamUrl()),e()})});t.once(Hls.Events.MANIFEST_PARSED,()=>{if(this.loadStarted)return;const e=this.getStartLoadPosition();t.startLoad(e),this.loadStarted=!0,t.once(Hls.Events.LEVEL_UPDATED,(r,i)=>{let{details:s}=i;const n=this.getStartLoadPosition(s);n!==e&&void 0!==n&&t.streamController.startLoad(n)})});const i=t.levels&&t.levels.length>0?Promise.resolve():new Promise(e=>{t.once(Hls.Events.MANIFEST_PARSED,()=>{e()})});return(0,Mo.s)(this.video,()=>{t.attachMedia(e)}),Promise.all([r,i]).then(()=>{})}onAudioTrackUpdated(e){const{HLSEncoder:t}=this;if(!t)return;const r=pt(t.audioTracks.find(t=>t.id===e));r&&this.emit("InternalAudioTrackValueChange",r.value)}getVideoType(){const e=this.getHlsEncoderLevelDetails();if(e)return bt(e);return(this.HLSEncoder&&this.HLSEncoder.levels||[]).some(e=>{let{details:t}=e;return Boolean(t&&t.live)})||this.getDuration()===1/0?bn.Z.LIVE:bn.Z.VOD}onLevelsUpdated(){const{sessionData:e={},levels:t=[]}=this.HLSEncoder||{};this.videoTrackLabels=function(e){const{VALUE:t=""}=e["com.yandex.video.labels.quality"]||{};return t.split(",").filter(Boolean).reduce((e,t)=>{const[r,i]=t.split(":");return void 0!==wt(r)&&i&&e.set(r,i),e},new Map)}(e),this.maxHeightCapping=function(e){const{VALUE:t=""}=e["com.yandex.video.capping.maxheight"]||{},r=parseInt(t,10);return r>0?r:void 0}(e),this.emit("VideoTracksChange",St(t,this.videoTrackLabels))}updateThumbnailTileMeta(){const{sessionData:e={}}=this.HLSEncoder||{},t=e=>{this.props.logEvent({event:e,params:void 0})},r=ht(e,ko.LOWRES,t),i=ht(e,ko.HIGHRES,t);if(void 0===i)return;const s=r?ut(r,t):void 0,n=ut(i,t),a=function(e){const{VALUE:t=""}=e["com.yandex.video.thumbnail.version"]||{};return parseFloat(t)||0}(e);this.props.onThumbnailTileGeneralMetaInfoChange({version:a,lowRes:s,highRes:n})}onEncoderError(e){const{details:t,type:r,url:i,frag:s}=e;if(!t)return;if((n=e).networkDetails&&423===n.networkDetails.status&&n.details===Hls.ErrorDetails.LEVEL_LOAD_ERROR){this.props.logEvent({event:$i.HlsJsForceCappingStart,params:{}});const{recoverHelper:s}=this;return void s.planTask(()=>this.recoverCurrentFrag(),{force:ot(e),reason:"HlsJs "+r,rawData:{details:t,type:r,url:i,isFatal:!1},delay:0})}var n;const a=it(e),o=nt(e);if(void 0!==o&&(a||r===Hls.ErrorTypes.MEDIA_ERROR))if(this.recoverHelper.allowed&&!o.isFatal){if(this.props.onError(o),at(e)){if(this.currentState!==Gi.X.BUFFERING&&function(e){const{details:t}=e;return!!t&&Ro.includes(t)}(e))return void(this.recoverOnBufferingReason=e);let n;e.details===Hls.ErrorDetails.INTERNAL_EXCEPTION&&"demuxerWorker"===e.event?(na.t.setItem(xo.WAS_WORKER_INTERNAL_ERROR,"true"),n=()=>this.recoverStream()):n=()=>this.recoverCurrentFrag(),this.recoverHelper.planTask(n,{force:ot(e),reason:"HlsJs "+r,rawData:{details:t,type:r,url:i,isFatal:a,frag:Je(s)},delay:1e3})}}else this.props.onError(new ss.u(_t({},o,{isFatal:!0})))}getHlsTextTrack(e){if(this.HLSEncoder)return this.HLSEncoder.subtitleTracks.find(t=>e.value===String(t.id))}unsubscribePreloadSourceHandlers(){const{preloadSourceHLSEncoder:e}=this;e&&(this.preloadSourceHandlers.forEach(t=>{let[r,i]=t;e.off(r,i)}),this.preloadSourceHandlers.length=0)}clearPreloadSourceHlsEncoder(){this.preloadSourceHLSEncoder=void 0,this.preloadPosition={}}getStartLoadPosition(e){const{startPosition:t}=this.state.controller,{liveOffset:r}=this.props;return function(e){let{details:t,startPosition:r,liveOffset:i}=e,{videoTime:s}=r;if(void 0===t)return s;if(t.hasProgramDateTime&&Tt(r.utc)){const e=t.fragments[0].programDateTime/1e3;s=r.utc-e}if(!Tt(s))return;const n=bt(t)===bn.Z.VOD?0:i,[a]=t.fragments,o=void 0===a?0:a.start,l=t.totalduration-n;return(0,oi.u)(s,o,l)}({details:e,startPosition:t,liveOffset:r})}startLevelForcingWithSizeCap(){clearInterval(this.levelForcingInterval),this.levelForcingInterval=window.setInterval(()=>{this.forceLevel()},1e3)}stopLevelForcingWithSizeCap(){clearInterval(this.levelForcingInterval)}forceLevel(){if(!this.HLSEncoder||!this.HLSEncoder.autoLevelEnabled||!this.HLSEncoder.levels||!this.HLSEncoder.levels.length)return;const{width:e,height:t,maxWidth:r,maxHeight:i}=this.getCapSizes(),s=Math.min(e,r||1/0),n=Math.min(t,i||1/0),a=Math.min(...[this.maxHeightCapping,n].filter(Bi.z)),{levels:o}=this.HLSEncoder,l=o.reduce((e,t,r)=>{if((t.height<e.smallestLevel.height||t.width<e.smallestLevel.width)&&(e.smallestLevel=t,e.smallestLevelIndex=r),t.height>a||t.width>s)return e;const i=(o[e.index]||{}).height||0;return t.height>i?_t({},e,{index:r}):e},{index:-1,smallestLevel:o[0],smallestLevelIndex:0});this.HLSEncoder.autoLevelCapping=-1===l.index?l.smallestLevelIndex:l.index}}var Yo=r(722);class Wo extends Yo.U{constructor(e){super(e),this.props=e,this.engine=Gn.$.MP4;const t=(0,Vi.I)(()=>{this.emit("VideoTracksChange",function(e){const{videoWidth:t,videoHeight:r}=e;return[{name:vt({width:t,height:r}),value:"0",bitrate:Co.A,width:t,height:r}]}(e.video))});this.once("CanPlay",t),this.once("Destroy",()=>this.off("CanPlay",t))}async attachEncoder(){await super.attachEncoder(),is.Y.log("mp4 native mode")}establishStartPosition(){return new Promise((e,t)=>{const r=this.addVideoEventListener("durationchange",()=>{this.canSeek()&&(this.applyStartPosition(),r(),e())});this.once("Detach",()=>{r(),t()})})}initVideoTypeQualifier(){this.emit("VideoTypeChange",bn.Z.VOD)}initDrm(){return Promise.resolve()}setVideoTrack(){}}const Go=5*Math.random(),Ko=e=>!!e.data&&e.data[1]===Ao.OC;var qo=r(7675);const zo=e=>{try{return(0,qo.c)(e.data[2])}catch(tu){return qo.P}};var Xo=r(6533),Qo=r(1091);var Zo=r(5371),Jo=r(6976),$o=r(2523),el=r(6213);class tl{static convertToTextTrackCue(e){return shaka&&VTTCue?e.startTime>=e.endTime?null:new VTTCue(e.startTime,e.endTime,e.payload):null}static removeWhere(e,t){const r=e.mode;e.mode="hidden";const i=e.cues||[];for(let s=i.length-1;s>=0;s--){const r=i[s];r&&t(r)&&e.removeCue(r)}e.mode=r}constructor(e,t){this.useNativeSubtitles=t,this.textTrack=void 0,(0,ho.w)(e.textTracks).forEach(e=>{e.mode="disabled",e.label===Jo.L&&(this.textTrack=e)}),this.textTrack||(this.textTrack=e.addTextTrack("subtitles",Jo.L)),this.textTrack.mode=this.hiddenMode()}remove(e,t){if(!this.textTrack||!shaka)return!1;return tl.removeWhere(this.textTrack,r=>r.startTime<t&&r.endTime>e),!0}append(e){if(!shaka||!this.isTextVisible()||!this.textTrack)return;const t=e.map(e=>{if(e.nestedCues.length){const t=e.nestedCues.map(e=>e.spacer?"\n":e.payload+" ").join("").replace(/ $/m,""),r=e.clone();return r.nestedCues=[],r.payload=t,r}return e}),r=[],i=this.textTrack.cues?Array.from(this.textTrack.cues):[];for(const s of t){if(!i.some(e=>e.startTime===s.startTime&&e.endTime===s.endTime&&e.text===s.payload)){const e=tl.convertToTextTrackCue(s);e&&r.push(e)}}r.slice().sort((e,t)=>e.startTime!==t.startTime?e.startTime-t.startTime:e.endTime!==t.endTime?e.endTime-t.startTime:r.indexOf(t)-r.indexOf(e)).forEach(e=>{this.textTrack.addCue(e)})}destroy(){if(this.textTrack){const e=e=>!0;tl.removeWhere(this.textTrack,e)}return this.textTrack=void 0,Promise.resolve()}isTextVisible(){return!!this.textTrack&&this.textTrack.mode!==this.hiddenMode()}setTextVisibility(e){this.textTrack&&(this.textTrack.mode=e?this.showingMode():this.hiddenMode())}hiddenMode(){return(0,$o.l)()}showingMode(){return(0,el.L)(this.useNativeSubtitles())}}var rl=r(7568);let il=!1;const sl={version:'Period>SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:version"]',uriTemplate:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:uri"]',tiles:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:tiles"]',spriteDuration:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:duration"]',resolution:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:resolution"]'},nl={version:sl.version,uriTemplate:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:uri"]',tiles:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:tiles"]',spriteDuration:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:duration"]',resolution:'SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:lowres:resolution"]'};var al=r(3399),ol=r(8024),ll=r.n(ol);const dl=document.createElement("canvas"),cl=dl.getContext("2d");var ul=r(4188),hl=r(35),pl=r(5251),fl=r(7919);const ml=(0,Vi.I)(()=>{const e=pe("Chrome");if(void 0===e)return!0;const[t]=e;return t>70}),gl=/^(ext-)?strm[^\.]+\.strm\.yandex\.net$/;var vl=r(6048),yl=r.n(vl),El=r(9752);class Sl extends El.N{constructor(e,t){super(),this.source=e,this.cacheData=t,this.addDestroyHandler(()=>{var e;null==(e=this.cacheData.segmentCache)||e.clear(),this.cacheData.loadedManifest=void 0,this.cacheData.cachedVariantTrack=void 0})}preload(){return Promise.resolve()}getBandwidthEstimate(){}copyCachedData(){var e;return{segmentCache:null==(e=this.cacheData.segmentCache)?void 0:e.copy(),loadedManifest:this.cacheData.loadedManifest}}getCachedVariantTrack(){return this.hasCachedSegments()?this.cacheData.cachedVariantTrack:void 0}getBufferedInfo(){return this.cacheData.bufferedInfo}getSource(){return this.source}getType(){return Bn.H.Cache}getManifestXml(){return this.cacheData.manifestXml}hasManifest(){return void 0!==this.cacheData.loadedManifest}hasCachedSegments(){var e;return Boolean(null==(e=this.cacheData.segmentCache)?void 0:e.hasCachedData())}}var Al=r(173);var Tl=r(594),bl=r(5348),Rl=r(5541),wl=r(8258),_l=r(836),kl=r(1285),Pl=r(3455);const Il=[429,500,502,503,504];var Cl=r(9940),Ol=r(6844),Dl=r(4616),Nl=r(3587),Ll=r(5422);var Ml=r(9841),xl=r(8682),Vl=r(6774),Fl=r(5690);class Ul extends Bo.L{static fuzz(e,t){void 0===t&&(t=.5);return(e<10?2**e*100:6e4)*(1+(2*Math.random()-1)*t)}initInternalSubscribe(){super.initInternalSubscribe(),this.once("Destroy",()=>this.chunkHostnameBlacklist.destroy()),this.once("Destroy",()=>this.stopShakaConfigAutoUpdate()),this.once("Destroy",()=>{var e;return null==(e=this.customNetworkingEngine)?void 0:e.destroy()}),this.once("Destroy",()=>{var e;return null==(e=this.preloader)?void 0:e.destroy()});const e=e=>{(0,Pl.V)(this.shakaPlayer)&&this.shakaPlayer.setTextTrackVisibility(Boolean(e))};this.on("InternalTextTrackValueChange",e),this.once("Destroy",()=>this.off("InternalTextTrackValueChange",e)),this.addEventListener(this.video,"play",this.updateBufferingState),this.addEventListener(this.video,"playing",this.updateBufferingState),this.on("VideoTypeChange",e=>{if(void 0===e)return;this.shakaPlayer&&this.setShakaAvailabilityWindowOverride(this.shakaPlayer);const t=e===bn.Z.VOD;this.setNativeTimeControlVisibility(t),this.setNativeTimelineControlVisibility(t)}),this.on("ContentImpression",()=>{var e,t,r;switch(null!=(e=null==(t=this.shakaPlayer)||null==(r=t.drmInfo())?void 0:r.keySystem)?e:null){case Ta.Ql:return this.emit("DrmSystemChange",Aa.W.widevine);case Ta.xE:return this.emit("DrmSystemChange",Aa.W.playready);default:return this.emit("DrmSystemChange",Aa.W.none)}})}constructor(e,t){super(e),this.preloader=t,this.engine=Gn.$.MPD,this.shakaPlayer=void 0,this.chunkHostnameBlacklist=new ul.S,this.lastNonBlockedBaseUrls=[],this.shakaConfigAutoUpdateInterval=void 0,this.manifestXML=void 0,this.initMpdEncoderPromise=void 0,this.detachMpdEncoderCalled=!1,this.useNativeSubtitles=!1,this.customNetworkingEngine=void 0,this.lastTrackBeforeDetach=void 0,this.preloadedTrack=void 0,this.isPauseCalled=!1,this.attempt={},this.playingStateBeforeLoadShakaSource=void 0,this.abrManager=void 0,this.abrRestrictionsHelper=new Vl.n({getManifestXml:()=>this.manifestXML,getState:()=>this.state,getCapSizes:()=>this.getCapSizes()}),this.tryToInjectWidevineCert=(0,Vi.I)(async()=>{const{drmConfig:e={}}=this.props.stream;if(!e)return;const t=e.advanced;if(t&&t["com.widevine.alpha"])try{const{serverCertificateUrl:e}=t["com.widevine.alpha"];if(!e)return;const{response:r}=await(0,pn.W)({method:"get",responseType:"arraybuffer",url:e,withCredentials:this.withCredentials});t["com.widevine.alpha"].serverCertificate=new Uint8Array(r)}catch(r){const e=ss.u.from(r,{isFatal:!1,code:ns.x.MPD_WIDEVINE_CERT_LOAD_ERROR});this.props.onError(e)}}),this.updateBufferGoal=()=>{this.updateShakaConfig()},this.shakaFailureCallback=e=>{let t=0;"undefined"!==typeof shaka&&(t=this.attempt[shaka.net.NetworkingEngine.RequestType.SEGMENT]);const r=Ul.fuzz(t),{clear:i,promise:s}=(0,Yi.n)(r);this.once("Detach",i),s.then(()=>{var e;null==(e=this.shakaPlayer)||e.retryStreaming(),this.off("Detach",i)})},this.shakaHTTPRequestFilter=(e,t)=>(0,Wr.Y)(()=>this.shakaHTTPRequestFilterInternal(e,t),this.onShakaFilterError),this.shakaHTTPRequestFilterInternal=(e,t)=>{if("undefined"!==typeof shaka)switch(t.allowCrossSiteCredentials=this.withCredentials,e){case shaka.net.NetworkingEngine.RequestType.LICENSE:const{stream:e}=this.props,{drmConfig:r}=e;!function(e,t){if(!t)return;if((0,Qa.pp)(e.uris[0],"wrapped"))return;const{requestParams:r}=t;if(r){const{StringUtils:t,Uint8ArrayUtils:i}=shaka.util,s=Ut({rawLicenseRequestBase64:i.toBase64(new Uint8Array(e.body||new ArrayBuffer(0)))},r);e.uris=e.uris.map(e=>(0,Qa.zP)(e,"wrapped","true")),e.body=t.toUTF8(JSON.stringify(s)),e.headers=Ut({},e.headers,{"Content-Type":"application/json"})}t.headers&&(e.headers=Ut({},e.headers,t.headers))}(t,r);break;case shaka.net.NetworkingEngine.RequestType.SEGMENT:Dt(t,this.getRemainingBufferedTime());const{uris:i}=t,s=i.filter(e=>{const{hostname:t}=(0,ta.en)(e);return!this.chunkHostnameBlacklist.isBlacklisted(t)});if(0===s.length)break;(0,Fl.X)(s,(e,t)=>{const r=(0,ta.en)(e).hostname,i=(0,ta.en)(t).hostname,s=this.lastNonBlockedBaseUrls.indexOf(r),n=this.lastNonBlockedBaseUrls.indexOf(i);return-1!==s&&-1!==n?s-n:-1!==s&&-1===n?-1:-1===s&&-1!==n?1:0}),this.lastNonBlockedBaseUrls=s.map(e=>(0,ta.en)(e).hostname),t.uris=s}},this.shakaPreviewsHTTPResponseFilter=(e,t)=>(0,Wr.Y)(()=>this.shakaPreviewsHTTPResponseFilterInternal(e,t),this.onShakaFilterError),this.shakaPreviewsHTTPResponseFilterInternal=(e,t)=>{if(void 0===shaka)return;if(e!==shaka.net.NetworkingEngine.RequestType.MANIFEST)return;if(!t.data)return;const r=t.fromCache&&this.manifestXML||(0,Ll.G)(e,t);if(!r)return;this.manifestXML&&this.checkRepresentationChange(this.manifestXML,r),this.manifestXML=r,this.videoTrackLabels=function(e){const t=new Map,r=e.querySelectorAll('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:labels:quality"]');return(0,ho.w)(r).forEach(e=>{const r=e.getAttribute("value");if(!r)return;r.split(",").filter(Boolean).forEach(e=>{const[r,i]=e.split(":");void 0!==wt(r)&&i&&t.set(r,i)})}),t}(r);const i=Ot(r,ko.LOWRES),s=Ot(r,ko.HIGHRES),n={version:function(e){const t=e.querySelector('AdaptationSet[mimeType="image/jpeg"] SupplementalProperty[schemeIdUri="urn:mpeg:yandex:thumbnail:version"]');return t?parseFloat(t.getAttribute("value")||""):0}(r),lowRes:i,highRes:s};n.highRes&&this.props.onThumbnailTileGeneralMetaInfoChange(n)},this.updateBufferingState=()=>{if((0,Pn.I)(this.state))return;const{shakaPlayer:e}=this;if(void 0===e)return;(function(e){if(!e.isBuffering())return!1;const t=(0,kl.k)(e);if(!(t===bn.Z.LIVE||t===bn.Z.EVENT))return!1;const r=e.getMediaElement();if(!r)return!1;const{currentTime:i}=r,s=(0,Rl.L)(e);if(0===s)return!1;const n=i+s/2,a=(0,Cl.O)(e,i),o=(0,Cl.O)(e,n);return Boolean(a&&!o)})(e)&&this.props.onExpectedStalledChange({reason:ts.k.LiveEdge,details:void 0});const t=this.computeVideoPlayingState(e);this.emit("InternalPlayingStateChange",t)},this.onShakaAdaptationEvent=()=>{this.actualizeAvailableVariantTracks(),this.actualizeActiveVariantTrack()},this.onShakaEmsgEvent=e=>{if(is.Y.log("-> Shaka EmsgEvent",e),!(0,Hi.K)(e)||!(0,Hi.K)(e.detail)||!(0,Hi.K)(e.detail.messageData))return;const{startTime:t,messageData:r}=e.detail,i=(0,mo.parseV2Tag)(r);i&&i.writer&&this.emit("MetadataChange",{fragmentMetadataArray:[i.writer],fragmentStart:t,fragmentDuration:(0,Rl.L)(this.shakaPlayer,t),src:this.getStreamUrl()})},this.reportLargeGap=e=>{is.Y.log("-> Shaka LargeGapEvent",e),this.props.logEvent({event:"MpdLargeGap",params:{currentTime:e.currentTime,gapSize:e.gapSize}})},this.actualizeTracks=()=>{(0,Pl.V)(this.shakaPlayer)&&(this.actualizeAvailableTracks(),this.actualizeActiveTracks())},this.onShakaErrorEvent=e=>{if(!shaka||!e)return;const{detail:t}=e;this.onShakaError(t);const r=It(shaka,t);r&&r.isFatal&&this.shakaPlayer&&(this.shakaPlayer.destroy(),this.shakaPlayer=void 0)},this.onShakaError=e=>{var t;if(!shaka)return;is.Y.error("-> onShakaError",e);const r=null!=(t=e.data[2])?t:0,i=function(e,t,r){let{code:i}=t;return i===e.util.Error.Code.VIDEO_ERROR&&r.controller.watchedTime>0}(shaka,e,this.state)&&this.recoverHelper.allowed,s=function(e,t,r){let{code:i,data:s}=t;return i===e.util.Error.Code.BAD_HTTP_STATUS?Il.indexOf(s[1])>-1:s[2]===e.net.NetworkingEngine.RequestType.MANIFEST||i!==e.util.Error.Code.HTTP_ERROR?i===e.util.Error.Code.TIMEOUT:r<=10}(shaka,e,this.attempt[r]);(i||s)&&(e.severity=shaka.util.Error.Severity.RECOVERABLE);const n=It(shaka,e);n&&(i&&this.recoverHelper.planTask(()=>this.recoverStream(),{delay:0,reason:String(n.code)}),this.checkDeadChunkServer(e),this.props.onError(n))},this.onShakaFilterError=e=>{if(shaka){if(is.Y.error("-> onShakaFilterError",e),Ct(e))return this.onShakaError(e);this.props.onError(new ss.u({code:ns.x.SHAKA_FILTER_ERROR,message:e.message,isFatal:!1,stack:e.stack}))}},this.onShakaNetworkSuccess=e=>{if(this.attempt[e]=0,shaka&&e===shaka.net.NetworkingEngine.RequestType.MANIFEST){const{videoType:e}=this.state.controller;e!==bn.Z.LIVE&&e!==bn.Z.EVENT||this.emit("DvrChange")}},this.onShakaNetworkError=(e,t)=>{var r;if("undefined"!==typeof shaka&&void 0!==this.shakaPlayer){if(this.attempt[e]=(null!=(r=this.attempt[e])?r:0)+1,e===shaka.net.NetworkingEngine.RequestType.LICENSE&&Ko(t)){if(zo(t).isFatal||t.severity===shaka.util.Error.Severity.CRITICAL)return void(t.severity=shaka.util.Error.Severity.CRITICAL)}void 0===Pt(shaka,t)?this.onShakaError(t):t.severity=shaka.util.Error.Severity.CRITICAL}},this.parseTextTrack=e=>{let{label:t,language:r,originalTextId:i}=e;const s=xt(this.manifestXML,i)||r;return{name:t||s||i,value:i,lang:s}},(0,Ml.g)(this.video),(0,jr.v)((0,Uo.tL)()),t&&t.isDestroyed&&(this.preloader=void 0),this.video.classList.add(ll().video_hiddenSubtitlesBtn),this.playerStore.setIsAbrSupported(!0),function(){if(!il&&(il=!0,window.MediaKeySession)){const{prototype:e}=window.MediaKeySession,{close:t}=e;e.close=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return Promise.race([t.call(this,r),(0,Yi.n)(200).promise])}}}(),this.useNativeSubtitles=this.state.skin.useNativeSubtitles}getMaxCapAllowedVideoTrack(){var e;const t=null==(e=this.abrManager)?void 0:e.getMaxCapAllowedVideoTrack();if(t&&t.width&&t.height)return{width:t.width,height:t.height}}getFragmentsData(){const{start:e=0,end:t=0}=void 0===this.shakaPlayer?{}:this.shakaPlayer.seekRange();return{totalDuration:t-e,fragmentDuration:(0,Rl.L)(this.shakaPlayer),startTime:e}}onOnline(){}onOffline(){}getUtcStartTime(){const e=(0,_l.g)(this.shakaPlayer,this.manifestXML);return void 0===e?super.getUtcStartTime():e}getUtcPosition(){const e=function(e,t){if(void 0===e)return;const r=(0,_l.g)(e,t);if(void 0===r)return;const i=e.getMediaElement();return i?r+i.currentTime:void 0}(this.shakaPlayer,this.manifestXML);return void 0===e?super.getUtcPosition():e}setVideoTrack(e){var t;let{value:r}=e;if(void 0===this.shakaPlayer)return;if(r===xl.A)return void this.setAbrEnabled(!0);const i=(0,bl.I)(this.shakaPlayer);if(void 0===i)return;const s=Mt(null==(t=this.abrManager)?void 0:t.getVariants(),r,i.originalAudioId),n=this.shakaPlayer.getVariantTracks().find(e=>e.id===s);void 0!==n&&(this.setAbrEnabled(!1),this.setVariantTrack(n))}setAudioTrack(e){let{lang:t,value:r}=e;if(void 0===this.shakaPlayer)return;const i=(0,bl.I)(this.shakaPlayer);if(void 0===i)return;const s=this.shakaPlayer.getVariantTracks().find(e=>{const t=e.originalAudioId===r,s=e.originalVideoId===i.originalVideoId;return t&&s});if(!i||!s)return void this.shakaPlayer.selectAudioLanguage(t);const{height:n,videoBandwidth:a}=i,{language:o}=s;this.setVariantTrack(this.shakaPlayer.getVariantTracks().find(e=>e.height===n&&e.videoBandwidth===a&&e.language===o))}setTextTrack(e){let{value:t}=e;if(!this.shakaPlayer)return;const r=this.shakaPlayer.getTextTracks().find(e=>{let{originalTextId:r}=e;return r===t});r&&(this.shakaPlayer.selectTextTrack(r),this.emit("InternalTextTrackValueChange",t))}disableTextTrack(){this.shakaPlayer&&this.emit("InternalTextTrackValueChange",void 0)}toggleNativeSubtitles(e){super.toggleNativeSubtitles(e),this.useNativeSubtitles=e}captureScreenshot(e){return(e=>{if(!cl)return Promise.reject();dl.width=e.videoWidth,dl.height=e.videoHeight;try{cl.drawImage(e,0,0,e.videoWidth,e.videoHeight)}catch(t){return Promise.reject(t)}return new Promise((e,r)=>{try{dl.toBlob(t=>{if(null===t)throw new Error("Empty blob");e(t)},"image/jpeg")}catch(t){r(t)}})})(e).then(e=>{this.previousScreenshotBlobUrl=URL.createObjectURL(e)}).catch(()=>{this.previousScreenshotBlobUrl=void 0}).then(()=>this.previousScreenshotBlobUrl)}onVideoTagError(e){super.onVideoTagError(e),is.Y.log("-> onVideoTagError",e)}getDuration(){return(0,Pl.V)(this.shakaPlayer)?this.shakaPlayer.seekRange().end:NaN}async requestDebugInfo(){var e;return this.shakaPlayer?{manifest:null!=(e=(0,Wr.Y)(()=>{var e;return null==(e=this.manifestXML)?void 0:e.documentElement.outerHTML}))?e:null,shakaPlayerStats:this.shakaPlayer.getStats()}:{noShakaPlayer:!0}}async preloadSource(){var e;this.tryToInjectWidevineCert(),await(0,Uo.tL)();if(this.isDestroyed||this.preloader&&!this.preloader.isDestroyed||void 0!==this.initMpdEncoderPromise||void 0!==this.shakaPlayer||!shaka.Player.isBrowserSupported()||(null==(e=this.customNetworkingEngine)?void 0:e.hasCachedData()))return;const t=new Nl.R({source:this.props,getState:()=>this.state,getCapSizes:()=>this.getCapSizes(),type:Bn.H.Internal,fpsController:this.fpsController,getVideoElementSizes:()=>this.getVideoElementSizes(),defaultQuality:this.props.defaultQuality});this.preloader=t,t.addDestroyHandler(()=>this.preloader=void 0);const r=t.getVideoElement(),i=(0,Ei.O)(r,"canplay",()=>{this.captureScreenshot(r).then(()=>{this.props.setPlayerBackgroundImage(this.previousScreenshotBlobUrl),this.props.setPlayerBackgroundVisibility(!1)})},{once:!0});this.once("ContentImpression",i),this.once("Destroy",i),await t.preload()}createCachePreloader(){if(this.customNetworkingEngine)return new Sl({stream:this.props.stream,sourceParams:this.props.sourceParams},Bt({},this.customNetworkingEngine.copyCachedData(),{cachedVariantTrack:this.customNetworkingEngine.getCurrentVariantTrack(),manifestXml:this.manifestXML,bufferedInfo:void 0===this.shakaPlayer?{total:[],audio:[],video:[]}:this.shakaPlayer.getBufferedInfo()}))}getSeekableRange(){const{start:e,end:t}=(0,Pl.V)(this.shakaPlayer)?this.shakaPlayer.seekRange():{start:0,end:0};return{start:e,end:Math.min(t,this.getDuration()-.001||0)}}canSeek(){return(0,Pl.V)(this.shakaPlayer)&&super.canSeek()}onTick(e){void 0!==this.shakaPlayer&&(0,Pl.V)(this.shakaPlayer)&&!1===this.shakaPlayer.isLive()&&void 0!==this.state.controller.videoType&&this.state.controller.videoType!==bn.Z.VOD&&this.emit("VideoTypeChange",bn.Z.VOD),!this.video.paused||this.state.controller.videoType!==bn.Z.LIVE&&this.state.controller.videoType!==bn.Z.EVENT||this.emit("DvrChange"),super.onTick(e)}getStreamUrl(){const e=super.getStreamUrl(),t={audio_mbr:"1",mburl:"1"};return Xe(e)||(t.preview="1"),Bo.L.isLiveStreamUrl(e)&&(t.packager="1",t.lowlatency="1"),(0,ta.Sr)(e,t,{saveOriginalPath:!0})}getMaxBufferLength(){const e=(0,kl.k)(this.shakaPlayer);return!(e===bn.Z.LIVE||e===bn.Z.EVENT)||this.shouldUseLowBuffer()||this.isLowLatencyLive()?super.getMaxBufferLength():this.props.liveOffset}async detachEncoder(){this.detachMpdEncoderCalled=!0;const e=(0,bl.I)(this.shakaPlayer);this.lastTrackBeforeDetach=e||void 0,await super.detachEncoder(),this.manifestXML=void 0;const{video:t,shakaPlayer:r}=this;t.classList.remove(ll().video_hiddenSubtitlesBtn),this.stopShakaConfigAutoUpdate(),void 0!==r&&await this.preventPauseAsync(t,()=>(this.shakaPlayer=void 0,r.destroy())),(0,bi.E)(window.VTTCue)||delete window.VTTCue}async attachEncoder(){this.detachMpdEncoderCalled=!1,await super.attachEncoder(),this.initMpdEncoderPromise=this.initMpdEncoder(),await this.initMpdEncoderPromise,this.initMpdEncoderPromise=void 0}getBandwidthEstimate(){var e,t;const r=null==(e=this.preloader)?void 0:e.getBandwidthEstimate();if(r&&(0,Bi.z)(r.value))return r;const i=null==(t=this.shakaPlayer)?void 0:t.getStats(),{estimatedBandwidth:s,estimatedBandwidthSource:n}=i||{};return s?{value:s,source:n}:super.getBandwidthEstimate()}getServerTime(){var e;const t=null==(e=this.customNetworkingEngine)?void 0:e.getServerTime();return t||void 0}getRemainingBufferedTime(){if(!(0,Pl.V)(this.shakaPlayer))return super.getRemainingBufferedTime();const{currentTime:e}=this.state.controller,{audio:t,video:r,total:i}=this.shakaPlayer.getBufferedInfo();return{total:(0,rl.p)(i,e)||0,video:(0,rl.p)(r,e)||0,audio:(0,rl.p)(t,e)||0}}getUtcEndTime(){if((0,kl.k)(this.shakaPlayer)===bn.Z.LIVE)return this.getSeekableRange().end;const e=this.getUtcStartTime();return e?e+this.getDuration():0}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e!==bn.Z.LIVE)return super.calculateDVRParams();const{fragmentDuration:t,startTime:r,totalDuration:i}=this.getFragmentsData(),s=t*Rn.m;return{fragmentDuration:t,dvrStartTime:r,dvrDuration:i,skinDVRStartTime:s+r,skinDVRDuration:i-s}}handleVideoElementPlayEvent(){var e;null!=(e=this.shakaPlayer)&&e.isBuffering()||super.handleVideoElementPlayEvent()}onVideoResize(){super.onVideoResize(),this.actualizeActiveVariantTrack()}async recoverStream(){return 1===this.recoverHelper.attempt&&this.captureScreenshot(this.props.video).then(()=>{this.handleBackgroundBeforeRecover()}),super.recoverStream()}async play(){if(this.isPauseCalled=!1,this.initMpdEncoderPromise&&await this.initMpdEncoderPromise,this.isPauseCalled)throw new Error("Pause called during play");await super.play()}pause(){this.isPauseCalled=!0,super.pause()}handleBackgroundBeforeRecover(){this.props.setPlayerBackgroundImage(this.previousScreenshotBlobUrl),this.once("CanPlay",()=>{this.props.setPlayerBackgroundImage(),this.clearScreenshot()})}async initMpdEncoder(){var e,t,r,i;this.tryToInjectWidevineCert(),(0,Fn.Z$)("drm",Vt(this.props.stream.drmConfig));try{await(0,Uo.tL)()}catch(tu){const t=ss.u.from(tu,{code:ns.x.MPD_SHAKA_INIT_ERROR});throw this.props.onError(t),t}if(this.detachMpdEncoderCalled)return;const s=(0,Mo.s)(this.video,()=>new shaka.Player(this.video));this.shakaPlayer=s,this.customNetworkingEngine=this.customNetworkingEngine||new Al.vU(null==(e=this.preloader)?void 0:e.copyCachedData()),this.customNetworkingEngine.setup(s,this.onShakaNetworkSuccess,this.onShakaNetworkError),this.playerStore.setControllerStateField(Cn.jY.preloadDetails,void 0===this.preloader?void 0:{preloadingMethod:this.preloader.getType(),preloaded:this.preloader.preloaded}),this.manifestXML=null==(t=this.preloader)?void 0:t.getManifestXml(),this.preloadedTrack=null==(r=this.preloader)?void 0:r.getCachedVariantTrack(),null==(i=this.preloader)||i.destroy(),this.preloader=void 0,this.subscribeContentImpression(),this.attachShakaEventListeners(s);const n=s.getNetworkingEngine();this.customNetworkingEngine.registerRequestFilter(this.shakaHTTPRequestFilter),n.registerResponseFilter(this.shakaPreviewsHTTPResponseFilter);const{video:a}=this,o=()=>this.useNativeSubtitles;this.configureShaka(s,Bt({},this.getInitialShakaConfig(),{textDisplayFactory:function(){return new tl(a,o)}})),this.logLoadToRum();try{if(await this.preventPauseAsync(this.video,async()=>{this.playingStateBeforeLoadShakaSource=this.state.controller.playingState;const e=this.state.controller.startPosition;if(await(0,Dl.D)({shakaPlayer:s,streamUrl:this.getStreamUrl(),startPosition:e}),e!==this.state.controller.startPosition){const e=this.state.controller.startPosition,t=(0,Bi.z)(null==e?void 0:e.utc)?null==e?void 0:e.utc:null==e?void 0:e.videoTime;t&&this.seek(t)}this.playingStateBeforeLoadShakaSource=void 0}),this.preloadedTrack=void 0,this.detachMpdEncoderCalled)return;this.initShakaConfigAutoUpdate(),this.lastTrackBeforeDetach=void 0}catch(tu){if(this.playingStateBeforeLoadShakaSource=void 0,this.detachMpdEncoderCalled)return;if(Ct(tu))return void this.onShakaError(tu);this.props.onError(new ss.u(Bt({},tu,{code:ns.x.SHAKA_LOAD_SOURCE_ERROR,isFatal:!0})))}}findPreloadedVariant(e){var t;const r=this.preloadedTrack||this.lastTrackBeforeDetach;if(void 0!==r&&null!=(t=this.customNetworkingEngine)&&t.hasCachedSegments())return e.find(e=>{let{video:t,audio:i}=e;const s=!t||t.originalId===r.originalVideoId,n=!i||i.originalId===r.originalAudioId;return s&&n})}getPlaybackRate(){return this.state.controller.playbackRate}getInitialShakaConfig(){var e;const{stream:t}=this.props,r=this.getBandwidthEstimate(),i=this.abrManager=new pl.P({getPlaybackRate:this.getPlaybackRate.bind(this),bandwidthEstimateOffset:null!=(e=this.props.bandwidthEstimateOffset)?e:0,getSegmentDuration:()=>(0,Rl.L)(this.shakaPlayer),getFilterParams:e=>({preloadedVariant:this.findPreloadedVariant(e),restrictions:this.abrRestrictionsHelper.getAbrRestrictions(),videoElementSizes:this.getVideoElementSizes(),defaultQuality:this.props.defaultQuality}),isLowLatencyLive:()=>this.isLowLatencyLive(),getManifestXml:()=>this.manifestXML,fpsController:this.fpsController});return Bt({},al.m,{abr:Bt({},al.m.abr,null!=r&&r.value?{defaultBandwidthEstimate:r.value,defaultBandwidthEstimateSource:r.source}:{}),abrFactory:function(){return i},drm:Bt({},al.m.drm,t.drmConfig),streaming:Bt({},al.m.streaming,{bufferingGoal:this.getMaxBufferLength(),failureCallback:this.shakaFailureCallback})})}attachShakaEventListeners(e){e.addEventListener("buffering",this.updateBufferingState),e.addEventListener("error",this.onShakaErrorEvent),e.addEventListener("adaptation",this.onShakaAdaptationEvent),e.addEventListener("trackschanged",this.actualizeTracks),e.addEventListener("emsg",this.onShakaEmsgEvent),e.addEventListener("largegap",this.reportLargeGap),e.addEventListener("variantchanged",()=>{this.tryToUpdateStreamingParameters()}),e.addEventListener("trackschanged",()=>{this.tryToUpdateStreamingParameters()}),e.addEventListener("manifestparsed",()=>{this.onManifestParsed(e),this.updateShakaConfig();const t=this.getBandwidthEstimate();(0,Bi.z)(t.value)&&((0,Fn.Z$)("bandwidthEstimate",Le(t.value/1e3)),this.configureShaka(e,{abr:{defaultBandwidthEstimate:t.value,defaultBandwidthEstimateSource:t.source}}))}),e.addEventListener("trackschanged",(0,Vi.I)(this.restoreUserTracks))}tryToUpdateVideoType(){const e=(0,kl.k)(this.shakaPlayer);e&&e!==this.state.controller.videoType&&this.emit("VideoTypeChange",e)}tryToUpdateProgramDateTime(){const e=(0,_l.g)(this.shakaPlayer,this.manifestXML),t=void 0===e?void 0:1e3*e;void 0!==t&&t!==this.state.controller.programDateTime&&this.emit("ProgramDateTimeChange",t)}tryToUpdateStreamingParameters(){this.tryToUpdateVideoType(),this.tryToUpdateProgramDateTime()}onManifestParsed(e){this.tryToUpdateStreamingParameters(),this.setShakaAvailabilityWindowOverride(e),this.setPresentationTimelineDelay(e)}isLowLatencyLive(){var e,t;return Boolean(null==(e=this.shakaPlayer)?void 0:e.isLive())&&Boolean(null==(t=this.manifestXML)?void 0:t.querySelector("[availabilityTimeOffset]"))}setPresentationTimelineDelay(e){var t;const r=e.getManifest();if(!r)return;const i=null==(t=this.customNetworkingEngine)?void 0:t.getServerTime();void 0!==i&&r.presentationTimeline.setClockOffset(i-Date.now());const s=this.isLowLatencyLive()?0:this.props.liveOffset+Go;r.presentationTimeline.setDelay(s)}setShakaAvailabilityWindowOverride(e){const t=(0,kl.k)(e);if(void 0===t)return;const r=t===bn.Z.EVENT?1/0:NaN,{manifest:{availabilityWindowOverride:i}}=e.getConfiguration();r===i||isNaN(r)&&isNaN(i)||this.configureShaka(e,{manifest:{availabilityWindowOverride:r}})}setVariantTrack(e){void 0!==this.shakaPlayer&&void 0!==e&&(this.shakaPlayer.selectVariantTrack(e,!0),this.actualizeTracks())}setAbrEnabled(e){var t;void 0!==this.shakaPlayer&&(null==(t=this.shakaPlayer.getConfiguration().abr)?void 0:t.enabled)!==e&&(this.configureShaka(this.shakaPlayer,{abr:{enabled:e}}),this.updateShakaConfig())}actualizeActiveTracks(){this.actualizeActiveVariantTrack(),this.actualizeActiveTextTrack()}actualizeActiveVariantTrack(){const e=(0,bl.I)(this.shakaPlayer);if(void 0===e)return;const{originalAudioId:t,originalVideoId:r}=e;this.emit("InternalVideoTrackValueChange",r),this.emit("InternalAudioTrackValueChange",t)}actualizeActiveTextTrack(){if(void 0===this.shakaPlayer)return;const{controller:{textTrackEnabled:e}}=this.state,t=this.getCurrentInternalTextTrack();this.emit("InternalTextTrackValueChange",void 0!==t&&e?this.parseTextTrack(t).value:void 0)}actualizeAvailableTracks(){this.actualizeAvailableTextTracks(),this.actualizeAvailableVariantTracks()}actualizeAvailableTextTracks(){const e=this.getAvailableTextTracks();this.video.classList.toggle(ll().video_hiddenSubtitlesBtn,0===e.length),this.emit("TextTracksChange",e)}getAvailableTextTracks(){return this.shakaPlayer?this.shakaPlayer.getTextTracks().map(this.parseTextTrack):[]}actualizeAvailableVariantTracks(){const e=(0,bl.I)(this.shakaPlayer);if(!e)return;const t=(0,Tl.P)(this.shakaPlayer);if(!t)return;const r=t.variants;if(!Array.isArray(r))return;const i={},s={};r.forEach(t=>{const r=t.video,n=t.audio;if(!n||n.originalId===e.originalAudioId){const t=((e,t)=>{const{bandwidth:r,width:i,height:s,originalId:n}=e;return{name:Ft(e,t),value:n,width:i,height:s,bitrate:r?r/1e3:Co.A}})(r,this.videoTrackLabels),{name:s=String(t.height)||""}=t;(void 0===i[s]||t.value===e.originalVideoId||i[s].value!==e.originalAudioId&&i[s].bitrate<t.bitrate)&&(i[s]=t)}if(n&&r.originalId===e.originalVideoId){const t=function(e){let{manifestXml:t,audioStream:{label:r,language:i,originalId:s,bandwidth:n}}=e;const a=xt(t,s)||i;return{name:r||a||s,value:s,lang:a,bitrate:n?n/1e3:Co.A}}({manifestXml:this.manifestXML,audioStream:n}),{name:r}=t;(void 0===s[r]||t.value===e.originalAudioId||s[r].value!==e.originalAudioId&&s[r].bitrate<t.bitrate)&&(s[r]=t)}}),this.emit("VideoTracksChange",(0,Sa.z)(i)),this.emit("AudioTracksChange",(0,Sa.z)(s))}getCurrentInternalTextTrack(){return void 0===this.shakaPlayer?void 0:this.shakaPlayer.getTextTracks().find(Ol.I)}checkDeadChunkServer(e){if(!shaka)return;if(!Ce(this.getStreamUrl()))return;const{code:t,data:r}=e;if(!(t===shaka.util.Error.Code.BAD_HTTP_STATUS||t===shaka.util.Error.Code.HTTP_ERROR||t===shaka.util.Error.Code.TIMEOUT))return;const[i]=r,s=r[r.length-1];if("string"===typeof i&&s===shaka.net.NetworkingEngine.RequestType.SEGMENT){const{hostname:e}=(0,ta.en)(i);this.chunkHostnameBlacklist.addHostname(e)}}initShakaConfigAutoUpdate(){this.stopShakaConfigAutoUpdate(),this.shakaConfigAutoUpdateInterval=window.setInterval(()=>{this.updateShakaConfig()},1e3)}updateShakaConfig(){const{shakaPlayer:e}=this;if(void 0!==e)try{const t=this.getMaxBufferLength();if(e.getConfiguration().streaming.bufferingGoal===t)return;this.configureShaka(e,{streaming:{bufferingGoal:t}})}catch(tu){}}stopShakaConfigAutoUpdate(){clearInterval(this.shakaConfigAutoUpdateInterval)}configureShaka(e,t){try{e.configure(t)}catch(tu){this.props.onError(ss.u.from(tu,{isFatal:!1,code:ns.x.SHAKA_CONFIGURE_ERROR}))}}checkRepresentationChange(e,t){if(function(e,t){const r=Lt(e),i=Lt(t);return yl()(r,i)}(e,t))return;this.props.onExpectedStalledChange({reason:ts.k.RepresentationsChange,details:void 0});const r=new ss.u({isFatal:!1,code:ns.x.REPRESENTATION_CHANGE});this.props.onError(r),this.recoverStream()}computeVideoPlayingState(e){const t=e.isBuffering()||this.video.readyState<this.video.HAVE_FUTURE_DATA;return void 0===this.playingStateBeforeLoadShakaSource?(0,hl.k)(this.video,t):this.playingStateBeforeLoadShakaSource===Gi.X.PAUSE?Gi.X.PAUSE:t?Gi.X.BUFFERING:Gi.X.PLAY}}var Bl=r(9298),Hl=r(6652),jl=r(2891),Yl=r(5586);class Wl extends Ji.V{constructor(e,t,r,i){var s;super(),s=this,this.drmConfig=t,this.errorCallback=r,this.withCredentials=i,this.video=void 0,this.loadCertificate=(0,Vi.I)(async()=>{try{const{promise:e,abort:t}=jt({method:"GET",url:this.drmConfig.servers["com.apple.fps.1_0"],responseType:"arraybuffer",retries:jl.W,timeout:Yl.Y,onRetry:this.onRequestRetry(e=>{this.onError(new ss.u({code:ns.x.FAIRPLAY_CERT_LOAD_ERROR,isFatal:!1,details:e}))}),withCredentials:this.withCredentials});this.addDestroyHandler(t);const{response:r}=await e;return new Uint8Array(r)}catch(tu){return this.onError(new ss.u({isFatal:!0,code:ns.x.FAIRPLAY_CERT_LOAD_ERROR,details:(0,Hi.K)(tu)?tu:void 0})),new Uint8Array(0)}}),this.onNeedKey=async function(e){let{initData:t}=void 0===e?{}:e;const{video:r}=s;if(!t||s.isDestroyed)return;const i=s.extractContentId(t);await s.waitForLoadedMetaData(),r.webkitKeys||"function"!==typeof WebKitMediaKeys||r.webkitSetMediaKeys(new WebKitMediaKeys("com.apple.fps.1_0")),r.webkitKeys||s.onError(new ss.u({code:ns.x.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR}));const n=await s.getWebKitMediaKeySessionInitData(t,i),a=s.video.webkitKeys.createSession("video/mp4",n);a||s.onError(new ss.u({code:ns.x.FAIRPLAY_CREATE_KEY_SESSION_ERROR})),s.addDestroyHandler(()=>a.close());s.addDestroyHandler((0,Ei.O)(a,"webkitkeymessage",e=>{let{message:t}=e;if(s.isDestroyed)return;const r=t||new ArrayBuffer(0),n=Yt({"Content-Type":"application/json"},s.drmConfig.headers),{abort:o,promise:l}=jt({responseType:"json",method:"POST",url:s.drmConfig.advanced["com.apple.fps.1_0"].processSPCPath,data:JSON.stringify(Yt({assetId:i,spc:btoa(Wt(new Uint8Array(r)))},s.drmConfig.requestParams)),headers:n,retries:jl.W,timeout:Yl.Y,onRetry:s.onRequestRetry(e=>{s.onError(new ss.u({isFatal:!1,code:ns.x.FAIRPLAY_SPC_LOAD_ERROR,details:e}))}),withCredentials:s.withCredentials});s.addDestroyHandler(o),l.then(e=>{let{response:{ckc:t}}=e;const r=Kt(atob(t));a.update(new Uint8Array(r))}).catch(e=>{s.onError(new ss.u({isFatal:!0,code:ns.x.FAIRPLAY_SPC_LOAD_ERROR,details:e}))})}));s.addDestroyHandler((0,Ei.O)(a,"webkitkeyerror",e=>{let t;const{error:r}=a;if(r){const{code:e,systemCode:i}=r;t={code:e,systemCode:i}}s.onError(new ss.u({code:ns.x.FAIRPLAY_CREATE_KEY_ERROR,isFatal:!1,details:t}))}))},this.onError=e=>{this.isDestroyed||(this.errorCallback.call(this.errorCallback,e),e.isFatal&&this.destroy())},this.onRequestRetry=e=>(t,r)=>{if(r.status!==Ao.OC)return e(t),!0;const i=(0,qo.c)(r.response);return this.onError((0,Xo.t)(i)),!i.isFatal},this.video=e,this.addDestroyHandler((0,Ei.O)(e,"webkitneedkey",this.onNeedKey)),this.loadCertificate()}async getWebKitMediaKeySessionInitData(e,t){const r=await this.loadCertificate(),i=new Uint16Array(Kt(t));let s=0;const n=e.byteLength+4+i.byteLength+4+r.byteLength,a=new ArrayBuffer(n),o=new DataView(a);new Uint8Array(a,s,e.byteLength).set(new Uint8Array(e)),s+=e.byteLength,o.setUint32(s,i.byteLength,!0),s+=4;const l=new Uint16Array(a,s,i.length);l.set(i),s+=l.byteLength,o.setUint32(s,r.byteLength,!0),s+=4;return new Uint8Array(a,s,r.byteLength).set(r),new Uint8Array(a,0,a.byteLength)}extractContentId(e){const t=new Uint8Array(e),r=Wt(new Uint16Array(t.buffer)),[,i]=r.split("//");return i||(this.onError(new ss.u({isFatal:!1,code:ns.x.FAIRPLAY_INVALID_CONTENT_ID})),"")}async waitForLoadedMetaData(){if(!(this.video.readyState>=HTMLMediaElement.HAVE_METADATA))return new Promise(e=>{this.addDestroyHandler((0,Ei.O)(this.video,"loadedmetadata",()=>e(),{once:!0}))})}}Wl.IS_SUPPORTED="undefined"!==typeof WebKitMediaKeys&&(0,qr.m)(WebKitMediaKeys.isTypeSupported)&&WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4");class Gl extends Zi.v{constructor(e){super(),this.video=void 0,this.unsubscribers=[],this.isStrmCatchUpStream=void 0,this.seekableEndFifo=new to.y(2),this.destroy=()=>{(0,xi.p)(this.unsubscribers)},this.handleProgressEvent=()=>{if(!this.video||!this.video.seekable.length)return;const e=this.video.seekable,t=e.end(e.length-1),r=this.seekableEndFifo.getAll();t!==r[r.length-1]&&(this.seekableEndFifo.push(t),this.updateVideoType({reason:"progress"}))},this.updateVideoType=e=>{let{reason:t}=e;this.emit("VideoTypeChange",{videoType:this.getVideoType(),videoTagDuration:this.video?this.video.duration:null,reason:t})},this.isStrmCatchUpStream=function(e){if(!Ce(e))return!1;const t=(0,ta.dD)((0,ta.en)(e).search);return Boolean(t.start)}(e)}setHTMLVideoElement(e){this.destroy(),this.video=e,this.unsubscribers.push((0,Ei.O)(e,"timeupdate",()=>{this.updateVideoType({reason:"timeupdate"})})),this.unsubscribers.push((0,Ei.O)(e,"durationchange",()=>{this.updateVideoType({reason:"durationchange"})})),this.unsubscribers.push((0,Ei.O)(e,"progress",this.handleProgressEvent))}getVideoType(){if(!this.video||isFinite(this.video.duration))return bn.Z.VOD;if(this.isStrmCatchUpStream)return bn.Z.EVENT;const e=this.seekableEndFifo.getAll();if(!this.video.seekable.length||e.length<2)return bn.Z.LIVE;const t=this.video.seekable.start(0);return e[1]>e[0]&&t?bn.Z.LIVE:bn.Z.EVENT}}class Kl{constructor(e){let{retries:t=3,nudgeDelay:r=2e3,nudge:i,shouldNudge:s,onNudgeFailed:n=cn.Z}=e;this.retries=void 0,this.nudge=void 0,this.shouldNudge=void 0,this.nudgeDelay=void 0,this.onNudgeFailed=void 0,this.currentRetries=0,this.timer=void 0,this.retries=t,this.nudge=i,this.shouldNudge=s,this.nudgeDelay=r,this.onNudgeFailed=n}schedule(){this.timer||(this.currentRetries++,this.timer=window.setTimeout(()=>{this.timer=void 0,this.shouldNudge()&&(this.currentRetries>this.retries?this.onNudgeFailed():(this.nudge(),this.schedule()))},this.nudgeDelay))}clear(){this.currentRetries=0,window.clearTimeout(this.timer),this.timer=void 0}}var ql=r(9507);let zl,Xl;!function(e){e.Start="Start",e.Watched4Sec="4SecWatched",e.Watched10Sec="10SecWatched",e.Watched20Sec="20SecWatched",e.Heartbeat30Sec="30SecHeartbeat",e.End="End"}(zl||(zl={})),function(e){e.PLAY="play",e.PAUSE="pause",e.BUFFERING="buffering",e.END="end"}(Xl||(Xl={}));const Ql=["loadstart","progress","durationchange","loadedmetadata","loadeddata","canplay","playing"];class Zl extends Yo.U{initInternalSubscribe(){super.initInternalSubscribe(),this.recoverSleepMode(),this.activateVideoTagIosWorkaround(),this.subscribeStalledNudger()}constructor(e){super(e),this.props=e,this.engine=Gn.$.NATIVE,this.stalledNudger=void 0,this.fairPlayController=void 0,this.isLowLatencyLiveStream=!1,this.isStuck=function(e){let{getCurrentTime:t,getPlayingState:r}=e;const i=new to.y(5);let s=0,n=t();return e=>{const a=t();if(r()!==Xl.PLAY)return s=0,i.clear(),!1;s=e+s;let o=!1;if(s>1e3&&n!==a&&(i.push(a),s=0,5===i.size())){const e=i.getAll(),t=Math.max(...e)-Math.min(...e);o=t>0&&t<1}return n=a,o}}({getCurrentTime:()=>this.getCurrentTime(),getPlayingState:()=>this.getPlayingState()}),this.stalledNudger=new Kl({nudge:()=>{this.state.controller.playbackRate>1&&this.setPlaybackRate(1),this.onNudge()},shouldNudge:()=>this.getPlayingState()===Gi.X.BUFFERING&&(!!this.shouldNudge()&&this.getRemainingBufferedTime().total>0),onNudgeFailed:()=>{this.props.logEvent({event:$i.NudgeStalledFailed,params:{}})}})}getUtcStartTime(){const e=this.video;if(!this.video.src||0===e.readyState||"function"!==typeof e.getStartDate)return super.getUtcPosition();const t=e.getStartDate();if(!t||"function"!==typeof t.getTime)return super.getUtcPosition();const r=t.getTime();return isNaN(r)?super.getUtcPosition():r/1e3}getUtcPosition(){const e=this.getUtcStartTime();return e>0?e+this.getCurrentTime():super.getUtcPosition()}async attachEncoder(){this.emit("BufferingRangesChange",[]),await super.attachEncoder(),is.Y.log("hls native mode")}async detachEncoder(){await super.detachEncoder(),this.video.src&&this.video.removeAttribute("src")}shouldSkipVideoTagError(e){return super.shouldSkipVideoTagError(e)||Boolean(this.fairPlayController&&this.fairPlayController.isDestroyed)}shouldNudge(){return!(0,Pn.I)(this.state)&&this.canSeek()}onNudge(){this.seek(this.state.controller.currentTime+.001)}getStartPosition(){const{videoTime:e,utc:t}=this.state.controller.startPosition;if((0,Bi.z)(e)||(0,Bi.z)(t)){if(this.state.controller.videoType===bn.Z.LIVE){const e=this.getUtcStartTime();if(e>0&&(0,Bi.z)(t)&&t>0)return t-e}return(0,Bi.z)(e)?e:void 0}}establishStartPosition(){return new Promise((e,t)=>{const r=[];Ql.forEach(t=>{r.push(this.addVideoEventListener(t,()=>{this.canSeek()&&(this.applyStartPosition(),(0,xi.p)(r),e())},{once:!0}))}),this.once("Detach",()=>{(0,xi.p)(r),t()})})}isDvrEnabled(){if(Ha.G&&!Bl.g)return!0;const{controller:{isFullscreen:e},skin:{nativeControlsVisibility:t}}=this.state;return!e&&!t}setVideoTrack(){is.Y.log("Unable to set video track on native encoder")}getBandwidthEstimate(){return{value:NaN,source:"default"}}async initDrm(){const{stream:{drmConfig:e}}=this.props;return this.initFairPlay(e)}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e===bn.Z.VOD||void 0===e)return super.calculateDVRParams();const{fragmentDuration:t,startTime:r,totalDuration:i}=this.getFragmentsData();return{fragmentDuration:t,dvrStartTime:r,dvrDuration:i,skinDVRStartTime:r,skinDVRDuration:i-vn.D}}getStreamUrl(){const e={force_m4s:"1"},t=super.getStreamUrl(),r=Bo.L.isLiveStreamUrl(t),i=qa>=14||ja>=15;return this.isLowLatencyLiveStream=r&&i,this.isLowLatencyLiveStream&&(e.lowlatency="1"),(0,ta.Sr)(t,e,{saveOriginalPath:!0})}isLowLatencyLive(){return this.isLowLatencyLiveStream}initVideoTypeQualifier(){const e=new Gl(this.getStreamUrl());this.once("Detach",e.destroy),e.on("VideoTypeChange",e=>{if(null==e||!e.videoType)return;const{controller:{videoType:t}}=this.props.playerStore.getState();this.checkIfRecoverNecessary(e,t)&&(this.stateController.putPlaybackRate(1),this.props.onRecover({reason:"currentTime is greater than duration during LIVE / EVENT in NativeController",delay:0,attempt:1}),this.recoverStream().then(()=>{this.play()})),void 0!==t&&e.videoType!==t&&this.props.logEvent({event:$i.NativeVideoTypeChange,params:qt({},e,{previousVideoType:t})}),this.emit("VideoTypeChange",e.videoType)}),e.setHTMLVideoElement(this.video)}onTick(e){this.handleBufferingRangesUpdate(),super.onTick(e),this.checkStuckState(e),this.checkOutOfDvr(),this.updateProgramDateTime()}checkIfRecoverNecessary(e,t){let{reason:r,videoTagDuration:i}=e;return(t===bn.Z.LIVE||t===bn.Z.EVENT)&&"durationchange"!==r&&i&&isFinite(i)}checkStuckState(e){this.video.error||this.isStuck(e)&&this.recoverHelper.planTask(()=>this.recoverStream(),{delay:100,reason:"Stuck on time "+this.getCurrentTime()})}checkOutOfDvr(){if(this.video.error)return;const e=this.getCurrentTime(),{startTime:t}=this.getFragmentsData(),{videoType:r,playingState:i}=this.state.controller;this.recoverHelper.started||e>=t||i===Gi.X.PLAY&&r===bn.Z.LIVE&&this.recoverHelper.planTask(()=>this.recoverStream(!0),{delay:0,reason:"Out of DVR. CurrentTime="+e+" startTime="+t})}handleBufferingRangesUpdate(){if(qa>=15||ja>=15){const e=this.props.video.buffered,t=this.props.video.buffered.length;if(!t)return;const r=this.state.controller.currentTime,i=this.state.controller.bufferingRanges.find(e=>r>=e.start&&r<=e.end);if(!i)return;for(let s=0;s<t;s++)if(e.start(s)<=r&&e.end(s)>r)return void(e.end(s)>i.end&&this.emit("BufferingRangesChange",(0,ql.e)(this.props.video)))}}async initFairPlay(e){if(!de(e))return(0,Fn.Z$)("drm","none"),void this.emit("DrmSystemChange",Aa.W.none);if((0,Fn.Z$)("drm","fairplay"),!Wl.IS_SUPPORTED)throw new ss.u({code:ns.x.FAIRPLAY_NOT_SUPPORTED});const{video:t,onError:r}=this.props,i=new Wl(t,e,r,this.withCredentials);this.fairPlayController=i,this.emit("DrmSystemChange",Aa.W.fairplay),this.once("Destroy",()=>i.destroy())}recoverSleepMode(){const e=(0,Ni.Y)(this.getVideoOwnerDocument(),e=>{e&&this.shouldNudge()&&(this.video.currentTime-=.001)});this.once("Destroy",e)}subscribeStalledNudger(){this.on("VideoPlayingStateChange",e=>{var t,r;e===Gi.X.BUFFERING?null==(t=this.stalledNudger)||t.schedule():null==(r=this.stalledNudger)||r.clear()})}updateProgramDateTime(){const{videoType:e}=this.state.controller,t=this.getUtcStartTime(),r=(e===bn.Z.LIVE||e===bn.Z.EVENT)&&t?1e3*t:void 0;this.emit("ProgramDateTimeChange",r)}activateVideoTagIosWorkaround(){Bl.g&&this.once("Destroy",(0,Ei.O)(this.video,"touchstart",()=>{this.video.paused?this.video.pause():Promise.resolve(this.video.play()).catch(cn.Z)},{once:!0}))}handleVideoElementPlayEvent(){this.props.video.buffered.length&&super.handleVideoElementPlayEvent()}}var Jl=r(884),$l=r(6571),ed=r(980);const td=e=>void 0!==e.width&&void 0!==e.height;var rd=r(2150);class id extends Zi.v{constructor(){super(...arguments),this.video=void 0,this.previousDuration=0,this.unsubscribers=[],this.destroy=()=>{this.previousDuration=0,(0,xi.p)(this.unsubscribers)},this.updateVideoType=()=>{this.emit("VideoTypeChange",this.getVideoType())}}setHTMLVideoElement(e){this.destroy(),this.video=e,this.unsubscribers.push((0,Ei.O)(e,"timeupdate",this.updateVideoType)),this.unsubscribers.push((0,Ei.O)(e,"durationchange",this.updateVideoType))}getVideoType(){return this.video&&this.video.duration?this.video.duration===1/0?bn.Z.LIVE:(0===this.previousDuration&&(this.previousDuration=this.video.duration),this.video.duration>this.previousDuration?bn.Z.EVENT:bn.Z.VOD):bn.Z.VOD}}const sd=Ea(),nd=sd?"app":"bro",ad=sd?pe("YandexSearch")||pe("YaSearchBrowser")||pe("YaApp_Android"):fe();var od=r(5442);class ld{constructor(e){this.playingState=void 0,this.video=void 0,this.jsonRpcMessenger=void 0,this.handleMessage=e=>{e&&(0,li.H)(e.data)&&this.jsonRpcMessenger.handleMessage(e.data)},this.video=e.video,this.playingState=e.playingState,this.jsonRpcMessenger=new od.A({onRun:(t,r)=>{if(!Array.isArray(t.params))throw new Error("Unexpected params value");e.onRun(t,r)},send:e=>{this.video.yandexPlayerSend(e)},serialize:JSON.stringify,deserialize:JSON.parse}),this.jsonRpcMessenger.on("Error",e.onError),this.jsonRpcMessenger.on("Warn",is.Y.warn),this.video.addEventListener("yandexplayermessage",this.handleMessage)}destroy(){this.jsonRpcMessenger.destroy(),this.video.removeEventListener("yandexplayermessage",this.handleMessage)}sendRequest(e,t){let{method:r,params:i}=e;return void 0===t&&(t=3e4),this.playingState!==Gi.X.PLAY&&this.playingState!==Gi.X.BUFFERING?Promise.reject(new Error("Can't send request while playingState is "+this.playingState)):this.jsonRpcMessenger.request({method:r,params:i},t)}sendEvent(e){let{method:t,params:r}=e;return this.playingState!==Gi.X.PLAY&&this.playingState!==Gi.X.BUFFERING?Promise.reject(new Error("Can't send event while playingState is "+this.playingState)):this.jsonRpcMessenger.sendEvent({method:t,params:r})}setPlayingState(e){this.playingState=e}}var dd=r(9366),cd=r(45);class ud{constructor(e){let{video:t,onError:r,playingState:i}=e;this.yandexRpcMessenger=void 0,this.handleRun=(e,t)=>{t(new dd.l("Not implemented",cd.v.METHOD_NOT_FOUND))},this.yandexRpcMessenger=new ld({video:t,onError:r,onRun:this.handleRun,playingState:i})}setPlayingState(e){return this.yandexRpcMessenger.setPlayingState(e)}destroy(){return this.yandexRpcMessenger.destroy()}async setViewPortSize(e){let{width:t,height:r}=e;await this.yandexRpcMessenger.sendRequest({method:"setViewPortSize",params:{width:t,height:r}})}async getPlayerVersion(){const e=await this.yandexRpcMessenger.sendRequest({method:"getPlayerVersion",params:[]});if(!(0,li.H)(e))throw new Error("Unexpected result in getPlayerVersion: "+e);return e}async getBandwidth(){const e=await this.yandexRpcMessenger.sendRequest({method:"getBandwidth",params:[]});if(!(0,Bi.z)(e))throw new Error("Unexpected result in getBandwidth: "+e);return e}async getStartDate(){const e=await this.yandexRpcMessenger.sendRequest({method:"getStartDate",params:[]});if(!(0,Bi.z)(e))throw new Error("Unexpected result in getStartDate: "+e);return e}}var hd=r(6971);document.createElement("div"),document.createElement("div");class pd extends Yo.U{constructor(){super(...arguments),this.engine=Gn.$.YANDEX,this.startDate=Bo.d,this.yandexRpc=void 0,this.wasSuspendedOnCurrentSource=!1,this.expectedStateAfterRestore=Gi.X.PAUSE,this.waitingForStartPositionEstablished=!1}async attachEncoder(){this.initYandexPlayer();const e=this.getStartPosition();(0,Bi.z)(e)&&(this.waitingForStartPositionEstablished=!0),await super.attachEncoder(),this.restoreYandexPlayer(),this.initYandexRpc(),this.initStartDateUpdater(),this.initBandwidthEstimateUpdater(),this.initViewPortSizeUpdater(),this.isRecoverablePlaylistHTTPStatus=!1,is.Y.log("yandex native mode")}play(){return this.expectedStateAfterRestore=Gi.X.PLAY,super.play()}pause(){return this.expectedStateAfterRestore=Gi.X.PAUSE,super.pause()}async detachEncoder(){this.isRecoverablePlaylistHTTPStatus=!0,this.suspendYandexPlayer(),this.detachYandexPlayer(),await super.detachEncoder()}getCapSizes(){const{width:e,height:t,maxWidth:r,maxHeight:i}=super.getCapSizes();return{width:Math.min(e,r||1/0),height:Math.min(t,i||1/0),maxWidth:1/0,maxHeight:1/0}}initInternalSubscribe(){super.initInternalSubscribe();let e=zt(this.playerStore.getState().controller.currentTime);this.on("CurrentTimeChange",t=>{if(this.state.controller.encoderState!==Sn.y.Attached)return;if(this.playerStore.getState().controller.playingState!==Gi.X.PLAY)return;if(this.waitingForStartPositionEstablished)return;const r=zt(t);r!==e&&(e=r,this.playerStore.setControllerStateField(Cn.jY.startPosition,{videoTime:t,utc:this.getUtcPosition()}),this.updateYandexPlayerConfig())}),this.once("Destroy",()=>{this.dropDetachedYandexPlayer()})}setVideoTrack(e){const{videoTracks:t}=this.video,r=Array.from(t).findIndex(t=>t.id===e.value);r in t?t[r].selected=!0:this.props.logEvent({event:"VideoTrackNotFound",params:{track:e,videoTracks:Array.from(t)}})}seekInternal(e){const{start:t,end:r}=this.getSeekableRange();(0,rd.O)(this.video,(0,oi.u)(e,t,r||0))}getSeekableRange(){const{videoType:e}=this.state.controller;switch(e){case bn.Z.LIVE:return{start:this.getUtcStartTime(),end:this.getDuration()};default:return{start:0,end:this.getDuration()}}}getDuration(){const{videoType:e}=this.state.controller;switch(e){case bn.Z.LIVE:return this.getUtcStartTime()+180;default:return this.video.duration}}getUtcStartTime(){return this.startDate}getUtcPosition(){const{videoType:e}=this.state.controller;switch(e){case bn.Z.LIVE:return this.getCurrentTime();default:return this.getUtcStartTime()?this.getUtcStartTime()+this.getCurrentTime():super.getUtcPosition()}}getMaxCapAllowedVideoTrack(){const{videoTracks:e}=this.state.controller,t=this.getCapSizes(),r=((e,t,r)=>{const i=e.filter(td);return i.sort((e,t)=>e.width>t.width&&e.height>t.height?-1:1).find(e=>{let{width:i,height:s}=e;return i<=t&&s<=r})||i[i.length-1]})(e,t.width,t.height);if(r&&r.width&&r.height)return{width:r.width,height:r.height}}getFragmentsData(){if(!this.isDvrEnabled()||!this.video||!this.video.seekable.length)return super.getFragmentsData();const{start:e,end:t}=this.getSeekableRange();return{totalDuration:t-e,fragmentDuration:vn.D,startTime:e}}isDvrEnabled(){return!0}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}initVideoTypeQualifier(){const e=new id;this.once("Detach",e.destroy),e.on("VideoTypeChange",e=>{e&&this.emit("VideoTypeChange",e)}),e.setHTMLVideoElement(this.video)}establishStartPosition(){return new Promise((e,t)=>{const{playingState:r,preload:i}=this.state.controller;!1===i&&r===Gi.X.PAUSE&&e();const s=this.addVideoEventListener("durationchange",()=>{if(!this.canSeek())return;const t=this.getStartPosition(),r=this.getCurrentTime();(0,Bi.z)(t)&&(0,Jl.C)(t,r,.5)||this.applyStartPosition(),s(),this.waitingForStartPositionEstablished=!1,e()});this.once("Detach",()=>{s(),t()})})}initDrm(e){return(0,Fn.Z$)("drm",e?"android":"none"),Promise.resolve()}async onVideoTagError(){const e=(0,po.Q)(this.video);if(this.state.controller.encoderState!==Sn.y.Attached)return super.onVideoTagError();this.video.poster=zi.O,this.checkPlaylistHTTPStatus();const t=new ss.u({code:fo.y[e.code],details:e,isFatal:!0}),r=await this.checkPlaylistHTTPStatusPromise;if(!r||!r.isFatalError())return t.category===hd.q.MEDIA&&(0,Wr.Y)(()=>Ma.ZP.setItem("videoplayer-yandex-player-last-fatal",String(Date.now()))),void this.props.onError(t);this.props.onError(r.toPlayerError())}onVideoResize(){super.onVideoResize(),this.updateAutoVideoTrackIfNeed()}initYandexRpc(){const e=new ud({video:this.video,onError:e=>{this.props.onError(new ss.u(Jt({},e,{isFatal:!1,code:ns.x.YANDEX_RPC_ERROR})))},playingState:this.state.controller.playingState});this.on("VideoPlayingStateChange",t=>{e.setPlayingState(t)}),this.yandexRpc=e,this.once("Detach",()=>{e.destroy(),this.yandexRpc=void 0})}initStartDateUpdater(){const{yandexRpc:e}=this;if(!e)return;const t=setInterval(()=>{e.getStartDate().then(e=>{if(!(e>0))return void this.emit("ProgramDateTimeChange",void 0);this.startDate=Math.floor(e/1e3);const{videoType:t}=this.state.controller;switch(t){case bn.Z.LIVE:return this.emit("ProgramDateTimeChange",0);default:return this.emit("ProgramDateTimeChange",e)}}).catch(cn.Z)},5e3);this.once("Detach",()=>{clearInterval(t)})}restoreYandexPlayer(){if(!Zt({featureName:"suspend-on-ad"}))return;if(!this.wasSuspendedOnCurrentSource)return;const e=this.video;(0,Wr.Y)(()=>{(0,qr.m)(e.yandexReattachPlayer)&&(e.yandexReattachPlayer(!e.paused).then(()=>{switch(this.expectedStateAfterRestore){case Gi.X.PLAY:return void super.play();case Gi.X.PAUSE:return void super.pause()}}),is.Y.log("video.yandexReattachPlayer()"))})}initYandexPlayer(){this.updateYandexPlayerConfig()}updateYandexPlayerConfig(){const e=this.getStartPosition(),t=this.getBandwidthEstimate(),{drmConfig:r}=this.props.stream,{height:i,width:s}=this.getCapSizes(),n={vsid:Zt({featureName:"single-vsid-with-android"})?this.state.controller.vsid:void 0,drmConfig:r,bandwidthEstimate:(0,Bi.z)(t.value)?Math.floor(t.value):void 0,startPosition:(0,Bi.z)(e)?e:void 0,viewPortHeight:(0,Bi.z)(i)?Math.floor(i):void 0,viewPortWidth:(0,Bi.z)(s)?Math.floor(s):void 0,flags:(0,xa.qm)(),slots:(a=this.props.sourceParams.additionalParams,void 0===a?"":a.slots||""),testIds:Xt(this.props.sourceParams.additionalParams)};var a;this.video.setAttribute("yandexplayer",JSON.stringify(n)),is.Y.log("this.video.setAttribute('yandexplayer', "+JSON.stringify(n)+")")}suspendYandexPlayer(){if(!Zt({featureName:"suspend-on-ad"}))return;const e=this.video;(0,qr.m)(e.yandexDetachPlayer)&&((0,Mo.s)(e,()=>e.yandexDetachPlayer()),is.Y.log("video.yandexDetachPlayer()"),this.wasSuspendedOnCurrentSource=!0)}dropDetachedYandexPlayer(){const e=this.video;(0,qr.m)(e.yandexDropDetachedPlayer)&&(is.Y.log("video.yandexDropDetachedPlayer()"),e.yandexDropDetachedPlayer())}detachYandexPlayer(){this.video.removeAttribute("yandexplayer"),is.Y.log("this.video.removeAttribute('yandexplayer')")}updateAutoVideoTrackIfNeed(){const{videoTracks:e,videoWidth:t,videoHeight:r}=this.video,i=(0,ed.Y)((0,$l.s)({videoTracks:e,videoWidth:t,videoHeight:r}));this.emit("InternalVideoTrackValueChange",i?i.value:void 0)}initBandwidthEstimateUpdater(){const{yandexRpc:e}=this;if(!e)return;const t=setInterval(()=>{e.getBandwidth().then(e=>{this.stateController.putLastKnownBandwidthEstimate({value:e,source:"yabro"})}).catch(cn.Z)},6e4);this.once("Detach",()=>{clearInterval(t)})}async updateViewPortSize(e){let{width:t,height:r}=e;const{yandexRpc:i}=this;return i?i.setViewPortSize({width:Math.floor(t),height:Math.floor(r)}).then(()=>({width:t,height:r})).catch(()=>({width:NaN,height:NaN})):{width:NaN,height:NaN}}initViewPortSizeUpdater(){const{yandexRpc:e}=this;if(!e)return;let t=NaN,r=NaN;this.updateViewPortSize(this.getCapSizes()).then(e=>{let{width:i,height:s}=e;t=i,r=s});const i=setInterval(()=>{const{width:e,height:i}=this.getCapSizes();e===t&&i===r||this.updateViewPortSize({width:e,height:i}).then(e=>{let{width:i,height:s}=e;t=i,r=s})},1e3);this.once("Detach",()=>{clearInterval(i)})}}var fd=r(4159);const md=(0,zr.c)(window),gd={};var vd=r(5355),yd=r(1701),Ed=r(4661),Sd=r.n(Ed),Ad=r(4458);const Td=["time","cacheVersion"],bd=r(8139),Rd=["object"===typeof document&&document&&"onfreeze"in document?"pagehide":"beforeunload","unload"];var wd=r(3974);const _d=!Ls.$&&(0,wd.N)("video/webm")?"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAByhFNm3RAHU27i1OrhBVJqWZTrIHlTbuMU6uEFlSua1OsggEj7AEAAAAAAAC5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAADIq17GDD0JATYCNTGF2ZjU3Ljc2LjEwMFdBjUxhdmY1Ny43Ni4xMDBEiYhASwAAAAAAABZUrmsBAAAAAAAAYq4BAAAAAAAAWdeBAXPFgQGcgQAitZyDdW5khoZBX09QVVNWqoNjLqBWu4QExLQAg4EC4QEAAAAAAAARn4ECtYhA53AAAAAAAGJkgSBjopNPcHVzSGVhZAECOAGAuwAAAAAAH0O2dQEAAAAAAAAt54EAo4eBAACA/P/+o4eBABWA/P/+oAEAAAAAAAAPoYeBACkA/P/+daKDa3KD":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAMm1kYXTeBABMYXZjNTcuMTA3LjEwMABCIAjBGDghEARgjBwhEARgjBwhEARgjBwAAAMbbW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAAAEsAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAkV0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAAEsAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAA1AAAEAAABAAAAAAG9bWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAADgZVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAABaG1pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAABLHN0YmwAAABqc3RzZAAAAAAAAAABAAAAWm1wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAANmVzZHMAAAAAA4CAgCUAAQAEgICAF0AVAAAAAAH0AAAAEYwFgICABRGQVuUABoCAgAECAAAAMHN0dHMAAAAAAAAABAAAAAEAAAQAAAAAAQAABBgAAAABAAAEAAAAAAEAAAHuAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAAEAAAAAQAAACRzdHN6AAAAAAAAAAAAAAAEAAAAGAAAAAYAAAAGAAAABgAAABRzdGNvAAAAAAAAAAEAAAAsAAAAGnNncGQBAAAAcm9sbAAAAAIAAAAB//8AAAAcc2JncAAAAAByb2xsAAAAAQAAAAQAAAABAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ny44My4xMDA=";let kd;!function(e){e.AutomaticallyGenerated="AutomaticallyGenerated",e.HardcodedParams="HardcodedParams",e.IOS9OrLess="IOS9OrLess",e.HTML5VideoIsNotSupported="HTML5VideoIsNotSupported",e.WindowHasBeenActive="WindowHasBeenActive",e.RAAStopped="RAAStopped",e.OldIE="OldIE",e.MediaError="MediaError",e.NotRecognized="NotRecognized",e.YaBroAllowedToPlay="YaBroAllowedToPlay"}(kd||(kd={}));const Pd=(0,r(2988).N)();var Id=r(7304),Cd=r(4886),Od=r(2626),Dd=r(4769);var Nd=r(2553);const Ld=e=>{const{paused:t}=e;return()=>{t?e.pause():e.paused&&(0,jr.v)(function(e){if(!Yr.Y)return Promise.reject();const t=(r=e.play).__yaMuffleVideoPlayPromiseOriginalPlay||r;var r;if((0,bi.E)(t))return t.call(e);const i=or("HTMLVideoElement")||or("HTMLMediaElement");if(i)return i.call(e);const s=document.createElement("div");s.style.display="none",document.body.appendChild(s);const n=or("HTMLMediaElement",(0,Nd.Q)(s).contentWindow);if(n){const t=n.call(e);return(0,cs.L)(s),t}return e.play()}(e))}},Md=e=>{const t=(e=>{const{muted:t}=e;return()=>{e.muted=t}})(e),r=(e=>{const{volume:t}=e;return()=>{e.volume=t}})(e),i=Ld(e);return()=>{t(),r(),i()}},xd=Pd>-1&&Pd<=16,Vd=dr({canPlayUnMuted:!1,canPlayMuted:!1,detectionMethod:kd.AutomaticallyGenerated}),Fd=dr({canPlayUnMuted:!0,canPlayMuted:!0,detectionMethod:kd.AutomaticallyGenerated});class Ud{constructor(e,t){let{checkSoundEnabled:r,promise:i}=t;if(this.video=e,this.promise=void 0,this.stop=cn.Z,this.isStopped=!1,this.revertVideoState=cn.Z,this.getIsActiveWindow())return this.promise=Promise.resolve(lr({},Fd,{detectionMethod:kd.WindowHasBeenActive})),this;if(i)return this.promise=i,this;const s=document.createElement("div");s.style.display="none";const n=Md(e),a=(0,Mo.s)(e,()=>function(e,t){const r={};return(0,Ai.Z)(t).forEach(t=>{r[t]=e.getAttribute(t)}),(0,Id.K)(e,t),(0,Vi.I)(()=>{(0,Id.K)(e,r)})}(e,{src:_d}));let o;this.revertVideoState=(0,Vi.I)(()=>{a(),e.load(),n(),(0,cs.L)(s)}),this.promise=new Promise(async(e,t)=>{let i,s,n;if(o=t,r){const e=await this.requestAutoplayAbilityByMuted(!1);s=e.autoplayAbility,i=e.detectionMethod}else s=!1;if(!this.isStopped){if(s)n=!0;else{const e=await this.requestAutoplayAbilityByMuted(!0);n=e.autoplayAbility,i=i&&i!==e.detectionMethod?"DifferentDetectionMethods unmuted=["+i+"] muted=["+e.detectionMethod+"]":e.detectionMethod}this.isStopped||(this.revertVideoState(),this.isStopped=!0,e(dr({canPlayUnMuted:s,canPlayMuted:n,detectionMethod:i||kd.NotRecognized})))}}),this.stop=()=>{this.isStopped||(this.isStopped=!0,o(new Error("requestAutoplayAbility has been stopped")),this.revertVideoState())}}async requestAutoplayAbilityByMuted(e){const{video:t}=this;if((0,Mo.s)(t,()=>{t.load()}),await(0,Cd._)(0),this.isStopped)return{autoplayAbility:!1,detectionMethod:kd.RAAStopped};t.muted=e,t.volume=e?0:1;const r=await new Promise(e=>{(0,Od.b)(t,{useProgressEvent:!0,timeoutForNonPromisePlay:500}).then(t=>{e({autoplayAbility:!0,detectionMethod:t})}).catch(r=>{const i=(0,po.Q)(t);i&&i.code===fo.y.MEDIA_ERR_DECODE?setTimeout(()=>{e({autoplayAbility:!0,detectionMethod:kd.MediaError})},0):e({autoplayAbility:!1,detectionMethod:r})})});return this.isStopped?{autoplayAbility:!1,detectionMethod:kd.RAAStopped}:r}getIsActiveWindow(){const e=(0,Dd.G)(this.video);if(!e)return!1;const t=ir(e);return Boolean(t&&t.hasBeenActive)}}let Bd;!function(e){e.AutoplayDisabled="AutoplayDisabled",e.RASAborted="RASAborted"}(Bd||(Bd={}));var Hd=r(532);const jd=pr((e,t)=>{e.callbacks.onAdblockDetected(t)}),Yd=pr((e,t)=>{e.callbacks.onVideoSizeChange(t)});var Wd=r(3117);const Gd=pr((e,t,r)=>{const i=e.getState();t.callbacks.onAudioTrackChange(Q(i))}),Kd=pr((e,t)=>{e.callbacks.onAudioTracksChange(t)}),qd=pr((e,t)=>{e.callbacks.onBufferingRangesChange(t)}),zd=pr((e,t,r)=>{t.callbacks.onFullScreenChange(r),gr(e,t),mr(e,t)}),Xd=pr((e,t)=>{e.callbacks.onTextTracksChange(t)}),Qd=pr((e,t)=>{e.callbacks.onChangeStream(t)}),Zd=pr((e,t)=>{e.callbacks.onStreamsWithSupportInfoChange(t)}),Jd=pr((e,t)=>{e.callbacks.onVideoTypeChange(t)}),$d=pr((e,t)=>{t||e.updateVideoControllerNativeControlsVisibility()}),ec=[es.midroll,es.postroll,es.preroll],tc=pr((e,t,r)=>{const i=function(e){const{ad:{nextAdInfo:t},controller:{videoType:r}}=e;if(void 0!==t&&("postroll"!==t.adBreakType||r===bn.Z.VOD))return t.remainingTime}(e.getState());t.callbacks.onNextAdRemainingTimeChange(i)}),rc=pr((e,t,r)=>{t.callbacks.onStartStageChange(r),r===En.o.waitForUserPlay&&e.putResourcesIdle(!0)});var ic=r(4295);const sc=["ewma","hlsjs","yabro"],nc=pr((e,t,r)=>{const{controller:{isOnline:i}}=e.getState();i?sc.includes(r.source)&&t.callbacks.onBandwidthEstimateChange(r):t.callbacks.onBandwidthEstimateChange({value:0,source:"default"})}),ac=pr((e,t,r)=>{r||nc(e,t,{value:0,source:"default"}),t.callbacks.onNetworkStatusChange({isOnline:r})});let oc=0;var lc=r(6394);const dc=pr(async(e,t)=>{if(!t)return;e.callbacks.onResourcesIdle(),e.callbacks.logEvent({event:$i.ResourcesIdle,params:{}}),await(0,Cd._)(5e3);const r=(0,lc.getGpu)();e.callbacks.logEvent({event:$i.ClientInfo,params:{gpu:{renderer:r.renderer,vendor:r.vendor}}})}),cc=function(e,t){let r=e[t];if(!(0,bi.E)(r)){const i=r;try{delete e[t],r=e[t],e[t]=i}catch(tu){}}return r}(Object,"create")?Object.create:function(e,t){function r(){}if(r.prototype=e,(0,Hi.K)(t))for(const i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return new r},uc=e=>e instanceof Date||"Date"===(0,Fi.M)(e),hc=function e(t,r){void 0===r&&(r={preserveConstructors:!0});let i=t;if((0,Zo.k)(t)){return t.map(t=>e(t,r))}return uc(t)?new Date(t.getTime()):(!(0,qr.m)(t)&&(0,Hi.K)(t)&&(i=r.preserveConstructors?cc(t):{},(0,Ri.M)(t,(t,s)=>{i[s]=e(t,r)})),i)};var pc=r(5372);class fc{constructor(e){let{playerApi:t,store:r}=e;this.playerApi=void 0,this.store=void 0,this.lastSourceId=void 0,this.prevVolumeInfoPayload=void 0,this.prevIsAbrEnabled=void 0,this.prevVideoTrackValue=void 0,this.waitingForVideoTracks=!1,this.currentPostPauserollInterval=void 0,this.watchedTimeCounter=void 0,this.putVolumeInfo=e=>{var t,r;(this.store.setVolumeInfo(e),t=this.prevVolumeInfoPayload,r=e,t.volume!==r.volume||t.muted!==r.muted)&&(this.prevVolumeInfoPayload=e,function(e,t){let{volume:r,muted:i,changeReason:s}=t;e.callbacks.onVolumeChange({volume:r,muted:i,changeReason:s})}(this.playerApi,e),gr(this.store,this.playerApi))},this.updateAdInfo=pr(e=>{const{ad:{adInfo:t}}=this.store.getState();this.putAdInfo(e),function(e,t,r){r&&t&&r.adType!==t.adType?(e.callbacks.onAdStateChange({state:Hn.NOT_PLAYING,type:r.adType,adParams:{}}),e.callbacks.onAdStateChange({state:Hn.PLAYING,type:t.adType,adParams:{}})):r&&!t?e.callbacks.onAdStateChange({state:Hn.NOT_PLAYING,type:r.adType,adParams:{}}):!r&&t&&e.callbacks.onAdStateChange({state:Hn.PLAYING,type:t.adType,adParams:{}})}(this.playerApi,e,t),void 0!==e&&g(e)&&this.requestMetaInfo(e,pn.W)}),this.putInStreamPlayingState=pr(e=>{this.store.setAdStateField(Cn.Dt.inStreamPlayingState,e),this.handlePlayingStateChange()},mn.inStreamPlayingState),this.putPlayingState=pr(e=>{this.store.setControllerStateField(Cn.jY.playingState,e),this.handlePlayingStateChange(),this.handleMidroll(),gr(this.store,this.playerApi),this.handlePostPauseroll()},An.playingState),this.putCurrentTime=pr(e=>{this.store.setControllerStateField(Cn.jY.currentTime,e),this.updateWatchedTime(),vr(this.store,this.playerApi),this.playerApi.callbacks.onCurrentTimeChange(e),this.store.setControllerStateField(Cn.jY.currentTimeLowGranularity,zt(e))}),this.handleMidroll=function(e){let t=!1;return async function(){if(!t){t=!0;try{await e(...arguments)}finally{t=!1}}}}(async()=>{const e=this.store.getState(),{controller:{currentTimeLowGranularity:t,duration:r,videoType:i,watchedTime:s}}=e;if(isNaN(r))return;const n=this.playerApi.getMultiroll(),a={watchedTime:s,sourceWatchedTime:s,currentTime:t,duration:r,videoType:i||bn.Z.VOD},o=await n.midroll.loadViewers(a),l=n.getNextAdInfo(a);this.putNextAdInfo(l),o.length<=0||await this.playerApi.playAdViewers(es.midroll,p(o,es.midroll),{})}),this.handlePostPauseroll=function(e){let t;const r=e=>{t=e};return function(){t&&(t(),t=void 0);for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return e(r,...s)}}(e=>{const{controller:{duration:t,playingState:r,watchedTime:i}}=this.store.getState();if(isNaN(t)||0===i||r!==Gi.X.PAUSE)return;if((0,Pn.I)(this.store.getState()))return;const s=(0,ji.u)();let n;const a=async()=>{const e=s()/1e3,t=await this.playerApi.getMultiroll().postPauseroll.loadViewers({pausedTime:e});this.currentPostPauserollInterval===n&&(0===t.length||this.playerApi.planAdViewers(p(t,es.postPauseroll)))};a(),n=window.setInterval(()=>{a()},15e3),e(()=>{clearInterval(n),this.currentPostPauserollInterval=void 0}),this.currentPostPauserollInterval=n}),this.putResourcesIdle=e=>{dc(this.playerApi,e)},this.playerApi=t,this.store=r;const{controller:{volume:i,muted:s,isAbrEnabled:n,videoTrackValue:a}}=this.store.getState();this.prevVideoTrackValue={isAbrEnabled:n,videoTrackValue:a},this.prevIsAbrEnabled=n,this.prevVolumeInfoPayload={volume:i,muted:s,changeReason:void 0},this.watchedTimeCounter=new pc.p}refreshCue(e){let{cueId:t,start:r,end:i}=e;const{ad:{originalBroadcastAdCues:s}}=this.store.getState(),n=hc(s),a=n[t]||{start:r,end:i};void 0!==r&&(a.start=r),void 0!==i&&(a.end=i),n[t]=a,this.putOriginalBroadcastAdCues(n)}putOriginalBroadcastAdCues(e){this.store.setAdStateField(Cn.Dt.originalBroadcastAdCues,e),this.updateOriginalAdState()}putIsAbrEnabled(e){if(this.prevIsAbrEnabled===e)return;this.prevIsAbrEnabled=e,this.store.setIsAbrEnabled(e);const{controller:{videoTrackValue:t}}=this.store.getState();this.putVideoTrackParams({videoTrackValue:t,isAbrEnabled:e})}putVideoTracks(e){const t=[...e].sort(Sr);this.store.setControllerStateField(Cn.jY.videoTracks,t),this.waitingForVideoTracks&&this.handleVideoTrackChange(),this.playerApi.callbacks.onVideoTracksChange(t)}putVideoTrackParams(e){let{isAbrEnabled:t,videoTrackValue:r}=e;const i={isAbrEnabled:t,videoTrackValue:r};if(yl()(i,this.prevVideoTrackValue))return;this.store.setVideoTrackParams({videoTrackValue:r,isAbrEnabled:t}),this.prevVideoTrackValue=i;const{controller:{videoTracks:s}}=this.store.getState();0!==s.length||void 0===i.videoTrackValue?this.handleVideoTrackChange():this.waitingForVideoTracks=!0}async handleVideoTrackChange(){this.waitingForVideoTracks=!1,await(0,Cd._)(0),this.playerApi.callbacks.onVideoTrackChange($(this.store.getState()))}handlePlayingStateChange(){const{controller:{playingState:e},ad:{inStreamPlayingState:t}}=this.store.getState();this.updateWatchedTime(),void 0===t||t===Gi.X.END?this.playerApi.callbacks.onStateChange(e):this.playerApi.callbacks.onStateChange(t)}async requestMetaInfo(e,t){await(0,Cd._)(5e3);const r=this.store.getState(),{ad:{adInfo:i},controller:{stream:s}}=r,n=function(e){const{controller:{stream:t}}=e;if(t)return void 0!==t.metaInfoUrl?t.metaInfoUrl:Ce(t.url)?Er(t.url).metaInfoUrl:void 0}(r);if(!i||!g(i)||i.params.startTimestamp!==e.params.startTimestamp||!s||!n)return;const{startProgramDateTime:a,startVideoTime:o,startTimestamp:l}=i.params,d=a+o,c=d+300,u=Math.round(1e3*(d+(Date.now()/1e3-l))),h=function(e,t,r){return e.replace(new RegExp("{{"+t+"}}","gm"),encodeURIComponent(r))}(n,"video-timestamp",String(u));let p;try{p=await t({method:"GET",url:h})}catch(E){return this.playerApi.callbacks.onError(new ss.u({code:ns.x.META_INFO_REQUEST_FAILED,details:{url:h},isFatal:!1}).toJSON()),void this.refreshCue({end:c,cueId:i.params.cueId})}const f=function(e){try{return(0,li.H)(e)?JSON.parse(e):void 0}catch(tu){return}}(p.responseText);if(!(0,Hi.K)(f))return;const{cutoff:m,cue_id:v}=f;if(v!==i.params.cueId)return;const y=(0,Bi.z)(m)?(u+m)/1e3:c;this.refreshCue({end:y,cueId:v}),this.requestMetaInfo(e,t)}updateWatchedTime(){const{controller:{currentTime:e,playingState:t,playbackRate:r,sourceId:i}}=this.store.getState();this.lastSourceId!==i&&(this.watchedTimeCounter.restoreLastUpdate(),this.lastSourceId=i);const s=function(e){let{ad:{adInfo:t}}=e;return void 0!==t&&ec.includes(t.adType)}(this.store.getState());this.watchedTimeCounter.calc(e,r,t===Gi.X.PLAY&&!s),this.putWatchedTime(this.watchedTimeCounter.get())}async handlePostroll(){const e=this.playerApi.getMultiroll(),t=await e.postroll.loadViewers({});t.length>0&&await this.playerApi.playAdViewers(es.postroll,p(t,es.postroll),{}),this.putPlayingState(Gi.X.END),this.playerApi.stop()}handleVideoTagPlayingStateChange(e){const{controller:{playingState:t,watchedTime:r}}=this.store.getState();if(t===e||t===Gi.X.END&&e===Gi.X.PAUSE)return;if(e===Gi.X.BUFFERING)return void this.putPlayingState(Gi.X.BUFFERING);if(t===Gi.X.BUFFERING&&e===Gi.X.PAUSE&&0===r||this.putStartStage(En.o.started),e!==Gi.X.END)return void this.putPlayingState(e);const i=this.store.getState(),{ad:{adInfo:s}}=i;(0,Pn.I)(i)?is.Y.log("putPlayingState("+Gi.X.END+") has not been dispatched because ad("+(s&&s.adType)+") is playing"):this.handlePostroll()}putAdblockDetected(e){this.store.setAdStateField(Cn.Dt.adblockDetected,e),jd(this.playerApi,e)}putVideoSize(e){this.store.setVideoSize(e),Yd(this.playerApi,e)}putPlaybackRate(e){this.store.setControllerStateField(Cn.jY.playbackRate,e),function(e,t){e.callbacks.onPlaybackRateChange(t)}(this.playerApi,e)}enableTextTrack(){fr(this.store,this.playerApi)}putAudioTrackValue(e){this.store.setControllerStateField(Cn.jY.audioTrackValue,e),Gd(this.store,this.playerApi,e)}putAudioTracks(e){this.store.setControllerStateField(Cn.jY.audioTracks,e),Kd(this.playerApi,e)}putBufferingRanges(e){this.store.setControllerStateField(Cn.jY.bufferingRanges,e),qd(this.playerApi,e)}putErrorInfo(e){this.store.setControllerStateField(Cn.jY.errorInfo,e),function(e,t){let{error:r}=t;if(void 0===r)return;const{code:i,isFatal:s,details:n}=r;s?(is.Y.error(i,n),e.setFullscreen(!1)):is.Y.warn(i,n),e.callbacks.onError(r.toJSON())}(this.playerApi,e)}putIsFullscreen(e){this.store.setControllerStateField(Cn.jY.isFullscreen,e),zd(this.store,this.playerApi,e)}putIsPip(e){this.store.setControllerStateField(Cn.jY.isPip,e),mr(this.store,this.playerApi)}putTextTrackEnabled(e){this.store.setControllerStateField(Cn.jY.textTrackEnabled,e),mr(this.store,this.playerApi)}putNativeTextTrackVisibility(e){this.store.setControllerStateField(Cn.jY.nativeTextTrackVisible,e),mr(this.store,this.playerApi)}putTextTracks(e){this.store.setControllerStateField(Cn.jY.textTracks,e),Xd(this.playerApi,e)}putStream(e){this.store.setControllerStateField(Cn.jY.stream,e),Qd(this.playerApi,e)}putLastKnownBandwidthEstimate(e){this.store.setControllerStateField(Cn.jY.lastKnownBandwidthEstimate,e),nc(this.store,this.playerApi,e)}putIsOnline(e){this.store.setControllerStateField(Cn.jY.isOnline,e),ac(this.store,this.playerApi,e)}putStreamsWithSupportInfo(e){this.store.setControllerStateField(Cn.jY.streamsWithSupportInfo,e),Zd(this.playerApi,e)}putVideoType(e){this.store.setControllerStateField(Cn.jY.videoType,e),Jd(this.playerApi,e)}putAdInfo(e){this.store.setAdStateField(Cn.Dt.adInfo,e),$d(this.playerApi,e)}putNextAdInfo(e){this.store.setAdStateField(Cn.Dt.nextAdInfo,e),tc(this.store,this.playerApi,e)}putWatchedTime(e){this.store.setControllerStateField(Cn.jY.watchedTime,e),this.handleMidroll()}putStartStage(e){this.store.setControllerStateField(Cn.jY.startStage,e),rc(this,this.playerApi,e)}putEncoderState(e){this.store.setControllerStateField(Cn.jY.encoderState,e),function(e,t){const{controller:{encoderState:r}}=e.getState();r===Sn.y.Attached&&(0,jr.v)(yr(e,t))}(this.store,this.playerApi)}putAutoplay(e){this.store.setControllerStateField(Cn.jY.autoplay,e),yr(this.store,this.playerApi)}updateOriginalAdState(){!function(e,t){const r=e.getState(),{ad:{adInfo:i,originalBroadcastAdCueId:s},controller:{watchedTime:n}}=r,a=y(r);if(a&&g(i)){const s=v(r,a);if(s){const{startProgramDateTime:r,startVideoTime:n,startTimestamp:a}=i.params,o=s.end+15,l=Date.now()/1e3-a,d=r+n;if(o<l+d){const r={utc:d+l,videoTime:(0,Bi.z)(n)?n+l:void 0};return e.setControllerStateField(Cn.jY.startPosition,r),void t.stopAd({stopAdReason:rs.CutOff})}}}if(a===s)return;let o;e.setAdStateField(Cn.Dt.originalBroadcastAdCueId,a),void 0!==a?oc=n:o=n-oc,t.callbacks.onOriginalBroadcastAdStateChange({cueId:a,originalBroadcastAdDuration:o})}(this.store,this.playerApi)}}let mc;!function(e){e.ExternalApi="ExternalApi",e.InternalApi="InternalApi"}(mc||(mc={}));class gc{constructor(e){let{initialState:t}=e;this.state=void 0,this.state=t}getState(){return this.state}removeCue(e){const{ad:t}=this.state,r=hc(t.originalBroadcastAdCues);delete r[e],t.originalBroadcastAdCues=r}updateSourceId(){const{controller:e}=this.state;e.sourceId=e.sourceId+1}setVolumeInfo(e){let{volume:t,muted:r}=e;const{controller:i}=this.state;i.volume=t,i.muted=r}setVideoSize(e){let{videoWidth:t,videoHeight:r}=e;const{controller:i}=this.state;i.videoWidth=t,i.videoHeight=r}setIsAbrEnabled(e){const{controller:t}=this.state;t.isAbrEnabled=t.isAbrSupported&&e}setIsAbrSupported(e){const{controller:t}=this.state;t.isAbrSupported=e,t.isAbrEnabled=t.isAbrEnabled&&e}setVideoTrackParams(e){let{isAbrEnabled:t,videoTrackValue:r}=e;const{controller:i}=this.state;i.videoTrackValue=r,i.isAbrEnabled=t&&i.isAbrSupported}setUserAudioTrackParams(e){let{name:t,lang:r}=e;const{controller:i}=this.state;i.userAudioTrackName=t,i.userAudioTrackLang=r}setUserTextTrackParams(e){let{enabled:t,name:r,lang:i}=e;const{controller:s}=this.state;s.userTextTrackEnabled=t,s.userTextTrackName=r,s.userTextTrackLang=i}setUserVideoTrackParams(e){let{name:t,height:r}=e;const{controller:i}=this.state;i.userVideoTrackName=t,i.userVideoTrackHeight=r}setErrorInfo(e){const{controller:t}=this.state;var r;(!e||(r=e,!(0,Ai.Z)(r).length)||e.error&&e.error.isFatal)&&(t.errorInfo=e)}setSkinStateField(e,t){this.state.skin[e]=t}setAdStateField(e,t){this.state.ad[e]=t}setControllerStateField(e,t){const{controller:r}=this.state;r[e]=t}}const vc=["resourceTimings"],yc=document.createElement("video"),Ec=(0,Vi.I)(()=>(0,xa.RW)("web_wait_volumechange")),Sc=ai(window);class Ac extends Zi.v{get state(){return this.playerStore.getState()}constructor(e,t,r,i){var s;super(),s=this,this.plannedAdViewers=[],this.callbacks=void 0,this.videoController=void 0,this.multiroll=Za,this.defineAutoplaySettingsDeferred=new Xi.B,this.abortRequestAutoplaySettings=cn.Z,this.onlineMonitor=new io,this.resourceTimingsMonitor=void 0,this.playbackProgressStorage=new no,this.visualState=void 0,this.container=void 0,this.video=void 0,this.videoSizeSensor=void 0,this.div=void 0,this.adDiv=void 0,this.playbackQualityController=void 0,this.playerStore=void 0,this.stateController=void 0,this.broadcastAd=void 0,this.playCallbacks=[],this.config=void 0,this.mediaInternalsHistory=void 0,this.currentAdPlaybackQueue=void 0,this.stopLoadSource=cn.Z,this.onReady=void 0,this.preloaders=[],this.cachePreloaders=[],this.playDeferred=void 0,this.becameStarting=!1,this.destroyed=!1,this.handleAdEnd=void 0,this.stopAd=()=>Promise.resolve(),this.setHiddenControls=e=>{e.indexOf(Ki.th.ALL)>-1?this.playerStore.setSkinStateField(Cn.rE.hiddenControls,Ki.uM):this.playerStore.setSkinStateField(Cn.rE.hiddenControls,e),this.videoController&&!this.playerStore.getState().ad.adInfo&&this.videoController.updateNativeControlsVisibility()},this.seekToLive=()=>{if(!this.videoController||!this.videoController.isDvrEnabled())return;const{skinDVRStartTime:e,skinDVRDuration:t}=this.state.skin,r=e+t;this.seek({videoTime:r})},this.setPlaybackRate=e=>{const{max:t,min:r}=ee(this.state);this.videoController.setPlaybackRate((0,oi.u)(e,r,t))},this.seek=function(e,t){let{videoTime:r,utc:i}=e;if(void 0===t&&(t=!1),"number"===typeof i){const e=i-s.videoController.getUtcStartTime();s.seekToVideoPosition(e,t)}else"number"===typeof r&&s.seekToVideoPosition(r,t)},this.setVolume=e=>{if(!this.videoController)return this.stateController.putVolumeInfo({muted:this.state.controller.muted,volume:e,changeReason:Kn.SetVolume}),void this.abortRequestAutoplaySettings(On.VolumeChange);const{muted:t,volume:r}=this.state.controller;let i=e,s=t;if(0===e){const{userVolume:e}=this.state.controller;i=e||r||Mn,s=!0}this.stateController.putVolumeInfo({volume:i,muted:s,changeReason:Kn.SetVolume}),this.currentAdPlaybackQueue&&(0,Pn.I)(this.state)?this.currentAdPlaybackQueue.setVolume(e):this.videoController&&(this.videoController.setVolume(i),this.videoController.setMuted(s))},this.setMuted=e=>{const t={volume:this.state.controller.volume,muted:e,changeReason:Kn.SetMuted};if(!this.videoController)return this.stateController.putVolumeInfo(t),void this.abortRequestAutoplaySettings(On.MuteChange);this.stateController.putVolumeInfo(t),this.currentAdPlaybackQueue&&(0,Pn.I)(this.state)?this.currentAdPlaybackQueue.setVolume(e?0:this.state.controller.volume):this.videoController&&this.videoController.setMuted(e)},this.playInrollAd=e=>{this.multiroll.inroll.schedule(Ar({},e,{timeOffset:(null==e?void 0:e.timeOffset)||0}))},this.playAdViewers=async(e,t,r,i)=>{K("player.adsdk.empty."+e),K("player.adsdk.start."+e),K("player.adsdk.fail."+e);try{await this.initAdPlaybackQueue(e),await this.playAdViewersInternal(e,t,r,i)}catch(tu){K("player.adsdk.fail."+e),(0,Un.Kp)({reason:"PLAY_AD_VIEWERS_ERROR",adSdkVersion:w(),adSdkLoaderVersion:R(),adblockDetected:this.state.ad.adblockDetected,adType:e,bandwidth:Le(void 0)}),this.onError(ss.u.from(tu,{code:ns.x.PLAY_AD_VIEWERS_ERROR,isFatal:!1,details:{adType:e,adViewersWithData:t,adDisplayConfig:r}}))}},this.handleSizeSensorUpdate=e=>{let{width:t,height:r}=e;this.emit("VisualStateChange",Ar({},this.visualState.getState(),{width:t,height:r}))},this.defineAutoplaySettingsAndLoadSource=()=>{const e=this.config.source,t=this.playerStore.getState(),{initialAutoplay:r,allowMuted:i,muted:n,volume:a,togglePlaybackOnVisibilityChangeSetting:o}=t.controller;this.defineAutoplaySettings(this.video,{autoplay:r,muted:n||0===a,allowMuted:!(!o||!o.forceAutoplay)||i}),this.loadSource(e,{shouldSaveProgress:!1}).catch(e=>{is.Y.error("load source error",e),Ye(e,jn.INIT),this.onError(e)}).then(()=>{this.onReady(),this.state.controller.autoplay||this.stateController.putResourcesIdle(!0)}).then(()=>{void 0!==e.params.adConfig&&(Xr.I?(0,pn.W)({method:"GET",url:fn.z,retries:2,checkStatus:e=>e>=200&&e<400}).then(e=>{if(-1===e.responseText.trim().indexOf('<VAST version="3.0">'))throw new Error("Invalid XML in response from ["+fn.z+"]")}):Promise.resolve()).catch((function(e){let{message:t}=void 0===e?{}:e;s.stateController.putAdblockDetected(!0),s.onError(new ss.u({code:ns.x.STRM_ABD_INVALID_RESPONSE,isFatal:!0,details:{reason:t}}))}))})},this.subscribeHandlers=()=>{this.onlineMonitor.on("Online",()=>{this.playerStore.setControllerStateField(Cn.jY.isOnline,!0),(0,Pn.I)(this.state)||this.videoController&&this.videoController.onOnline(),this.callbacks.onExpectedStalledChange({reason:ts.k.Offline,details:void 0})}),this.onlineMonitor.on("Offline",()=>{this.playerStore.setControllerStateField(Cn.jY.isOnline,!1),this.videoController&&this.videoController.onOffline()}),this.on("VideoTypeChange",e=>{this.stateController.putVideoType(e)}),this.on("DurationChange",e=>{this.playerStore.setControllerStateField(Cn.jY.duration,e),this.videoController.updateDVRParams(),this.updateVideoInfo()}),this.on("DvrChange",()=>{this.updateVideoInfo()}),this.on("ProgramDateTimeChange",e=>{this.playerStore.setControllerStateField(Cn.jY.programDateTime,e)}),this.on("CurrentTimeChange",this.handleVideoControllerCurrentTimeChange),this.on("BufferingRangesChange",e=>{this.stateController.putBufferingRanges(e)}),this.on("VideoTrackValueChange",e=>{this.stateController.putVideoTrackParams({videoTrackValue:e,isAbrEnabled:this.state.controller.isAbrEnabled})}),this.on("VideoTracksChange",e=>{this.stateController.putVideoTracks(e)}),this.on("AudioTrackValueChange",e=>{this.stateController.putAudioTrackValue(e)}),this.on("AudioTracksChange",e=>{this.stateController.putAudioTracks(e)}),this.on("TextTrackValueChange",e=>{const{controller:{textTrackEnabled:t,textTrackValue:r}}=this.getState(),i=void 0!==e,s=void 0===e?r:e;this.stateController.putTextTrackEnabled(i),this.playerStore.setControllerStateField(Cn.jY.textTrackValue,s);if((t?r:void 0)===(i?e:void 0))return;const n=i?Z(this.getState()):void 0;this.callbacks.onTextTrackChange(n)}),this.on("TextTracksChange",e=>{this.stateController.putTextTracks(e)}),this.on("VideoPlayingStateChange",e=>{this.stateController.handleVideoTagPlayingStateChange(e)});const e=this.logCanPlay(jn.INIT);this.once("CanPlay",e),this.once("SetSource",()=>this.off("CanPlay",e));const t=this.logLoadStartHavingCurrentData(jn.INIT);this.once("LoadedData",t),this.once("SetSource",()=>this.off("LoadedData",t)),this.once("Destroy",()=>{this.off("ContentImpression")});const r=(0,Ni.Y)(this.getContainerDocument(),e=>{this.playerStore.setControllerStateField(Cn.jY.isDocumentVisible,e)});var i;this.once("Destroy",r),this.once("Destroy",(i=e=>{this.callbacks.logEvent({event:$i.DrmSystemsSupportDetected,params:e})},void 0===Ca?(Ia.push(i),()=>{const e=Ia.indexOf(i);-1!==e&&Ia.splice(e,1)}):(i(Ca),cn.Z)))},this.setBackgroundImage=e=>{this.div.style.backgroundImage=e?"url('"+e+"')":""},this.setBackgroundVisibility=e=>{this.div.style.backgroundSize=e?"contain":"0  0"},this.shouldCaptureScreenshot=()=>{var e;return this.videoController&&this.videoController.engine===Gn.$.MPD&&this.state.controller.videoType===bn.Z.VOD&&!(null!=(e=this.state.controller.stream)&&e.drmConfig)},this.playAdViewersInternal=async(e,t,r,i)=>{if(!this.currentAdPlaybackQueue)return;const s=this.currentAdPlaybackQueue,{ad:{adInfo:n}}=this.state,a=this.getAdViewersWithData(t),o=a.map(e=>{let{adViewer:t}=e;return t}),l=function(e){return e.reduce((e,t)=>e+Math.max(Math.floor(t.getAdPodsCount())),Math.max(Math.floor(0)))}(o);if(0===l)return q("player.adsdk.empty."+e),(0,Un.Kp)({reason:"NO_AD_PODS_TO_PLAY_AD",adSdkVersion:w(),adSdkLoaderVersion:R(),adblockDetected:this.state.ad.adblockDetected,adType:e,bandwidth:Le(void 0)}),void this.callbacks.logEvent({event:"NoAdPodsToPlayAd",params:void 0});n&&!i&&this.onError(new ss.u({code:ns.x.AD_IS_ALREADY_PLAYING,isFatal:!1,details:{currentAdType:n.adType,adType:e}})),this.prepareBeforeOrAfterAd(!1,e),this.callbacks.logEvent({event:"PlayAdViewers",params:{adType:e,adPodsCount:l}});const d=e===es.inroll?{cueId:this.getAdViewersCueId(e,t),startProgramDateTime:this.state.controller.programDateTime/1e3,startVideoTime:this.videoController?this.videoController.getCurrentTime():this.state.controller.currentTime,startTimestamp:Date.now()/1e3}:{};let c=!1;const u=(0,Vi.I)(async t=>{let{stopAdReason:r}=t;this.shouldCaptureScreenshot()&&(this.resetPosterFitStyle(),this.setBackgroundVisibility(!0),this.once("CanPlay",()=>{this.setBackgroundImage(),this.videoController.clearScreenshot()}));const i=this.state.ad.inStreamPlayingState;c=!0,this.currentAdPlaybackQueue&&(this.currentAdPlaybackQueue.destroy(r),this.currentAdPlaybackQueue=void 0),this.stateController.updateAdInfo(void 0),this.callbacks.onExpectedStalledChange({reason:ts.k.AdEnd,details:{adType:e}}),this.prepareBeforeOrAfterAd(!0,e);const s=async()=>{K("encoder.attach");try{await this.attachEncoder()}catch(tu){is.Y.error(tu)}finally{q("encoder.attach",{additional:{engine:this.state.controller.engine}})}};r!==rs.LoadSource&&r!==rs.PlayerDestroy&&await s(),e!==es.postroll&&(is.Y.log("videoController.play()"),i!==Gi.X.PAUSE&&(0,jr.v)(this.videoController.play()))});this.stopAd=u;const h=f(o)+s.getQueueDuration(),p=this.currentAdPlaybackQueue.getUtcPositionBeforeAd(),m=this.getSeekPositionAfterAd({adType:e,adViewersDuration:h,utcPosition:p});this.playerStore.setControllerStateField(Cn.jY.startPosition,m),this.prepareBeforeAd(e),(()=>{this.stateController.updateAdInfo({adType:e,params:d})})(),c||(a.forEach(t=>{let{adViewer:i,additionalData:n,adType:a}=t;s.playAdViewers({adType:e,adPodType:a,adViewer:i,additionalData:n,adDisplayConfig:r,adElement:this.adDiv,posterUrl:this.getPosterUrlForAd()})}),this.plannedAdViewers=[],await s.getDestroyPromise(),this.handleAdEnd&&await this.handleAdEnd(),c||await this.stopAd({stopAdReason:rs.AdCompleted}))},this.handleVideoControllerCurrentTimeChange=e=>{if(this.state.controller.encoderState!==Sn.y.Attached)return;!(e<.5&&this.state.controller.engine===Gn.$.NATIVE&&this.state.controller.videoType===bn.Z.LIVE)&&(this.stateController.putCurrentTime(e),this.playerStore.getState().ad.adInfo||this.playbackProgressStorage.saveProgress(e)),this.videoController.updateDVRParams(),this.updateVideoInfo()},this.handleVisualStateChange=e=>{let{isPip:t,isFullScreen:r,isVisible:i}=e;this.stateController.putIsFullscreen(r);const{isSupportedPipMode:s,isYandexPipMode:n,isVisibilitySupported:a}=this.visualState;this.emit("VisualStateChange",Ar({isPip:t,isVisible:i,isFullScreen:r,isSupportedPipMode:s,isYandexPipMode:n,isVisibilitySupported:a},this.videoSizeSensor.getSize())),s&&!n&&(this.stateController.putIsPip(t),a&&this.playerStore.setControllerStateField(Cn.jY.isVisible,i))},this.onRecover=async e=>{const t=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(this.getSyncDebugInfo(),vc);this.callbacks.onRecover(Ar({},e,t))},this.logLoadStartHavingCurrentData=e=>()=>{if(!yi){if(this.video.readyState<this.video.HAVE_CURRENT_DATA){const t=this.logLoadStartHavingCurrentData(e);return this.once("LoadedData",t),void this.once("SetSource",()=>this.off("LoadedData",t))}this.isCanPlayAndStartHavingCurrentDataLog()&&this.emit("ContentImpression")}},this.logCanPlay=e=>()=>{yi||this.isCanPlayAndStartHavingCurrentDataLog()&&(this.callbacks.logEvent({event:$i.CanPlay,params:{stage:e}}),this.emit("ContentImpression"))},this.isCanPlayAndStartHavingCurrentDataLog=()=>!this.state.ad.hasPreroll&&this.state.controller.preload,this.startStream=()=>this.state.controller.encoderState===Sn.y.Attached?Promise.resolve():this.attachEncoder().catch(is.Y.error),this.handleFirstContentImpression=()=>{this.resetPosterFitStyle();const{controller:e}=this.playerStore.getState(),t=e.videoTracks.find(t=>{let{value:r}=t;return r===e.videoTrackValue});(0,Fn.I8)({browserRtt:Ve(h()),calcRtt:Ve(ze())}),(0,Un.G1)(this.videoController.engine,{videoType:e.videoType,bandwidth:Le(t&&t.bitrate),startWithCapping:re(t,this.videoController)},this.state.ad.adSyncInit),this.callbacks.logEvent({event:$i.ContentImpression,params:{}}),this.callbacks.onContentImpression({hasPreroll:this.state.ad.adSyncInit,engine:this.state.controller.engine}),this.stateController.putResourcesIdle(!0),this.hidePoster()},this.setMaxListeners(14),this.container=e,this.config=t,this.onReady=(0,Vi.I)(i);const n=t.source,{params:a}=n,{additionalParams:o}=a,l=t.volume,{togglePlaybackOnVisibilityChange:c}=t;this.callbacks=t.callbacks,this.resourceTimingsMonitor=new ao.$W(t.resourceTimingsMonitor);const{autoplay:u}=t,p=t.hidden;t.debug&&is.Y.enableConsole(),this.div=document.createElement("div"),this.div.className=Sd().locals.StreamPlayer,(0,li.H)(t.backgroundColor)&&(this.div.style.backgroundColor=t.backgroundColor),this.adDiv=document.createElement("div"),this.adDiv.className=Sd().locals.StreamPlayer_ui,this.div.tabIndex=-1,this.container.appendChild(this.div),this.container.appendChild(this.adDiv);const m=Boolean(t.allowMuted),g=Ar({},t);delete g.callbacks;const v={controller:Ar({},An,{autoplay:u,initialAutoplay:u,allowMuted:m,preload:t.preload,from:o.from,vsid:o.vsid,volume:t.volume,muted:t.muted,userVolume:void 0===t.volume?NaN:l,isFullscreen:!1,togglePlaybackOnVisibilityChangeSetting:c,isDocumentVisible:(0,Di.s)(this.getContainerDocument()),isOnline:!0,isAbrEnabled:t.autoQuality,defaultQuality:t.defaultQuality,feed:t.feed,preview:a.preview,posterStyle:a.posterStyle,playerConfig:g}),ad:Ar({},mn,{adblockDetected:Xr.I,nativeAdControlsVisibility:t.useNativeAdControls}),skin:Ar({},Tn,{hiddenControls:p,useNativeSubtitles:!0,nativeControlsVisibility:!(0,qi.p)(p)})},y=new gc({initialState:v}),E=new fc({store:y,playerApi:this});this.playerStore=y,this.stateController=E,this.updateRumInfo();const S=this.container.getElementsByTagName("video")[0]||function(){const e=document.createElement("video");return window.parent&&window.parent.HTMLVideoElement&&bd(HTMLMediaElement.prototype,window.parent.HTMLVideoElement.prototype),e}();this.video=S,S.poster||(S.poster=zi.O),this.playbackQualityController=new Ad.Q(S),this.mediaInternalsHistory=new ro(S);const A=(0,Hd.n)(S);this.div.appendChild(S),A();const T=this.getContainerDocument().getElementsByTagName("head")[0];!function(e,t){const r=document.createElement("style");r.textContent+=e,t?t.appendChild(r):(0,zr.c)(window).appendChild(r)}(Sd().toString(),T),d(S,Sd().locals.player__video),this.videoSizeSensor=new Li.b(S),(0,Wr.Y)(()=>window.Ya.Rum.sendHeroElement()),function(e){e.setAttribute("playsinline","playsinline"),e.setAttribute("webkit-playsinline","webkit-playsinline")}(S),this.visualState=r.visualState,this.visualState.setVideoElement(S),this.on("VisualStateChange",e=>{e&&this.callbacks.onVisualStateChange(e)});const b=function(e,t,r){let i,s=0;const n=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];e.call(r,...i)};return function(){const e=Date.now(),r=e-s;clearTimeout(i);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];r<t?i=window.setTimeout(n,t-r,...o):(s=e,n(...o))}}(this.handleSizeSensorUpdate,500);this.videoSizeSensor.onResize.add(e=>{let{width:t,height:r}=e;return b({width:t,height:r})}),b(this.videoSizeSensor.getSize()),this.once("Destroy",()=>this.videoSizeSensor.destroy()),c&&this.visualState.isYandexPipMode&&Ge(window,!1,this.video),this.visualState.observe(this.handleVisualStateChange),this.handleVisualStateChange(this.visualState.getState()),this.defineAutoplaySettingsAndLoadSource(),this.initTelemetryTracking(),Promise.resolve().then(()=>{this.initEventSubscribes(t,S)})}initTelemetryTracking(){this.callbacks.onCapSizeChange(this.getMaxCapAllowedVideoTrack());const e=()=>{const e=this.getMaxCapAllowedVideoTrack();this.callbacks.onCapSizeChange(e)},t=()=>{const e=this.getBandwidthEstimate();e&&this.callbacks.onBandwidthEstimateChange(e)},r=e=>{this.callbacks.onPlaybackQualityUpdate(e)};this.once("Destroy",()=>{this.off("CanPlay",t),this.off("CanPlay",e),this.off("VideoTracksChange",e),this.off("VisualStateChange",e),this.off("VideoTrackValueChange",e),this.off("PlaybackQualityUpdate",r)}),this.on("PlaybackQualityUpdate",r),this.on("CanPlay",t),this.on("CanPlay",e),this.on("VideoTracksChange",e),this.on("VisualStateChange",e),this.on("VideoTrackValueChange",e)}recoverStream(){return this.videoController?this.videoController.recoverStream():Promise.resolve()}getRecoverHelper(){var e;if(this.videoController)return null==(e=this.videoController)?void 0:e.recoverHelper}toggleNativeSubtitles(e){this.videoController&&this.videoController.toggleNativeSubtitles(e)}updateVideoControllerNativeControlsVisibility(){this.videoController&&this.videoController.updateNativeControlsVisibility()}getMultiroll(){return this.multiroll}setPictureInPictureEnabled(e){Ge(window,e,this.video)}getRemainingBufferedTime(){return this.videoController?this.videoController.getRemainingBufferedTime():{total:0}}getVideoPlaybackQuality(){return this.playbackQualityController.getPlaybackQuality()}getCapSizes(){var e;return null==(e=this.videoController)?void 0:e.getCapSizes()}getMaxCapAllowedVideoTrack(){if(this.videoController)return this.videoController.getMaxCapAllowedVideoTrack()}getContainerSize(){var e;return null==(e=this.videoController)?void 0:e.getContainerSize()}getVideoTrack(){return $(this.state)}getVideoTracks(){return this.state.controller.videoTracks}getAudioTrack(){return Q(this.state)}getAudioTracks(){return this.state.controller.audioTracks}getTextTrack(){return function(e){const{textTrackEnabled:t}=e.controller;if(t)return Z(e)}(this.state)}getTextTracks(){return this.state.controller.textTracks}setNativeTextTrackVisibility(e){this.stateController.putNativeTextTrackVisibility(e)}setNativeAdControlsVisibility(e){this.playerStore.setAdStateField(Cn.Dt.nativeAdControlsVisibility,e)}getMuted(){return this.state.controller.muted}getLiveLatency(){return void 0===this.videoController?void 0:this.videoController.getLiveLatency()}getPlayingState(){return this.state.controller.playingState}getDuration(){return this.state.controller.duration}getCurrentTime(){return this.state.controller.currentTime}getVideoType(){return this.state.controller.videoType}getTimelineInfo(){const{controller:{duration:e,currentTime:t},skin:{skinDVRStartTime:r,skinDVRDuration:i}}=this.state;return{currentTime:t,duration:e,utcStartTime:this.getUtcStartTime(),dvrStartTime:r,dvrDuration:i}}getWatchedTime(){return this.state.controller.watchedTime}getPreloadDetails(){const{preloadDetails:e}=this.state.controller;if((null==e?void 0:e.preloadingMethod)!==Bn.H.Internal)return e}getBandwidthEstimate(){return(void 0===this.videoController?this.state.controller.lastKnownBandwidthEstimate:this.videoController.getBandwidthEstimate())||void 0}getCurrentStream(){return this.state.controller.stream}setVideoStyle(e){this.playerStore.setControllerStateField(Cn.jY.videoElementStyle,e),n(this.video,e)}setSource(e,t){let{shouldSaveProgress:r=!1}=void 0===t?{}:t;this.loadSource(e,{shouldSaveProgress:r}).catch(e=>{Ye(e,jn.SET_SOURCE),this.onError(e)}),this.emit("SetSource",e);const i=this.logCanPlay(jn.SET_SOURCE);this.once("CanPlay",i),this.once("SetSource",()=>this.off("CanPlay",i));const s=this.logLoadStartHavingCurrentData(jn.SET_SOURCE);this.once("LoadedData",s),this.once("SetSource",()=>this.off("LoadedData",s))}getSourceId(){return this.playerStore.getState().controller.sourceId}getUtcPosition(){return this.videoController?this.videoController.getUtcPosition():Bo.d}planAdViewers(e){this.plannedAdViewers=e}play(){var e,t;if(this.performPlayCallbacks(),(0,jr.v)(this.video.play()),this.state.controller.startStage!==En.o.started&&this.stateController.putStartStage(this.becameStarting?En.o.starting:En.o.init),this.currentAdPlaybackQueue&&(0,Pn.I)(this.state))return this.currentAdPlaybackQueue.resumeAd(),null==(e=this.playDeferred)||e.resolve(),Promise.resolve();if(this.plannedAdViewers.length>0)return this.playAdViewers(es.postPauseroll,this.plannedAdViewers,{}),null==(t=this.playDeferred)||t.resolve(),Promise.resolve();if(!this.videoController||this.state.controller.encoderState!==Sn.y.Attached)return this.stateController.putAutoplay(!0),this.abortRequestAutoplaySettings(On.ApiPlay),this.playDeferred||(this.playDeferred=new Xi.B,this.playDeferred.promise.catch(cn.Z).then(()=>this.playDeferred=void 0)),this.playDeferred.promise;const r=this.videoController.getCurrentTime(),i=this.videoController.getDuration();i>0&&r>=i&&this.seek({videoTime:0}),is.Y.log("StreamPlayer.play() -> videoController.play()");const s=this.state.controller.startStage===En.o.starting||this.state.controller.startStage===En.o.started?this.videoController.play():this.tryToPlay(this.videoController);return s.then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()},()=>{var e;null==(e=this.playDeferred)||e.reject(void 0),this.state.controller.startStage===En.o.init&&this.stateController.putStartStage(En.o.waitForUserPlay)}),s}pause(){var e;(0,Un.cA)(),this.stateController.putResourcesIdle(!0),this.emit("PauseCalled"),this.video.pause(),this.state.controller.startStage!==En.o.started&&(this.stateController.putAutoplay(!1),this.stateController.putStartStage(En.o.waitForUserPlay)),null==(e=this.playDeferred)||e.reject(new Error("playing rejected cause of #pause()")),this.currentAdPlaybackQueue&&(0,Pn.I)(this.state)?this.currentAdPlaybackQueue.pauseAd():this.videoController&&this.state.controller.encoderState===Sn.y.Attached?this.videoController.pause():this.stateController.putAutoplay(!1)}getPlaybackRate(){return this.state.controller.playbackRate}setVideoTrack(e){const t=this.getVideoTrack();if(hr(t,e))return;this.stateController.putIsAbrEnabled(e===xn.R.value);const r=e===xn.R.value&&this.state.controller.isAbrSupported?xn.R:this.state.controller.videoTracks.find(t=>t.value===String(e));if(r&&r!==xn.R&&r.height&&r.width)try{Ma.ZP.setItem("videoplayer-user-quality-choice",JSON.stringify({height:Math.min(r.height,r.width),width:Math.max(r.height,r.width)}))}catch(tu){}const{videoHeight:i}=this.state.controller,s=((null==r?void 0:r.height)||0)>i;r&&r.value!==xn.R.value&&s&&(0,fd.AJ)(!0,this.state.controller.from),this.playerStore.setUserVideoTrackParams({name:r&&r.value!==xn.R.value&&r.name||void 0,height:r&&r.height?r.height:void 0}),r&&(this.videoController.setVideoTrack(r),this.callbacks.onExpectedStalledChange({reason:ts.k.VideoTrackChange,details:{newTrack:r,oldTrack:t}}),is.Y.log("SELECTED VIDEO TRACK: ",r))}setAudioTrack(e){const t=this.getAudioTrack();if(hr(t,e))return;const r=this.state.controller.audioTracks.find(t=>t.value===String(e));r&&(this.playerStore.setUserAudioTrackParams({name:r.name||void 0,lang:r.lang||void 0}),this.videoController.setAudioTrack(r),this.callbacks.onExpectedStalledChange({reason:ts.k.AudioTrackChange,details:{newTrack:r,oldTrack:t}}),is.Y.log("SELECTED AUDIO TRACK: ",r))}getSyncDebugInfo(){const{resourceTimingsMonitor:e,videoController:t}=this;return{recoverHelperState:t?t.getRecoverHelperState():Yn.w.OFF,state:this.getState(),remainingBufferedTime:(0,In.r)(this.state),resourceTimings:e.getAllResourcesTimings(),mediaInternalsHistory:this.mediaInternalsHistory.getHistory()}}async requestDebugInfo(){return Ar({},this.getSyncDebugInfo(),{videoController:this.videoController?await this.videoController.requestDebugInfo():{noController:!0}})}getState(){return this.state}setTextTrack(e){const{textTracks:t,userTextTrackLang:r,userTextTrackName:i,textTrackEnabled:s,textTrackValue:n}=this.state.controller;if(s&&n===e)return;if(e===xl.A)return void this.stateController.enableTextTrack();const a=void 0===e?void 0:t.find(t=>t.value===e),o={enabled:Boolean(a),lang:a?a.lang||void 0:r,name:a?a.name||void 0:i};this.playerStore.setUserTextTrackParams(o),a?(this.videoController.setTextTrack(a),is.Y.log("SELECTED TEXT TRACK: ",a)):(this.videoController.disableTextTrack(),is.Y.log("DISABLE TEXT TRACK"))}getVolume(){return this.state.controller.volume}setFullscreen(e){if(e)try{this.visualState.changeFullscreenState({isFullScreen:!0})}catch(tu){is.Y.error("Request fullscreen for element:",tu)}else try{this.visualState.changeFullscreenState({isFullScreen:!1})}catch(tu){is.Y.error("Exit fullscreen for element:",tu)}}async destroy(){this.stopAd({stopAdReason:rs.PlayerDestroy}),this.stopLoadSource(Wn.destroy),this.multiroll.destroy(),this.currentAdPlaybackQueue&&this.currentAdPlaybackQueue.destroy(rs.PlayerDestroy),this.onlineMonitor.destroy(),this.visualState.destroy(),this.resourceTimingsMonitor.destroy(),this.mediaInternalsHistory.destroy(),this.playbackQualityController.destroy(),this.destroyed=!0,this.emit("Destroy"),await this.destroyVideoController(),function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(this.container)}skipAdPod(){this.currentAdPlaybackQueue&&this.currentAdPlaybackQueue.skipAdPod()}stop(){this.seek({videoTime:0}),this.pause(),this.videoController.engine===Gn.$.NATIVE&&0===this.video.buffered.length&&this.video.load()}preloadSource(e){this.callbacks.logEvent({event:$i.PreloadSource,params:{source:e,reason:mc.ExternalApi}});let t=cn.Z,r=!1;return{promise:this.preloadSourceImpl(e,()=>r,e=>t=e),abort:()=>{r||(r=!0,t())}}}initEventSubscribes(e,t){this.waitForPlayOccurred().then(()=>{const{startStage:e}=this.state.controller;[En.o.started,En.o.broken,En.o.destroyed].includes(e)||(this.stateController.putStartStage(En.o.starting),this.becameStarting=!0)}).catch(cn.Z),gi.w&&this.once("Destroy",sr(()=>this.destroy())),this.once("Destroy",(0,Ei.O)(this.div,"selectstart",e=>{e.preventDefault(),e.stopPropagation()})),this.once("Destroy",(0,Wi.X)(()=>{this.stateController.updateOriginalAdState()})),this.once("Destroy",(0,Ei.O)(this.getMainContainer(),"click",t=>{this.state.controller.watchedTime>0||void 0===this.state.ad.inStreamPlayingState&&e.shouldPlayOnFirstClick&&this.play()},{once:!0})),gi.w&&this.once("Destroy",sr(()=>this.destroy())),this.once("Destroy",()=>{this.off("VisualStateChange")}),this.once("Destroy",(0,Ei.O)(this.video,"volumechange",()=>{(this.videoController||this.currentAdPlaybackQueue)&&this.updateVolumeInfo()})),this.subscribeHandlers()}updateRumInfo(){const{controller:e}=this.state;(0,Fn.I8)({apiVersion:2,bundle:"modern",slowConnection:this.config.slowConnection,vsid:e.vsid,from:e.from,saveData:(0,eo.R)()})}requestAutoplaySettings(e,t,r){return function(e){return void 0===e&&(e=window),(0,ti.T)(e).some(e=>{const{hasBeenActive:t}=(0,Wr.Y)(()=>ir(e))||{hasBeenActive:!1};return t})}(window)?{promise:Promise.resolve({autoplay:t.autoplay,muted:t.muted,detectionMethod:"ACTIVATED_WINDOW"}),abort:cn.Z,skipCacheUpdate:!0}:ur(Ar({},t,null!=r&&r.autoplay?r:{},{videoSlot:e}))}defineAutoplaySettings(e,t){if(this.state.controller.autoplay&&!this.state.controller.isDocumentVisible)return this.stateController.putStartStage(En.o.waitForDocumentVisibility),this.stateController.putAutoplay(!1),void this.defineAutoplaySettingsDeferred.resolve();let r;(0,$r.iW)("detect.autoplay");const i=rr(t),{promise:s,skipCacheUpdate:n=!1,abort:a}=this.requestAutoplaySettings(e,t,i);s.then(()=>{(0,$r.vG)("detect.autoplay")});const{promise:o,clear:l}=(0,Yi.n)(500);o.then(()=>{this.state.controller.startStage===En.o.init&&this.stateController.putStartStage(En.o.waitForUserPlay)});const d=(0,ji.u)();this.abortRequestAutoplaySettings=e=>{void 0===r&&this.callbacks.logEvent({event:"PlayWithoutRAAResults",params:{delay:d(),reason:e}}),l(),a()},s.then(e=>{var s,a,o,d;n||(d=e,function(e,t){return!t||e.allowMuted!==t.allowMuted||e.autoplay!==t.autoplay||e.muted!==t.muted}(o=t,i)&&(0,Wr.Y)(()=>{na.t.setItem(tr(o),JSON.stringify(er({},d,{cacheVersion:2,time:Date.now()})))})),this.callbacks.logEvent({event:e.autoplay?"AutoplayAllowed":"AutoplayDisabled",params:{message:JSON.stringify(null!=(s=null!=(a=r)?a:t)?s:i),autoplaySettingsRequestResult:r,initialAutoplayParams:t,cachedSettings:i}}),r=e,l();const{isVisible:c}=this.state.controller;is.Y.log("Autoplay settings defined",r);const{autoplay:u,muted:h,autoplayImpossible:p,requireAllowMutedToAutoplay:f}=r;this.stateController.putVolumeInfo({muted:h,volume:this.state.controller.volume,changeReason:Kn.RequestAutoplaySettings});const m=function(e){const{controller:{togglePlaybackOnVisibilityChangeSetting:t,muted:r}}=e;return!!t&&!(t.onlyMuted&&!r)}(this.state)&&!1===c;m&&this.callbacks.logEvent({event:"HiddenAutoplayPrevented",params:{autoplaySettingsRequestResult:r}});const g=u&&!m&&this.state.controller.autoplay;var v;(is.Y.log("autoplay status:",u),is.Y.log("isVisible",c),is.Y.log("preventHiddenAutoplay",m),g||this.stateController.putStartStage(En.o.waitForUserPlay),g)?this.playerStore.setControllerStateField(Cn.jY.preload,!0):((0,Un.cA)(),null==(v=this.playDeferred)||v.reject(new Error("playing rejected cause of autoplay-false")));if(this.playerStore.setControllerStateField(Cn.jY.autoplay,g),p){this.playerStore.setControllerStateField(Cn.jY.autoplayImpossible,!0),this.callbacks.logEvent({event:"AutoplayImpossible",params:{message:JSON.stringify(r),autoplaySettingsRequestResult:r}});try{console.warn("Cannot autoplay video"+(f?" with sound":"")+" in this environment."+(f?" Use autoplay={allowMuted: true} if you prefer mute video and enable autoplay.":""))}catch(y){}}}).catch(cn.Z).then(()=>{this.defineAutoplaySettingsDeferred.resolve()})}createVideoController(e,t){let{stream:i,supportInfo:s}=e;const n={playerStore:this.playerStore,stateController:this.stateController,video:this.video,videoSizeSensor:this.videoSizeSensor,stream:i,sourceParams:t,debug:this.config.debug,liveOffset:this.config.liveOffset,slowConnection:this.config.slowConnection,maxBufferLength:this.config.maxBufferLength,defaultQuality:this.state.controller.defaultQuality,skippableFragments:t.skippableFragments,bandwidthEstimateOffset:this.config.bandwidthEstimateOffset,resourceTimingsMonitor:this.resourceTimingsMonitor,setPlayerBackgroundImage:this.setBackgroundImage,setPlayerBackgroundVisibility:this.setBackgroundVisibility,onError:e=>this.onError(e),onRecover:this.onRecover,logEvent:this.callbacks.logEvent,onSubtitlesChange:this.callbacks.onSubtitlesChange,onThumbnailTileGeneralMetaInfoChange:this.callbacks.onThumbnailTileGeneralMetaInfoChange,onExpectedStalledChange:this.callbacks.onExpectedStalledChange,getPipWindowSize:()=>this.visualState.getPipWindowSize()},a=(o=s.engine,l=n,d=this.getPreloader(i,t),o===Gn.$.YANDEX?new pd(l):o===Gn.$.HLS?new jo(l):o===Gn.$.MPD?new Ul(l,d):o===Gn.$.MP4?new Wo(l):o===Gn.$.YASP?new(r(6140).D)(l):new Zl(l));var o,l,d;this.cleanCachePreloaders();const c=e=>{this.videoController=e,this.playerStore.setControllerStateField(Cn.jY.engine,s.engine),this.callbacks.onEngineChange(s.engine,this.playerStore.getState().controller.sourceId),(0,Fn.Z$)("engine",s.engine),e.on("VideoPlayingStateChange",e=>this.emit("VideoPlayingStateChange",e)),e.on("MetadataChange",e=>this.emit("MetadataChange",e)),e.on("CurrentTimeChange",e=>this.emit("CurrentTimeChange",e)),e.on("DurationChange",e=>this.emit("DurationChange",e)),e.on("DvrChange",()=>this.emit("DvrChange")),e.on("DVRDurationChange",e=>this.callbacks.onDVRDurationChange(e)),e.on("DVRStartTimeChange",e=>this.callbacks.onDVRStartTimeChange(e)),e.on("ProgramDateTimeChange",e=>this.emit("ProgramDateTimeChange",e)),e.on("BufferingRangesChange",e=>this.emit("BufferingRangesChange",e)),e.on("CanPlay",()=>this.emit("CanPlay")),e.on("ContentImpression",()=>this.emit("ContentImpression")),e.on("DrmSystemChange",this.callbacks.onDrmSystemChange),e.on("LoadedData",()=>this.emit("LoadedData")),e.on("VideoTypeChange",e=>this.emit("VideoTypeChange",e)),e.on("VideoTrackValueChange",e=>{this.emit("VideoTrackValueChange",e)}),e.on("AudioTrackValueChange",e=>this.emit("AudioTrackValueChange",e)),e.on("TextTrackValueChange",e=>this.emit("TextTrackValueChange",e)),e.on("VideoTracksChange",e=>this.emit("VideoTracksChange",e)),e.on("AudioTracksChange",e=>this.emit("AudioTracksChange",e)),e.on("TextTracksChange",e=>this.emit("TextTracksChange",e))};return Ui(a)?Promise.resolve().then(async()=>c(await a)):c(a)}cleanCachePreloaders(){for(;this.cachePreloaders.length>0&&this.config.cacheSourcesCount<this.cachePreloaders.length;)this.cachePreloaders[0].destroy(),this.cachePreloaders.splice(0,1)}getPreloader(e,t){const r=Me(e.url),i=this.preloaders.filter(e=>Me(e.getSource().stream.url)===r);var s;i.push(...this.cachePreloaders.filter(e=>Me(e.getSource().stream.url)===r)),i.sort((s=t.startPosition.videoTime||0,function(e,t){const{total:r,audio:i,video:n}=(0,za.t)(e.getBufferedInfo(),s),{total:a,audio:o,video:l}=(0,za.t)(t.getBufferedInfo(),s);return r!==a?a-r:n!==l?l-n:o-i}));const n=i[0];if(void 0===n)return;let a=this.preloaders.indexOf(n);return a>-1?this.preloaders.splice(a,1):(a=this.cachePreloaders.indexOf(n),a>-1&&this.cachePreloaders.splice(a,1)),n}getPreparedSourceParams(e,t,r){return Ar({},Ln,t,{startPosition:this.getInitialStartPosition(t,r),withCredentials:xe(e,t)})}getInitialStartPosition(e,t){const r=e&&e.startPosition||Ln.startPosition;if(r){if((0,Ai.Z)(r).some(e=>(0,Bi.z)(r[e])))return r}const i=null==t?void 0:t.getProgress();return void 0===i?r:{videoTime:i}}async loadSource(e,t){let{shouldSaveProgress:r}=t;is.Y.log("loadSource start",e),this.callbacks.onEngineChange(void 0,this.playerStore.getState().controller.sourceId),this.callbacks.onDrmSystemChange(void 0);const i=r?"LoadSourceWithSaveProgress":"LoadSource";this.callbacks.logEvent({event:i,params:{source:e}}),(0,Un.Cf)(),this.shouldCaptureScreenshot()&&(this.setBackgroundImage(),this.setBackgroundVisibility(!1),this.videoController.clearScreenshot()),this.stopAd({stopAdReason:rs.LoadSource}),this.plannedAdViewers=[],this.stopLoadSource(Wn.setSource),this.playbackProgressStorage.clearVideoContentId(),this.stateController.putStreamsWithSupportInfo(void 0),this.stateController.putStream(void 0),this.playerStore.setControllerStateField(Cn.jY.sourceParams,void 0),this.playerStore.setControllerStateField(Cn.jY.streams,e.streams),this.stateController.putResourcesIdle(!1);const{preferredAudioLangs:s,preferredTextLangs:n}=e.params.preferredTracks;s.length>0&&this.playerStore.setUserAudioTrackParams({lang:s[0],name:void 0}),n.length>0&&this.playerStore.setUserTextTrackParams({lang:n[0],name:void 0,enabled:!0});const a=new ys;this.stopLoadSource=e=>a.stop(e);try{this.multiroll.destroy()}catch(A){!function(e,t){(0,Wr.Y)(()=>window.Ya.Rum.logError(te({},e,{additional:(0,Fn.B6)()}),(0,Hi.K)(t)?t:new Error("NOT_AN_OBJECT_ERROR")))}({message:"Can not destroy multiroll instance",method:"loadSource",source:"multiroll",sourceMethod:"destroy",type:"logic"},A)}this.multiroll=Za;const o=!this.videoController,{streams:l}=e,d=Ie({streams:l,video:this.video,preferNative:this.config.preferNative,disableAndroidPlayer:this.config.disableAndroidPlayer}),c=Ne(e.params),u=function(e){return(0,Hi.K)(e)&&!1===e.hasPreroll}(c);this.playerStore.setAdStateField(Cn.Dt.adSyncInit,(0,Hi.K)(c)&&(!u||!1!==c.hasPreroll));let h=u?null:this.initMultirollModule(c,a);(0,Fn.Z$)("hasPreroll",!u);const p=this.destroyVideoController(),f=await d;if(this.stateController.putStreamsWithSupportInfo(f.streamsWithSupportInfo),a.stopReason)return void this.callbacks.logEvent({event:$i.StreamStopWhileChoosingStream,params:void 0});if("error"===f.status)throw f.error;const{supportedStream:m}=f;var g;(g=m).supportInfo.engine===Gn.$.MPD?$t(yd.LN):g.supportInfo.engine===Gn.$.HLS?$t(yd.v2):g.supportInfo.engine===Gn.$.YASP&&(vd.e.setInitialConfig({sourceLimit:Number.MAX_SAFE_INTEGER}),vd.e.warmUp());const{stream:v}=m;this.playbackProgressStorage.setVideoContentId(this.config.restoreTabSessionPlaybackProgress?e.params.videoInfo.videoContentId:void 0);const y=this.getPreparedSourceParams(v,e.params,this.playbackProgressStorage);if(await p,a.stopReason)return void this.callbacks.logEvent({event:$i.StreamStopWhileDestroyVideoController,params:void 0});if(this.resetPlayerStore(v,y,{shouldSaveProgress:r,isFirstLoad:o}),await Promise.race([this.defineAutoplaySettingsDeferred.promise,a.stopPromise]),a.stopReason)return void this.callbacks.logEvent({event:$i.StreamStopDuringDefineAutoplaySettings,params:void 0});const E=this.createVideoController(m,y);if(Ui(E)&&(await Promise.race([E,a.stopPromise]),a.stopReason))return;(0,Fn.Z$)("bandwidthEstimate",Le(this.videoController.getBandwidthEstimate().value/1e3)),(0,Fn.Z$)("drm","none"),o?(Promise.resolve().then(()=>{this.initBroadcastAd()}),Oe(v.url,Boolean(y.withCredentials)).then(e=>{this.stateController.putAdblockDetected(e||Xr.I),this.stateController.putAdblockDetected(e||Xr.I)}),this.setMuted(this.state.controller.muted),this.setVolume(this.state.controller.volume)):this.prepareNextSource(v,y),this.setPosterFitStyle(),this.once("ContentImpression",this.handleFirstContentImpression),this.once("SetSource",()=>this.off("ContentImpression",this.handleFirstContentImpression));const S=async()=>{h||(h=this.initMultirollModule(c,a));const e=await h;if(a.stopReason)return this.callbacks.logEvent({event:$i.StreamStopWhileLoadingMultiroll,params:{streamStopReason:a.stopReason}}),void e.destroy();this.multiroll=e};if(u){const{adInitOffset:e=0}=c||{};new Promise(t=>{let r=!1;const i=()=>{this.off("CurrentTimeChange",s),this.off("ContentImpression",n)},s=()=>{if(!r)return;this.getWatchedTime()<=e||(i(),t())},n=()=>r=!0;this.on("ContentImpression",n),this.on("CurrentTimeChange",s),this.once("SetSource",i)}).then(()=>{a.stopReason||S()})}else await S();a.stopReason||this.startPrerollAndContent(a,o)}async preloadSourceImpl(e,t,r){const{streams:i}=e,s=Ie({streams:i,video:yc,preferNative:this.config.preferNative,disableAndroidPlayer:this.config.disableAndroidPlayer}),n=await s;if(t())throw new Error("abort preloadSource");if("error"===n.status)throw n.error;const{supportedStream:a}=n,{stream:o,supportInfo:l}=a,d=new no;d.setVideoContentId(this.config.restoreTabSessionPlaybackProgress?e.params.videoInfo.videoContentId:void 0);const c=this.getPreparedSourceParams(o,e.params,d),u=Fe({stream:o,sourceParams:c}),h=this.preloaders.find(e=>Fe(e.getSource())===u);if(h)return r(()=>h.destroy()),h.preload();const p=(0,uo.J)({engine:l.engine,source:{stream:o,sourceParams:c},getState:()=>this.playerStore.getState(),getCapSizes:()=>{var e;return null==(e=this.videoController)?void 0:e.getCapSizes()},getVideoElementSizes:()=>{var e;return null==(e=this.videoController)?void 0:e.getVideoElementSizes()},defaultQuality:this.config.defaultQuality});if(!p)throw new Error("can not create preloader");return this.preloaders.splice(0,0,p),this.preloaders=this.preloaders.filter(e=>!e.isDestroyed).slice(0,10),r(()=>p.destroy()),p.preload()}async initMultirollModule(e,t){let r=Za;if(!e)return r;(0,Un.Fw)("AD",!0);try{const i=X(window,e,this.state.controller.vsid),s=await Promise.race([i,t.stopPromise.then(()=>{})]);if(void 0===s)return r;const{loadMultiroll:n}=s,a=n(Ar({},e,{secureMode:"Safe"}),{preroll:{shouldPreload:()=>{const{preload:e,startStage:t}=this.state.controller;return e&&(t===En.o.waitForUserPlay||t===En.o.waitForDocumentVisibility)}},midroll:{preloadOffset:20,preloadMinTime:5},postroll:{preloadOffset:20,preloadMinTime:5},getPreloadParams:()=>{const e={videoSlot:this.video},t=this.getBandwidthEstimate();return null!=t&&t.value?Ar({},e,{desiredBitrate:t.value/1e3}):e},adLoaded:e=>{let{adBreakType:t}=e;const r=(()=>{switch(t){case es.preroll:return es.preroll;case es.midroll:return es.midroll;case es.postroll:return es.postroll;case es.inroll:return es.inroll;case es.postPauseroll:return es.postPauseroll}})();void 0!==r&&this.callbacks.onAdLoaded({adType:r})}});(0,jr.v)(t.stopPromise.then(()=>a).then(e=>e.destroy()));const o=await Promise.race([a,t.stopPromise.then(()=>{})]);if(void 0===o)return r;r=o}catch(i){(0,Un.Kp)({reason:"MULTIROLL_INIT_ERROR",adSdkVersion:w(),adSdkLoaderVersion:R(),adblockDetected:this.state.ad.adblockDetected,bandwidth:Le(void 0)}),this.callbacks.onAdError(),this.onError(new ss.u({isFatal:(0,qr.m)(Sc)&&(!(0,Hi.K)(i)||"0"===String(i.code)||!i.code),code:ns.x.MULTIROLL_INIT_ERROR,details:{error:i,adConfig:e}}))}return r}async startPrerollAndContent(e,t){is.Y.log("startPrerollAndContent");let r=[];const i=(0,Vi.I)(()=>this.startStream()),s=(0,Vi.I)(async()=>{this.multiroll!==Za&&K("adsdk.loadviewers.preroll");const t=this.multiroll.preroll.loadViewers({}),i=await Promise.race([t,e.stopPromise.then(()=>{})]);if(void 0===i)return;r=i,this.multiroll!==Za&&q("adsdk.loadviewers.preroll");const s=r.length>0;this.playerStore.setAdStateField(Cn.Dt.hasPreroll,s),s&&this.callbacks.logEvent({event:$i.PrerollInit,params:{}})}),{startStage:n,preload:a}=this.state.controller;if(n===En.o.waitForUserPlay||n===En.o.waitForDocumentVisibility){if(is.Y.log("Waiting for "+(n===En.o.waitForUserPlay?"user gesture":"document visibility")),this.callbacks.logEvent({event:n===En.o.waitForUserPlay?$i.WaitForUserGesture:$i.WaitForDocumentVisibility,params:{preload:a}}),a){if(is.Y.log("Preload preroll in player"),await Promise.race([s(),e.stopPromise]),e.stopReason)return void this.callbacks.logEvent({event:$i.StreamStopWhilePreloadingPreroll,params:{streamStopReason:e.stopReason}});this.state.ad.hasPreroll||(is.Y.log("No preroll, preload content"),i())}if(n===En.o.waitForDocumentVisibility&&await function(e,t){return(0,Di.s)(e)===t?Promise.resolve():new Promise(r=>{(0,Ni.Y)(e,e=>{e===t&&r()})})}(this.getContainerDocument(),!0),this.state.controller.startStage===En.o.waitForUserPlay&&await this.waitForPlay(),e.stopReason)return void this.callbacks.logEvent({event:n===En.o.waitForUserPlay?$i.StreamStopWhileWaitingForPlay:$i.StreamStopWhileWaitingForDocumentVisibility,params:{streamStopReason:e.stopReason}})}if(is.Y.log("Start playing"),t&&this.stateController.putAutoplay(!0),await Promise.race([s(),e.stopPromise]),e.stopReason)this.callbacks.logEvent({event:$i.StreamStopWhileLoadingPreroll,params:{streamStopReason:e.stopReason}});else{if(!this.state.ad.hasPreroll)return await i(),void this.logPlayAfterWaitingForDocumentVisibility();this.playerStore.setControllerStateField(Cn.jY.preload,!0),is.Y.log("Start preroll"),this.playAdViewers(es.preroll,p(r,es.preroll),{videoSlotCanAutoPlay:n!==En.o.waitForDocumentVisibility||void 0})}}waitForPlay(){const e=(0,ji.u)();return new Promise(t=>{this.waitForPlayOccurred().then(r=>{this.callbacks.logEvent({event:$i.WaitForPlayCompleted,params:{reason:r,timeout:e()}}),t()}).catch(cn.Z),this.playCallbacks.push(t)})}async waitForPlayOccurred(){return new Promise((e,t)=>{let r=cn.Z,i=cn.Z,s=0;const n=()=>{r(),i(),clearInterval(s)},a=t=>{void 0!==this.videoController&&(n(),e(t))};this.video.paused?(r=(0,Ei.O)(this.video,"play",()=>{a(Vn.VideoPlayEvent)}),i=(0,Ei.O)(this.video,"timeupdate",()=>{this.video.paused||a(Vn.DetectByInterval)}),s=window.setInterval(()=>{this.video.paused||a(Vn.DetectByInterval)},100),this.once("Destroy",()=>{n(),t()})):a(Vn.VideoIsNotPausedOnInit)})}initBroadcastAd(){const{video:e}=this;if(this.broadcastAd=new vs({video:e,slot:e.parentElement,playerApi:this,stateController:this.stateController,onError:e=>this.onError(e),playerStore:this.playerStore}),this.videoController&&this.videoController.engine===Gn.$.NATIVE){let t=0;e.addEventListener("timeupdate",()=>{const{currentTime:r}=e;this.isLive()&&r<t&&this.broadcastAd&&this.stateController.putOriginalBroadcastAdCues({}),t=r})}this.on("MetadataChange",e=>{const{fragmentMetadataArray:t,fragmentStart:r}=e;if(is.Y.log("receive metadata: ",t),!this.broadcastAd)return;const{programDateTime:i}=this.state.controller;if(void 0===i)return;const s=i+1e3*r;let n;Math.random()<.01&&this.callbacks.logEvent({event:$i.StreamPlayerReceivedMetadata,params:e}),t.forEach(e=>{try{const t=JSON.parse(e);if(!function(e){return(0,Hi.K)(e)&&(0,li.H)(e.cue_id)&&(0,Bi.z)(e.offset)}(t))return;n=Ar({},t,{pts:s})}catch(tu){is.Y.log("metadata is not valid ["+e+"]")}}),n&&(this.callbacks.onInrollFrame(n),this.state.ad.adConfig&&this.broadcastAd.handleInrollFrame(n).catch(e=>{is.Y.error(e),this.onError(new ss.u(Ar({},e,{code:ns.x.BROADCAST_AD_BLOCK_INIT_ERROR,isFatal:!1,details:{code:e.code,message:e.message,id:e.id,details:e.details,stack:e.stack,metadata:{cueId:n.cue_id,podStart:s+n.offset}}})))}))}),this.broadcastAd.on("AdIntervalRemoved",e=>{this.playerStore.removeCue(e)}),this.broadcastAd.on("AdIntervalUpdated",e=>{let{cueId:t,start:r,end:i}=e;this.stateController.refreshCue({cueId:t,start:r/1e3,end:i/1e3})}),this.broadcastAd.on("InrollAdPlayRequest",e=>{this.playAdViewers(es.inroll,e,{})})}getPosterUrlForAd(){var e;const t=null==(e=this.state.controller.sourceParams)?void 0:e.preview;return t&&t!==zi.O?t:null}prepareBeforeOrAfterAd(e,t){this.broadcastAd&&t!==es.inroll&&this.broadcastAd.setEnabled(e)}getSeekPositionAfterAd(e){let{adType:t,adViewersDuration:r,utcPosition:i}=e;if(t===es.inroll){return{utc:i?i+r:void 0,videoTime:this.state.controller.currentTime+r}}return t===es.preroll?this.state.controller.startPosition:t===es.midroll||t===es.postPauseroll?{utc:i||void 0,videoTime:this.state.controller.currentTime}:t===es.postroll?{videoTime:0}:{}}getAdViewersWithData(e){const{controller:{isFullscreen:t,isPip:r}}=this.state,i=t&&u(this.getContainerDocument().defaultView,this.video)===this.video;return i||r?e.filter(e=>{const{adViewer:t}=e;return t.filterAdPodsIndependentOnHtmlControls("StreamPlayer can't play CPC ads: ["+(r?"PiP":i?"FullScreen":"unknown")+"] mode"),t.getAdPodsCount()>0}):e}getAdViewersCueId(e,t){var r;if(e!==es.inroll)return this.state.ad.originalBroadcastAdCueId;const i=t.find(e=>e.additionalData.cueId);return null!=(r=null==i?void 0:i.additionalData.cueId)?r:this.state.ad.originalBroadcastAdCueId}prepareBeforeAd(e){const{ad:{adInfo:t}}=this.state;t||(e!==es.preroll&&K("encoder.detach"),this.shouldCaptureScreenshot()&&(K("capture.screenshot"),this.videoController.captureScreenshot(this.video).then(e=>{q("capture.screenshot"),e&&(this.setBackgroundImage(e),this.setBackgroundVisibility(!1))})),e!==es.preroll&&q("encoder.detach",{additional:{engine:this.state.controller.engine}}),this.handleAdEnd=(0,Vi.I)(async()=>{K("adsdk.player.start."+e),vd.e.isYaspVideoElement(this.video)&&await this.video.detach(),this.once("ContentImpression",()=>{q("adsdk.player.start."+e),this.handleAdEnd=void 0})}))}async initAdPlaybackQueue(e){if(this.currentAdPlaybackQueue)return;const{ad:{adSyncInit:t}}=this.state,r=[(0,Ei.O)(this.video,"firstframedecoded",()=>{(0,Un.CN)("AD",{},t)},{once:!0}),(0,Ei.O)(this.video,"firstframeshown",()=>{(0,Un.qB)("AD",{},t)},{once:!0})],i=this.getUtcPosition();await this.detachEncoder();let s=!1;const n=new os({video:(()=>vd.e.isSupported()?vd.e.attach(this.video):this.video)(),utcPositionBeforeAd:i,onAdStartRejected:e=>{var t;null==(t=this.playDeferred)||t.reject(e)},onAdSkippableStateChange:e=>{this.callbacks.onAdSkippableStateChange(e)},onAdPodCloseStateChange:e=>{this.callbacks.onAdPodCloseStateChange(e)},onAdVolumeAvailabilityStateChange:e=>{this.callbacks.onAdVolumeAvailabilityStateChange(e)},onAdPodError:()=>{this.callbacks.onAdError()},onAdPodDurationChange:e=>{this.callbacks.onAdPodDurationChange(e)},onAdPodCurrentTimeChange:e=>{this.callbacks.onAdPodCurrentTimeChange(e)},onAdPodTimeToSkipChange:e=>{this.callbacks.onAdPodTimeToSkipChange(e)},onAdInteraction:()=>{this.callbacks.onAdInteraction()},onFirstAdPodStarted:()=>{var t;(0,Un.G1)("AD",{adblockDetected:this.state.ad.adblockDetected,adType:e,bandwidth:Le(void 0)},this.state.ad.adSyncInit),q("player.adsdk.start."+e),this.hidePoster(),e!==es.postroll&&this.preloadVideoControllerSource({whileAd:!0}),null==(t=this.playDeferred)||t.resolve()},onLastAdPodStopped:e=>{this.multiroll.dispatchEvent({event:"AdBreakEnd",data:e})},onBeforeAdPodStart:e=>{this.callbacks.onBeforeAdPodStart(e)},onAdPodStarted:t=>{let{isFullyClickable:r}=t;this.stateController.putResourcesIdle(!0),this.callbacks.onAdPodStart({isFullyClickable:r}),s&&q("adsdk.creative.switch."+e)},onAdPodSkipped:()=>{this.callbacks.onAdPodSkip()},onAdPodStopped:()=>{(0,xi.p)(r),s=!0,K("adsdk.creative.switch."+e),this.stateController.putInStreamPlayingState(void 0),this.callbacks.onAdPodEnd()},onAdPodPlayingStateChange:e=>{let{playingState:t,expectedStalledReason:r,adType:i}=e;t===Gi.X.BUFFERING&&this.callbacks.onExpectedStalledChange({reason:r,details:{adType:i}}),this.stateController.putInStreamPlayingState(t)},onAdClickThru:()=>{this.callbacks.onAdPodClick()},onAdSizeChange:e=>{this.stateController.putVideoSize({videoWidth:void 0===e.width?NaN:e.width,videoHeight:void 0===e.height?NaN:e.height})},onRequestFullscreenStateChange:e=>{this.callbacks.onRequestFullscreenChange(e)},getControlsSettings:()=>function(e){const{ad:{nativeAdControlsVisibility:t}}=e;return{controlsVisibility:t?{}:{mute:!1,timeline:!1,play:!1,loader:!1}}}(this.playerStore.getState()),logEvent:this.callbacks.logEvent,onError:e=>{this.onError(e)},adConfig:this.state.ad.adConfig,playerContainer:ar(this.state.controller.vsid,window.parent.document),lang:this.config.lang});this.currentAdPlaybackQueue=n}updateVideoInfo(){(0,Pn.I)(this.state)?this.playbackQualityController.persist():(this.playbackQualityController.update(),this.emit("PlaybackQualityUpdate",this.playbackQualityController.getPlaybackQuality()))}resetPlayerStore(e,t,r){let{shouldSaveProgress:i,isFirstLoad:s}=r;this.playerStore.updateSourceId(),this.stateController.putStream(e),this.playerStore.setControllerStateField(Cn.jY.sourceParams,t);const n=this.getStartPositionForLoadSource(t,{shouldSaveProgress:i});if(this.playerStore.setControllerStateField(Cn.jY.startPosition,n),i||this.playerStore.setControllerStateField(Cn.jY.duration,An.duration),this.stateController.putCurrentTime(Math.max(0,n.videoTime||An.currentTime)),!s){const{additionalParams:e=Nn}=t,{from:r=Dn.K}=e;this.playerStore.setControllerStateField(Cn.jY.from,r),this.playerStore.setControllerStateField(Cn.jY.preview,t.preview||Ln.preview),this.stateController.putBufferingRanges(An.bufferingRanges),i||(this.stateController.watchedTimeCounter=new pc.p,this.stateController.putWatchedTime(An.watchedTime)),this.stateController.putVideoType(void 0),this.playerStore.setControllerStateField(Cn.jY.programDateTime,void 0),this.stateController.putVideoTracks(An.videoTracks),this.stateController.putAudioTrackValue(An.audioTrackValue),this.stateController.putAudioTracks(An.audioTracks),this.stateController.putTextTrackEnabled(An.textTrackEnabled),this.playerStore.setControllerStateField(Cn.jY.textTrackValue,An.textTrackValue),this.stateController.putTextTracks(An.textTracks),this.callbacks.onSubtitlesChange([]),this.callbacks.onThumbnailTileGeneralMetaInfoChange(void 0),this.stateController.putOriginalBroadcastAdCues({}),this.state.controller.playingState===Gi.X.END&&this.stateController.putPlayingState(Gi.X.PAUSE),this.stateController.putInStreamPlayingState(void 0),this.playerStore.setAdStateField(Cn.Dt.hasPreroll,!1),this.stateController.putNextAdInfo(void 0),this.playerStore.setControllerStateField(Cn.jY.preload,!0),this.playerStore.setControllerStateField(Cn.jY.preloadDetails,An.preloadDetails)}this.playerStore.setAdStateField(Cn.Dt.adConfig,Ne(t))}prepareNextSource(e,t){this.stateController.putErrorInfo({}),this.emit("DurationChange",NaN),this.playerStore.setControllerStateField(Cn.jY.preload,!0),this.playbackQualityController.reset(),this.playCallbacks=[],this.stateController.putVideoTrackParams({videoTrackValue:An.videoTrackValue,isAbrEnabled:this.state.controller.isAbrEnabled}),this.broadcastAd&&this.stateController.putOriginalBroadcastAdCues({})}performPlayCallbacks(){this.playCallbacks.length>0&&((0,xi.p)(this.playCallbacks),this.playCallbacks=[])}seekToVideoPosition(e,t){Number.isNaN(e)||((0,Pn.I)(this.state)&&!t?this.playerStore.setControllerStateField(Cn.jY.startPosition,{videoTime:e}):this.videoController.seek(e))}isLive(){return this.state.controller.videoType===bn.Z.LIVE}getStartPositionForLoadSource(e,t){let{shouldSaveProgress:r}=t;const{controller:{currentTime:i,watchedTime:s}}=this.state,n=this.getUtcStartTime(),a=void 0===n?void 0:n+i,o=(0,Hi.K)(e.startPosition)?e.startPosition:{};return r&&s>0?{videoTime:i,utc:a}:o}getUtcStartTime(){const{controller:{programDateTime:e}}=this.state;return void 0===e?void 0:e/1e3}onError(e){const t=e instanceof ss.u?e:new ss.u(Ar({},e,{code:e.code||ns.x.DEFAULT_ERROR}));this.stateController.putErrorInfo({error:t}),t.isFatal&&(this.callbacks.logEvent({event:"MediaInternalsHistoryOnFatal",params:{history:this.mediaInternalsHistory.getHistory()}}),!(0,Pn.I)(this.state)&&this.currentAdPlaybackQueue&&this.currentAdPlaybackQueue.destroy(rs.PlayerError),this.stateController.handleVideoTagPlayingStateChange(Gi.X.PAUSE),this.resourceTimingsMonitor.updateInfo(),this.destroyVideoController())}async detachEncoder(){this.videoController&&(await this.videoController.detachEncoder(),this.stateController.putEncoderState(Sn.y.Detached))}async attachEncoder(){this.state.controller.isOnline||await new Promise(e=>this.onlineMonitor.once("Online",e)),this.stateController.putEncoderState(Sn.y.Attaching);try{await this.videoController.attachEncoder()}catch(r){throw this.stateController.putEncoderState(Sn.y.Detached),r}finally{const e=this.getPreloadDetails();this.callbacks.onPreloadDetailsUpdate("none"===(null==e?void 0:e.preloaded)?void 0:this.getPreloadDetails())}this.stateController.putEncoderState(Sn.y.Attached),this.updateVolumeInfo();const e=this.state.controller.playingState,t=this.videoController.getPlayingState();t&&e!==t&&this.emit("VideoPlayingStateChange",t)}async destroyVideoController(){this.videoController&&(this.cacheVideoController(),await this.videoController.destroy(),this.stateController.putEncoderState(Sn.y.Detached))}cacheVideoController(){if(this.config.cacheSourcesCount<=0)return;if(!this.videoController)return;if(this.state.controller.videoType!==bn.Z.VOD)return;const e=this.videoController.createCachePreloader();if(!e)return;const t=Me(this.videoController.getStreamUrl()),r=this.cachePreloaders.findIndex(e=>Me(e.getSource().stream.url)===t);r>-1&&(this.cachePreloaders[r].destroy(),this.cachePreloaders.splice(r,1)),this.cachePreloaders.push(e)}async tryToPlay(e){var t;let r=!1;this.once("PauseCalled",()=>r=!0);try{return void await e.play()}catch(i){}if(this.destroyed)return Promise.reject();if(r)return Promise.reject();if(null!=(t=this.state.controller.errorInfo.error)&&t.isFatal)return Promise.reject();if(this.video.muted)return Promise.reject();if(!this.state.controller.allowMuted)return Promise.reject();if(this.setMuted(!0),Ec()){const e=new Promise(e=>{this.once("Destroy",(0,Ei.O)(this.video,"volumechange",e,{once:!0}))}),t=new Promise((e,t)=>{this.once("Destroy",t)});await Promise.race([e,t])}try{return void await e.play()}catch(s){return this.setMuted(!1),Promise.reject()}}async logPlayAfterWaitingForDocumentVisibility(){const{videoController:e}=this,{startStage:t,initialAutoplay:r}=this.state.controller;t===En.o.waitForDocumentVisibility&&r&&e&&this.callbacks.logEvent({event:$i.PlayAfterWaitingForDocumentVisibility,params:{}})}getContainerDocument(){return this.container.ownerDocument||document}getMainContainer(){return this.container}setPosterFitStyle(){var e,t;const{videoElementStyle:r,posterStyle:i}=this.playerStore.getState().controller,s=null!=(e=null!=(t=null==r?void 0:r.objectFit)?t:null==i?void 0:i.objectFit)?e:"cover";n(this.video,Ar({},this.playerStore.getState().controller.videoElementStyle,{objectFit:s}))}resetPosterFitStyle(){n(this.video,Ar({objectFit:"contain"},this.playerStore.getState().controller.videoElementStyle))}hidePoster(){this.video.poster=zi.O}preloadVideoControllerSource(e){let{whileAd:t}=e;void 0!==this.videoController?(this.callbacks.logEvent({event:$i.PreloadSource,params:{reason:mc.InternalApi,whileAd:t}}),(0,jr.v)(this.videoController.preloadSource())):console.warn("preloadVideoControllerSource: videoController is undefined")}updateVolumeInfo(){this.stateController.putVolumeInfo({volume:this.video.volume,muted:this.video.muted,changeReason:Kn.VolumeChangeEvent})}}var Tc=r(4312);class bc{constructor(e,t){void 0===e&&(e=window),this.handlers=[],this.onDestroy=new Tc.M,this.fullscreenElement=null,this.setFullScreenElementFromAPI=()=>{const e=u(this.win,this.video);this.setFullscreenElement(e)},this.win=e,this.video=t,t&&Bl.g&&(this.onDestroy.addOne((0,Ei.O)(t,"webkitbeginfullscreen",()=>{this.setFullscreenElement(t)})),this.onDestroy.addOne((0,Ei.O)(t,"webkitendfullscreen",()=>{this.setFullscreenElement(null)}))),this.names=c(e,t),this.names&&(this.onDestroy.addOne((0,Ei.O)(this.win.document,this.names.events.change,this.setFullScreenElementFromAPI)),this.setFullScreenElementFromAPI())}requestFullscreenForElement(e,t){if(void 0===this.names)throw new this.win.Error("Fullscreen is not supported");{const{request:r}=this.names;if(!(r in e))throw new this.win.Error("Fullscreen is not supported");e[r](t)}}isFullscreen(){return null!==this.fullscreenElement}exit(){if(void 0===this.names)throw new Error("Fullscreen is not supported");this.video&&this.fullscreenElement===this.video?this.video[this.names.exit]():this.win.document[this.names.exit]()}getFullscreenElement(){return this.fullscreenElement}addHandler(e){if("function"!==typeof e)throw new this.win.Error("Fullscreen handler must be a function");this.handlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e)}destroy(){this.handlers.length=0,this.onDestroy.dispatch(void 0)}setFullscreenElement(e){this.fullscreenElement=e,this.handlers.forEach(t=>t(e))}}var Rc=r(1343);let wc;!function(e){e.PiP="PiP",e.YaBroEarly="YaBroEarly",e.YaBroAttrLegacy="YaBroAttrLegacy",e.YaBroAttrCurrent="YaBroAttrCurrent",e.OperaPopOut="OperaPopOut",e.SafariPresentationMode="SafariPresentationMode"}(wc||(wc={}));const _c={[wc.PiP]:{isSupported:e=>{if("pictureInPictureEnabled"in e.document){if(br()){const t=Tr(e);return 20===t.major&&t.minor>4||t.major>20}return!0}return!1},getCurrent:e=>e.document.pictureInPictureElement||null,observe:(e,t,r)=>t?(t.addEventListener("enterpictureinpicture",r),t.addEventListener("leavepictureinpicture",r),()=>{t.removeEventListener("enterpictureinpicture",r),t.removeEventListener("leavepictureinpicture",r)}):cn.Z,getPipWindow:e=>e.pictureInPictureWindow||null},[wc.YaBroEarly]:{isSupported:(e,t)=>"broughtOut"in t,getCurrent:(e,t)=>t&&"broughtOut"in t&&t.broughtOut?t:null,observe:(e,t,r)=>t?(t.addEventListener("oowvideobringin",r),t.addEventListener("oowvideobringout",r),()=>{t.removeEventListener("oowvideobringin",r),t.removeEventListener("oowvideobringout",r)}):cn.Z},[wc.YaBroAttrCurrent]:{isSupported:e=>{if(br()){const t=Tr(e);return 18===t.major&&t.minor>=6||t.major>18}return!1}},[wc.YaBroAttrLegacy]:{isSupported:e=>br()&&Tr(e).major<18},[wc.SafariPresentationMode]:{isSupported:(e,t)=>"webkitPresentationMode"in t,getCurrent:(e,t)=>t&&"picture-in-picture"===t.webkitPresentationMode?t:null,observe:(e,t,r)=>t?(t.addEventListener("webkitpresentationmodechanged",r),()=>t.removeEventListener("webkitpresentationmodechanged",r)):cn.Z},[wc.OperaPopOut]:{isSupported:(e,t)=>"onoperadetachedviewcontrol"in t&&"onoperadetachedviewchange"in t}},kc=[wc.PiP,wc.YaBroEarly,wc.YaBroAttrCurrent,wc.YaBroAttrLegacy,wc.SafariPresentationMode,wc.OperaPopOut];class Pc extends Zi.v{constructor(e,t){void 0===e&&(e=window),super(),this.api=null,this.apiName=null,this.window=void 0,this.pipWindow=null,this.currentElement=null,this.unsubscribeFromApi=cn.Z,this.handlePipEvent=e=>{var t;const r=e.target;this.digestCurrentElement(r);const i=Boolean(this.getCurrentElement());this.pipWindow=(null==(t=this.api)||null==t.getPipWindow?void 0:t.getPipWindow(e))||null,this.emit("Change",i)},this.window=e;const r=t||window.HTMLVideoElement.prototype;for(let i=0;i<kc.length;i++){const e=kc[i],t=_c[e];try{if(t.isSupported(this.window,r)){this.api=t,this.apiName=e;break}}catch(tu){}}this.digestCurrentElement(t),this.api&&this.api.observe&&(this.unsubscribeFromApi=this.api.observe(this.window,t,this.handlePipEvent))}getSupportedApiName(){return this.apiName}getCurrentElement(){return this.currentElement}addHandler(e){return this.api&&this.api.observe?(this.on("Change",e),()=>this.off("Change",e)):null}getPipWindowSize(){if(!this.pipWindow)return null;const{width:e,height:t}=this.pipWindow;return e&&t?{width:e,height:t}:null}destroy(){this.currentElement=null;const e=this.window.document;null!=e&&e.pictureInPictureElement&&(null==e.exitPictureInPicture||e.exitPictureInPicture()),this.off("Change"),this.unsubscribeFromApi()}digestCurrentElement(e){this.api&&this.api.getCurrent&&(this.currentElement=this.api.getCurrent(this.window,e))}}class Ic extends Zi.v{constructor(e,t){super(),this.isSupportedPipMode=!0,this.isYandexPipMode=!1,this.isVisibilitySupported=void 0,this.window=void 0,this.element=void 0,this.fullscreenApi=void 0,this.pipApi=void 0,this.video=void 0,this.state={isPip:!1,isFullScreen:!1,isVisible:!0},this.observe=e=>(this.on("Change",e),()=>this.off("Change")),this.fireVisualStateHandlers=()=>{const{isPip:e,isVisible:t,isFullScreen:r}=this.state,i={isPip:e,isVisible:t,isFullScreen:r,isSupportedPipMode:this.isSupportedPipMode,isVisibilitySupported:this.isVisibilitySupported,isYandexPipMode:this.isYandexPipMode};this.emit("Change",i)},this.handleVisibilityChange=e=>{this.state.isVisible!==e&&(this.state.isVisible=e,this.fireVisualStateHandlers())},this.handlePipChange=e=>{this.state.isPip!==e&&(this.state.isPip=e,this.state.isFullScreen=this.getFullscreenStateProperty(this.fullscreenApi.getFullscreenElement()),this.fireVisualStateHandlers())},this.getFullscreenStateProperty=e=>Rr(this.video.ownerDocument,this.video)||this.video===e,this.handleFullscreenChange=e=>{const t=this.getFullscreenStateProperty(e);this.state.isFullScreen!==t&&(this.state.isFullScreen=t,this.fireVisualStateHandlers())},this.element=e,this.window=(0,Rc.F)(this.element),this.isVisibilitySupported=t}setVideoElement(e){void 0===this.video&&(this.video=e,this.observeFullscreen(),this.observePip())}setExternalVisibility(e){this.handleVisibilityChange(e)}setExternalFullscreen(e){this.state.isFullScreen!==e&&(this.state.isFullScreen=e,this.fireVisualStateHandlers())}changeFullscreenState(e){e.isFullScreen!==this.state.isFullScreen&&(e.isFullScreen?this.fullscreenApi.requestFullscreenForElement(this.video,{navigationUI:"hide"}):this.fullscreenApi.exit())}changePipState(e){e.isPip!==this.state.isPip&&(e.isPip||this.pipApi.destroy())}destroy(){this.emit("Destroy"),this.off("Destroy")}getState(){const{isPip:e,isVisible:t,isFullScreen:r}=this.state;return{isPip:e,isVisible:t,isFullScreen:r,isSupportedPipMode:this.isSupportedPipMode,isVisibilitySupported:this.isVisibilitySupported,isYandexPipMode:this.isYandexPipMode}}getPipWindowSize(){return this.pipApi.getPipWindowSize()}observePip(){this.pipApi=new Pc((0,Rc.F)(this.video),this.video),this.pipApi.addHandler(this.handlePipChange),this.once("Destroy",()=>{this.pipApi.destroy()});const e=this.pipApi.getSupportedApiName();this.isSupportedPipMode=e!==wc.OperaPopOut,this.isYandexPipMode=e===wc.YaBroAttrCurrent||e===wc.YaBroAttrLegacy}observeFullscreen(){this.fullscreenApi=new bc(this.window,this.video),this.fullscreenApi.addHandler(this.handleFullscreenChange),this.once("Destroy",()=>{this.fullscreenApi.destroy()})}}let Cc;!function(e){e.Unknown="Unknown",e.ExternalApi="ExternalApi",e.VisiblePlayback="VisiblePlayback",e.PlayRejected="PlayRejected",e.RestoreAfterInsertInto="RestoreAfterInsertInto",e.WaitForSourceConfigUpdate="WaitForSourceConfigUpdate",e.CompletedRecoverSourceConfig="CompletedRecoverSourceConfig"}(Cc||(Cc={}));var Oc=r(8614);const Dc=["from","vsid"];var Nc=r(3222);const Lc=["playready-proxy.ott.yandex.ru","playready-proxy-preproduction.ott.yandex.ru","widevine-proxy.ott.yandex.ru","widevine-proxy-preproduction.ott.yandex.ru","fairplay-proxy.ott.yandex.ru","fairplay-proxy-preproduction.ott.yandex.ru","drm.yandex-team.ru"],Mc=e=>{let t=e;return(0,Zo.k)(e)?[].concat(e).map(e=>Mc(e)):uc(e)?new Date(e.getTime()):(!(0,qr.m)(e)&&(0,Hi.K)(e)&&(t={},(0,Ri.M)(e,(e,r)=>{t[r]=Mc(e)})),t)};let xc;!function(e){e.play="play",e.pause="pause",e.seek="seek",e.setSource="setSource",e.preloadSource="preloadSource",e.abortPreloadSource="abortPreloadSource",e.setVolume="setVolume",e.setMuted="setMuted",e.setFullscreen="setFullscreen",e.setPictureInPicture="setPictureInPicture",e.setPlaybackRate="setPlaybackRate",e.setVideoTrack="setVideoTrack",e.setAudioTrack="setAudioTrack",e.setTextTrack="setTextTrack",e.setNativeTextTrackVisibility="setNativeTextTrackVisibility",e.setNativeAdControlsVisibility="setNativeAdControlsVisibility",e.setHiddenControls="setHiddenControls",e.setVideoStyle="setVideoStyle",e.setPictureInPictureEnabled="setPictureInPictureEnabled",e.setExternalVisualState="setExternalVisualState",e.getExternalVisualState="getExternalVisualState",e.getIsVisibilitySupported="getIsVisibilitySupported",e.getConfig="getConfig",e.requestDebugInfo="requestDebugInfo",e.xhrRequest="xhrRequest",e.stopAd="stopAd",e.playInrollAd="playInrollAd",e.skipAdPod="skipAdPod",e.playAdViewers="playAdViewers",e.destroy="destroy",e.logDelta="logDelta"}(xc||(xc={}));let Vc=0;const Fc=["requestId"];class Uc extends Zi.v{getDataFromPostMessageEvent(e){let{data:t}=e;if("object"!==typeof t)return;const{id:r,batch:i}=t;return"string"===typeof r&&0!==r.length&&i&&Array.isArray(i)?{id:r,batch:i}:void 0}constructor(e){let{id:t,sender:r,receiver:i,syncMode:s=!1,internal:n=!1}=e;super(),this.id=void 0,this.key=void 0,this.abortRequestMap=Object.create(null),this.sender=void 0,this.receiver=void 0,this.sendPromise=void 0,this.messagesBatch=[],this.receiverCallback=void 0,this.id=t,this.key=s?"handle_data_"+t:void 0,this.sender=r,this.receiver=i;const a=e=>{const{id:t,batch:r}=e;t===this.id&&r.forEach(e=>{let{answer:t,command:r,event:i}=e;if(t&&void 0!==t.requestId&&this.emit("Answer",t),i&&this.emit("Event",i),!r)return;const a=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(r,Fc),o=Nr({},n&&s?Mc(a):a,{sendAnswer:e=>{this.sendAnswer(e,r.requestId)}});this.emit("Command",o)})};this.receiverCallback=e=>{const t=this.getDataFromPostMessageEvent(e);void 0!==t&&a(t)},this.key&&(i[this.key]=a),i.addEventListener("message",this.receiverCallback)}sendEvent(e,t){let{data:r,sourceId:i}=t;const s={eventName:e,data:r,sourceId:i};this.sendPostMessage({event:s})}sendCommand(e,t){const r={commandName:e,params:t};this.sendPostMessage({command:r})}sendRequest(e,t,r){void 0===r&&(r=6e4);const i={commandName:e,params:t,requestId:Vc++},s=this.waitForAnswer(i,r);return this.sendPostMessage({command:i}),s}destroy(){this.receiver.removeEventListener("message",this.receiverCallback),this.off("Command"),this.off("Answer"),this.off("Event"),this.off("Error"),(0,Ri.M)(this.abortRequestMap,e=>e())}flush(){if(this.sendPromise=void 0,0===this.messagesBatch.length)return;const e={id:this.id,batch:[...this.messagesBatch]};this.messagesBatch=[];try{this.sender.postMessage(e,"*")}catch(tu){this.safeSendClonedData(e,"*")}}waitForAnswer(e,t){let r,i=cn.Z;const s=()=>{clearTimeout(r),i(),delete this.abortRequestMap[e.requestId]};return new Promise(n=>{r=window.setTimeout(()=>{const t=this.abortRequestMap[e.requestId];"function"===typeof t&&t()},t);const a=t=>{t.requestId===e.requestId&&(s(),n(t.data))};this.on("Answer",a),i=()=>this.off("Answer",a),this.abortRequestMap[e.requestId]=s})}sendAnswer(e,t){void 0===t&&(t=-1);const r={data:e,requestId:t};this.sendPostMessage({answer:r})}sendPostMessage(e){let{event:t,command:r,answer:i}=e;if(this.key)try{const e={id:this.id,batch:[{event:t,answer:i,command:r}]};return void this.sender[this.key](e)}catch(s){}this.messagesBatch.push({event:t,answer:i,command:r}),this.planRealSend()}safeSendClonedData(e,t){try{this.sender.postMessage(JSON.parse(JSON.stringify(e)),t)}catch(r){this.emit("Error",r)}}planRealSend(){void 0===this.sendPromise&&(this.sendPromise=Promise.resolve().then(()=>this.flush()))}}const Bc=e=>void 0===e?void 0:String(e),Hc={sourceId:NaN,data:void 0},jc={state:Hn.NOT_PLAYING,type:void 0,adParams:{}};(0,ei.s)("internal_start");const Yc=Dr(window.location),Wc=Yc.vsid;(0,xa.ZP)(Yc);const Gc=(0,Vi.I)(()=>(0,xa.RW)("web_sdk_normalize_time"));let Kc;const qc=new Uc({id:Wc,sender:window.parent,syncMode:!0,receiver:window,internal:!0}),zc=e=>{qc.sendEvent("onLogEvent",{sourceId:-1,data:e})},Xc=e=>{const t=Lr(e),r=t.isFatal?(0,Qr.e)(t.code,Zc):void 0,i=Lr(new ss.u(Vr({},t,{messageDetails:r})));qc.sendEvent("onError",{sourceId:Hr(),data:i})};let Qc=Cc.Unknown,Zc=Xr.I,Jc=Xl.PAUSE,$c=jc;(0,La.I)(window).playerJsLoaded=!0;const eu={};(async()=>{const e=async function(e){const t=La.f.initialStreamPlayerParams?Mc(La.f.initialStreamPlayerParams):await e.sendRequest(xc.getConfig,void 0);return Vr({},t,{device:t.device,bandwidthEstimateOffset:t.bandwidthEstimateOffset,maxBufferLength:t.maxBufferLength,skinConfig:t.skinConfig,backgroundColor:t.backgroundColor,togglePlaybackOnVisibilityChange:t.togglePlaybackOnVisibilityChange})}(qc),t={onDrmSystemChange:e=>{qc.sendEvent("onDrmSystemChange",{sourceId:Hr(),data:e})},onChangeStream:e=>{qc.sendEvent("onChangeStream",{sourceId:Hr(),data:e}),e&&xr({},e.url)},onError:Xc,onRecover:e=>{qc.sendEvent("onRecover",{sourceId:Hr(),data:e})},onStateChange:e=>{const t=Hr();qc.sendEvent("onStateChange",{sourceId:t,data:{playingState:e,reason:Qc}}),Jc!==e&&(Jc=e,Qc=Cc.Unknown)},onAdStateChange:e=>{$c.state!==e.state&&(Qc=Cc.Unknown);const t=Vr({},$c);$c=e,qc.sendEvent("onAdStateChange",{sourceId:Hr(),data:{nextAdState:e,prevAdState:t}})},onAdLoaded:e=>{qc.sendEvent("onAdLoaded",{sourceId:Hr(),data:e})},onAdError:()=>{qc.sendEvent("onAdError",{sourceId:Hr(),data:void 0})},onBeforeAdPodStart:e=>{qc.sendEvent("onBeforeAdPodStart",{sourceId:Hr(),data:e})},onAdPodStart:e=>{qc.sendEvent("onAdPodStart",{sourceId:Hr(),data:e})},onAdPodClick:()=>{qc.sendEvent("onAdPodClick",{sourceId:Hr(),data:void 0})},onAdPodSkip:()=>{qc.sendEvent("onAdPodSkip",{sourceId:Hr(),data:void 0})},onAdPodEnd:()=>{qc.sendEvent("onAdPodEnd",{sourceId:Hr(),data:void 0})},onAdSkippableStateChange:e=>{qc.sendEvent("onAdSkippableStateChange",{sourceId:Hr(),data:e})},onAdPodCloseStateChange:e=>{qc.sendEvent("onAdPodCloseStateChange",{sourceId:Hr(),data:e})},onAdPodDurationChange:e=>{qc.sendEvent("onAdPodDurationChange",{sourceId:Hr(),data:e})},onAdPodCurrentTimeChange:e=>{qc.sendEvent("onAdPodCurrentTimeChange",{sourceId:Hr(),data:e})},onAdPodTimeToSkipChange:e=>{qc.sendEvent("onAdPodTimeToSkipChange",{sourceId:Hr(),data:e})},onAdVolumeAvailabilityStateChange:e=>{qc.sendEvent("onAdVolumeAvailabilityStateChange",{sourceId:Hr(),data:e})},onAdInteraction:()=>{qc.sendEvent("onAdInteraction",{sourceId:Hr(),data:void 0})},onVideoTypeChange:e=>{qc.sendEvent("onVideoTypeChange",{sourceId:Hr(),data:e})},onDVRStartTimeChange:()=>{void 0!==Kc&&qc.sendEvent("onTimelineInfoChange",{sourceId:Hr(),data:Fr(Kc)})},onDVRDurationChange:()=>{void 0!==Kc&&qc.sendEvent("onTimelineInfoChange",{sourceId:Hr(),data:Fr(Kc)})},onCurrentTimeChange:()=>{void 0!==Kc&&(qc.sendEvent("onPositionChange",{sourceId:Hr(),data:{time:Kc.getCurrentTime(),utcTime:Kc.getUtcPosition(),watchedTime:Kc.getWatchedTime(),videoPlaybackQuality:Kc.getVideoPlaybackQuality(),liveLatency:Kc.getLiveLatency()}}),qc.sendEvent("onTimelineInfoChange",{sourceId:Hr(),data:Fr(Kc)}))},onFullScreenChange:e=>{qc.sendEvent("onFullScreenChange",{sourceId:Hr(),data:e})},onVolumeChange:e=>{qc.sendEvent("onVolumeChange",{sourceId:Hr(),data:e})},onVideoTrackChange:e=>{var t;qc.sendEvent("onVideoTrackChange",{sourceId:Hr(),data:e}),qc.sendEvent("onCapSizeChange",{sourceId:Hr(),data:null==(t=Kc)?void 0:t.getMaxCapAllowedVideoTrack()})},onVideoTracksChange:e=>{qc.sendEvent("onVideoTracksChange",{sourceId:Hr(),data:e})},onAudioTrackChange:e=>{qc.sendEvent("onAudioTrackChange",{sourceId:Hr(),data:e})},onAudioTracksChange:e=>{qc.sendEvent("onAudioTracksChange",{sourceId:Hr(),data:e})},onTextTrackChange:e=>{qc.sendEvent("onTextTrackChange",{sourceId:Hr(),data:e})},onTextTracksChange:e=>{qc.sendEvent("onTextTracksChange",{sourceId:Hr(),data:e})},onSubtitlesChange:e=>{qc.sendEvent("onSubtitlesChange",{sourceId:Hr(),data:e})},onPlaybackRateChange:e=>{qc.sendEvent("onPlaybackRateChange",{sourceId:Hr(),data:e})},onThumbnailTileGeneralMetaInfoChange:e=>{qc.sendEvent("onThumbnailTileGeneralMetaInfoChange",{sourceId:Hr(),data:e})},onOriginalBroadcastAdStateChange:e=>{qc.sendEvent("onOriginalBroadcastAdStateChange",{sourceId:Hr(),data:e})},onAdblockDetected:e=>{Zc=e,(0,Wr.Y)(()=>{window.Ya.Rum.updateErrors({blocker:Zc}),window.Ya.Rum.setVars({"-blocker":Zc}),(0,ei.s)(Jr,window.Ya.Rum.getTime(),!1,{[Jr]:Number(Zc)})})},onContentImpression:e=>{qc.sendEvent("onContentImpression",{sourceId:Hr(),data:e})},onResourcesIdle:()=>{qc.sendEvent("onResourcesIdle",{sourceId:Hr(),data:void 0})},onVisualStateChange:e=>{qc.sendEvent("onVisualStateChange",{sourceId:Hr(),data:e})},onBufferingRangesChange:e=>{void 0!==Kc&&qc.sendEvent("onBufferingRangesChange",{sourceId:Hr(),data:Ur(Kc,e)})},onStartStageChange:e=>{qc.sendEvent("onStartStageChange",{sourceId:Hr(),data:e})},onVideoSizeChange:e=>{qc.sendEvent("onVideoSizeChange",{sourceId:Hr(),data:e})},onNextAdRemainingTimeChange:e=>{qc.sendEvent("onNextAdRemainingTimeChange",{sourceId:Hr(),data:e})},logEvent:zc,onStreamsWithSupportInfoChange:e=>{qc.sendEvent("onStreamsWithSupportInfoChange",{sourceId:Hr(),data:e})},onEngineChange:(e,t)=>{qc.sendEvent("onEngineChange",{sourceId:t,data:e})},onNetworkStatusChange:e=>{qc.sendEvent("onNetworkStatusChange",{sourceId:Hr(),data:e})},onBandwidthEstimateChange:e=>{qc.sendEvent("onBandwidthEstimateChange",{sourceId:Hr(),data:e})},onCapSizeChange:e=>{qc.sendEvent("onCapSizeChange",{sourceId:Hr(),data:e})},onPlaybackQualityUpdate:e=>{qc.sendEvent("onPlaybackQualityUpdate",{sourceId:Hr(),data:e})},onExpectedStalledChange:e=>{qc.sendEvent("onExpectedStalledChange",{sourceId:Hr(),data:e})},onRequestFullscreenChange:e=>{qc.sendEvent("onRequestFullscreenChange",{sourceId:Hr(),data:e})},onInrollFrame:e=>{qc.sendEvent("onInrollFrame",{sourceId:Hr(),data:e})},onPreloadDetailsUpdate:e=>{qc.sendEvent("onPreloadDetailsUpdate",{sourceId:Hr(),data:{details:e}})}},r=await e.then(e=>Vr({},e,{callbacks:t}));let i=r.source.params.additionalParams;qc.sendEvent("onInit",Hc);const s=function(e){const t=window.parent.document.getElementById(nr(Wc));if(!t)throw new ss.u({code:Oc.c.PLAYER_CONTAINER_NOT_FOUND,isFatal:!1,details:e,message:"Player container was not found"});return t}(r);(function(e){return void 0===e&&(e=window),(0,ho.w)(e.document.querySelectorAll("style[data-ya-player-style]"))})().forEach(e=>function(e,t){(0,Dd.G)(e)!==(0,Dd.G)(t)&&t.appendChild(e)}(e,s)),function(e){if(e.source.streams.some(e=>{let{url:t}=e;return Ce(t)})){const e=(0,zr.c)(window),t=document.createElement("link");t.rel="preconnect",t.href="https://strm.yandex.ru",e.appendChild(t)}}(r);const{isVisibilitySupported:n}=await async function(e){return La.f.isVisibilitySupported?{isVisibilitySupported:La.f.isVisibilitySupported}:e.sendRequest(xc.getIsVisibilitySupported,void 0)}(qc),a=new Ic(s,n);Kc=new Ac(s,r,{visualState:a},()=>qc.sendEvent("onReady",Hc)),(0,ei.s)(Zr),qc.on("Command",e=>{switch(e.commandName){case xc.pause:Qc=e.params,void 0!==Kc&&Kc.pause(),e.sendAnswer();break;case xc.play:Qc=e.params,Kc?Kc.play().then(()=>{e.sendAnswer(!0)}).catch(()=>{e.sendAnswer(!1)}):e.sendAnswer(!1);break;case xc.seek:Kc.seek({videoTime:Br(Kc,e.params)});break;case xc.setPlaybackRate:Kc.setPlaybackRate(e.params);break;case xc.setSource:const{sourceConfig:t,shouldSaveProgress:s}=e.params;if(!t)throw new ss.u("setSource method receives an object");e.sendAnswer(),qc.flush();const{additionalParams:n}=t.params;n&&(i=n),t.streams=t.streams.map(e=>Vr({},e,{drmConfig:e.drmConfig?kr(e.drmConfig,i.vsid):void 0,url:wr({url:e.url,adConfig:t.params.adConfig,additionalParams:i})})),xr(t,t.streams[0].url),Kc.setSource(t,{shouldSaveProgress:s});break;case xc.preloadSource:const{sourceConfig:o,requestId:l}=e.params,{additionalParams:d}=o.params;o.streams=o.streams.map(e=>Vr({},e,{drmConfig:e.drmConfig?kr(e.drmConfig,d.vsid):void 0,url:wr({url:e.url,adConfig:o.params.adConfig,additionalParams:d})}));const{promise:c,abort:u}=Kc.preloadSource(o);eu[l]=u,c.then(()=>{qc.sendEvent("onPreloadSourceResolve",{sourceId:-1,data:l})}).catch(()=>{qc.sendEvent("onPreloadSourceReject",{sourceId:-1,data:l})}).then(()=>{delete eu[l]});break;case xc.abortPreloadSource:const h=eu[e.params];(0,qr.m)(h)&&(h(),delete eu[e.params]);break;case xc.setVolume:e.params>0&&Kc.setMuted(!1),Kc.setVolume(e.params);break;case xc.setMuted:Kc.setMuted(e.params);break;case xc.setVideoTrack:Kc.setVideoTrack(e.params);break;case xc.setAudioTrack:Kc.setAudioTrack(e.params);break;case xc.setTextTrack:Kc.setTextTrack(e.params);break;case xc.setNativeTextTrackVisibility:Kc.setNativeTextTrackVisibility(e.params);break;case xc.setNativeAdControlsVisibility:Kc.setNativeAdControlsVisibility(e.params);break;case xc.setFullscreen:Kc.setFullscreen(e.params);break;case xc.setPictureInPicture:a.changePipState({isPip:e.params});break;case xc.setHiddenControls:Kc.setHiddenControls(e.params);break;case xc.setVideoStyle:Kc.setVideoStyle(e.params);break;case xc.setPictureInPictureEnabled:Kc.setPictureInPictureEnabled(e.params);break;case xc.requestDebugInfo:(async function(){let e={};return void 0!==Kc&&(e=await Kc.requestDebugInfo()),Vr({},e,{adState:$c,playingState:Jc,vsid:Wc,version:"1.0-10769",utcPosition:Kc.getUtcPosition(),currentTime:Kc.getCurrentTime(),system:Or(),clientTimestamp:Date.now(),internalInitialConfig:r})})().then(t=>e.sendAnswer(t));break;case xc.stopAd:Kc.stopAd({stopAdReason:rs.InsertIntoCalled}).then(()=>{e.sendAnswer()});break;case xc.playInrollAd:Kc.playInrollAd(e.params);break;case xc.skipAdPod:Kc.skipAdPod();break;case xc.playAdViewers:const{adType:p,adViewers:f}=e.params;Kc.playAdViewers(p,f,{},!0).then(()=>{e.sendAnswer({success:!0})}).catch(()=>{e.sendAnswer({success:!1})});break;case xc.destroy:a.destroy(),void 0!==Kc&&Kc.destroy(),e.sendAnswer(e.params);break;case xc.setExternalVisualState:"boolean"===typeof e.params.isVisible&&a.setExternalVisibility(e.params.isVisible),"boolean"===typeof e.params.isFullscreen&&a.setExternalFullscreen(e.params.isFullscreen);break;case xc.logDelta:(0,$r.uo)(e.params.deltaId,e.params.value,e.params.params);break;default:throw new Error("IFrameApi Error: unexpected command in MessageEvent: "+e.commandName)}}),qc.on("Error",e=>{const t=new ss.u(Vr({},e,{code:Oc.c.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR,details:{},isFatal:!1}));qc.sendEvent("onError",{sourceId:Hr(),data:t.toJSON()})}),(0,$r.iW)("detect.visibility"),"boolean"===typeof La.f.initialVisibility?(a.setExternalVisibility(La.f.initialVisibility),(0,$r.vG)("detect.visibility")):qc.sendRequest(xc.getExternalVisualState,void 0).then(e=>{let{isVisible:t}=e;a.setExternalVisibility(t),(0,$r.vG)("detect.visibility")})})().catch(e=>{qc.sendEvent("onInitError",{sourceId:1,data:Lr(new ss.u(Vr({},e,{isFatal:"boolean"!==typeof e.isFatal||e.isFatal,code:e.code||Oc.c.ON_PLAYER_INIT_ERROR})))})})},1208:(e,t,r)=>{"use strict";r.d(t,{s:()=>i.s});r(6087);var i=r(8698)},3133:(e,t,r)=>{"use strict";function i(e,t){if(void 0===t)return e;return void 0!==function(e){const t=(0,s.pp)(e,"t");return void 0===t?t:Number(t)}(e)?(0,s.Yc)(e,"t",t):(0,s.zP)(e,"t",String(t))}r.d(t,{o:()=>i});r(7881);var s=r(5946)},6971:(e,t,r)=>{"use strict";let i;r.d(t,{q:()=>i}),function(e){e.DEFAULT="DEFAULT",e.MEDIA="MEDIA",e.NETWORK_MEDIA="NETWORK_MEDIA",e.NETWORK_PLAYER="NETWORK_PLAYER",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NO_CODECS="NO_CODECS",e.CANNOT_PLAY="CANNOT_PLAY",e.UNSUPPORTED_ENV="UNSUPPORTED_ENV",e.EXCEPTION="EXCEPTION",e.ADS="ADS",e.CONFIG="CONFIG",e.REGIONAL="REGIONAL",e.DRM="DRM",e.ACCESS="ACCESS",e.BANNED="BANNED"}(i||(i={}))},5946:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){const t=f[e];if(t)return t;p.href=e;let r=p.pathname||"";"/"!==r.charAt(0)&&(r="/"+r);const s={href:p.href,protocol:p.protocol,host:p.host,hostname:p.hostname,port:p.port,pathname:r,search:p.search,hash:p.hash,baseDomain:(p.hostname||"").split(".").slice(-2).join(".")};return f[e]=s,i({},s)}function n(e,t,r){if(void 0===t)return e;if(void 0===r)return e;const i=encodeURIComponent(t)+"="+encodeURIComponent(r);return p.href=e,p.search=p.search?p.search+"&"+i:"?"+i,p.href}function a(e,t){p.href=e;return((p.hash||"").slice(1).split("&").map(e=>e.split("=")).map(e=>{let[t,r]=e;return[t,void 0===r?"":r]}).find(e=>{let[r]=e;return r===t})||[])[1]}function o(e,t,r){if(void 0===t)return e;if(void 0===r)return e;const i=encodeURIComponent(t)+"="+encodeURIComponent(r);return p.href=e,p.hash=p.hash?p.hash+"&"+i:"#"+i,p.href}function l(e,t,r){return e=function(e,t){if(-1===e.indexOf("#"))return e;p.href=e;const r=u(p.hash.slice(1),t);return p.hash=r?"#"+r:"",p.href}(e,t),void 0===r?e:o(e,t,r)}function d(e,t,r){void 0===r&&(r={});for(const i in t)t.hasOwnProperty(i)&&(e=n(e,i,t[i]));for(const i in r)r.hasOwnProperty(i)&&(e=o(e,i,r[i]));return e}function c(e,t){if(-1===e.indexOf("?"))return e;p.href=e;const r=u(p.search.slice(1),t);return p.search=r?"?"+r:"",p.href}function u(e,t){return e.split("&").filter(e=>e!==t&&0!==e.indexOf(t+"=")).join("&")}function h(e,t){return-1===e.indexOf("?")?e:t.reduce(c,e)}r.d(t,{Hn:()=>h,Sr:()=>d,WR:()=>c,Yc:()=>l,en:()=>s,pp:()=>a,zP:()=>o});const p=document.createElement("a"),f={}},5636:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});var i=r(55);class s{constructor(){this.resolve=void 0,this.reject=void 0,this.promise=void 0;let e=i.Z,t=i.Z;this.promise=new Promise((r,i)=>{e=r,t=i}),this.resolve=e,this.reject=t}}},5442:(e,t,r)=>{"use strict";function i(e){let{id:t,method:r,params:i}=e;return{jsonrpc:"2.0",id:t,method:r,params:i}}function s(e){if(!("params"in e))return[];if(Array.isArray(e.params))return e.params;if((0,u.K)(e.params))return e.params;throw new Error("Expect #params to be an array or an object if present in "+JSON.stringify(e))}function n(e){return a(e)}function a(e){if((0,c.z)(e.id)){if(Math.floor(e.id)!==e.id)throw new Error("Expect #id to be an integer if it's a number in "+JSON.stringify(e));return e.id}if((0,h.H)(e.id)||null===e.id)return e.id;throw new Error("Expect #id to be an integer, string or null (not recommended) in "+JSON.stringify(e))}function o(e){if(!("id"in e))throw new Error("Expect #id to present in rpc response "+JSON.stringify(e));return a(e)}function l(e){if("object"!==typeof e.error||null===e.error)throw new Error("Expect #error to be an object in "+JSON.stringify(e));const t=e.error;if(!(0,c.z)(t.code))throw new Error("Expect #error#code to be an number in "+JSON.stringify(e));if(!(0,h.H)(t.message))throw new Error("Expect #error#message to be an string in "+JSON.stringify(e));return"data"in t?{code:t.code,message:t.message,data:t.data}:{code:t.code,message:t.message}}function d(e){const t=function(e){if(!(0,u.K)(e))throw new Error("Can't parse \""+e+'" as object');return e}(e);if(!function(e){return"2.0"===e.jsonrpc}(t))throw new Error("Expect "+((0,p.Y)(()=>JSON.stringify(e))||e)+" to be a json-rpc v2 message");if((0,h.H)(t.method))return function(e){return"id"in e?{jsonrpc:e.jsonrpc,method:e.method,params:s(e),id:n(e)}:{jsonrpc:e.jsonrpc,method:e.method,params:s(e)}}(t);if("result"in t)return function(e){return{jsonrpc:e.jsonrpc,result:e.result,id:o(e)}}(t);if("error"in t)return function(e){return{jsonrpc:e.jsonrpc,error:l(e),id:o(e)}}(t);throw new Error("Expect "+((0,p.Y)(()=>JSON.stringify(e))||e)+" to be a json-rpc v2 message")}r.d(t,{A:()=>v});var c=r(7187),u=r(3770),h=r(8833),p=r(2818),f=r(9366);r(7881);var m=r(4513),g=r(55);class v extends m.M{constructor(e){super(),this.lastRpcRequestId=1,this.waiters=Object.create(null),this.send=void 0,this.onRun=void 0,this.serialize=void 0,this.deserialize=void 0,this.send=e.send,this.onRun=e.onRun,this.serialize=e.serialize,this.deserialize=e.deserialize}destroy(){super.destroy(),this.onRun=g.Z;for(const e in this.waiters)this.waiters[e](new Error("Stop on destroy"))}request(e,t){let{method:r,params:s}=e;void 0===t&&(t=3e4);const n=this.getUniqueRpcRequestId();return this.sendMessage(i({id:n,method:r,params:s})),this.waitForResponse(n,t,r)}sendEvent(e){let{method:t,params:r}=e;return this.sendMessage(i({method:t,params:r})),Promise.resolve()}getUniqueRpcRequestId(){return String(this.lastRpcRequestId++)}waitForResponse(e,t,r){const i=setTimeout(()=>{const i=this.waiters[e];void 0!==i&&i(new Error("Timeout fired ("+t+"ms) on method "+r+" for id="+e+"."))},t),s=()=>{clearTimeout(i),delete this.waiters[e]};return new Promise((t,r)=>{this.waiters[e]=(e,i)=>(s(),null!==e?r(e):t(i))})}sendMessage(e){this.send(this.serialize(e))}handleRpcRequest(e){let{id:t,method:r,params:i}=e;this.onRun({method:r,params:i},(e,r)=>{t&&this.sendMessage(function(e){let{id:t,error:r,result:i}=e;return r?{jsonrpc:"2.0",id:t,error:r.toJSON()}:{jsonrpc:"2.0",id:t,result:void 0===i?null:i}}({id:t,error:e,result:r}))})}handleRpcResponse(e){const t=this.waiters[e.id];if(void 0!==t)if("error"in e){t(new f.l(e.error.message,e.error.code,"string"===typeof e.error.data?e.error.data:void 0))}else t(null,e.result);else this.emit("Warn",new Error("Response for missed waiter for id="+JSON.stringify(e.id)))}handleMessage(e){try{const t=d(this.deserialize(e));"result"in t||"error"in t?this.handleRpcResponse(t):"method"in t&&this.handleRpcRequest(t)}catch(t){this.emit("Error",t)}}}},9366:(e,t,r)=>{"use strict";r.d(t,{l:()=>a});var i=r(45),s=r(8139),n=r.n(s);class a extends Error{constructor(e,t,r){void 0===t&&(t=i.v.UNKNOWN_ERROR),super(e),this.message=void 0,this.stack=void 0,this.toJSON=void 0,this.code=void 0,n()(this,a.prototype),this.message=e,this.code=t,this.stack=null!=r?r:this.stack,this.toJSON=()=>({code:this.code,message:this.message,data:this.stack})}toString(){return JSON.stringify(this.toJSON())}}},45:(e,t,r)=>{"use strict";let i;r.d(t,{v:()=>i}),function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.PARSE_ERROR=-32700]="PARSE_ERROR",e[e.INVALID_REQUEST=-32600]="INVALID_REQUEST",e[e.METHOD_NOT_FOUND=-32601]="METHOD_NOT_FOUND",e[e.INVALID_PARAMS=-32602]="INVALID_PARAMS",e[e.INTERNAL_ERROR=-32603]="INTERNAL_ERROR"}(i||(i={}))},5605:(e,t,r)=>{"use strict";function i(e){return(0,s.H)(e.tagName)}r.d(t,{m:()=>i});var s=r(8833)},8836:(e,t,r)=>{"use strict";function i(e){return Object.prototype.toString.call(e)===s}r.d(t,{F:()=>i,u:()=>s});const s="[object Window]"},8468:(e,t,r)=>{"use strict";function i(e,t){return e+"/"+t}function s(e){if("string"===typeof e&&(e={message:e}),"object"===typeof e&&null!==e||(e={}),"function"===typeof e.toJSON)try{return{__stringifyError:e.toJSON()}}catch(s){}const{name:t,message:r,stack:i}=e;return{__stringifyError:{name:t,message:r,stack:i}}}function n(e,t,r,s){const n=o(e[t],i(r,t),s);return void 0===n?"null":n}function a(e){return JSON.stringify(e)}function o(e,t,r){switch(typeof e){case"boolean":return e?"true":"false";case"string":return a(e);case"undefined":return;case"bigint":return a(e.toString());case"function":return a("[Function"+("string"===typeof e.name&&e.name.length>0?" "+e.name:"")+"]");case"symbol":return a("[Symbol]");case"number":return isNaN(e)||!isFinite(e)?"null":String(e);case"object":if(null===e)return"null";if((0,u.F)(e))return a(u.u);if((0,c.m)(e))return a("[DOMNode "+e.tagName+"]");if((0,h.f)(e)){const{name:t}=e.constructor;return a("["+(t||"TypedArray")+"("+(e.byteLength||0)+")]")}const l=r.get(e);if(void 0!==l)return a("[Circular "+l+"]");r.set(e,t);return(0,p.k)(e)?function(e,t,r){if(0===e.length)return"[]";let i="["+n(e,0,t,r);for(let s=1;s<e.length;s++)i+=","+n(e,s,t,r);return i+"]"}(e,t,r):function(e,t,r){if("function"===typeof e.toJSON){let n;try{n=e.toJSON()}catch(d){n=s(d)}return o(n,i(t,"toJSON"),r)}let n="{",l=!0;for(let c in e){if(!Object.prototype.hasOwnProperty.call(e,c))continue;let u;try{u=e[c]}catch(d){u=s(d)}const h=o(u,i(t,c),r);void 0!==h&&(l?l=!1:n+=",",n+=a(c)+":"+h)}return n+"}"}(e,t,r)}}function l(e){try{return o(e,"~",function(){const e="undefined"!==typeof WeakMap?new WeakMap:void 0,t=[];return{set:(r,i)=>{if(void 0!==e)try{e.set(r,i)}catch(s){t.push({path:i,value:r})}else t.push({path:i,value:r})},get:r=>{const i=(0,d.s)(t,e=>e.value===r);return void 0!==e&&void 0===i?e.get(r):i?i.path:void 0}}}())}catch(t){return JSON.stringify(s(t))}}r.d(t,{Y:()=>l});var d=r(3888),c=r(5605),u=r(8836),h=r(6028),p=r(2364)},2364:(e,t,r)=>{"use strict";r.d(t,{k:()=>i});const i="function"===typeof Array.isArray?Array.isArray:function(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}},6028:(e,t,r)=>{"use strict";function i(e){return"undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&ArrayBuffer.isView(e)}r.d(t,{f:()=>i})},55:(e,t,r)=>{"use strict";function i(){}r.d(t,{Z:()=>i})},7919:(e,t,r)=>{"use strict";function i(e,t){const r=Math.pow(10,t);return Math.round((e+s.I)*r)/r}r.d(t,{R:()=>i});var s=r(884)},9010:(e,t,r)=>{"use strict";r.d(t,{x:()=>i});class i{static fromUTF8(e){if(!e)return"";let t=new Uint8Array(e);239===t[0]&&187===t[1]&&191===t[2]&&(t=t.subarray(3));let r=i.fromCharCode(t),s=escape(r);try{return decodeURIComponent(s)}catch(n){throw new Error("BAD_ENCODING")}}static fromUTF16(e,t,r){if(void 0===r&&(r=!1),!e)return"";if(!r&&e.byteLength%2!==0)throw new Error("BAD_ENCODING: Data has an incorrect length, must be even");let s;if(e instanceof ArrayBuffer)s=e;else{let t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e)),s=t.buffer}let n=Math.floor(e.byteLength/2),a=new Uint16Array(n),o=new DataView(s);for(let i=0;i<n;i++)a[i]=o.getUint16(2*i,t);return i.fromCharCode(a)}static fromBytesAutoDetect(e){let t=new Uint8Array(e);if(239===t[0]&&187===t[1]&&191===t[2])return i.fromUTF8(t);if(254===t[0]&&255===t[1])return i.fromUTF16(t.subarray(2),!1);if(255===t[0]&&254===t[1])return i.fromUTF16(t.subarray(2),!0);const r=function(e,t){return e.byteLength<=t||e[t]>=32&&e[t]<=126};if(0===t[0]&&0===t[2])return i.fromUTF16(e,!1);if(0===t[1]&&0===t[3])return i.fromUTF16(e,!0);if(r(t,0)&&r(t,1)&&r(t,2)&&r(t,3))return i.fromUTF8(e);throw new Error("UNABLE_TO_DETECT_ENCODING")}static toUTF8(e){let t=encodeURIComponent(e),r=unescape(t),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i.buffer}static toUTF16(e,t){const r=new Uint8Array(2*e.length),i=new DataView(r.buffer);for(let s=0;s<e.length;++s){const r=e.charCodeAt(s);i.setUint16(2*s,r,t)}return r.buffer}static fromCharCode(e){if(!i.fromCharCodeImpl){const e=e=>{try{const t=new Uint8Array(e);return String.fromCharCode.apply(null,t).length>0}catch(t){return!1}};for(let t=65536;t>0;t/=2)if(e(t)){i.fromCharCodeImpl=e=>{let r="";for(let i=0;i<e.length;i+=t){const s=e.subarray(i,i+t);r+=String.fromCharCode.apply(null,s)}return r};break}}if(!i.fromCharCodeImpl)throw new Error("Unable to create a fromCharCode method");return i.fromCharCodeImpl(e)}static resetFromCharCode(){i.fromCharCodeImpl=null}}i.fromCharCodeImpl=null},1610:(e,t,r)=>{"use strict";r.d(t,{P:()=>s});var i=r(9010);class s{static concat(){let e=0;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(let a=0;a<r.length;++a)e+=r[a].length;let s=new Uint8Array(e),n=0;for(let a=0;a<r.length;++a)s.set(r[a],n),n+=r[a].length;return s}static toHex(e){let t="";for(let r=0;r<e.length;++r){let i=e[r].toString(16);1===i.length&&(i="0"+i),t+=i}return t}static fromHex(e){let t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.substr(r,2),16);return t}static toBase64(e,t){void 0===t&&(t=!0);let r=i.x.fromCharCode(e),s=btoa(r).replace(/\+/g,"-").replace(/\//g,"_");return t?s:s.replace(/=*$/,"")}static fromBase64(e){let t=atob(e.replace(/-/g,"+").replace(/_/g,"/")),r=new Uint8Array(t.length);for(let i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}static equal(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}}},1725:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{b:()=>u});var s=r(3945);const n=e=>{try{const{left:t,right:r,top:i,bottom:s}=e.getBoundingClientRect();return{left:t,right:r,top:i,bottom:s,width:r-t,height:s-i}}catch(t){return{left:0,width:0,top:0,height:0,right:0,bottom:0}}};var a=r(1122),o=r(4312),l=r(4963);class d extends o.M{constructor(e,t){void 0===t&&(t=(e,t)=>e===t),super(),this.checkToEqualFunction=t,this.value=e}getValue(){return this.value}subscribeValueCondition(e,t){return this.add(r=>{e(r)&&(0,l.p)(t,r)})}subscribeValueConditionOnce(e,t){const r=this.subscribeValueCondition(e,e=>{r(),(0,l.p)(t,e)});return r}dispatch(e){this.checkToEqualFunction(this.value,e)||(this.value=e,super.dispatch(e))}}var c=r(5779);r(7881);class u extends a.V{constructor(e){super(),this.onResize=void 0,this.resizeObserverCallback=e=>{let[{contentRect:{width:t,height:r}}]=e;this.onResize.dispatch({width:t,height:r})};const t=n(e);if(this.onResize=new d({width:t.width,height:t.height},(e,t)=>{let{width:r,height:i}=t;return!!(isNaN(r)||isNaN(i)||r<1||i<1)||e.width===r&&e.height===i}),this.addDestroyHandler(()=>{this.onResize.removeAll()}),"undefined"!==typeof ResizeObserver)try{const t=new ResizeObserver(this.resizeObserverCallback);t.observe(e),this.addDestroyHandler(()=>{t.disconnect()})}catch(r){this.fallbackToCustomDetectionMethods(e)}else this.fallbackToCustomDetectionMethods(e)}getSize(){return i({},this.onResize.getValue())}fallbackToCustomDetectionMethods(e){const{ownerDocument:t}=e;if(!t)return;const{defaultView:r}=t;if(!r)return;const i=()=>{const t=n(e);this.onResize.dispatch({width:t.width,height:t.height})};this.addDestroyHandler((0,s.O)(r,"resize",i,{passive:!0})),this.addDestroyHandler((0,c.X)(i))}}},6612:(e,t,r)=>{"use strict";r.d(t,{t:()=>s});var i=r(2741);const s={getItem(e){try{return i.ZP.getItem(e)}catch(t){return null}},setItem(e,t){try{i.ZP.setItem(e,t)}catch(r){}},removeItem(e){try{i.ZP.removeItem(e)}catch(t){}},clear(){try{i.ZP.clear()}catch(e){}}}},4145:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});const i=["play","setSource","destroy"]},1792:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});const i=["sendReportLog","preloadSource","requestVideoElementFullscreen","requestDebugInfo","requestExternalPlay","requestExternalPlayerList","insertInto","playAdViewers",...r(4145).V]},101:(e,t,r)=>{"use strict";r.d(t,{v:()=>n});var i=r(1792),s=r(7549);const n=[...i.o,...s.t,"getState","getReadyState"]},1194:(e,t,r)=>{"use strict";r.d(t,{n:()=>i});const i=["pause","on","once","off","publicEmit"]},7549:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});const i=["setVideoTrack","setAudioTrack","setTextTrack","changeAdditionalParams","exitVideoElementFullscreen","setPlaybackRate","setMuted","setVolume","setPictureInPictureAllowed","setVideoStyle","setNativeControlsVisibility","setNativeTextTrackVisibility","logEvent","logError","seek","openReportWindow","playInrollAd","skipAdPod","setNativeAdControlsVisibility","setDebugPanelVisibility",...r(1194).n]},6832:(e,t,r)=>{"use strict";var i=r(101);const s=window;s.Ya||(s.Ya={}),s.Ya.playerApi||(s.Ya.playerApi={}),s.Ya.playerApi.METHODS||(s.Ya.playerApi.METHODS=i.v)},6087:(e,t,r)=>{"use strict";r(6832);window.Ya.playerApi},8698:(e,t,r)=>{"use strict";r.d(t,{s:()=>i});r(6832);const i=window.Ya.playerApi},9329:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});class i{constructor(){this.handlers=Object.create(null),this.onceHandlers=Object.create(null),this.maxEventListeners=10}setMaxListeners(e){!isFinite(e)||e<=0||(this.maxEventListeners=e)}on(e,t){this.getHandlers(e).push(t),this.checkSubscriptions(e)}once(e,t){this.getOnceHandlers(e).push(t),this.checkSubscriptions(e)}off(e,t){const r=this.getHandlers(e),i=this.getOnceHandlers(e);if(void 0===t)return r.length=0,void(i.length=0);this.removeHandler(t,r),this.removeHandler(t,i)}emit(e,t){const r=this.getHandlers(e),i=this.getOnceHandlers(e).slice();this.getOnceHandlers(e).length=0,r.slice().concat(i).forEach(e=>{try{e(t)}catch(r){setTimeout(()=>{throw r},0)}})}getHandlers(e){return void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e]}getOnceHandlers(e){return void 0===this.onceHandlers[e]&&(this.onceHandlers[e]=[]),this.onceHandlers[e]}checkSubscriptions(e){const t=this.getHandlers(e).length+this.getOnceHandlers(e).length;t>this.maxEventListeners&&console.warn("There are "+t+" subscriptions on event named "+e)}removeHandler(e,t){const r=t.indexOf(e);-1!==r&&t.splice(r,1)}}},5809:(e,t,r)=>{"use strict";r.d(t,{q:()=>s,z:()=>i});const i="https://strm.yandex.net/int/enc/srvr.xml",s="int/enc/srvr.xml"},5357:(e,t,r)=>{"use strict";r.d(t,{I:()=>s});var i=r(5809);const s=-1===i.z.indexOf(i.q)},1291:(e,t,r)=>{"use strict";r.d(t,{W:()=>s,m:()=>i});r(7881);const i=1,s=10},492:(e,t,r)=>{"use strict";function i(e){return void 0!==e.ad.adInfo}r.d(t,{I:()=>i})},3664:(e,t,r)=>{"use strict";function i(e){const{controller:{videoType:t}}=e;return t!==s.Z.VOD&&function(e){const{controller:{currentTime:t,bufferingRanges:r},skin:{skinDVRStartTime:i,skinDVRDuration:s}}=e;if(0===r.length)return!1;const a=i+s-n.W;return s===1/0||t>a}(e)}r.d(t,{x:()=>i});var s=r(4651),n=r(1291)},4295:(e,t,r)=>{"use strict";function i(e,t,r){if(s.G||!(0,o.x)(e)||(0,a.I)(e)||!r)return;const{controller:{playingState:i,playbackRate:c}}=e;if(i!==n.X.PLAY)return;const u=t.total;let h;if(u<2){const e=5*(u-2),t=2*d/(1+Math.pow(Math.E,-e));h=1-d+t}else{const e=.02;if(Math.abs(r-7)<=7*e)h=1;else{const e=5*(r-7),t=2*d/(1+Math.pow(Math.E,-e));h=1-d+t}}return Math.abs(c-h)<=l&&(h=void 0),h}r.d(t,{R:()=>i,_:()=>d});var s=r(9317),n=r(7746),a=r(492),o=r(3664);const l=s.G?.25:.02,d=.03},9004:(e,t,r)=>{"use strict";function i(e){const{currentTime:t,bufferingRanges:r}=e.controller;return(0,s.p)(r,t)}r.d(t,{r:()=>i});var s=r(7568)},9696:(e,t,r)=>{"use strict";let i,s,n;r.d(t,{Dt:()=>i,jY:()=>n,rE:()=>s}),function(e){e.inStreamPlayingState="inStreamPlayingState",e.adConfig="adConfig",e.adInfo="adInfo",e.originalBroadcastAdCueId="originalBroadcastAdCueId",e.originalBroadcastAdCues="originalBroadcastAdCues",e.adblockDetected="adblockDetected",e.hasPreroll="hasPreroll",e.adSyncInit="adSyncInit",e.nextAdInfo="nextAdInfo",e.nativeAdControlsVisibility="nativeAdControlsVisibility"}(i||(i={})),function(e){e.hiddenControls="hiddenControls",e.useNativeSubtitles="useNativeSubtitles",e.nativeControlsVisibility="nativeControlsVisibility",e.skinDVRStartTime="skinDVRStartTime",e.skinDVRDuration="skinDVRDuration"}(s||(s={})),function(e){e.engine="engine",e.autoplay="autoplay",e.allowMuted="allowMuted",e.autoplayImpossible="autoplayImpossible",e.startStage="startStage",e.preload="preload",e.duration="duration",e.encoderState="encoderState",e.from="from",e.vsid="vsid",e.streams="streams",e.stream="stream",e.streamsWithSupportInfo="streamsWithSupportInfo",e.sourceParams="sourceParams",e.sourceId="sourceId",e.bufferingRanges="bufferingRanges",e.userVolume="userVolume",e.currentTime="currentTime",e.currentTimeLowGranularity="currentTimeLowGranularity",e.watchedTime="watchedTime",e.startPosition="startPosition",e.videoType="videoType",e.playingState="playingState",e.errorInfo="errorInfo",e.lastRecoverPosition="lastRecoverPosition",e.preview="preview",e.isFullscreen="isFullscreen",e.isPip="isPip",e.isVisible="isVisible",e.togglePlaybackOnVisibilityChangeSetting="togglePlaybackOnVisibilityChangeSetting",e.isDocumentVisible="isDocumentVisible",e.isOnline="isOnline",e.lastKnownBandwidthEstimate="lastKnownBandwidthEstimate",e.fragmentDuration="fragmentDuration",e.dvrStartTime="dvrStartTime",e.dvrDuration="dvrDuration",e.programDateTime="programDateTime",e.isAbrSupported="isAbrSupported",e.isAbrEnabled="isAbrEnabled",e.defaultQuality="defaultQuality",e.videoTrackValue="videoTrackValue",e.videoTracks="videoTracks",e.userVideoTrackName="userVideoTrackName",e.userVideoTrackHeight="userVideoTrackHeight",e.audioTrackValue="audioTrackValue",e.audioTracks="audioTracks",e.userAudioTrackName="userAudioTrackName",e.userAudioTrackLang="userAudioTrackLang",e.textTrackEnabled="textTrackEnabled",e.nativeTextTrackVisible="nativeTextTrackVisible",e.textTrackValue="textTrackValue",e.textTracks="textTracks",e.userTextTrackEnabled="userTextTrackEnabled",e.userTextTrackName="userTextTrackName",e.userTextTrackLang="userTextTrackLang",e.playbackRate="playbackRate",e.expectedStalled="expectedStalled",e.videoWidth="videoWidth",e.videoHeight="videoHeight",e.volume="volume",e.videoElementStyle="videoElementStyle",e.playerConfig="playerConfig",e.preloadDetails="preloadDetails",e.feed="feed"}(n||(n={}))},9507:(e,t,r)=>{"use strict";function i(e){const t=[];for(let i=0;i<e.buffered.length;i++)try{t.push({start:e.buffered.start(i),end:e.buffered.end(i)})}catch(r){}return function(e){const t=e.map(e=>{let{start:t,end:r}=e;return{start:t,end:r}}).sort((e,t)=>e.start-t.start);if(t.length<=1)return t;const r=[t[0]];return t.slice(1).forEach((e,t)=>{const i=r[r.length-1];i.end<e.start?r.push(e):i.end<e.end&&(i.end=e.end)}),r}(t)}r.d(t,{e:()=>i});r(7881)},3545:(e,t,r)=>{"use strict";function i(){o=(0,n.s)(document)}function s(){return o}r.d(t,{C:()=>i,p:()=>s});var n=r(2439),a=r(9738);let o=(0,n.s)(document);(0,a.Y)(document,e=>{e||(o=e)})},4519:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(){return g||(!function(){try{m=encodeURIComponent(JSON.stringify(i({},p,f)))}catch(e){}}(),g=!0),m}function n(){return i({},p,f)}function a(){try{return JSON.parse(window.Ya.Rum._vars["-additional"])}catch(e){return{}}}function o(){try{return window.Ya.Rum.setVars({"-additional":JSON.stringify(p)})}catch(e){}}function l(){try{return window.Ya.Rum.updateErrors({additional:i({},p)})}catch(e){}}function d(e){return void 0===e||void 0===e.additional?s():encodeURIComponent(JSON.stringify(i({},p,f,e.additional)))}function c(e){p=i({},a(),e),o(),l(),g=!1}function u(e,t){p=i({},a(),{[e]:t}),o(),l(),g=!1}function h(e){f=e,g=!1}r.d(t,{B6:()=>d,I8:()=>c,Pj:()=>h,Vk:()=>n,Z$:()=>u});let p={},f={},m="",g=!1},5865:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}function n(e){(0,d.Y)(()=>{window.Ya.Rum.time(e)})}function a(e,t){void 0===t&&(t={}),(0,u.p)()&&(0,d.Y)(()=>{const r=s(t,p);window.Ya.Rum.timeEnd(e,i({},r,{"-additional":(0,c.B6)(t)}))})}function o(e,t,r){void 0===r&&(r={}),(0,u.p)()&&(0,d.Y)(()=>{const{additional:n,initSubpage:a=!1}=r,o=s(r,f);if(a&&(0,h.bk)()>0)return;const d=(0,h.x)(),u=(0,l.K)(d)?d.additional:void 0;window.Ya.Rum.sendDelta(e,t,i({},d,o,{"-additional":(0,l.K)(n)?(0,c.B6)(i({},u,n)):(0,c.B6)(u)}))})}r.d(t,{iW:()=>n,uo:()=>o,vG:()=>a});var l=r(3770),d=r(2818),c=r(4519),u=r(3545),h=r(959);const p=["additional"],f=["additional","initSubpage"]},4334:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e,t,r,s){void 0===s&&(s={}),(0,n.Y)(()=>{const{additional:n={}}=s,l=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(s,o);window.Ya.Rum.sendTimeMark(e,t,r,i({},l,{"-additional":(0,a.B6)(s)}))})}r.d(t,{s:()=>s});var n=r(2818),a=r(4519);const o=["additional"]},959:(e,t,r)=>{"use strict";function i(e){a=window.Ya.Rum.makeSubPage(e?"Init":"SetSource"),o++}function s(){return a}function n(){return o}let a;r.d(t,{QJ:()=>i,bk:()=>n,x:()=>s});let o=-1},7382:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){const t=(0,S.x)();return i({},t,{additional:i({},(0,p.K)(t)?t.additional:void 0,e)})}function n(e){const t=0===O,r=D[e];return D[e]=!0,(0,y.p)()&&t&&!r}function a(){n("sourceStart")&&(0,E.s)(A.autoplayFalse)}function o(e){let{reason:t="unknown"}=e,r=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,T);n("sourceStart")&&(0,E.s)(A.firstStartAdSDKFailed,void 0,void 0,i({reason:t},r))}function l(){O++,D.sourceStart=!1;const e=0===O;e?(0,E.s)(A.firstLoadSource):(0,y.C)();try{(0,S.QJ)(e);const t=(0,S.x)();(0,m.Pj)(t.additional||{})}catch(t){}}function d(e,t){if(!(0,y.p)()||D.sourceStart)return;const r=0===O;r&&t?(0,v.iW)(P[e]):r?(0,v.iW)(k[e]):t?(0,v.iW)(C[e]):(0,v.iW)(I[e])}function c(e,t,r){const i=D.sourceStart;if(D.sourceStart=!0,!(0,y.p)()||i)return;if(0===O){const i=r?R[e]:b[e],s=r?P[e]:k[e];(0,E.s)(i,void 0,!1,{additional:t}),(0,v.vG)(s,{additional:t})}else r?(0,v.vG)(C[e],s(t)):(0,v.vG)(I[e],s(t))}function u(e,t,r){n("yaFirstFrameDecoded")&&(r&&"AD"!==e||(0,E.s)(w[e],void 0,!1,{additional:t}))}function h(e,t,r){n("yaFirstFrameShown")&&(r&&"AD"!==e||(0,E.s)(_[e],void 0,!1,{additional:t}))}r.d(t,{Kp:()=>o,cA:()=>a,Fw:()=>d,Cf:()=>l,G1:()=>c,CN:()=>u,qB:()=>h});var p=r(3770),f=r(3486),m=r(4519);let g;!function(e){e.firstNetworkAdSDK="first.network.adsdk",e.firstNetworkHls="first.network.hls",e.firstNetworkMpd="first.network.mpd",e.firstNetworkMp4="first.network.mp4",e.firstNetworkNative="first.network.native",e.firstNetworkYandex="first.network.yandex",e.firstNetworkYasp="first.network.yasp",e.firstNetworkAdSDKHls="first.network.adsdk.hls",e.firstNetworkAdSDKMpd="first.network.adsdk.mpd",e.firstNetworkAdSDKMp4="first.network.adsdk.mp4",e.firstNetworkAdSDKNative="first.network.adsdk.native",e.firstNetworkAdSDKYandex="first.network.adsdk.yandex",e.firstNetworkAdSDKYasp="first.network.adsdk.yasp",e.setSourceNetworkAdSDK="setsource.network.adsdk",e.setSourceNetworkHls="setsource.network.hls",e.setSourceNetworkMpd="setsource.network.mpd",e.setSourceNetworkMp4="setsource.network.mp4",e.setSourceNetworkNative="setsource.network.native",e.setSourceNetworkYandex="setsource.network.yandex",e.setSourceNetworkYasp="setsource.network.yasp",e.setSourceNetworkAdSDKHls="setsource.network.adsdk.hls",e.setSourceNetworkAdSDKMpd="setsource.network.adsdk.mpd",e.setSourceNetworkAdSDKMp4="setsource.network.adsdk.mp4",e.setSourceNetworkAdSDKNative="setsource.network.adsdk.native",e.setSourceNetworkAdSDKYandex="setsource.network.adsdk.yandex",e.setSourceNetworkAdSDKYasp="setsource.network.adsdk.yasp"}(g||(g={}));var v=r(5865),y=r(3545),E=r(4334),S=r(959);let A;!function(e){e.firstLoadSource="firstloadsource",e.yaFirstFrameDecodedMp4="ya.firstframedecoded.mp4",e.yaFirstFrameDecodedMpd="ya.firstframedecoded.mpd",e.yaFirstFrameDecodedHls="ya.firstframedecoded.hls",e.yaFirstFrameDecodedYandex="ya.firstframedecoded.yandex",e.yaFirstFrameDecodedYasp="ya.firstframedecoded.yasp",e.yaFirstFrameDecodedNative="ya.firstframedecoded.native",e.yaFirstFrameDecodedAdSDK="ya.firstframedecoded.adsdk",e.yaFirstFrameShownMp4="ya.firstframeshown.mp4",e.yaFirstFrameShownMPD="ya.firstframeshown.mpd",e.yaFirstFrameShownHls="ya.firstframeshown.hls",e.yaFirstFrameShownYandex="ya.firstframeshown.yandex",e.yaFirstFrameShownYasp="ya.firstframeshown.yasp",e.yaFirstFrameShownNative="ya.firstframeshown.native",e.yaFirstFrameShownAdSDK="ya.firstframeshown.adsdk",e.autoplayFalse="autoplayfalse",e.firstStartAdSDKFailed="firststart.adsdk.failed",e.firstStartAdSDK="firststart.adsdk",e.firstStartYandex="firststart.yandex",e.firstStartYasp="firststart.yasp",e.firstStartHls="firststart.hls",e.firstStartMp4="firststart.mp4",e.firstStartMpd="firststart.mpd",e.firstStartNative="firststart.native",e.firstStartAdSDKYandex="firststart.adsdk.yandex",e.firstStartAdSDKYasp="firststart.adsdk.yasp",e.firstStartAdSDKHls="firststart.adsdk.hls",e.firstStartAdSDKMpd="firststart.adsdk.mpd",e.firstStartAdSDKMp4="firststart.adsdk.mp4",e.firstStartAdSDKNative="firststart.adsdk.native"}(A||(A={}));const T=["reason"],b={[f.$.HLS]:A.firstStartHls,[f.$.MPD]:A.firstStartMpd,[f.$.MP4]:A.firstStartMp4,[f.$.NATIVE]:A.firstStartNative,[f.$.YANDEX]:A.firstStartYandex,[f.$.YASP]:A.firstStartYasp,AD:A.firstStartAdSDK},R={[f.$.HLS]:A.firstStartAdSDKHls,[f.$.MPD]:A.firstStartAdSDKMpd,[f.$.MP4]:A.firstStartAdSDKMp4,[f.$.NATIVE]:A.firstStartAdSDKNative,[f.$.YANDEX]:A.firstStartAdSDKYandex,[f.$.YASP]:A.firstStartAdSDKYasp,AD:A.firstStartAdSDK},w={[f.$.HLS]:A.yaFirstFrameDecodedHls,[f.$.MPD]:A.yaFirstFrameDecodedMpd,[f.$.MP4]:A.yaFirstFrameDecodedMp4,[f.$.NATIVE]:A.yaFirstFrameDecodedNative,[f.$.YANDEX]:A.yaFirstFrameDecodedYandex,[f.$.YASP]:A.yaFirstFrameDecodedYasp,AD:A.yaFirstFrameDecodedAdSDK},_={[f.$.HLS]:A.yaFirstFrameShownHls,[f.$.MPD]:A.yaFirstFrameShownMPD,[f.$.MP4]:A.yaFirstFrameShownMp4,[f.$.NATIVE]:A.yaFirstFrameShownNative,[f.$.YANDEX]:A.yaFirstFrameShownYandex,[f.$.YASP]:A.yaFirstFrameShownYasp,AD:A.yaFirstFrameShownAdSDK},k={[f.$.HLS]:g.firstNetworkHls,[f.$.MPD]:g.firstNetworkMpd,[f.$.MP4]:g.firstNetworkMp4,[f.$.NATIVE]:g.firstNetworkNative,[f.$.YANDEX]:g.firstNetworkYandex,[f.$.YASP]:g.firstNetworkYasp,AD:g.firstNetworkAdSDK},P={[f.$.HLS]:g.firstNetworkAdSDKHls,[f.$.MPD]:g.firstNetworkAdSDKMpd,[f.$.MP4]:g.firstNetworkAdSDKMp4,[f.$.NATIVE]:g.firstNetworkAdSDKNative,[f.$.YANDEX]:g.firstNetworkAdSDKYandex,[f.$.YASP]:g.firstNetworkAdSDKYasp,AD:g.firstNetworkAdSDK},I={[f.$.HLS]:g.setSourceNetworkHls,[f.$.MPD]:g.setSourceNetworkMpd,[f.$.MP4]:g.setSourceNetworkMp4,[f.$.NATIVE]:g.setSourceNetworkNative,[f.$.YASP]:g.setSourceNetworkYandex,[f.$.YANDEX]:g.setSourceNetworkYasp,AD:g.setSourceNetworkAdSDK},C={[f.$.HLS]:g.setSourceNetworkAdSDKHls,[f.$.MPD]:g.setSourceNetworkAdSDKMpd,[f.$.MP4]:g.setSourceNetworkAdSDKMp4,[f.$.NATIVE]:g.setSourceNetworkAdSDKNative,[f.$.YANDEX]:g.setSourceNetworkAdSDKYandex,[f.$.YASP]:g.setSourceNetworkAdSDKYasp,AD:g.setSourceNetworkAdSDK};let O=-1;const D={sourceStart:!1,yaFirstFrameDecoded:!1,yaFirstFrameShown:!1}},4458:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var i=r(1122),s=r(4942);class n extends i.V{constructor(e){super(),this.video=void 0,this.playbackQuality=s.oI,this.persistedPlaybackQuality=s.oI,this.accumulatedPlaybackQuality=s.oI,this.video=e,this.addDestroyHandler(()=>{this.reset(),this.video=void 0})}update(){if(!this.video)return;const e=(0,s.cd)(this.video);this.playbackQuality=e,0!==this.persistedPlaybackQuality.totalVideoFrames&&(this.persistedPlaybackQuality.totalVideoFrames>e.totalVideoFrames&&(this.accumulatedPlaybackQuality={droppedVideoFrames:this.accumulatedPlaybackQuality.droppedVideoFrames+this.persistedPlaybackQuality.droppedVideoFrames,corruptedVideoFrames:this.accumulatedPlaybackQuality.corruptedVideoFrames+this.persistedPlaybackQuality.corruptedVideoFrames,totalVideoFrames:this.accumulatedPlaybackQuality.totalVideoFrames+this.persistedPlaybackQuality.totalVideoFrames}),this.persistedPlaybackQuality=s.oI)}persist(){0!==this.playbackQuality.totalVideoFrames&&(this.persistedPlaybackQuality=this.playbackQuality,this.playbackQuality=s.oI)}reset(){this.playbackQuality=s.oI,this.persistedPlaybackQuality=s.oI,this.accumulatedPlaybackQuality=s.oI}getPlaybackQuality(){return this.persistedPlaybackQuality.totalVideoFrames>0?s.oI:{droppedVideoFrames:this.playbackQuality.droppedVideoFrames+this.accumulatedPlaybackQuality.droppedVideoFrames,corruptedVideoFrames:this.playbackQuality.corruptedVideoFrames+this.accumulatedPlaybackQuality.corruptedVideoFrames,totalVideoFrames:this.playbackQuality.totalVideoFrames+this.accumulatedPlaybackQuality.totalVideoFrames}}}},722:(e,t,r)=>{"use strict";function i(e){if(I(e.message))return w.x[e.message];if(I(e.code))return w.x[e.code];const t=g.y[e.code];return I(t)?w.x[t]:w.x.DEFAULT_ERROR}function s(e){if(void 0===e)return;const{id:t,label:r,language:i,bitrate:s}=e;return{name:r||i,value:t,lang:i||"",bitrate:s||void 0}}function n(e){const t=(0,h.w)(e.audioTracks).find(e=>e.enabled);return t?s(t):void 0}function a(e){return"subtitles"===e.kind&&e.label!==O.L}function o(e,t){if(void 0===e)return;const{id:r,label:i,language:s}=e;return{name:i||s,value:"undefined"!==typeof r&&""!==r?r:"index:"+t,lang:s||""}}function l(e){const t=[];return(0,h.w)(e).forEach(e=>{const r=s(e);r&&t.push(r)}),t}function d(e){const t=[];return(0,h.w)(e).forEach((e,r)=>{if(!a(e))return;const i=o(e,r);i&&t.push(i)}),t}r.d(t,{U:()=>Y});var c=r(2420),u=r(5386),h=r(7469),p=r(897),f=r(7187),m=r(6567),g=r(7554),v=(r(7881),r(4489)),y=r(3133),E=r(492),S=r(2843),A=r(3120),T=r(8468),b=r(6432),R=r(5921),w=r(7985);class _{static fromXHR(e){return new _(e)}constructor(e){this.status=void 0,this.status=e.status}isFatalError(){return this.isRegionLimitationError()||this.isSignatureExpiredError()||this.isBannedError()}toPlayerError(){return new R.u({code:this.getErrorCode(),isFatal:this.isFatalError(),details:JSON.parse((0,T.Y)(this))})}isRegionLimitationError(){return this.status===b.Ah}isSignatureExpiredError(){return b.PO.includes(this.status)}isBannedError(){return this.status===b.RR}getErrorCode(){return this.isRegionLimitationError()?w.x.REGIONAL_LIMITATION_MANIFEST:this.isSignatureExpiredError()?w.x.SIGNATURE_EXPIRED_MANIFEST:this.isBannedError()?w.x.BANNED_MANIFEST:w.x.DEFAULT_ERROR}}var k=r(8258),P=r(8833);const I=e=>(0,P.H)(e)&&(0,k.n)(w.x,e);var C=r(278),O=r(6976),D=r(10),N=r(1042),L=r(2150),M=r(7889),x=r(3219),V=r(9183),F=r(8107),U=r(6571),B=r(980),H=r(4651),j=r(7018);class Y extends M.L{subscribeVideoTracksChange(){this.addEventListener(this.video.videoTracks,"addtrack",()=>{this.emit("VideoTracksChange",(0,D.x)(this.video.videoTracks)),this.restoreUserVideoTrack()}),this.addEventListener(this.video.videoTracks,"removetrack",()=>{this.emit("VideoTracksChange",(0,D.x)(this.video.videoTracks))}),this.addEventListener(this.video.videoTracks,"change",()=>{const{videoHeight:e,videoWidth:t,videoTracks:r}=this.video,i=(0,B.Y)((0,U.s)({videoTracks:r,videoHeight:e,videoWidth:t}));this.emit("InternalVideoTrackValueChange",i&&i.value)})}subscribeAudioTracksChange(){this.addEventListener(this.video.audioTracks,"addtrack",e=>{this.emit("AudioTracksChange",l(this.video.audioTracks)),this.actualizeNativeAudioTrack(),this.restoreUserAudioTrack()}),this.addEventListener(this.video.audioTracks,"removetrack",()=>{this.emit("AudioTracksChange",l(this.video.audioTracks)),this.actualizeNativeAudioTrack()}),this.addEventListener(this.video.audioTracks,"change",e=>{this.actualizeNativeAudioTrack(),this.saveUserAudioTrack(e)})}subscribeTextTracksChange(){this.addEventListener(this.video.textTracks,"addtrack",()=>{this.emit("TextTracksChange",d(this.video.textTracks)),this.restoreUserTextTrack()})}initInternalSubscribe(){super.initInternalSubscribe(),this.subscribeVideoBuffering();const e=(0,u.I)(()=>{this.emit("VideoTracksChange",(0,D.x)(this.video.videoTracks)),this.emit("AudioTracksChange",l(this.video.audioTracks)),this.emit("TextTracksChange",d(this.video.textTracks));const{videoHeight:e,videoWidth:t,videoTracks:r}=this.video,i=(0,B.Y)((0,U.s)({videoTracks:r,videoHeight:e,videoWidth:t}));i&&this.emit("InternalVideoTrackValueChange",i.value),this.setFirstAudioTrack()});this.initTextTracks(),this.once("CanPlay",e),this.once("Destroy",()=>{this.off("CanPlay",e)}),this.video.videoTracks&&this.subscribeVideoTracksChange(),this.video.audioTracks&&this.subscribeAudioTracksChange(),this.video.textTracks&&this.subscribeTextTracksChange(),this.addVideoEventListener("progress",()=>{const{videoType:e}=this.state.controller;e!==H.Z.LIVE&&e!==H.Z.EVENT||this.emit("DvrChange")}),this.subscribeCueChange()}constructor(e){super(e),this.props=e,this.serverTimeEstimator=void 0,this.estimatorPollingInterval=void 0,this.isRecoverablePlaylistHTTPStatus=!0,this.checkPlaylistHTTPStatusPromise=void 0,this.applyStartPosition=()=>{if(!this.canSeek())return;const e=this.getCurrentTime(),t=this.getStartPosition();(0,f.z)(t)&&e!==t&&this.seekInternal(t)},this.saveUserAudioTrack=e=>{if(!e.isTrusted)return;const t=n(this.video);t&&this.playerStore.setUserAudioTrackParams({name:t.name||void 0,lang:t.lang||void 0})},this.actualizeNativeAudioTrack=()=>{const e=n(this.video);this.emit("InternalAudioTrackValueChange",e&&e.value)},this.notifyTextTracksChanged=()=>{const e=function(e,t){const{textTracks:r=[]}=e;for(let i=0;i<r.length;i++){const e=r[i];if(e&&a(e)&&e.mode===t)return o(e,i)}}(this.video,this.getVisibleTextTrackMode());this.emit("InternalTextTrackValueChange",e&&e.value)},this.playerStore.setIsAbrSupported(!0),this.stateController.putIsAbrEnabled(!0),this.serverTimeEstimator=new x.p,this.estimateLatency(),this.on("VideoTypeChange",e=>{this.startLatencyPolling(e)}),this.on("Detach",()=>this.stopLatencyPolling()),this.once("Destroy",()=>this.stopLatencyPolling())}getServerTime(){const e=this.serverTimeEstimator.getServerTime();return e||void 0}setAudioTrack(e){if(""===e.value)return;const t=(0,h.w)(this.props.video.audioTracks),r=t.find(t=>t.id===e.value);r&&t.forEach(e=>e.enabled=e.id===r.id)}setTextTrack(e){""!==e.lang&&this.renderTextTrack(e.lang)}disableTextTrack(){this.renderTextTrack(void 0)}renderTextTrack(e){(0,C.I)(this.video.textTracks).forEach((t,r)=>{t&&(o(t,r).lang===e?t.mode=this.getVisibleTextTrackMode():t.mode=this.getHiddenTextTrackMode())})}seekInternal(e){(0,L.O)(this.video,(0,c.u)(e,0,this.getDuration()||0))}getSeekableRange(){const e=this.video.seekable;return{start:e.start(0),end:e.end(e.length-1)}}getFragmentsData(){if(!this.isDvrEnabled()||!this.video||!this.video.seekable.length)return super.getFragmentsData();const{start:e,end:t}=this.getSeekableRange();return{totalDuration:t-e,fragmentDuration:S.D,startTime:e}}shouldSkipVideoTagError(e){return e.code!==g.y.MEDIA_ERR_DECODE&&e.code!==g.y.MEDIA_ERR_ENCRYPTED&&e.code!==g.y.MEDIA_ERR_SRC_NOT_SUPPORTED||(0,E.I)(this.state)}async onVideoTagError(){const e=(0,m.Q)(this.video);if(this.shouldSkipVideoTagError(e))return;this.video.poster=v.O,this.checkPlaylistHTTPStatus();const t=!this.recoverHelper.allowed||!this.isRecoverablePlaylistHTTPStatus,r=new R.u({code:i(e),details:e,isFatal:t});if(!t)return this.props.onError(r),void this.recoverHelper.planTask(()=>this.recoverStream(),{delay:500,reason:"VideoTagError ["+e.code+"]["+e.message+"]"});const s=await this.checkPlaylistHTTPStatusPromise;s&&s.isFatalError()?this.props.onError(s.toPlayerError()):this.props.onError(r)}onTick(e){super.onTick(e),this.isDvrEnabled()&&this.updateSkinDvrParameters(e)}async attachEncoder(){await super.attachEncoder();const e=e=>(this.props.onError(e),Promise.reject((0,A.e)(e.code,this.state.ad.adblockDetected)));if(this.engine===F.$.NATIVE&&!j.x)return e(new R.u({code:w.x.NATIVE_HLS_NOT_SUPPORTED_ERROR}));const{video:t}=this;this.subscribeContentImpression();try{await this.initDrm(this.props.stream.drmConfig)}catch(r){return e(R.u.from(r))}this.establishStartPosition(),this.initVideoTypeQualifier(),this.logLoadToRum(),(0,N.s)(t,()=>t.src=this.getStreamUrl()),this.startLatencyPolling(this.state.controller.videoType)}getStreamUrl(){const e=this.getStartPosition(),t=super.getStreamUrl();return(0,y.o)(t,e)}onOnline(){}onOffline(){}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}getStartPosition(){const{videoTime:e,utc:t}=this.state.controller.startPosition;if(!(0,f.z)(e)&&!(0,f.z)(t))return;const r=this.getUtcStartTime();return r>0&&(0,f.z)(t)&&t>0?t-r:(0,f.z)(e)?e:void 0}checkPlaylistHTTPStatus(){this.checkPlaylistHTTPStatusPromise||(this.checkPlaylistHTTPStatusPromise=this.loadPlaylistInfo().then(_.fromXHR).then(e=>(this.isRecoverablePlaylistHTTPStatus=!e.isFatalError(),e)).catch(()=>{}))}estimateLatency(){const e=(0,V.m)();(0,p.W)({url:this.getStreamUrl(),method:"HEAD",timeout:5e3}).then(t=>{this.serverTimeEstimator.parseServerTime({"x-server-time-ms":t.getResponseHeader("x-server-time-ms"),date:t.getResponseHeader("date")},(0,V.m)()-e)},()=>{})}startLatencyPolling(e){this.estimatorPollingInterval||e!==H.Z.EVENT&&e!==H.Z.LIVE||(this.estimatorPollingInterval=window.setInterval(()=>this.estimateLatency(),1e4))}stopLatencyPolling(){clearInterval(this.estimatorPollingInterval),this.estimatorPollingInterval=void 0}initTextTracks(){let e=!1,t=!1;const{textTracks:r}=this.video;if(!r)return;const i=(0,u.I)(()=>{this.castTextTracksModeOnInit(),this.addEventListener(r,"change",this.notifyTextTracksChanged),this.notifyTextTracksChanged()}),s=()=>{e&&t&&i()};this.addEventListener(this.video,"loadedmetadata",()=>{e=!0,s()}),this.addEventListener(r,"addtrack",function(e,t,r,i){function s(){null!==n&&clearTimeout(n),n=null}3===arguments.length&&"boolean"!==typeof r&&(i=r,r=!1);let n=null;const a=function(){const a=arguments;i=i||this,r&&null===n&&e.apply(i,a),s(),n=window.setTimeout((function(){r||e.apply(i,a),n=null}),t)};return a.cancel=s,a}(()=>{t=!0,s()},0))}setFirstAudioTrack(){this.restoreUserAudioTrack();const e=n(this.video);e&&this.emit("InternalAudioTrackValueChange",e.value)}loadPlaylistInfo(){return(0,p.W)({method:"GET",url:this.getStreamUrl()+"&xhr=1",timeout:3e3,checkStatus:()=>!0})}subscribeCueChange(){const{textTracks:e}=this.video;if(!e||"function"!==typeof e.addEventListener)return;const t=e=>{const t=e.track;t&&"metadata"===t.kind&&(t.mode="hidden",this.addEventListener(t,"cuechange",e=>{const{activeCues:t}=e.target,{length:r}=t;if(!r)return;const i=t[r-1];if(!i)return;const{value:s,startTime:n,endTime:a}=i;if(!s)return;const o="number"===typeof a&&isFinite(a)?a-n:S.D,l=(0,h.w)(t).map(e=>{if(e&&e.value){const{data:t}=e.value;if("string"===typeof t)return t}return""});this.emit("MetadataChange",{fragmentMetadataArray:l,fragmentStart:n,fragmentDuration:o,src:this.video.src})}))};e.addEventListener("addtrack",t),this.on("Destroy",()=>e.removeEventListener("addtrack",t))}castTextTracksModeOnInit(){if(this.state.skin.useNativeSubtitles)return;void 0!==(0,C.I)(this.video.textTracks).find(e=>Boolean(e&&"disabled"===e.mode))||(0,C.I)(this.video.textTracks).forEach(e=>{e&&(e.mode="showing"===e.mode?this.getVisibleTextTrackMode():this.getHiddenTextTrackMode())})}}},7889:(e,t,r)=>{"use strict";function i(e,t,r){void 0===t&&(t=T());let i=r;return function(r){if(!t(i,r))return i=r,e(r)}}function s(e){let{skin:{hiddenControls:t}}=e;return!t.includes(P.th.TIMELINE)}function n(e){const{watchedTime:t=0}=e;return t<15?15:Ee.o}function a(e){const{currentTime:t=0,skippableFragments:r}=e;if(!r)return Ee.o;const i=r.find(e=>t>=e.startTime&&t<e.endTime);if(i)return i.startTime,3;const s=r.find(e=>t<e.startTime);return s?s.startTime-t+x.D:Ee.o}function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function l(e,t,r){let{videoWidth:i,videoHeight:s}=e;const{width:n,height:a}=r;if(!i||!s)return{width:n,height:a};switch(t){case"none":return{width:i,height:s};case"cover":{const e=Math.floor(s*n/i);return e>=a?{width:n,height:e}:{height:a,width:Math.floor(i*a/s)}}case"contain":case"scale-down":{const e=Math.floor(s*n/i);return e<=a?{width:n,height:e}:{height:a,width:Math.floor(i*a/s)}}case"fill":default:return{width:n,height:a}}}function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{d:()=>Ie,L:()=>Ce});var c=r(3821);const u=function(){const{volume:e}=c.u;c.u.volume=0===e?1:0;const t=c.u.volume!==e;return c.u.volume=e,t}();var h=r(2420),p=r(9298),f=r(3945),m=r(5386),g=r(7469),v=r(4230),y=r(7304),E=r(5779),S=r(7746),A=(r(7881),r(6048)),T=r.n(A),b=r(6),R=r(4489),w=r(5636),_=r(4513),k=r(492),P=r(6538),I=r(4295),C=r(9004),O=r(8559),D=r(3117),N=r(267),L=r(9696),M=r(9507),x=r(2843),V=r(2613),F=r(1062),U=r(7382),B=r(675),H=r(9730),j=r(3486),Y=r(5210),W=r(6620),G=r(7182),K=r(2626),q=r(5595),z=r(55),X=r(9908);class Q{constructor(e){this.props=e,this.currentAttempt=0,this.recovering=!1,this.plannedTaskPromise=void 0,this.resetTimeoutId=0}get allowed(){return this.currentAttempt<10}get started(){return this.currentAttempt>0}get attempt(){return this.currentAttempt}getState(){return this.started?X.w.ON:X.w.OFF}planTask(e,t){let r,{reason:i,delay:s,force:n,rawData:a}=t;if(this.recovering&&!n)return this.log("Can't plan task cause is in process of recover"),void this.props.onConcurrentRecover({reason:i,rawData:a});this.clearPlannedTask("new task planned"),this.clearResetTimeout("new task planned"),"number"===typeof s?(r=(0,q.n)(s).promise.then(z.Z),this.log("#"+this.currentAttempt+", PLAN task, "+s+"ms, ["+i+"]",a)):(r=s,this.log("#"+this.currentAttempt+", PLAN async task, ["+i+"]",a)),(0,v.v)(r),r.then(()=>{if(r===this.plannedTaskPromise)return this.recovering=!0,this.currentAttempt++,this.props.onRunTask({reason:i,delay:s,rawData:a,attempt:this.currentAttempt}),this.log("#"+this.currentAttempt+", RUN task, ["+i+"]",a),this.clearPlannedTask(),e()}).catch(e=>{this.log("Error while recover",e),this.props.onRecoverError({reason:i,rawData:a},e)}).then(()=>{this.recovering=!1}),this.plannedTaskPromise=r}isRecovering(){return this.recovering}planReset(e){let{reason:t,delay:r}=e;this.log("plan RESET, "+r+"ms, if ["+t+"]"),this.clearResetTimeout("new reset planned"),this.resetTimeoutId=window.setTimeout(()=>{this.reset(t)},r)}destroy(){this.reset("destroy")}reset(e){this.props.onReset(),this.log("RESET because of ["+e+"]"),this.clearPlannedTask(),this.clearResetTimeout(),this.currentAttempt=0}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];G.Y.log("RecoverHelper:",...t)}clearPlannedTask(e){e&&this.log("CLEAR planned TASKS because of ["+e+"]"),this.plannedTaskPromise=void 0}clearResetTimeout(e){e&&this.log("CLEAR planned RESET because of ["+e+"]"),0!==this.resetTimeoutId&&(clearTimeout(this.resetTimeoutId),this.resetTimeoutId=0)}}var Z=r(278),J=r(2523),$=r(6213),ee=r(4980),te=r(893),re=r(8024),ie=r.n(re),se=r(9583);var ne=r(35),ae=r(7553),oe=r(4343),le=r(4942);class de{constructor(e){void 0===e&&(e={}),this.timeMeasurer=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.totalDecodedFrames=0,this.totalDroppedFrames=0,this.lastVideoWidth=void 0,this.lastVideoHeight=void 0,this.maxWidth=1/0,this.maxHeight=1/0,this.props=void 0,this.props=e}setRestrictions(e,t){var r,i;e>=this.maxWidth&&t>=this.maxHeight||t<360||(this.maxWidth=e,this.maxHeight=t,G.Y.warn("FPSController changed restrictions: "+e+"\xd7"+t+"."),null==(r=(i=this.props).onRestrictionsChange)||r.call(i,{decodedFrames:this.totalDecodedFrames,droppedFrames:this.totalDroppedFrames,maxWidth:e,maxHeight:t}))}getRestrictions(){return{maxWidth:this.maxWidth,maxHeight:this.maxHeight}}update(e){if(!e.videoWidth||!e.videoHeight)return;const t=(0,le.cd)(e);this.checkFPS(e.videoWidth,e.videoHeight,t.totalVideoFrames,t.droppedVideoFrames)}checkFPS(e,t,r,i){!this.timeMeasurer||!r||this.lastVideoWidth!==e||this.lastVideoHeight!==t||r<this.lastDecodedFrames?(this.timeMeasurer=(0,oe.u)(),this.totalDecodedFrames=0,this.totalDroppedFrames=0):(this.totalDroppedFrames+=i-this.lastDroppedFrames,this.totalDecodedFrames+=r-this.lastDecodedFrames,this.timeMeasurer()>5e3&&this.totalDroppedFrames>.25*this.totalDecodedFrames&&this.setRestrictions(e,t)),this.lastDecodedFrames=r,this.lastDroppedFrames=i,this.lastVideoWidth=e,this.lastVideoHeight=t}}var ce=r(2150);class ue{constructor(e,t){this.win=e,this.callback=t,this.started=!1,this.intervalId=0,this.getDiff=(0,oe.u)()}start(){this.started||(this.started=!0,this.getDiff=(0,oe.u)(),this.intervalId=this.win.setInterval(()=>{const e=this.getDiff();this.getDiff=(0,oe.u)(),this.callback(e)},100))}stop(){this.started&&(this.started=!1,this.win.clearInterval(this.intervalId))}}var he=r(3664),pe=r(2905),fe=r(3211);const me=null===c.u.onwaiting;var ge=r(6040);const ve=!me||pe.w||fe.$?(e,t)=>{let r=0,i=!1;return(0,E.X)(()=>{const s=e.currentTime,n=e.duration,a=1/ge.Xr;if(!e.paused){const e=r+a;i?s>e&&(t(!1),i=!1):s<e&&s!==n&&(t(!0),i=!0)}r=s})}:(e,t)=>{let r=!1;const i=(0,f.O)(e,"waiting",()=>{r||(r=!0,t(!0))},{passive:!0}),s=(0,f.O)(e,"playing",()=>{r&&(r=!1,t(!1))},{passive:!0}),n=(0,f.O)(e,"canplay",()=>{r&&(r=!1,t(!1))},{passive:!0});return()=>{i(),s(),n()}};var ye=r(4651),Ee=r(3034);class Se{constructor(e){this.props=void 0,this.bufferGoalFilters=[n,a],this.props=e}getBufferGoal(e){const{watchedTime:t=0,currentTime:r=0}=e,i=o({},this.props,{watchedTime:t,currentTime:r});return this.bufferGoalFilters.reduce((e,t)=>Math.min(t(i),e),Ee.o)}}var Ae=r(9591),Te=r(4159),be=r(2786),Re=r(3942);class we{constructor(e){this.props=e,this.video=void 0,this.videoSizeSensor=void 0,this.defaultQuality=void 0,this.getPipWindowSize=void 0;const{video:t,videoSizeSensor:r,defaultQuality:i,getPipWindowSize:s}=this.props;this.video=t,this.videoSizeSensor=r,this.defaultQuality=i,this.getPipWindowSize=s}getCapSizes(){var e;const t=null!=(e=this.getPipWindowSize())?e:l(this.video,this.props.objectFit||"contain",this.videoSizeSensor.getSize()),r=t.height>t.width,i=(0,Te.dg)(this.props.from),s=(0,be.R)(),n=null!==this.defaultQuality,a=(0,Re.R)(this.defaultQuality),o=(i&&n?Math.max(screen.height,t.height):t.height)*devicePixelRatio,d=(i&&n?Math.max(screen.width,t.width):t.width)*devicePixelRatio,c=r||i?o:Math.min(o,a),u=r&&!i?Math.min(d,a):d,h=!r&&s?Ae.T:1/0;return{width:u,height:c,maxWidth:r&&s?Ae.T:1/0,maxHeight:h}}}var _e=r(5921),ke=r(7985),Pe=r(7568);const Ie=0;class Ce extends _.M{get state(){return this.playerStore.getState()}get fragDuration(){return this.getFragmentsData().fragmentDuration}get isDestroyed(){return this.destroyed}async requestDebugInfo(){return{notImplemented:!0}}constructor(e){var t;super(),this.props=e,this.engine=void 0,this.recoverHelper=void 0,this.video=void 0,this.wasPausedAfterQualityChanged=!1,this.currentTextTrack=void 0,this.withCredentials=!1,this.playerStore=void 0,this.stateController=void 0,this.currentState=void 0,this.videoTrackLabels=new Map,this.previousScreenshotBlobUrl=void 0,this.destroy=(0,m.I)(()=>(this.destroyed=!0,this.destroyUnsafe())),this.destroyed=!1,this.tickController=void 0,this.fpsController=new de({onRestrictionsChange:e=>{this.props.logEvent({event:"FPSControllerRestrictions",params:e})}}),this.currentSubtitles=[],this.bandwidthEstimateUpdateInterval=null,this.bufferGoalManager=void 0,this.preventPauseState=void 0,this.playDeferred=void 0,this.sizeCapper=void 0,this.isPauseHandlerCalled=void 0,this.longStalledRecoverInfo=null,this.restoreUserTracks=()=>{this.restoreUserTextTrack(),this.restoreUserAudioTrack(),this.restoreUserVideoTrack()},this.refreshSubtitles=()=>{try{if(!this.video)return;const e=this.getCurrentTextTrack(),t=e?(0,g.w)(e.activeCues).filter(e=>e&&e.text).map(e=>{let{text:t}=e;return t}):[];T()(this.currentSubtitles,t)||(this.currentSubtitles=t,this.props.onSubtitlesChange(t))}catch(e){this.props.onError(_e.u.from(e,{code:ke.x.REFRESH_SUBTITLES_ERROR,isFatal:!1}))}},this.disableSubtitlesNative=()=>{this.video&&(0,Z.I)(this.video.textTracks).forEach(e=>{e&&(e.mode="disabled")})},this.emptySubtitles=()=>{this.currentSubtitles.length>0&&(this.currentSubtitles=[],this.props.onSubtitlesChange([]))},this.handleConcurrentRecover=e=>{this.props.logEvent({event:"ConcurrentRecoverCalled",params:e})},this.handleRecoverError=(e,t)=>{this.props.onError(new _e.u({code:ke.x.RECOVER_TASK_ERROR,isFatal:!1,details:e,stack:null==t?void 0:t.stack}))},this.setMaxListeners(42),this.isPauseHandlerCalled=this.props.video.paused,this.recoverHelper=new Q({onRunTask:this.props.onRecover,onReset:()=>this.playerStore.setControllerStateField(L.jY.lastRecoverPosition,void 0),onConcurrentRecover:this.handleConcurrentRecover,onRecoverError:this.handleRecoverError}),this.on("Destroy",()=>this.recoverHelper.destroy());const{video:r,playerStore:i,sourceParams:s,stateController:n}=this.props;this.video=r,this.playerStore=i,this.stateController=n,this.setLoop(Boolean(e.sourceParams.loop)),this.withCredentials=Boolean(e.sourceParams.withCredentials),this.setPoster(s.preview),this.updateNativeControlsVisibility();const a=this.playerStore.getState().controller.preload||p.g;r.setAttribute("preload",a?"auto":"none");const o=(0,f.O)(r,"loadstart",()=>this.video.style.opacity="1");this.on("Destroy",o),this.tickController=new ue(window,e=>{try{this.onTick(e)}catch(t){this.props.onError(_e.u.from(t,{code:ke.x.ON_TICK_ERROR,isFatal:!1}))}}),this.on("Destroy",()=>this.tickController.stop()),this.on("InternalPlayingStateChange",this.updateBufferGoal),Promise.resolve().then(()=>{this.initInternalSubscribe()}),this.bufferGoalManager=new Se({skippableFragments:e.sourceParams.skippableFragments}),this.sizeCapper=new we({video:this.video,fpsController:this.fpsController,videoSizeSensor:this.props.videoSizeSensor,getPipWindowSize:this.props.getPipWindowSize,from:this.state.controller.from,defaultQuality:this.props.defaultQuality,objectFit:null==(t=this.state.controller.videoElementStyle)?void 0:t.objectFit})}initInternalSubscribe(){this.on("VideoPlayingStateChange",e=>{if(e!==S.X.END||(0,k.I)(this.state)){if(e===S.X.PLAY&&!(0,k.I)(this.state)){const e=this.fragDuration<=x.D*V.O?1e3*this.fragDuration:1e3*x.D;this.recoverHelper.planReset({delay:e,reason:"no new errors for "+e+"ms"})}}else this.recoverHelper.reset("onPlayingStateChange ["+S.X.END+"]")}),this.on("InternalPlayingStateChange",e=>{const{encoderState:t}=this.state.controller;(t===B.y.Attaching||t===B.y.Attached)&&this.currentState!==e&&(this.isBufferingOnPreload(e)||this.currentState===S.X.END&&this.video.paused||(this.currentState=e,this.emit("VideoPlayingStateChange",e)))}),this.on("CurrentTimeChange",e=>{const t=this.getDuration(),{videoType:r}=this.state.controller;e>=t&&t>0&&r===ye.Z.VOD&&!this.props.sourceParams.loop&&this.emit("InternalPlayingStateChange",S.X.END)}),this.on("InternalVideoTrackValueChange",i(e=>{this.emit("VideoTrackValueChange",e)})),this.on("InternalAudioTrackValueChange",i(e=>{this.emit("AudioTrackValueChange",e)})),this.on("InternalTextTrackValueChange",i(e=>{this.emit("TextTrackValueChange",e)})),this.subscribeYabroRum(),this.addVideoEventListener("playing",()=>this.handleVideoElementPlayEvent()),this.addVideoEventListener("loadedmetadata",()=>{this.emit("DurationChange",this.getDuration())}),this.addVideoEventListener("play",()=>{this.isPauseHandlerCalled=!1}),this.addVideoEventListener("seeked",()=>{this.emit("Seeked")});let e=this.video.playbackRate;this.addVideoEventListener("ratechange",()=>{const t=this.video.playbackRate,r=this.state.controller.playbackRate;if(e===t)return;const i=e;e=t,(0,k.I)(this.state)||this.recoverHelper.isRecovering()||0===t||t===r||(0===i&&t!==r?this.setPlaybackRate(r):t!==this.state.controller.playbackRate&&this.stateController.putPlaybackRate(t))}),this.addVideoEventListener("pause",()=>this.onPause()),this.addVideoEventListener("progress",()=>{(0,k.I)(this.state)||this.emit("BufferingRangesChange",(0,M.e)(this.props.video))}),this.addVideoEventListener("canplay",()=>{this.emit("CanPlay",void 0)}),this.addVideoEventListener("ended",()=>{const{videoType:e}=this.playerStore.getState().controller;e===ye.Z.VOD||void 0===e?this.emit("InternalPlayingStateChange",S.X.END):this.video.paused&&G.Y.warn('Pause stream after "ended" event on LIVE stream')}),this.addVideoEventListener("loadeddata",()=>{this.emit("LoadedData",void 0)}),this.addVideoEventListener("error",e=>this.onVideoTagError(e)),this.handleSubtitles(),this.addVideoEventListener("timeupdate",()=>{(0,k.I)(this.state)||this.state.controller.playingState===S.X.PAUSE||this.fpsController.update(this.video)}),this.addVideoEventListener("durationchange",()=>{(0,k.I)(this.state)||this.dispatchOnDurationChange()}),this.on("DvrChange",()=>this.updateDVRParams())}async play(){if(this.preventPauseState)return this.preventPauseState=d({},this.preventPauseState,{shouldPlayAfterEnd:!0}),G.Y.log("play method call during preventPauseAsync operation"),this.playDeferred||(this.playDeferred=new w.B,this.playDeferred.promise.catch(z.Z).then(()=>this.playDeferred=void 0)),this.playDeferred.promise;await this.playInternal()}getVideoElementSizes(){var e,t;return d({},null!=(e=this.props.getPipWindowSize())?e:l(this.video,(null==(t=this.state.controller.videoElementStyle)?void 0:t.objectFit)||"contain",this.props.videoSizeSensor.getSize()),{dpi:"undefined"!==typeof devicePixelRatio?devicePixelRatio:1})}getFragmentsData(){return{totalDuration:this.getDuration(),fragmentDuration:x.D,startTime:0}}getUtcStartTime(){return Ie}getUtcPosition(){return Ie}async attachEncoder(){this.tickController.start(),this.bandwidthEstimateUpdateInterval=window.setInterval(()=>{this.stateController.putLastKnownBandwidthEstimate(this.getBandwidthEstimate()),(0,se.J)(this.getBandwidthEstimate())},5e3),"defaultPlaybackRate"in this.video&&(this.video.defaultPlaybackRate=this.state.controller.playbackRate);const e=new ee.$(this.video,()=>{this.onVideoResize()});this.once("Detach",()=>e.destroy())}onVideoTagError(e){!this.video.src&&!(0,k.I)(this.state)&&(this.video.style.opacity="0")}captureScreenshot(e){return Promise.resolve(void 0)}clearScreenshot(){this.previousScreenshotBlobUrl&&(URL.revokeObjectURL(this.previousScreenshotBlobUrl),this.previousScreenshotBlobUrl=void 0)}seek(e){if(!this.canSeek())return void this.playerStore.setControllerStateField(L.jY.startPosition,{videoTime:e});this.playerStore.setControllerStateField(L.jY.lastRecoverPosition,void 0);const{start:t,end:r}=this.getSeekableRange(),{currentTime:i,bufferingRanges:s}=this.state.controller,n=(0,h.u)(e,t,r);void 0===(0,Y.k)(s,n)&&this.props.onExpectedStalledChange({reason:H.k.Seek,details:{oldPosition:i,newPosition:n}}),(0,ce.O)(this.video,n),this.emit("CurrentTimeChange",this.getCurrentTime())}setPlaybackRate(e){const t=this.video.playbackRate;if(t===e)return;this.video.playbackRate=e;const r=this.video.playbackRate;r!==t&&this.stateController.putPlaybackRate(r)}getUtcEndTime(){return 0}static isLiveStreamUrl(e){return e.startsWith("https://strm.yandex.ru/live/")||e.startsWith("https://streaming.tst.strm.yandex.net/live/")}updateNativeControlsVisibility(){const e=!(0,b.p)(this.state.skin.hiddenControls)&&(this.state,!0);this.playerStore.setSkinStateField(L.rE.nativeControlsVisibility,e),(0,y.K)(this.video,{controls:e?"controls":null}),this.video.classList.toggle(ie().video_hiddenControls,!e),this.setNativeTimeControlVisibility(s(this.state)),this.setNativeTimelineControlVisibility(s(this.state))}detachEncoder(){if(this.tickController.stop(),this.state.controller.encoderState===B.y.Attached){const e=this.getBandwidthEstimate();this.stateController.putLastKnownBandwidthEstimate(e),(0,se.J)(e)}return null!==this.bandwidthEstimateUpdateInterval&&clearInterval(this.bandwidthEstimateUpdateInterval),this.emit("BufferingRangesChange",[]),this.emit("InternalVideoTrackValueChange",void 0),this.emit("InternalAudioTrackValueChange",void 0),this.emit("InternalTextTrackValueChange",void 0),this.emit("Detach",void 0),"defaultPlaybackRate"in this.video&&(this.video.defaultPlaybackRate=1),Promise.resolve()}async preloadSource(){G.Y.log("preloadSource() is not implemented for "+this.engine)}createCachePreloader(){}setLoop(e){const{video:t}=this.props,{loop:r}=this.video;e!==r&&(t.loop=e)}isPaused(){return this.props.video.paused}pause(){var e;this.recoverHelper.reset("pause"),this.props.video.pause(),this.onPause(),null==(e=this.playDeferred)||e.reject(new Error("playing rejected cause of #pause()"))}getDuration(){return this.video.duration}getCurrentTime(){return Math.floor(1e3*this.props.video.currentTime)/1e3}getVideoWidth(){return this.video.videoWidth}getVideoHeight(){return this.video.videoHeight}setVolume(e){!function(e){return"number"===typeof e&&W.d<=e&&e<=W._}(e)?G.Y.warn("setVolume wrong value"):u?this.video.volume=e:G.Y.warn("cannot change video volume")}getVolume(){return this.video.volume}setMuted(e){this.video.muted=e}getMuted(){return this.video.muted}setPoster(e){this.state.skin.nativeControlsVisibility&&(this.removePoster(),this.props.video.setAttribute("poster",e||R.O))}removePoster(){this.props.video.removeAttribute("poster")}isDvrEnabled(){return!0}toggleNativeSubtitles(e){const t=this.state.skin.useNativeSubtitles;if(t===e)return;const r=(0,$.L)(t),i=(0,$.L)(e),s=(0,J.l)();this.playerStore.setSkinStateField(L.rE.useNativeSubtitles,e),(0,Z.I)(this.video.textTracks).forEach((e,t)=>{e&&(e.mode=r===e.mode?i:s)})}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}getRecoverHelperState(){return this.recoverHelper.getState()}getContainerSize(){const e=this.getVideoElementSize();return{width:e.width*devicePixelRatio,height:e.height*devicePixelRatio}}getCapSizes(){return this.sizeCapper.getCapSizes()}getMaxCapAllowedVideoTrack(){}getRemainingBufferedTime(){return{total:(0,C.r)(this.state)||0}}getBandwidthEstimate(){return(0,ae.L)(this.playerStore.getState())}async recoverStream(e){void 0===e&&(e=!1);const t=this.getPositionToRecover();this.playerStore.setControllerStateField(L.jY.startPosition,e?{}:t),await this.detachEncoder(),await this.attachEncoder()}getLiveLatency(){if(!this.isLiveStreaming())return;const e=this.getUtcPosition(),t=this.getServerTime();return e>0&&void 0!==t?Math.max(t/1e3-e,0):void 0}getServerTime(){}getPlayingState(){return this.currentState}isLiveStreaming(){const{state:e}=this;if(!(0,he.x)(e)||(0,k.I)(e))return!1;const{controller:{playingState:t,currentTime:r,duration:i}}=e;return!(t!==S.X.PLAY&&t!==S.X.BUFFERING)&&!(0===r||!i)}subscribeVideoBuffering(){const{video:e}=this,t=ve(e,t=>{const r=(0,ne.k)(e,t);this.isStalledLiveEdge(r)?this.props.onExpectedStalledChange({reason:H.k.LiveEdge,details:void 0}):this.isRender(r)&&this.props.onExpectedStalledChange({reason:H.k.Render,details:{}}),this.emit("InternalPlayingStateChange",r)});this.once("Destroy",t)}updateVideoSize(){const{videoWidth:e,videoHeight:t}=this.video;this.state.controller.videoWidth===e&&this.state.controller.videoHeight===t||this.stateController.putVideoSize({videoWidth:e,videoHeight:t})}isRender(e){if(e!==S.X.BUFFERING)return!1;const{controller:{bufferingRanges:t,currentTime:r}}=this.state,i=(0,Pe.p)(t,r);return!!i&&i>1}isStalledLiveEdge(e){const{video:t}=this,{controller:{videoType:r}}=this.state,i=e===S.X.BUFFERING,s=r===ye.Z.EVENT||r===ye.Z.LIVE,n=t.seekable.length>0&&t.seekable.end(0)-t.currentTime<2.5;return i&&s&&n}getPositionToRecover(){const{programDateTime:e,currentTime:t,startPosition:r}=this.state.controller;return t?{utc:void 0===e?void 0:e/1e3+t,videoTime:t}:r}subscribeContentImpression(){this.once("Detach",function(e,t){const r=(0,f.O)(e,"timeupdate",()=>{e.currentTime>0&&!e.paused&&(s(),t())}),i=(0,f.O)(e,"playing",()=>{e.duration>0&&(s(),t())}),s=()=>{r(),i()};return s}(this.video,()=>{this.emit("ContentImpression",void 0)}))}onTick(e){const t=this.getCurrentTime();t===this.state.controller.currentTime&&0!==t||this.emit("CurrentTimeChange",t),this.video.paused&&this.currentState===S.X.PLAY&&!this.wasPausedAfterQualityChanged&&this.state.controller.encoderState!==B.y.Attaching&&this.state.controller.playingState!==S.X.PAUSE&&this.emit("InternalPlayingStateChange",S.X.PAUSE),this.setPlaybackRateCatchup(),this.planRecoverCauseLongStalled()}planRecoverCauseLongStalled(){if(this.state.controller.playingState!==S.X.BUFFERING||this.state.controller.encoderState!==B.y.Attached)return void(this.longStalledRecoverInfo=null);if(this.engine!==j.$.NATIVE)return;if(null===this.longStalledRecoverInfo)return void(this.longStalledRecoverInfo={getTime:(0,oe.u)(),planned:!1});if(this.longStalledRecoverInfo.planned)return;const e=4*this.getFragmentsData().fragmentDuration;isNaN(e)||this.longStalledRecoverInfo.getTime()>1e3*e&&(this.longStalledRecoverInfo.planned=!0,this.recoverHelper.planTask(()=>this.recoverStream(!0),{delay:0,reason:"Stalled longer than 4 segments."}))}addVideoEventListener(e,t,r){let{once:i}=void 0===r?{}:r,s=t;const{video:n}=this,a=()=>{n.removeEventListener(e,s)};return i&&(s=e=>{this.off("Destroy",a),a(),t.call(n,e)}),this.on("Destroy",a),this.video.addEventListener(e,s),a}addEventListener(e,t,r,i){const s=(0,f.O)(e,t,r,i);this.once("Destroy",s)}getSeekableRange(){return{start:0,end:this.getDuration()||0}}setNativeTimeControlVisibility(e){this.video.classList.toggle(ie().video_hiddenTime,!e)}setNativeTimelineControlVisibility(e){this.video.classList.toggle(ie().video_hiddenTimeline,!e)}getVisibleTextTrackMode(){return(0,$.L)(this.state.skin.useNativeSubtitles)}getHiddenTextTrackMode(){return(0,J.l)()}getCurrentTextTrack(){if(!this.video)return;const e=this.getVisibleTextTrackMode();return(0,Z.I)(this.video.textTracks).find(t=>void 0!==t&&t.mode===e)}restoreUserTextTrack(){const{userTextTrackEnabled:e}=this.state.controller;if(void 0!==e)if(e){const e=function(e){const{userTextTrackName:t,userTextTrackLang:r,textTracks:i}=e.controller;return(0,D.Y)(i,{name:t,lang:r})}(this.state);e&&this.setTextTrack(e)}else this.disableTextTrack()}restoreUserAudioTrack(){const e=function(e){const{userAudioTrackName:t,userAudioTrackLang:r,audioTracks:i}=e.controller;return(0,O.x)(i,{name:t,lang:r})}(this.playerStore.getState());e&&(G.Y.log("Set audio track by user params audioTrack=["+JSON.stringify(e)+"]"),this.setAudioTrack(e))}restoreUserVideoTrack(){const e=function(e){const{videoTracks:t,userVideoTrackName:r,userVideoTrackHeight:i}=e.controller;return(0,N.G)(t,{name:r,height:i})}(this.playerStore.getState());e&&(G.Y.log("Set video track by user params videoTrack=["+JSON.stringify(e)+"]"),this.setVideoTrack(e))}updateSkinDvrParameters(e){const t=e/1e3,{skin:{skinDVRStartTime:r,skinDVRDuration:i},controller:{videoType:s,dvrDuration:n,duration:a}}=this.state;if(s===ye.Z.LIVE){const e=Math.min(r+t,a||0);this.playerStore.setSkinStateField(L.rE.skinDVRStartTime,e),this.emit("DVRStartTimeChange",e)}else if(s===ye.Z.EVENT){const e=Math.min(i+t,n);this.playerStore.setSkinStateField(L.rE.skinDVRDuration,e),this.emit("DVRDurationChange",e)}}async destroyUnsafe(){this.emit("Destroy",void 0),await this.detachEncoder(),super.destroy();const{error:e}=this.state.controller.errorInfo;e&&e.isFatal&&this.video.src&&this.video.removeAttribute("src")}async preventPauseAsync(e,t){const{paused:r}=e,i=t();this.preventPauseState||(this.preventPauseState={promises:[],shouldPlayAfterEnd:!r}),this.preventPauseState.promises.push(i);const s=await i;if(this.preventPauseState){const e=this.preventPauseState.promises.length;Promise.all(this.preventPauseState.promises).catch(z.Z).then(()=>{this.preventPauseState&&e===this.preventPauseState.promises.length&&(this.preventPauseState.shouldPlayAfterEnd&&(0,v.v)(this.playInternal()),this.preventPauseState=void 0)})}return s}getVideoOwnerDocument(){return this.video.ownerDocument||document}logLoadToRum(){(0,U.Fw)(this.engine,this.state.ad.adSyncInit)}subscribeYabroRum(){this.once("Detach",this.addVideoEventListener("firstframedecoded",()=>{(0,U.CN)(this.engine,{},this.state.ad.adSyncInit)},{once:!0})),this.once("Detach",this.addVideoEventListener("firstframeshown",()=>{(0,U.qB)(this.engine,{},this.state.ad.adSyncInit)},{once:!0}))}getStreamUrl(){return this.props.stream.url}shouldUseLowBuffer(){const{startStage:e,autoplay:t,preload:r,feed:i}=this.state.controller;return!(!this.video.paused||!i)||e!==F.o.started&&!t&&r}isBufferingOnPreload(e){if(e!==S.X.BUFFERING)return!1;if(!this.state.controller.preload)return!1;const{startStage:t}=this.state.controller;return t!==F.o.started&&(t!==F.o.starting&&(t!==F.o.init||!this.state.controller.initialAutoplay||!this.state.controller.autoplay))}getMaxBufferLength(){return this.shouldUseLowBuffer()?te.s:this.bufferGoalManager.getBufferGoal({watchedTime:this.state.controller.watchedTime,currentTime:this.getCurrentTime()})}handleVideoElementPlayEvent(){this.video.paused||(this.wasPausedAfterQualityChanged=!1,this.emit("InternalPlayingStateChange",S.X.PLAY))}updateBufferGoal(){}isLowLatencyLive(){return!1}onVideoResize(){this.updateVideoSize()}onPause(){this.video.paused&&(this.isPauseHandlerCalled||(this.isPauseHandlerCalled=!0,this.wasPausedAfterQualityChanged||this.video.ended||this.getCurrentTime()>=this.getDuration()||this.emit("InternalPlayingStateChange",S.X.PAUSE)))}calculateDVRParams(){const{fragmentDuration:e,startTime:t,totalDuration:r}=this.getFragmentsData();return{fragmentDuration:e,dvrDuration:r,dvrStartTime:t,skinDVRDuration:r,skinDVRStartTime:t}}updateDVRParams(){const{fragmentDuration:e,dvrStartTime:t,dvrDuration:r,skinDVRStartTime:i,skinDVRDuration:s}=this.calculateDVRParams();this.playerStore.setControllerStateField(L.jY.fragmentDuration,e);const{dvrDuration:n,dvrStartTime:a}=this.state.controller;T()(n,r)||(this.playerStore.setControllerStateField(L.jY.dvrDuration,r),this.playerStore.setSkinStateField(L.rE.skinDVRDuration,s),this.emit("DVRDurationChange",s)),T()(a,t)||(this.playerStore.setControllerStateField(L.jY.dvrStartTime,t),this.playerStore.setSkinStateField(L.rE.skinDVRStartTime,i),this.emit("DVRStartTimeChange",i))}setPlaybackRateCatchup(){const e=(0,I.R)(this.state,this.getRemainingBufferedTime(),this.getLiveLatency());void 0!==e&&this.isLowLatencyLive()&&this.setPlaybackRate(e)}getVideoElementSize(){var e;const t=this.props.videoSizeSensor.getSize();return null!=(e=this.props.getPipWindowSize())?e:{width:t.width,height:t.height}}handleSubtitles(){const{textTracks:e}=this.video;e&&"function"===typeof e.addEventListener&&(this.on("Destroy",(0,f.O)(e,"addtrack",e=>{const t=e.track;t&&"subtitles"===t.kind&&this.on("Destroy",(0,f.O)(t,"cuechange",this.refreshSubtitles))})),this.on("TextTrackValueChange",e=>{void 0===e?this.emptySubtitles():this.refreshSubtitles()}),this.on("Destroy",(0,E.X)(this.refreshSubtitles)),this.on("Detach",this.disableSubtitlesNative))}dispatchOnDurationChange(){const e=this.getDuration();isNaN(e)||this.state.controller.duration!==e&&this.emit("DurationChange",e)}playInternal(){const e=(0,K.b)(this.video);return e.then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()}).catch(e=>{var t;-1!==String(e).indexOf("no supported sources")&&this.props.onError(new _e.u({code:ke.x.UNSUPPORTED_MEDIA_TYPE,isFatal:!0})),null==(t=this.playDeferred)||t.reject(e)}),e.then(z.Z)}shouldLogStalledDebugInfo(){return!1}}},6140:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{D:()=>Q});var n=r(722),a=r(3486),o=r(2150),l=(r(7881),r(2420)),d=r(675),c=r(4489),u=r(5355),h=r(980),p=r(6571),f=r(7187);var m=r(4651),g=r(35),v=r(8835),y=r(6902),E=r(7182),S=r(2102),A=r(7469),T=r(3945),b=r(418),R=r(7985),w=r(228),_=r(9841),k=r(10),P=r(4885),I=r(1091),C=r(9696),O=r(2843),D=r(5921),N=r(7746),L=r(4893),M=r(6636),x=r(1122),V=r(7922),F=r(4956),U=r(1610),B=r(874),H=r(7675),j=r(9010),Y=r(3770),W=r(8833),G=r(5595),K=r(6533);class q extends x.V{constructor(e,t,r){super(),this.video=e,this.config=t,this.session=void 0,this.initPromise=void 0,this.currentDrmKeySystem=w.W.none,this.keySystem=void 0,this.onError=void 0,this.onError=e=>{this.isDestroyed||(e.isFatal&&this.destroy(),r(e))},this.addEventListener(this.video,"encrypted",e=>{this.onEncrypted(e.target)},{once:!0}),this.keySystem=null}async getMediaKeySessionInitData(){return Promise.resolve({})}async loadCertificate(e){if(e)try{const{response:t}=await this.requestDrmProxy({method:"get",responseType:"arraybuffer",url:e,withCredentials:this.config.withCredentials});return t}catch(t){const e=D.u.from(t);this.onError(new D.u(i({},e.toJSON(),{code:"DRM_CERT_LOAD_ERROR",message:"Failed to get certificate via direct link: "+e,isFatal:!1})))}return new Uint8Array(0)}async init(){return this.initPromise||(this.initPromise=this.initInternal()),this.initPromise}async initInternal(){var e,t,r;if(this.currentDrmKeySystem!==w.W.none)return;if(!this.video)return;if(this.keySystem=null!=(e=this.config.servers)&&e[V.Ql]?V.Ql:null!=(t=this.config.servers)&&t[V.xE]?V.xE:null,!this.keySystem)return void this.onError(new D.u({code:"DRM_NO_SUPPORTED_KEY_SYSTEM",message:"No supported drm server specified",isFatal:!0}));if(this.video.mediaKeys)return;const{serverCertificateUrl:i}=(null==(r=this.config.advanced)?void 0:r[this.keySystem])||{},s=this.loadCertificate(i);let n;try{const e=await window.navigator.requestMediaKeySystemAccess(this.keySystem,F._);n=await e.createMediaKeys()}catch(o){const e=(0,Y.K)(o)?o.message:(0,W.H)(o)?o:"";return void this.onError(D.u.from(o,{code:"DRM_FAILED_TO_CREATE_CDM",message:"Failed to create mediaKeys: "+e,isFatal:!0}))}try{if(this.isDestroyed)return;await this.video.setMediaKeys(n)}catch(o){const e=(0,Y.K)(o)?o.message:(0,W.H)(o)?o:"";return void this.onError(D.u.from(o,{code:"DRM_FAILED_TO_SET_MEDIA_KEYS",message:"Failed set mediaKeys: "+e,isFatal:!0}))}const a=await s;a.length>0&&await n.setServerCertificate(a),this.currentDrmKeySystem=function(e){switch(e){case V.Ql:return w.W.widevine;case V.xE:return w.W.playready;default:return w.W.none}}(this.keySystem)}async onEncrypted(e){var t;if(this.isDestroyed)return;if(await this.initPromise,!e.mediaKeys||!this.keySystem)return void this.onError(new D.u({code:"DRM_INIT_ERROR",message:"MediaKeys not inited",isFatal:!0}));const r=null==(t=this.config.servers)?void 0:t[this.keySystem];if(r){try{this.session=e.mediaKeys.createSession()}catch(s){const e=(0,Y.K)(s)?s.message:(0,W.H)(s)?s:"";return void this.onError(D.u.from(s,{code:"DRM_FAILED_TO_CREATE_SESSION",message:"Failed to create session: "+e,isFatal:!0}))}if(this.session){this.addEventListener(this.session,"message",async e=>{let{message:t}=e;try{var n;const{response:e}=await this.handleSessionMessage(this.keySystem,r,this.config.requestParams,t);if(this.isDestroyed)return;await(null==(n=this.session)?void 0:n.update(e))}catch(s){var a;const t=D.u.from(s),r=null!=(a=t.details)&&a.drmProxyError?t.code:"DRM_SESSION_ERROR";this.onError(new D.u(i({},t.toJSON(),{code:r,message:"Failed to handle session message: "+t})))}},!1),this.addEventListener(this.session,"error",e=>{var t,r;this.onError(new D.u(i({},e,{code:"DRM_SESSION_ERROR",message:"Session error: "+e.message,isFatal:null==(t=null==(r=e.details)?void 0:r.isFatal)||t})))});try{const e=await this.getMediaKeySessionInitData();await this.generateRequest(this.session,e)}catch(s){return void this.onError(D.u.from(s,{code:"DRM_UNKNOWN_ERROR"}))}}else this.onError(new D.u({code:"DRM_FAILED_TO_CREATE_SESSION",message:"session is "+this.session,isFatal:!0}))}else this.onError(new D.u({code:"DRM_NO_LICENSE_SERVER",message:"No valid url to license server",isFatal:!0}))}async generateRequest(e,t){let{initData:r,initDataType:i}=t;if(!this.isDestroyed)if(r)try{const t=U.P.fromBase64(r).buffer;await e.generateRequest(i,t)}catch(s){const e=(0,Y.K)(s)?s.message:(0,W.H)(s)?s:"";this.onError(D.u.from(s,{code:"DRM_FAILED_TO_GENERATE_REQUEST",message:"Failed to generate request: "+e+"}",isFatal:!0}))}else this.onError(new D.u({code:"DRM_NO_INIT_DATA",message:"No drm initialization data in initialization info",isFatal:!0}))}addEventListener(e,t,r,i){const s=(0,T.O)(e,t,r,i);this.addDestroyHandler(s)}requestDrmProxy(e){return new Promise((t,r)=>{(0,B.W)(i({},e,{onSuccess:t,onError:(e,t)=>{const i=(0,H.c)(j.x.fromUTF8(t.response));return t.status||(i.isFatal=!0),r((0,K.t)(i))}}))})}handleSessionMessage(e,t,r,s){let n=s;const a={method:"post",data:"",headers:{"Content-Type":"application/json"},responseType:"arraybuffer",url:t,withCredentials:this.config.withCredentials};if(e===V.xE){const e=this.unpackPlayReadyRequest(s);a.headers=i({},e.headers,a.headers),n=e.data}const o=i({},r,{rawLicenseRequestBase64:U.P.toBase64(new Uint8Array(n))});return a.data=j.x.toUTF8(JSON.stringify(o)),this.requestDrmProxy(a)}unpackPlayReadyRequest(e){const t=j.x.fromUTF16(e,!0,!0),r={};let i=e;if(!t.includes("PlayReadyKeyMessage"))return{headers:r,data:i};const s=(new DOMParser).parseFromString(t,"application/xml"),n=s.getElementsByTagName("HttpHeader");for(let o=0;o<n.length;++o){const e=n[o].getElementsByTagName("name")[0],t=n[o].getElementsByTagName("value")[0];e.textContent&&t.textContent&&(r[e.textContent]=t.textContent)}const a=s.getElementsByTagName("Challenge")[0];return a&&"base64encoded"===a.getAttribute("encoding")&&(i=U.P.fromBase64(a.textContent).buffer),{headers:r,data:i}}async destroy(){super.destroy(),this.currentDrmKeySystem=w.W.none;try{var e,t;const r=(0,G.n)(1e3).promise;await Promise.race([Promise.all([null==(e=this.session)?void 0:e.closed,null==(t=this.session)?void 0:t.close()]),r])}catch(r){}if(this.session=void 0,""===this.video.src)try{await this.video.setMediaKeys(null)}catch(r){}}}var z=r(6610);class X extends q{constructor(e,t,r){super(e,t,r),this.drmInfoReceivedDeferred=new z.B,this.addEventListener(this.video,"yasp-drmInfoReceived",e=>this.drmInfoReceivedDeferred.resolve(e),{once:!0})}async getMediaKeySessionInitData(){var e,t;const r=(await this.drmInfoReceivedDeferred.promise).detail.find(e=>e.keySystem===this.keySystem);if(!r)throw new D.u({code:R.x.DRM_INIT_ERROR,message:"No drm initialization info",isFatal:!0});if(null==(e=r.initData)||null==(t=e[0])||!t.initData)throw new D.u({code:R.x.DRM_INIT_ERROR,message:"No drm initialization data in initialization info",isFatal:!0});return r.initData[0]}}class Q extends n.U{constructor(e){super(e),this.props=e,this.engine=a.$.YASP,this.yaspVideoElement=null,this.preloader=void 0,this.unsubscribers=[],this.initEncoderPromise=void 0,this.drmController=void 0,this.handleVideoTypeChange=e=>{let{detail:t}=e;const r=t;r&&this.emit("VideoTypeChange",r);const i=1e3*this.getUtcStartTime();switch(r){case m.Z.LIVE:this.emit("ProgramDateTimeChange",0);break;case m.Z.EVENT:this.emit("ProgramDateTimeChange",i);break;default:this.emit("ProgramDateTimeChange",i||void 0)}},this.handleNetworkTrace=e=>{let{detail:t}=e;const r=t;this.props.logEvent({event:"NetworkTrace",params:r})},this.handleDebug=e=>{let{detail:t}=e;"string"===typeof t&&E.Y.log("[PLAYER] [YASP]",t)},this.reportNudgeStalledFailed=()=>{this.props.logEvent({event:"YaspNudgeStalledFailed",params:{}})},this.reportNudgeStalled=()=>{this.props.logEvent({event:"YaspNudgeStalled",params:{}})},this.reportEmsg=e=>{const{startTime:t,messageData:r,segmentDuration:i}=e.detail,s=(0,M.parseV2Tag)(r);s&&s.writer&&this.emit("MetadataChange",{fragmentMetadataArray:[s.writer],fragmentStart:t,fragmentDuration:i,src:this.getStreamUrl()})},this.reportLargeGap=e=>{var t,r;E.Y.log("-> Yasp LargeGapEvent",e);const i=[];for(let s=0;s<this.video.buffered.length;s++)i.push([this.video.buffered.start(s),this.video.buffered.end(s)]);this.props.logEvent({event:"YaspLargeGap",params:{currentTime:null==e||null==(t=e.detail)?void 0:t.currentTime,gapSize:null==e||null==(r=e.detail)?void 0:r.gapSize,bufferedRanges:i}})},this.reportError=e=>{const t=e.detail;if("YASP_FETCH_SEGMENT_BAD_HTTP_STATUS"===t.code||"YASP_FETCH_MANIFEST_BAD_HTTP_STATUS"===t.code){const e=(0,I.X)(t.details.status,"YASP_FETCH_MANIFEST_BAD_HTTP_STATUS"===t.code);e&&(t.code=e,t.isFatal=!0)}this.props.onError(D.u.from(t))},(0,_.g)(this.video),this.initDetachedVideoElementErrorHandling(),this.initAbrDecisionsLogging(),this.initWorkerStateLogging()}async requestDebugInfo(){return this.yaspVideoElement&&this.yaspVideoElement.yasp?this.yaspVideoElement.yaspRequestDebugInfo():{noYasp:!0}}initTextTracks(){var e;const t=null==(e=this.yaspVideoElement)?void 0:e.textTracks;t&&(this.unsubscribers.push((0,T.O)(t,"change",()=>{this.notifyTextTracksChanged()})),this.notifyTextTracksChanged())}subscribeVideoTracksChange(){this.addEventListener(this.video.videoTracks,"addtrack",()=>{this.emit("VideoTracksChange",(0,k.x)(this.video.videoTracks))}),this.addEventListener(this.video.videoTracks,"removetrack",()=>{this.emit("VideoTracksChange",(0,k.x)(this.video.videoTracks))}),this.addEventListener(this.video.videoTracks,"change",()=>{const{videoHeight:e,videoWidth:t,videoTracks:r}=this.video,i=(0,h.Y)((0,p.s)({videoTracks:r,videoHeight:e,videoWidth:t}));this.emit("InternalVideoTrackValueChange",i&&i.value)})}async attachEncoder(){this.initEncoderPromise=this.preventPauseAsync(this.video,async()=>{this.yaspVideoElement=u.e.attach(this.video,{defaultQuality:this.props.defaultQuality,skippableFragments:this.props.sourceParams.skippableFragments,sourceLimit:Number.MAX_SAFE_INTEGER}),this.initTextTracks(),this.subscribeVideoTracksChange(),this.subscribeAudioTracksChange(),this.subscribeTextTracksChange(),this.unsubscribers.push((0,T.O)(this.yaspVideoElement,"yasp-videotracksadded",()=>this.restoreUserVideoTrack())),this.yaspVideoElement.addEventListener("yasp-largegap",this.reportLargeGap),this.yaspVideoElement.addEventListener("yasp-nudgefail",this.reportNudgeStalledFailed),this.yaspVideoElement.addEventListener("yasp-nudge",this.reportNudgeStalled),this.yaspVideoElement.addEventListener("yasp-emsg",this.reportEmsg),this.yaspVideoElement.addEventListener("yasp-error",this.reportError),this.yaspVideoElement.addEventListener("yasp-videoTypeChange",this.handleVideoTypeChange),this.yaspVideoElement.addEventListener("yasp-networkTrace",this.handleNetworkTrace),this.yaspVideoElement.addEventListener("yasp-debug",this.handleDebug),await super.attachEncoder(),this.isRecoverablePlaylistHTTPStatus=!1,this.initVideoSizesUpdater(),this.configureYasp({defaultBandwidthEstimate:this.getBandwidthEstimate(),presentationDelay:1e3*this.props.liveOffset,userQuality:(0,L.n)(),defaultQuality:this.props.defaultQuality})}),await this.initEncoderPromise,this.initEncoderPromise=void 0}async play(){return this.yaspVideoElement?(this.yaspVideoElement.yaspSetVideoElementSizes(this.getVideoElementSizes()),this.yaspVideoElement.play()):super.play()}async detachEncoder(){var e,t,r,i,s,n,a;if(this.isRecoverablePlaylistHTTPStatus=!0,null==(e=this.yaspVideoElement)||e.removeEventListener("yasp-largegap",this.reportLargeGap),null==(t=this.yaspVideoElement)||t.removeEventListener("yasp-nudgefail",this.reportNudgeStalledFailed),null==(r=this.yaspVideoElement)||r.removeEventListener("yasp-nudge",this.reportNudgeStalled),null==(i=this.yaspVideoElement)||i.removeEventListener("yasp-error",this.reportError),null==(s=this.yaspVideoElement)||s.removeEventListener("yasp-videoTypeChange",this.handleVideoTypeChange),null==(n=this.yaspVideoElement)||n.removeEventListener("yasp-networkTrace",this.handleNetworkTrace),null==(a=this.yaspVideoElement)||a.removeEventListener("yasp-debug",this.handleDebug),this.unsubscribers.forEach(e=>e()),this.unsubscribers=[],this.initEncoderPromise)try{await this.initEncoderPromise}catch(o){}await this.preventPauseAsync(this.video,async()=>{var e;await(null==(e=this.yaspVideoElement)?void 0:e.detach()),this.yaspVideoElement=null,await super.detachEncoder()})}subscribeVideoBuffering(){const{video:e}=this;let t=(0,v.s)(e);const r=()=>{const r=(0,g.k)(e,t);this.emit("InternalPlayingStateChange",r)},i=(0,v.C)(e,e=>{t=e,r()});this.addEventListener(e,"play",r),this.once("Destroy",i)}handleVideoElementPlayEvent(){if(0!==this.video.buffered.length)return super.handleVideoElementPlayEvent()}async destroyUnsafe(){const e=this.getStreamUrl();await super.destroyUnsafe(),await u.e.releaseSrc(e)}initDetachedVideoElementErrorHandling(){u.e.messenger.on("yasp-error",e=>{this.props.onError(D.u.from(e))}),this.once("Destroy",()=>u.e.messenger.off("yasp-error"))}initAbrDecisionsLogging(){u.e.messenger.on("AbrDecisionChange",e=>{let{abrDecisionsLog:t}=e;this.props.logEvent({event:"AbrDecisionChange",params:t})}),this.once("Destroy",()=>u.e.messenger.off("AbrDecisionChange"))}initWorkerStateLogging(){u.e.messenger.on("LogWorkerState",e=>{this.props.logEvent({event:e.enabled?"YaspWorkerEnabled":"YaspWorkerDisabled",params:e})}),this.once("Destroy",()=>u.e.messenger.off("AbrDecisionChange"))}initInternalSubscribe(){super.initInternalSubscribe(),this.addVideoEventListener("resize",()=>{const{videoTracks:e,videoWidth:t,videoHeight:r}=this.video,i=(0,h.Y)((0,p.s)({videoTracks:e,videoWidth:t,videoHeight:r}));this.emit("InternalVideoTrackValueChange",i?i.value:void 0)}),this.addVideoEventListener("loadedmetadata",()=>{this.currentState===N.X.END&&this.video.paused&&0===this.video.currentTime&&this.seek(0)}),this.once("ContentImpression",()=>{var e,t;this.emit("DrmSystemChange",null!=(e=null==(t=this.drmController)?void 0:t.currentDrmKeySystem)?e:w.W.none)})}setAudioTrack(e){var t;if(""===e.value)return;const r=(0,A.w)(null==(t=this.yaspVideoElement)?void 0:t.audioTracks),i=r.find(t=>t.id===e.value);i&&(i.enabled=!0,r.forEach(e=>{e!==i&&(e.enabled=!1)}))}setVideoTrack(e){if(!this.yaspVideoElement||!this.yaspVideoElement.videoTracks)return;const t=this.yaspVideoElement.videoTracks.getTrackById(e.value);t&&(t.selected=!0,this.stateController.putIsAbrEnabled(e.value===P.R.value),this.configureYasp({userQuality:(0,L.n)(),defaultQuality:this.props.defaultQuality}))}getStreamUrl(){return(0,S.A)(super.getStreamUrl())}async initDrm(e){if(!this.yaspVideoElement)return;if(this.drmController)return;if(!e)return void this.addEventListener(this.yaspVideoElement,"encrypted",()=>{this.props.onError(new D.u({code:R.x.NO_DRM_CONFIG,isFatal:!0}))},{once:!0});const t=s({},e,{withCredentials:this.withCredentials});this.drmController=new X(this.yaspVideoElement,t,e=>this.props.onError(e)),await this.drmController.init(),this.on("Destroy",async()=>{var e;await(null==(e=this.drmController)?void 0:e.destroy()),this.drmController=void 0})}getMaxCapAllowedVideoTrack(){if("function"!==typeof u.e.getStats)return super.getMaxCapAllowedVideoTrack();const e=u.e.getStats()||{},{maxCapAllowedVideoTrack:t}=e;return t||super.getMaxCapAllowedVideoTrack()}seekInternal(e){const{start:t,end:r}=this.getSeekableRange();(0,o.O)(this.video,(0,l.u)(e,t,r||0))}getSeekableRange(){if(!this.video.seekable.length)return{start:0,end:this.getDuration()||0};return{start:this.video.seekable.start(0),end:this.video.seekable.end(0)}}updateSkinDvrParameters(e){const t=e/1e3,{skin:{skinDVRStartTime:r,skinDVRDuration:i},controller:{videoType:s,dvrDuration:n}}=this.state;if(s===m.Z.LIVE){const e=r+t;this.playerStore.setSkinStateField(C.rE.skinDVRStartTime,e),this.emit("DVRStartTimeChange",e)}else if(s===m.Z.EVENT){const e=Math.min(i+t,n);this.playerStore.setSkinStateField(C.rE.skinDVRDuration,e),this.emit("DVRDurationChange",e)}}startLatencyPolling(){}getDuration(){return this.video.duration}isLowLatencyLive(){return this.yaspVideoElement?this.yaspVideoElement.isLowLatencyLive():super.isLowLatencyLive()}getUtcStartTime(){if(!this.yaspVideoElement)return super.getUtcPosition();const e=this.yaspVideoElement.getStartDate();if(!e)return super.getUtcPosition();const t=e.getTime();return isNaN(t)?super.getUtcPosition():t/1e3}onTick(e){super.onTick(e)}getUtcPosition(){const e=this.getUtcStartTime();return e>=0?e+this.getCurrentTime():super.getUtcPosition()}getServerTime(){return this.yaspVideoElement?this.yaspVideoElement.getServerTime():super.getServerTime()}getLiveLatency(){if(!this.isLiveStreaming())return;const e=this.getUtcPosition(),t=this.getServerTime();return e>0&&void 0!==t?Math.max(t-e,0):void 0}getFragmentsData(){const{start:e,end:t}=this.getSeekableRange();return{totalDuration:t-e,fragmentDuration:O.D,startTime:e}}isDvrEnabled(){return!0}getBandwidthEstimate(){if("function"!==typeof u.e.getStats)return super.getBandwidthEstimate();const e=u.e.getStats()||{},{bandwidth:t}=e;if(t){const e=(0,b.S)(t);if(e&&(0,f.z)(e.value))return e}return super.getBandwidthEstimate()}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}async onVideoTagError(){if(this.state.controller.encoderState!==d.y.Attached)return super.onVideoTagError();const e=this.video.error;if(!e)return super.onVideoTagError();this.video.poster=c.O,this.checkPlaylistHTTPStatus();const t=D.u.from(e.yaspError),r=await this.checkPlaylistHTTPStatusPromise;r&&r.isFatalError()?this.props.onError(r.toPlayerError()):this.props.onError(t)}initVideoTypeQualifier(){}establishStartPosition(){return Promise.resolve(void 0)}configureYasp(e){var t;null==(t=this.yaspVideoElement)||t.yaspConfigure(e)}async preloadSource(){if(this.isDestroyed||this.preloader&&!this.preloader.isDestroyed)return;const e=(0,y.J)({source:this.props,engine:this.engine,getState:()=>this.state,getCapSizes:()=>this.getCapSizes(),getVideoElementSizes:()=>this.getVideoElementSizes(),defaultQuality:this.props.defaultQuality});e&&(this.preloader=e,e.on("Destroy",()=>{this.preloader=void 0}),await e.preload({defaultBandwidthEstimate:this.getBandwidthEstimate(),presentationDelay:void 0!==this.props.liveOffset?1e3*this.props.liveOffset:this.props.liveOffset,defaultQuality:this.props.defaultQuality}))}initVideoSizesUpdater(){var e;let t=NaN,r=NaN;null==(e=this.yaspVideoElement)||e.yaspSetVideoElementSizes(this.getVideoElementSizes());const i=setInterval(()=>{var e;const i=this.getVideoElementSizes(),{width:s,height:n}=i;s===t&&n===r||(t=s,r=n,null==(e=this.yaspVideoElement)||e.yaspSetVideoElementSizes(i))},1e3);this.once("Detach",()=>{clearInterval(i)})}shouldLogStalledDebugInfo(){return!0}estimateLatency(){}}},8493:(e,t,r)=>{"use strict";r.d(t,{S:()=>i,e:()=>s});r(7881);const i=1e6,s=1e5},3034:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});r(7881);const i=30},893:(e,t,r)=>{"use strict";r.d(t,{s:()=>i});r(7881);const i=5},9591:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});r(7881);const i=360},3399:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{m:()=>o});var s=r(442),n=r(2891);const a={timeout:5e3,baseDelay:100,backoffFactor:1,fuzzFactor:.5},o={drm:{retryParameters:i({},a,{timeout:r(5586).Y,maxAttempts:n.W})},manifest:{availabilityWindowOverride:1/0,retryParameters:i({},a,{timeout:s.d4}),dash:{ignoreMinBufferTime:!0,autoCorrectDrift:!1,ignoreEmptyAdaptationSet:!0,targetLatency:5}},streaming:{rebufferingGoal:.3,jumpLargeGaps:!0,retryParameters:i({},a,{timeout:s.C})}}},9583:(e,t,r)=>{"use strict";function i(e){if(isNaN(e.value))return;const t={bandwidthEstimate:Math.floor(e.value),time:(0,n.m)(),source:e.source};a.t.setItem("videoplayer-bandwidth-estimate",JSON.stringify(t))}function s(){try{const e=a.t.getItem("videoplayer-bandwidth-estimate");if(!e)return NaN;const{bandwidthEstimate:t,time:r}=JSON.parse(e);return(0,n.m)()-r<o?t:NaN}catch(e){return NaN}}r.d(t,{N:()=>s,J:()=>i});var n=r(9183),a=(r(7881),r(6612));const o=r(9201).b?9e5:864e5},4188:(e,t,r)=>{"use strict";r.d(t,{S:()=>o});r(7881);var i=r(4513),s=r(2248),n=r(6838),a=r(897);class o extends i.M{constructor(){super(),this.blacklist=new Set,this.destroyed=!1,this.checkLoopTimeoutId=void 0,this.startLoop(),this.once("Destroy",()=>{this.destroyed=!0})}destroy(){this.stopLoop(),super.destroy()}getBlacklist(){return Array.from(this.blacklist)}addHostname(e){s.T.indexOf(e)>-1||this.blacklist.has(e)||this.blacklist.add(e)}isBlacklisted(e){return this.blacklist.has(e)}async checkBlacklistedHosts(){await Promise.all(Array.from(this.blacklist).map(async e=>{try{await async function(e){await(0,a.W)({method:"GET",url:e,withCredentials:!1,timeout:2e3})}(function(e){return"https://"+e+"/ping?r="+(0,n.a)(12)}(e)),this.blacklist.delete(e)}catch(t){}}))}startLoop(){this.destroyed||(this.checkLoopTimeoutId=setTimeout(async()=>{this.stopLoop(),await this.checkBlacklistedHosts(),this.startLoop()},3e4))}stopLoop(){clearTimeout(this.checkLoopTimeoutId)}}},3219:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var i=r(7187),s=r(4343);class n{constructor(){this.serverTimestamp=void 0,this.getElapsedTimeFromServerDate=()=>0}parseServerTime(e,t){if(!e.date&&!e["x-server-time-ms"])return;let r=NaN;if(e["x-server-time-ms"]){r=new Date(parseInt(e["x-server-time-ms"],10)).getTime()}else if(e.date){r=new Date(e.date).getTime()}(0,i.z)(r)&&(this.serverTimestamp=r+t/2,this.getElapsedTimeFromServerDate=(0,s.u)())}getServerTime(){if(void 0!==this.serverTimestamp)return this.serverTimestamp+this.getElapsedTimeFromServerDate()}}},6095:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});var i=r(4343),s=(r(7881),r(5060));class n{constructor(){this.previousVariantHeight=void 0,this.lastDowngradedVariantHeight=void 0,this.getTimeSinceDowngrade=()=>1/0}filter(e){const t=e.filter(s.F);if(t.length<=1)return e;let r=t[t.length-1].video.height;return this.isDowngrading(r)&&(this.lastDowngradedVariantHeight=r,this.getTimeSinceDowngrade=(0,i.u)()),void 0!==this.lastDowngradedVariantHeight&&(this.getTimeSinceDowngrade()<1e4?r=this.lastDowngradedVariantHeight:this.lastDowngradedVariantHeight=void 0),this.previousVariantHeight=r,t.filter(e=>e.video.height<=r)}reset(){this.getTimeSinceDowngrade=()=>1/0,this.previousVariantHeight=void 0,this.lastDowngradedVariantHeight=void 0}isDowngrading(e){return void 0!==this.previousVariantHeight&&this.previousVariantHeight>e}}},4508:(e,t,r)=>{"use strict";function i(e,t,r){if(e.length<=1)return e;let i=0;const s=Math.max(r,1);for(let n=1;n<e.length;n++){const r=e[n],a=e[n+1]||{bandwidth:1/0},o=r.bandwidth/.95*s,l=a.bandwidth/.85*s;t>=o&&t<=l&&(i=n)}return e.slice(0,i+1)}r.d(t,{S:()=>i})},5060:(e,t,r)=>{"use strict";function i(e){return(0,o.K)(e.video)&&(0,a.z)(e.video.width)&&(0,a.z)(e.video.height)}function s(e,t,r,s){let{width:a=1/0,height:o=1/0,dpi:d=1}=t;void 0===s&&(s={width:null,height:null});const c=e.filter(i);if(c.length<=1)return e;const u=(0,l.R)(r),h=o*d,p=a*d,f=a/o;let m,g;o>a?(m=s.width||Math.min(u,p),g=m/f):(g=s.height||Math.min(u,h),m=g*f);const v=function(e,t){let{width:r,height:i}=e;return t>r/i?{width:r,height:r/t}:{width:i*t,height:i}}({width:m,height:g},c[0].video.width/c[0].video.height),y=[],E=v.width*v.height,S=(0,n.U)(c.slice().reverse(),e=>{let{video:{width:t,height:r}}=e;return Math.abs(E-t*r)});for(let i=0;i<c.length&&(y.push(c[i]),S!==c[i]);i++);return y.length<1?[c[0]]:y}r.d(t,{i:()=>s,F:()=>i});var n=r(5679),a=r(7187),o=r(3770),l=(r(7881),r(3942))},2522:(e,t,r)=>{"use strict";function i(e){const t=[],r=Object.create(null),i=Object.create(null);return e.forEach(e=>{const{video:s,audio:n}=e;s&&s.height&&s.width&&s.originalId&&n&&n.bandwidth?(void 0===r[s.originalId]&&(r[s.originalId]=[],i[s.originalId]=s),r[s.originalId].push(e)):t.push(e)}),(0,n.M)(r,(e,r)=>{const n=i[r],l={width:n.width,height:n.height};if((0,a.E)(l)<=o)t.push(...e);else{const r=(0,s.Y)(e,e=>{var t;return(null==(t=e.audio)?void 0:t.bandwidth)||0});t.push(r)}}),t}r.d(t,{p:()=>i,v:()=>o});var s=r(942),n=r(141),a=(r(7881),r(8578));const o=360},5251:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{P:()=>v});var s=r(942),n=(r(7881),r(6048)),a=r.n(n),o=r(55),l=r(8441),d=r(4508),c=r(5060),u=r(2522),h=r(6095),p=r(6389),f=r(2786),m=r(9591),g=r(4893);class v{constructor(e){this.bandwidthEstimator=new l.I,this.config=void 0,this.enabled=!1,this.originalShakaVariants=[],this.props=void 0,this.startupComplete=!1,this.switchCallback=o.Z,this.variants=[],this.switchHistoryRule=new h.I,this.props=e}init(e){this.switchCallback=e}configure(e){this.config=e}stop(){this.enabled=!1,this.switchCallback=o.Z,this.variants=[],this.switchHistoryRule.reset()}getBandwidthEstimate(){const e=this.bandwidthEstimator.getBandwidthEstimate({value:this.config.defaultBandwidthEstimate,source:this.config.defaultBandwidthEstimateSource});return{value:e.value+this.props.bandwidthEstimateOffset,source:e.source}}getMaxCapAllowedVideoTrack(){const{videoElementSizes:e}=this.props.getFilterParams(this.variants),t=this.variants.filter(c.F);if(0===t.length)return;const r=(0,g.n)(),s=(0,c.i)(t,e||{},void 0,r);return i({},s[s.length-1].video)}enable(){this.enabled=!0}disable(){this.enabled=!1}getVariants(){return this.variants}setVariants(e){a()(e,this.originalShakaVariants)||(this.originalShakaVariants=e,this.variants=(0,u.p)([...e].sort((e,t)=>e.bandwidth-t.bandwidth)),this.switchHistoryRule.reset())}chooseVariant(){const{preloadedVariant:e,videoElementSizes:t,defaultQuality:r}=this.props.getFilterParams(this.variants);if(e)return e;let i=(0,d.S)(this.variants,this.getBandwidthEstimate().value,this.props.getPlaybackRate());i=function(e,t){const r=(0,p.P)(t);if(!r)return e;const i=e.filter(c.F);if(i.length<=1)return e;const s=[];for(let n=0;n<i.length;n++)i[n].video.height<=r.maxHeight&&s.push(i[n]);return s}(i,this.props.getManifestXml()),i=function(e){return(0,f.R)()?e.filter(e=>!(e.video&&e.video.height&&e.video.width)||Math.min(e.video.height,e.video.width)<=m.T):e}(i),i=this.switchHistoryRule.filter(i),i=(0,c.i)(i,t||{},r,(0,g.n)());return(0,s.Y)(i.slice().reverse(),e=>{var t;return(null==e||null==(t=e.audio)?void 0:t.bandwidth)||0})||null}segmentDownloaded(e,t){this.bandwidthEstimator.sample(e,t,this.props.isLowLatencyLive()),this.enabled&&this.suggestStreams()}suggestStreams(){if(!this.startupComplete){if(!this.bandwidthEstimator.hasGoodEstimate())return;this.startupComplete=!0}const e=this.chooseVariant();e&&this.switchCallback(e)}}},6774:(e,t,r)=>{"use strict";r.d(t,{n:()=>a});var i=r(7187),s=(r(7881),r(6389));const n={maxWidth:1/0,maxHeight:1/0,width:1/0,height:1/0};class a{constructor(e){this.props=e}getAbrRestrictions(){if(!this.props.getState().controller.isAbrEnabled)return n;const e=this.props.getCapSizes();if(void 0===e)return n;const{width:t,height:r,maxHeight:a,maxWidth:o}=e,l=(0,s.P)(this.props.getManifestXml()),d=null!=l&&l.maxHeight?(null==l?void 0:l.maxHeight)+1:1/0;return{maxWidth:o,maxHeight:Math.min(...[d,a].filter(i.z)),height:r,width:t}}}},173:(e,t,r)=>{"use strict";function i(e,t){return e.getAll().find(e=>e.pathname===t)}function s(e){return/\/init-?.*\.mp4/.test(e)}function n(e){const t=e.getNetworkingEngine();t&&(t.unregisterScheme("http"),t.unregisterScheme("https"))}r.d(t,{vU:()=>y});var a=r(3564),o=r(5946),l=r(5348),d=r(222),c=r(2843),u=r(4929),h=r(3034);const p=h.o/c.D*2*2;class f{constructor(){this.initSegments=new u.y(10),this.segments=new u.y(p)}set(e,t){const{pathname:r}=(0,d.en)(e),i={pathname:r,response:t};s(e)?this.initSegments.push(i):this.segments.push(i)}get(e){const{pathname:t}=(0,d.en)(e),r=s(e)?i(this.initSegments,t):i(this.segments,t);return void 0===r?void 0:r.response}clear(){this.initSegments.clear(),this.segments.clear()}copy(){const e=new f;return e.initSegments=this.initSegments.copy(),e.segments=this.segments.copy(),e}hasCachedData(){return this.initSegments.getAll().length>0||this.segments.getAll().length>0}}var m=r(3219),g=r(9183),v=r(55);class y{constructor(e){let{segmentCache:t,loadedManifest:r}=void 0===e?{segmentCache:void 0,loadedManifest:void 0}:e;this.segmentCache=void 0,this.lastLoadedManifest=void 0,this.useLastLoadedManifest=!0,this.shakaPlayer=void 0,this.networkErrorHandler=void 0,this.networkSuccessHandler=void 0,this.serverTimeEstimator=void 0,this.requestFilters=[],this.strmSession=void 0,this.segmentCache=t||new f,this.lastLoadedManifest=r,this.serverTimeEstimator=new m.p}setup(e,t,r){this.shakaPlayer&&(n(this.shakaPlayer),this.useLastLoadedManifest=!0),this.shakaPlayer=e,this.networkSuccessHandler=t,this.networkErrorHandler=r;const i=this.customNetPluginFactory(window.shaka),s=e.getNetworkingEngine();null==s||s.registerScheme("http",i),null==s||s.registerScheme("https",i)}destroy(){this.requestFilters.length=0,this.segmentCache.clear(),this.shakaPlayer&&n(this.shakaPlayer)}hasCachedSegments(){return this.segmentCache.hasCachedData()}hasCachedData(){return this.useLastLoadedManifest&&void 0!==this.lastLoadedManifest||this.hasCachedSegments()}getCurrentVariantTrack(){return(0,l.I)(this.shakaPlayer)}copyCachedData(){return{segmentCache:this.segmentCache.copy(),loadedManifest:this.lastLoadedManifest}}getServerTime(){return this.serverTimeEstimator.getServerTime()}registerRequestFilter(e){this.requestFilters.indexOf(e)>-1||this.requestFilters.push(e)}unregisterRequestFilter(e){const t=this.requestFilters.indexOf(e);t<=-1||this.requestFilters.splice(t,1)}cacheResponse(e,t,r,i){switch(r){case e.net.NetworkingEngine.RequestType.MANIFEST:this.lastLoadedManifest=i,this.useLastLoadedManifest=!1;break;case e.net.NetworkingEngine.RequestType.SEGMENT:this.segmentCache.set(t,i)}}getCachedResponse(e,t,r){switch(r){case e.net.NetworkingEngine.RequestType.MANIFEST:const{useLastLoadedManifest:r,lastLoadedManifest:i}=this;return r&&void 0!==i?(this.useLastLoadedManifest=!1,i):void 0;case e.net.NetworkingEngine.RequestType.SEGMENT:const s=this.segmentCache.get(t);return void 0===s?void 0:s;default:return}}customNetPluginFactory(e){return(t,r,i,s)=>{const n=this.getCachedResponse(e,t,i);if(void 0!==n)return n.fromCache=!0,new e.util.AbortableOperation(Promise.resolve(n),v.Z);switch(this.requestFilters.forEach(e=>{try{e(i,r)}catch(t){}}),i){case e.net.NetworkingEngine.RequestType.MANIFEST:void 0===this.strmSession?t=(0,a.c)(t):(r.headers["x-strm-session"]=this.strmSession,r.headers["x-client-timestamp"]=String(Date.now()),l=t,t=(0,o.WR)(l,a.j));break;case e.net.NetworkingEngine.RequestType.SEGMENT:t=(0,a.c)(r.uris[0]||t)}var l;const d=function(e){return e.net.HttpFetchPlugin.isSupported()?e.net.HttpFetchPlugin:e.net.HttpXHRPlugin}(e),c=(0,g.m)(),u=d(t,r,i,s);return new e.util.AbortableOperation(u.promise.then(r=>(i===e.net.NetworkingEngine.RequestType.MANIFEST&&(this.strmSession=r.headers["x-strm-session"],this.serverTimeEstimator.parseServerTime(r.headers,(0,g.m)()-c)),this.cacheResponse(e,t,i,r),this.networkSuccessHandler(i),r)).catch(t=>{throw t&&t.code!==e.util.Error.Code.OPERATION_ABORTED&&this.networkErrorHandler(i,t),t}),()=>u.abort())}}}},8441:(e,t,r)=>{"use strict";r.d(t,{I:()=>a});r(7881);class i{constructor(e){this.alpha=void 0,this.estimate=0,this.totalWeight=0,this.setHalfLife(e)}sample(e,t){const r=Math.pow(this.alpha,e),i=t*(1-r)+r*this.estimate;isNaN(i)||(this.estimate=i,this.totalWeight+=e)}getEstimate(){const e=1-Math.pow(this.alpha,this.totalWeight);return this.estimate/e}setHalfLife(e){this.alpha=Math.exp(Math.log(.5)/e)}}const s={fast:2,slow:5},n={fast:1,slow:2};class a{constructor(){this.fast=void 0,this.slow=void 0,this.bytesSampled=0,this.fast=new i(s.fast),this.slow=new i(s.slow)}sample(e,t,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=16e3),e<=0||t<(r?2e3:i))return;this.setHalfLife(r?n:s);let a=8*t/(e/1e3);const o=e/1e3;this.bytesSampled=this.bytesSampled+t,this.fast.sample(o,a),this.slow.sample(o,a)}getBandwidthEstimate(e){return this.hasGoodEstimate()?{value:this.getCurrentEstimate(),source:"ewma"}:e}hasGoodEstimate(){return this.bytesSampled>=128e3}getCurrentEstimate(){return Math.min(this.fast.getEstimate(),this.slow.getEstimate())}setHalfLife(e){this.fast.setHalfLife(e.fast),this.slow.setHalfLife(e.slow)}}},3587:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{R:()=>A});var s=r(3945),n=r(5386),a=r(4230),o=r(7187),l=(r(7881),r(55)),d=r(893),c=r(3399),u=r(7553),h=r(2178),p=r(5251),f=r(173),m=r(5348),g=r(5541),v=r(4616),y=r(9752),E=r(5053),S=r(6774);class A extends y.N{constructor(e){super(),this.props=e,this.preload=(0,n.I)(async()=>{if(await(0,h.tL)(),this.isDestroyed)throw new Error("MpdPreloader was destroyed");const e=new shaka.Player(this.videoElement);this.shakaPlayer=e,this.manifestXmlSpy=new E.U(e);e.getNetworkingEngine().registerRequestFilter((t,r)=>{if(t===shaka.net.NetworkingEngine.RequestType.LICENSE)return new Promise((t,r)=>{e.addEventListener("unloading",r)});r.allowCrossSiteCredentials=this.props.source.sourceParams.withCredentials}),e.configure(this.getInitialShakaConfig()),e.addEventListener("manifestparsed",()=>{const{videoTime:t,utc:r}=this.props.source.sourceParams.startPosition,i=(0,o.z)(t)||(0,o.z)(r);e.isLive()&&!i&&this.destroy()});const t=new f.vU;t.setup(e,l.Z,l.Z),this.customNetworkingEngine=t;const r=new Promise((t,r)=>{let i=l.Z;const a=()=>{i(),r(new Error("MpdPreloader: shakaPlayer unloading"))};e.addEventListener("unloading",a);const o=(0,s.O)(this.videoElement,"progress",()=>{const{total:r,audio:s,video:n}=e.getBufferedInfo();if(0===s.length||0===n.length)return;const{start:a,end:o}=r[0]||{},l=o-a,c=this.videoElement.duration;(d.s<=l+.2||c<=o+.2)&&(i(),t())});i=(0,n.I)(()=>{o(),e.removeEventListener("unloading",a)})});return(0,a.v)((0,v.D)({shakaPlayer:e,streamUrl:this.props.source.stream.url,startPosition:this.props.source.sourceParams.startPosition})),r}),this.shakaPlayer=void 0,this.customNetworkingEngine=void 0,this.manifestXmlSpy=void 0,this.abrRestrictionsHelper=void 0,this.videoElement=document.createElement("video"),(0,a.v)((0,h.tL)()),this.abrRestrictionsHelper=new S.n({getManifestXml:()=>{var e;return null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml()},getState:this.props.getState,getCapSizes:this.props.getCapSizes}),this.addDestroyHandler(()=>{var e,t,r;null==(e=this.customNetworkingEngine)||e.destroy(),null==(t=this.manifestXmlSpy)||t.destroy(),null==(r=this.shakaPlayer)||r.destroy(),this.customNetworkingEngine=void 0,this.manifestXmlSpy=void 0,this.shakaPlayer=void 0})}getBandwidthEstimate(){var e;if(this.isDestroyed)return;const t=null==(e=this.shakaPlayer)?void 0:e.getStats();return null!=t&&t.estimatedBandwidth?{value:t.estimatedBandwidth,source:t.estimatedBandwidthSource}:void 0}getCachedVariantTrack(){return this.hasCachedSegments()?(0,m.I)(this.shakaPlayer):void 0}copyCachedData(){var e;const t=null==(e=this.customNetworkingEngine)?void 0:e.copyCachedData();return{segmentCache:null==t?void 0:t.segmentCache,loadedManifest:null==t?void 0:t.loadedManifest}}getVideoElement(){return this.videoElement}getType(){return this.props.type}getBufferedInfo(){return void 0===this.shakaPlayer?{total:[],audio:[],video:[]}:this.shakaPlayer.getBufferedInfo()}getSource(){return this.props.source}getManifestXml(){var e;return null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml()}hasManifest(){var e;return void 0!==(null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml())}hasCachedSegments(){var e;return Boolean(null==(e=this.customNetworkingEngine)?void 0:e.hasCachedSegments())}getInitialShakaConfig(){var e,t;const r=this.props.getState(),{stream:s}=this.props.source,n=(0,u.L)(r),a=new p.P({getPlaybackRate:()=>1,bandwidthEstimateOffset:null!=(e=null==(t=r.controller.playerConfig)?void 0:t.bandwidthEstimateOffset)?e:0,getSegmentDuration:()=>(0,g.L)(this.shakaPlayer),getFilterParams:e=>({preloadedVariant:void 0,videoElementSizes:this.props.getVideoElementSizes(),restrictions:this.abrRestrictionsHelper.getAbrRestrictions(),defaultQuality:this.props.defaultQuality}),isLowLatencyLive:()=>!1,getManifestXml:()=>{var e;return null==(e=this.manifestXmlSpy)?void 0:e.getManifestXml()},fpsController:this.props.fpsController});return i({},c.m,{abr:i({},c.m.abr,{enabled:!1},null!=n&&n.value?{defaultBandwidthEstimate:n.value,defaultBandwidthEstimateSource:n.source}:{}),abrFactory:function(){return a},drm:i({},c.m.drm,s.drmConfig),streaming:i({},c.m.streaming,{bufferingGoal:d.s})})}}},9752:(e,t,r)=>{"use strict";r.d(t,{N:()=>n});var i=r(1122),s=(r(7881),r(5334));class n extends i.V{get preloaded(){if(this.isDestroyed)return"none";const e=this.getSource().sourceParams.startPosition.videoTime||0,{total:t}=(0,s.t)(this.getBufferedInfo(),e);return t>=2?"full":this.hasCachedSegments()?"partial":this.hasManifest()?"manifest":"none"}}},5053:(e,t,r)=>{"use strict";r.d(t,{U:()=>a});var i=r(1122),s=r(55),n=r(5422);class a extends i.V{constructor(e){super(),this.manifestXml=void 0,this.resolvePromise=s.Z,this.rejectPromise=s.Z,this.manifestXmlPromise=void 0;const t=e.getNetworkingEngine(),r=(e,t)=>{const r=(0,n.G)(e,t);void 0===this.manifestXml&&void 0!==r&&this.resolvePromise(r),void 0!==r&&(this.manifestXml=r)};null==t||t.registerResponseFilter(r),this.addDestroyHandler(()=>{null==t||t.unregisterResponseFilter(r),this.rejectPromise()}),e.addEventListener("unloading",this.rejectPromise)}getManifestXml(){if(!this.isDestroyed)return this.manifestXml}async waitForManifestXml(){return this.isDestroyed?Promise.reject():void 0!==this.manifestXml?Promise.resolve(this.manifestXml):(this.manifestXmlPromise||(this.manifestXmlPromise=new Promise((e,t)=>{this.resolvePromise=e,this.rejectPromise=t})),this.manifestXmlPromise)}}},594:(e,t,r)=>{"use strict";function i(e){if(void 0===e)return;const t=e.getManifest();if(!t)return;const r=e.getMediaElement();if(!r)return;const{currentTime:i}=r,{periods:s=[]}=t;for(let n=0;n<s.length-1;n++)if(s[n].startTime<i&&i<s[n+1].startTime)return s[n];return s[s.length-1]}r.d(t,{P:()=>i})},5991:(e,t,r)=>{"use strict";function i(e){const t=(0,n.I)(e);if(!t)return;const r=(0,s.P)(e);return r?r.variants.find(e=>t.id===e.id):void 0}r.d(t,{S:()=>i});var s=r(594),n=r(5348)},5348:(e,t,r)=>{"use strict";function i(e){if((0,s.V)(e))try{var t;const r=e.getVariantTracks(),i=r.find(n.I),s=null==(t=e.getConfiguration().abr)?void 0:t.enabled,a=e.getMediaElement();if(!a||!s)return i;const{videoWidth:o=0,videoHeight:l=0}=a;return r.find(e=>e.width===o&&e.height===l&&e.originalAudioId===(null==i?void 0:i.originalAudioId))||i}catch(r){return}}r.d(t,{I:()=>i});var s=r(3455),n=r(6844)},5541:(e,t,r)=>{"use strict";function i(e,t){let r=0;if(!(0,n.V)(e))return r;if(void 0===t){const i=e.getMediaElement();if(!i)return r;t=i.currentTime}const i=(0,s.O)(e,t);if(i){const{startTime:e,endTime:t}=i;r=t-e}return r}r.d(t,{L:()=>i});r(7881);var s=r(9940),n=r(3455)},9940:(e,t,r)=>{"use strict";function i(e,t){const r=(0,n.S)(e);if(!r||!r.video)return null;try{const e=r.video.findSegmentPosition(t);return(0,s.z)(e)?r.video.getSegmentReference(e):null}catch(i){return null}}r.d(t,{O:()=>i});var s=r(7187),n=r(5991)},836:(e,t,r)=>{"use strict";function i(e,t){if(void 0===e)return;if((0,n.k)(e)===s.Z.LIVE)return 0;if(void 0===t)return;const r=t.documentElement.getAttribute("publishTime");if(!r)return;const i=Date.parse(r);return isNaN(i)?void 0:i/1e3}r.d(t,{g:()=>i});r(7881);var s=r(4651),n=r(1285)},1285:(e,t,r)=>{"use strict";function i(e){if(!(0,a.V)(e))return;if(!e.isLive())return s.Z.VOD;const t=function(e){const t=(0,n.S)(e);if(t&&t.video)return t.video.presentationTimeOffset}(e);return void 0!==t?0===t?s.Z.LIVE:s.Z.EVENT:void 0}r.d(t,{k:()=>i});var s=r(4651),n=r(5991),a=r(3455)},3455:(e,t,r)=>{"use strict";function i(e){return void 0!==e&&null!==e.getManifest()}r.d(t,{V:()=>i})},6844:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});const i=e=>e.active},4616:(e,t,r)=>{"use strict";async function i(e){let{shakaPlayer:t,streamUrl:r,startPosition:i}=e,c=!1;t.addEventListener("unloading",()=>c=!0);const u=(0,n.z)(null==i?void 0:i.utc),h=u||null==i?void 0:i.videoTime,p=t.load(r,(0,n.z)(h)?h:void 0);if(!u)return void await p;const f=null==i?void 0:i.utc,m=new d.U(t);if(await p,c)throw new Error("loadShakaSource aborted");const g=m.getManifestXml()||await m.waitForManifestXml();if(c)throw new Error("loadShakaSource aborted");const v=(0,l.g)(t,g),y=void 0===v?null==i?void 0:i.videoTime:0===v?null==i?void 0:i.utc:Math.max(f-v,0);if(void 0===y)return;const E=t.getMediaElement();(function(e){if(!(0,o.V)(e))return!1;const t=e.getMediaElement();return!!t&&(Number(t.readyState)>0&&Number(t.duration)>0)})(t)||await new Promise((e,r)=>{(0,s.O)(E,"loadeddata",e,{once:!0}),t.addEventListener("unloading",r)}),(0,a.O)(E,y)}r.d(t,{D:()=>i});var s=r(3945),n=r(7187),a=(r(7881),r(2150)),o=r(3455),l=r(836),d=r(5053)},6389:(e,t,r)=>{"use strict";function i(e){if(void 0===e)return;const t=e.querySelector('SupplementalProperty[schemeIdUri="urn:mpeg:yandex:capping:maxheight"]');if(!t)return;const r=parseInt(t.getAttribute("value")||"",10);return r>0?{maxHeight:r}:void 0}r.d(t,{P:()=>i});r(7881)},5422:(e,t,r)=>{"use strict";function i(e){return e?function(e){let t="",r=0;const i=e.length;let s=0,n=0,a=0;for(;r<i;)switch(s=e[r++],s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(s);break;case 12:case 13:n=e[r++],t+=String.fromCharCode((31&s)<<6|63&n);break;case 14:n=e[r++],a=e[r++],t+=String.fromCharCode((15&s)<<12|(63&n)<<6|(63&a)<<0)}return t}(new Uint8Array(Array.from(e))):""}function s(e,t){if(void 0!==shaka&&e===shaka.net.NetworkingEngine.RequestType.MANIFEST&&t.data)return function(e){if(!e)return null;try{const t=(new DOMParser).parseFromString(e,"application/xml");return null===t.querySelector("parsererror")?t:null}catch(t){return null}}(i(new Uint8Array(t.data)))||void 0}r.d(t,{G:()=>s})},9841:(e,t,r)=>{"use strict";function i(e){try{if(!navigator.requestMediaKeySystemAccess)return;const t=(0,s.F)(e);if(t===window)return;if(!t.navigator.requestMediaKeySystemAccess)return;navigator.requestMediaKeySystemAccess=function(){return t.navigator.requestMediaKeySystemAccess(...arguments)}}catch(t){}}r.d(t,{g:()=>i});var s=r(1343)},5689:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});const i="videoplayer-prefer-hd"},4159:(e,t,r)=>{"use strict";function i(e,t){void 0===t&&(t=o.K),t in l?l[t].preferHd=e:l[t]={preferHd:e},n.t.setItem(a.t,JSON.stringify(l))}function s(e){return void 0===e&&(e=o.K),e in l&&l[e].preferHd}r.d(t,{AJ:()=>i,dg:()=>s});var n=r(6612),a=r(5689),o=r(7588);let l=function(){try{return JSON.parse(n.t.getItem(a.t)||"{}")}catch(e){return{}}}()},3564:(e,t,r)=>{"use strict";function i(e){const t=new URL(e);return t.searchParams.set(s,String(Date.now())),t.href}r.d(t,{c:()=>i,j:()=>s});const s="t"},35:(e,t,r)=>{"use strict";function i(e,t){let{paused:r}=e;return r?s.X.PAUSE:t?s.X.BUFFERING:s.X.PLAY}r.d(t,{k:()=>i});var s=r(7746)},6902:(e,t,r)=>{"use strict";async function i(e){const t=window;if(!function(e){const t=e;return!!((0,u.K)(t.yandex)&&(0,u.K)(t.yandex.mediaPlayer)&&(0,c.m)(t.yandex.mediaPlayer.sendDirective))&&!(!(0,u.K)(t.yandex.mediaPlayer.onPreloaderEvent)||!(0,c.m)(t.yandex.mediaPlayer.onPreloaderEvent.addListener))}(t))throw new Error("Can not use YandexPreloader");return new Promise((r,i)=>{try{t.yandex.mediaPlayer.sendDirective(e,()=>{const e=s();e?i(new Error(e.message||"YandexPreloader sendDirective error")):r()})}catch(a){var n;i(new Error((null==(n=s())?void 0:n.message)||"YandexPreloader sendDirective call exception"))}})}function s(){var e,t,r;return null==(e=window)||null==(t=e.chrome)||null==(r=t.runtime)?void 0:r.lastError}function n(e){let{engine:t,source:r,getState:i,getCapSizes:s,fpsController:n,getVideoElementSizes:d,defaultQuality:c}=e;switch(t){case o.$.MPD:return new l.R({source:r,getState:i,getCapSizes:s,type:a.H.Api,fpsController:n,getVideoElementSizes:d,defaultQuality:c});case o.$.YASP:return new S({source:r,getState:i,getCapSizes:s,type:a.H.Api,getVideoElementSizes:d,defaultQuality:c});case o.$.YANDEX:return void new h(r);default:return}}r.d(t,{J:()=>n});var a=r(3992),o=r(3486),l=r(3587),d=r(1122),c=r(6351),u=r(3770);class h extends d.V{get preloaded(){return"none"}constructor(e){super(),this.source=e}getSource(){return this.source}getBufferedInfo(){return{total:[],audio:[],video:[]}}async preload(){await i(JSON.stringify({url:this.source.stream.url}))}}var p=r(5386),f=r(4513),m=r(5355),g=(r(7881),r(6610)),v=r(4834),y=r(2102),E=r(4893);class S extends f.M{constructor(e){super(),this.props=e,this.isDestroyed=!1,this.preloaded="none",this.url="",this.bufferedInfo={total:[],audio:[],video:[]},this.fullPreloadDeferred=new g.B,this.handleBufferedInfoChange=e=>{let{source:t,bufferedInfo:r}=e;if(t!==this.url)return;this.bufferedInfo=r;this.bufferedInfo.total.reduce((e,t)=>{let{start:r,end:i}=t;return e+(i-r)},0)>=v.a?(this.preloaded="full",this.fullPreloadDeferred.resolve()):this.preloaded="partial"},this.preload=(0,p.I)(async e=>{var t,r;if(this.isDestroyed)throw new Error("YaspPreloader was destroyed");this.url=(0,y.A)(this.props.source.stream.url,this.props.source.sourceParams.startPosition.videoTime),m.e.messenger.on("BufferedInfoChanged",this.handleBufferedInfoChange);const i=this.props.getVideoElementSizes();m.e.preloadSrc(this.url,{videoContentId:null!=(t=null==(r=this.props.source.sourceParams.videoInfo)?void 0:r.videoContentId)?t:"missed"}).then(()=>{i&&m.e.setVideoElementSizes(this.url,i);const t=m.e.getStats().bandwidth||(null==e?void 0:e.defaultBandwidthEstimate);return m.e.configure(this.url,{defaultBandwidthEstimate:t,presentationDelay:null==e?void 0:e.presentationDelay,userQuality:(0,E.n)(),defaultQuality:this.props.defaultQuality}),this.preloaded="manifest",this.fullPreloadDeferred.promise})}),this.once("Destroy",()=>{this.isDestroyed=!0})}getBufferedInfo(){return this.bufferedInfo}getSource(){return this.props.source}destroy(){m.e.releaseSrc(this.props.source.stream.url),m.e.messenger.off("BufferedInfoChanged",this.handleBufferedInfoChange),super.destroy()}}},7553:(e,t,r)=>{"use strict";function i(e,t){return e.responseEnd-t.responseEnd}function s(){if("undefined"===typeof window.performance)return{value:NaN,source:"timing-api"};const e=u.B.reduce((e,t)=>(0,c.Z)(e,function(e){try{return e.performance.getEntriesByType("resource").filter(e=>{let{duration:t,responseEnd:r,transferSize:i}=e;return t>0&&r>0&&i>1024})}catch(t){return[]}}(t),i),[]).filter(e=>{let{name:t}=e;return h.l.test(t)});if(0===e.length)return{value:NaN,source:"timing-api"};const t=new p.I;return e.forEach(e=>{let{transferSize:r,duration:i}=e;return t.sample(i,r)}),t.getBandwidthEstimate({value:NaN,source:"timing-api"})}function n(e){const{controller:{lastKnownBandwidthEstimate:t,playerConfig:r}}=e;if(isFinite(t.value))return t;if(null!=r&&r.slowConnection)return{value:l.e,source:"default-slow"};const i=(0,d.N)();if(!isNaN(i)&&i>0)return{value:i,source:"cache"};const n=s();if(!isNaN(n.value)&&n.value>0)return n;const c=function(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:r={}}=t;if("number"===typeof r.downlink)return r.downlink;if("number"===typeof r.downlinkMax)return r.downlinkMax;if("string"===typeof r.type||"number"===typeof r.type)switch(r.type){case o.BLUETOOTH:return 3;case a.CELL_2G:return.384;case a.CELL_3G:case o.CELLULAR:return 2;case o.WIMAX:return 37;case o.NONE:return 0;case a.ETHERNET:case o.ETHERNET:case a.WIFI:case o.WIFI:case o.MIXED:return 10;case a.UNKNOWN:case o.UNKNOWN:case o.OTHER:}return-1}(window);return-1===c?{value:l.S,source:"network-api"}:{value:1e3*c*1e3,source:"network-api"}}var a,o;r.d(t,{L:()=>n}),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.ETHERNET=1]="ETHERNET",e[e.WIFI=2]="WIFI",e[e.CELL_2G=3]="CELL_2G",e[e.CELL_3G=4]="CELL_3G"}(a||(a={})),function(e){e.BLUETOOTH="bluetooth",e.CELLULAR="cellular",e.ETHERNET="ethernet",e.MIXED="mixed",e.NONE="none",e.OTHER="other",e.UNKNOWN="unknown",e.WIFI="wifi",e.WIMAX="wimax"}(o||(o={}));r(7881);var l=r(8493),d=r(9583),c=r(6197),u=r(2440),h=r(7841),p=r(8441)},8578:(e,t,r)=>{"use strict";function i(e){let{width:t,height:r}=e;const i=Math.max(t,r),a=Math.min(t,r);if(i<=0)return 0;let o=s[0];for(let l=0;l<s.length;l++){const e=s[l],t=n[e];if(i>=1.3*Math.floor(16*t/9)||a>=1.3*t)return o;o=e}return s[s.length-1]}r.d(t,{E:()=>i});const s=[4320,2880,2160,1440,1080,720,480,360,240,144,0],n=s.reduce((e,t)=>(e[t]=t,e),Object.create(null))},4893:(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var i=r(6612);const s={width:null,height:null},n=()=>{const e=i.t.getItem("videoplayer-user-quality-choice");if(!e)return s;try{return JSON.parse(e)}catch(t){return s}}},2178:(e,t,r)=>{"use strict";function i(e){let{win:t=window,src:r,checkLoad:i,onBeforeLoad:s=l.Z,onLoad:n=l.Z,withCredentials:d=!1}=e;o.s["ll1.0-10769"]=o.s["ll1.0-10769"]||{};const c=o.s["ll1.0-10769"];return c[r]||(c[r]=(0,a.v)({checkLoad:i,win:t,src:r,retries:3,dropCacheOnRetry:!0,onBeforeLoad:e=>{d||(e.crossOrigin="anonymous"),s()}}).then(n),c[r].catch(()=>delete c[r])),c[r]}function s(){let e=!1;return i({src:c.v2,checkLoad:()=>"undefined"!==typeof Hls,onBeforeLoad:()=>{e=!0,(0,d.iW)("lib.hlsjs")},onLoad:()=>{e&&(0,d.vG)("lib.hlsjs")}})}function n(){let e=!1;return i({src:c.LN,checkLoad:()=>"undefined"!==typeof shaka,onBeforeLoad:()=>{e=!0,(0,d.iW)("lib.shaka")},onLoad:()=>{e&&(0,d.vG)("lib.shaka")}}).then(u._)}r.d(t,{NF:()=>s,tL:()=>n});var a=r(8842),o=r(1208),l=r(55),d=r(5865),c=r(1701),u=r(9828)},2150:(e,t,r)=>{"use strict";function i(e,t){a.v&&n<81&&n>77&&e.duration-t<.5&&(t=e.duration-.5),e.currentTime=t}r.d(t,{O:()=>i});var s=r(1247);const n=function(e){const t=(0,s.i)(e).match(/Firefox\/([0-9]+)\./);return t&&parseInt(t[1],10)||-1}(window);var a=r(1076);r(7881)},9828:(e,t,r)=>{"use strict";function i(){a(),(0,n.E)(window.VTTCue)||(o?window.VTTCue=o:o=window.VTTCue)}r.d(t,{_:()=>i});var s=r(5386),n=r(5638);const a=(0,s.I)(()=>shaka.polyfill.installAll());let o},2843:(e,t,r)=>{"use strict";r.d(t,{D:()=>i});r(7881);const i=Math.max(5,0)},7588:(e,t,r)=>{"use strict";r.d(t,{K:()=>i});const i="other"},442:(e,t,r)=>{"use strict";r.d(t,{C:()=>n,d4:()=>i,e8:()=>s});r(7881);const i=8e3,s=1e4,n=1e4},2613:(e,t,r)=>{"use strict";r.d(t,{O:()=>i});const i=2},1062:(e,t,r)=>{"use strict";r.d(t,{o:()=>i.o});var i=r(7951)},6432:(e,t,r)=>{"use strict";r.d(t,{Ah:()=>a,OC:()=>n,PO:()=>i,RR:()=>o,Vy:()=>s});const i=[401,403],s=404,n=418,a=451,o=454},2248:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});const i=["strm.yandex.net","strm.yandex.ru","strm-ott.akamaized.net","media.strm.yandex.net","cdn.ngenix.net","streaming.tst.strm.yandex.net"]},6976:(e,t,r)=>{"use strict";r.d(t,{L:()=>i});const i="StreamPlayerJs TextTrack"},4885:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{R:()=>c});var s=r(1991),n=r(6351),a=r(8533),o=r.n(a),l=r(9278);var d=r(8682);const c={name:(e=>{l.f.i18nLang||(l.f.i18nLang="ru");const t=l.f.i18nLang;if(!(0,n.m)(l.f.i18nTranslateEngine)){const e=r(7050)("./"+t+".ts");(0,a.setI18nLang)(t),l.f.i18nTranslateEngine=o()(i({},e))}return l.f.i18nTranslateEngine(e)})("TRACK_AUTO"),value:d.A,bitrate:s.A}},8682:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});const i="auto"},1991:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});r(7881);const i=-1},6620:(e,t,r)=>{"use strict";r.d(t,{_:()=>i,d:()=>s});const i=1,s=0},2891:(e,t,r)=>{"use strict";r.d(t,{W:()=>i});const i=3},5586:(e,t,r)=>{"use strict";r.d(t,{Y:()=>i});const i=1e4},3120:(e,t,r)=>{"use strict";function i(e,t){if(void 0===t&&(t=!1),e===o.x.NO_CODECS&&s.E&&n.c>6)return{title:"NO_CODECS_TITLE",message:"NO_CODECS_MESSAGE",helpLink:"https://yandex.ru/support/video-player/player-issues.html#no-codecs",helpLinkButtonText:"NO_CODECS_HELP_LINK_TITLE"};const r=(0,l.W)(e);return t&&function(e){return[a.q.NETWORK_PLAYER,a.q.NETWORK_MEDIA,a.q.NETWORK_TIMEOUT,a.q.DRM,a.q.ADS].indexOf(e)>-1}(r)?{title:"ADBLOCK_DETECTED_TITLE",message:"ADBLOCK_DETECTED_MESSAGE",helpLink:"https://yandex.ru/support/video-player/blocker-settings.html",helpLinkButtonText:"ERROR_SCREEN_DEFAULT_HELP_LINK"}:function(e){return{title:c[e],message:u[e],helpLink:d[e],helpLinkButtonText:h[e]||"ERROR_SCREEN_DEFAULT_HELP_LINK"}}(r)}r.d(t,{e:()=>i});var s=r(3089),n=r(8274),a=r(6971),o=r(7985),l=r(3234);const d={[a.q.MEDIA]:"https://yandex.ru/support/video-player/loading-issues.html",[a.q.NETWORK_MEDIA]:"https://yandex.ru/support/video-player/loading-issues.html",[a.q.NETWORK_PLAYER]:"https://yandex.ru/support/video-player/player-issues.html",[a.q.NETWORK_TIMEOUT]:"https://yandex.ru/support/video-player/player-issues.html",[a.q.NO_CODECS]:"https://yandex.ru/search/?text=\u043a\u043e\u0434\u0435\u043a\u0438",[a.q.UNSUPPORTED_ENV]:"https://yandex.ru/soft/browsers/",[a.q.EXCEPTION]:"https://yandex.ru/support/video-player/loading-issues.html",[a.q.DRM]:"https://yandex.ru/support/video-player/drm.html",[a.q.BANNED]:null},c={[a.q.DEFAULT]:"DEFAULT_ERROR_CATEGORY_TITLE",[a.q.MEDIA]:"MEDIA_ERROR_CATEGORY_TITLE",[a.q.NETWORK_MEDIA]:"NETWORK_MEDIA_ERROR_CATEGORY_TITLE",[a.q.NETWORK_PLAYER]:"NETWORK_PLAYER_ERROR_CATEGORY_TITLE",[a.q.NETWORK_TIMEOUT]:"NETWORK_TIMEOUT_ERROR_CATEGORY_TITLE",[a.q.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_TITLE",[a.q.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_TITLE",[a.q.CANNOT_PLAY]:"CANNOT_PLAY_ERROR_CATEGORY_TITLE",[a.q.EXCEPTION]:"EXCEPTION_ERROR_CATEGORY_TITLE",[a.q.CONFIG]:"CONFIG_ERROR_CATEGORY_TITLE",[a.q.REGIONAL]:"REGIONAL_ERROR_CATEGORY_TITLE",[a.q.DRM]:"DRM_ERROR_CATEGORY_TITLE",[a.q.ACCESS]:"ACCESS_ERROR_CATEGORY_TITLE",[a.q.BANNED]:"BANNED_ERROR_CATEGORY_TITLE"},u={[a.q.DEFAULT]:"DEFAULT_ERROR_CATEGORY_MESSAGE",[a.q.MEDIA]:"MEDIA_ERROR_CATEGORY_MESSAGE",[a.q.NETWORK_MEDIA]:"NETWORK_MEDIA_ERROR_CATEGORY_MESSAGE",[a.q.NETWORK_PLAYER]:"NETWORK_PLAYER_ERROR_CATEGORY_MESSAGE",[a.q.NETWORK_TIMEOUT]:"NETWORK_TIMEOUT_ERROR_CATEGORY_MESSAGE",[a.q.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_MESSAGE",[a.q.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_MESSAGE",[a.q.CANNOT_PLAY]:"CANNOT_PLAY_ERROR_CATEGORY_MESSAGE",[a.q.EXCEPTION]:"EXCEPTION_ERROR_CATEGORY_MESSAGE",[a.q.CONFIG]:"CONFIG_ERROR_CATEGORY_MESSAGE",[a.q.DRM]:"DRM_ERROR_CATEGORY_MESSAGE",[a.q.ACCESS]:"ACCESS_ERROR_CATEGORY_MESSAGE",[a.q.BANNED]:"BANNED_ERROR_CATEGORY_MESSAGE"},h={[a.q.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_HELP_LINK",[a.q.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_HELP_LINK"}},675:(e,t,r)=>{"use strict";let i;r.d(t,{y:()=>i}),function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(i||(i={}))},9730:(e,t,r)=>{"use strict";let i;r.d(t,{k:()=>i}),function(e){e.Init="Init",e.SetSource="SetSource",e.Seek="Seek",e.VideoTrackChange="VideoTrackChange",e.AudioTrackChange="AudioTrackChange",e.Recover="Recover",e.MediaError="MediaError",e.Offline="Offline",e.Render="Render",e.Other="Other",e.RepresentationsChange="RepresentationsChange",e.LiveEdge="LiveEdge",e.AdStart="AdStart",e.AdOther="AdOther",e.AdBetween="AdBetween",e.AdEnd="AdEnd"}(i||(i={}))},3992:(e,t,r)=>{"use strict";let i;r.d(t,{H:()=>i}),function(e){e.Internal="internal",e.Api="api",e.Cache="cache"}(i||(i={}))},9908:(e,t,r)=>{"use strict";let i;r.d(t,{w:()=>i}),function(e){e.ON="ON",e.OFF="OFF"}(i||(i={}))},3486:(e,t,r)=>{"use strict";r.d(t,{$:()=>i.$});var i=r(8107)},1701:(e,t,r)=>{"use strict";r.d(t,{LN:()=>s,v2:()=>i});const i="https://yastatic.net/yandex-video-player-iframe-api-bundles/hlsjs/0.12.2-1761-1846-1976_tmp-2080-2095-2146-2171-2-2172-2232_tmp-2427-2498/hls.min.js",s="https://yastatic.net/yandex-video-player-iframe-api-bundles/shaka/2.5.17-yandex-patched-fix-ttml-parsing/shaka-player.compiled.js"},4929:(e,t,r)=>{"use strict";r.d(t,{y:()=>i});class i{constructor(e){this.length=e,this.list=[]}push(e){this.list.length>=this.length&&this.list.shift(),this.list.push(e)}getAll(){return this.list}clear(){this.list.length=0}copy(){const e=new i(this.length);return e.list=this.list.slice(),e}has(e){return-1!==this.list.indexOf(e)}size(){return this.list.length}}},7182:(e,t,r)=>{"use strict";function i(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=t.map(s),n="YA PLAYER: "+(new Date).toString()+" "+i.join(" ");return n}function s(e){return e&&"object"===typeof e?JSON.stringify(e,Object.getOwnPropertyNames(e)):e}r.d(t,{Y:()=>l});var n=r(8468),a=r(3770);const o=[];class l{static enableConsole(){l.consoleEnabled=!0,l.log("YA PLAYER VERSION: 1.0-10769")}static log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];l.consoleEnabled&&console.log(i(...t)),l.addToHistory("log",t)}static warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];l.consoleEnabled&&console.warn(i(...t)),l.addToHistory("warn",t)}static error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];l.consoleEnabled&&console.error(i(...t)),l.addToHistory("error",t)}static getHistory(){return[...o]}static addToHistory(e,t){o.length>=150&&o.shift(),o.push("["+e+"]["+Date.now()+"] "+t.map(e=>{try{return(0,n.Y)(e)}catch(t){return(0,a.K)(t)?JSON.stringify(["stringify_error",t.stack]):JSON.stringify(["stringify_error","not_an_object_error"])}}).join())}}l.consoleEnabled=void 0},7841:(e,t,r)=>{"use strict";r.d(t,{l:()=>i});const i=new RegExp("^https?:\\/\\/([^\\/]+\\.)?("+["strm-ott\\.akamaized\\.net","akamai\\.strm\\.yandex\\.net","(an|strm)\\.yandex\\.(ru|net)","cdn\\.ngenix\\.net","strm\\.yandex\\.cdnga\\.net","strm-yandex\\.gcdn\\.co","(widevine|playready|fairplay)-proxy\\.ott\\.yandex\\.ru"].join("|")+")\\/(?!log|perf|jstracer|ping)")},9304:(e,t,r)=>{"use strict";async function i(e){let{url:t,data:r,contentType:i}=e;if(((e,t)=>{if("function"!==typeof navigator.sendBeacon)return!1;try{return navigator.sendBeacon(e,t)}catch(r){return!1}})(t,i?new Blob([r],{type:i}):r))return;const s=new XMLHttpRequest;s.open("POST",t),s.withCredentials=!0,void 0!==i&&s.setRequestHeader("Content-Type",i),s.send(r)}r.d(t,{$W:()=>a});r(7881);var s=r(7841);const n={perfLogUrl:"https://log.strm.yandex.ru/perf",updateInterval:3e4,urlRegexp:s.l};class a{static clearResourceTimings(){"function"===typeof performance.clearResourceTimings?performance.clearResourceTimings():"function"===typeof performance.webkitClearResourceTimings&&performance.webkitClearResourceTimings()}constructor(e){let{perfLogUrl:t=n.perfLogUrl,updateInterval:r=n.updateInterval,urlRegexp:i=n.urlRegexp}=void 0===e?{}:e;this.timeoutId=void 0,this.history=[],this.reportUrl=void 0,this.updateInterval=void 0,this.urlRegexp=void 0,this.reportUrl=t,this.updateInterval=r,this.urlRegexp="string"===typeof i?new RegExp(i):i,a.isSupported&&this.loop()}destroy(){clearTimeout(this.timeoutId)}async updateInfo(){if(!a.isSupported)return;const e=this.getCurrentResourcesTimings();if(a.clearResourceTimings(),0===e.length)return;this.history.push(...e),this.history.length>200&&this.history.splice(0,this.history.length-200);const t=new URL(this.reportUrl);t.searchParams.set("perfnow",String(Date.now())),t.searchParams.set("navstart",String(void 0!==performance.timeOrigin?performance.timeOrigin:performance.timing.navigationStart)),i({url:t.href,data:JSON.stringify(e)})}getAllResourcesTimings(){return[...this.history,...this.getCurrentResourcesTimings()]}getCurrentResourcesTimings(){if(!a.isSupported)return[];return performance.getEntriesByType("resource").filter(e=>{let{name:t}=e;return this.urlRegexp.test(t)&&t!==this.reportUrl})}loop(){this.updateInterval<=0||(this.timeoutId=window.setTimeout(async()=>{await this.updateInfo(),this.loop()},this.updateInterval))}}a.isSupported=window.performance&&"function"===typeof window.performance.getEntriesByType&&("function"===typeof performance.clearResourceTimings||"function"===typeof performance.webkitClearResourceTimings)},8559:(e,t,r)=>{"use strict";function i(e,t){let{name:r,lang:i}=t;const s=r?e.find(e=>e.name===r):void 0;return s||(i?e.find(e=>e.lang===i):void 0)}r.d(t,{x:()=>i})},3117:(e,t,r)=>{"use strict";function i(e,t){let{name:r,lang:i}=t;const s=e.find(e=>e.name===r);return s||(i?e.find(e=>e.lang===i):void 0)}r.d(t,{Y:()=>i})},267:(e,t,r)=>{"use strict";function i(e,t){let{name:r,height:i}=t;const n=r?e.find(e=>e.name===r):void 0;if(n)return n;if(void 0===i)return;const a=e.filter(e=>{let{height:t}=e;return void 0!==t});return(0,s.U)(a,e=>{let{height:t}=e;return Math.abs(t-i)})}r.d(t,{G:()=>i});var s=r(5679)},278:(e,t,r)=>{"use strict";function i(e){let{kind:t}=e;return"subtitles"===t}function s(e){const t=[];for(let r=0;r<e.length;r++)i(e[r])&&t.push(e[r]);return t}r.d(t,{I:()=>s})},6571:(e,t,r)=>{"use strict";function i(e){let{videoTracks:t=[],videoHeight:r,videoWidth:i}=e;const a=(0,s.w)(t),o=a.find(e=>{let{selected:t}=e;return t});if(void 0!==o)return o.id===n.A?(e=>{let{tracks:t,videoHeight:r,videoWidth:i}=e;return t.sort((e,t)=>{const{width:s=0,height:n=0}=e,{width:a=0,height:o=0}=t;return Math.abs(n-r)-Math.abs(o-r)||Math.abs(s-i)-Math.abs(a-i)})[0]})({tracks:a,videoHeight:r,videoWidth:i}):o}r.d(t,{s:()=>i});var s=r(7469);var n=r(8682)},2523:(e,t,r)=>{"use strict";function i(){return"disabled"}r.d(t,{l:()=>i})},6213:(e,t,r)=>{"use strict";function i(e){return e?"showing":"hidden"}r.d(t,{L:()=>i})},980:(e,t,r)=>{"use strict";function i(e){if(void 0===e)return;const{id:t,label:r,language:i,bitrate:n=s.A,height:a=0,width:o=0}=e;return{name:r||i,value:t,bitrate:n,height:a,width:o}}r.d(t,{Y:()=>i});var s=r(1991)},10:(e,t,r)=>{"use strict";function i(e){const t=[];return(0,s.w)(e).forEach(e=>{const r=(0,n.Y)(e);r&&t.push(r)}),t.filter(e=>{let{value:t}=e;return t!==a.A})}r.d(t,{x:()=>i});var s=r(7469),n=r(980),a=r(8682)},8835:(e,t,r)=>{"use strict";r.d(t,{C:()=>n,s:()=>a});var i=r(9507),s=(r(7881),r(5779));const n=(e,t)=>{let r=!1;const i=()=>{const i=a(e,r?.3:.15);i!==r&&(r=i,t(r))},n=(0,s.X)(i),o=setTimeout(i,0);return()=>{n(),clearTimeout(o)}},a=function(e,t){void 0===t&&(t=.15);const{currentTime:r,duration:s}=e;return e.readyState<e.HAVE_FUTURE_DATA||!(0,i.e)(e).some(e=>{let{start:i,end:n}=e;return!(r<i||r>n)&&(s<=n||r+t<n)})}},5372:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});r(7881);var i=r(4343);class s{constructor(){this.lastUpdate=void 0,this.watchedTime=0}calc(e,t,r){if(void 0!==this.lastUpdate){const r=function(e,t){const r=e>=0&&e<=t+.5?e:t;return Math.max(0,r)}((e-this.lastUpdate.videoTime)/t,this.lastUpdate.getElapsedTime()/1e3);this.watchedTime=this.watchedTime+r}this.lastUpdate=r?{getElapsedTime:(0,i.u)(),videoTime:e}:void 0}get(){return this.watchedTime}restoreLastUpdate(){this.lastUpdate=void 0}}},6533:(e,t,r)=>{"use strict";function i(e){return new n.u({isFatal:e.isFatal,code:e.error===a.EXPIRED_SIGNATURE?s.x.DRM_PROXY_ERROR_SIGNATURE_EXPIRED:s.x.DRM_PROXY_ERROR,details:{drmProxyError:e.error}})}r.d(t,{t:()=>i});var s=r(7985),n=r(5921);let a;!function(e){e.EXPIRED_SIGNATURE="EXPIRED_SIGNATURE"}(a||(a={}))},5210:(e,t,r)=>{"use strict";function i(e,t,r){return void 0===r&&(r=0),(0,s.s)(e,e=>{let{start:i,end:s}=e;return i-r<=t&&t<=s+r})}r.d(t,{k:()=>i});var s=r(3888)},5334:(e,t,r)=>{"use strict";function i(e,t){for(let r=0;r<e.length;++r){const{start:i,end:s}=e[r];if(i<=t+.1&&t<=s)return Math.max(s-t,0)}return 0}function s(e,t){return{total:i(e.total,t),audio:i(e.audio,t),video:i(e.video,t)}}r.d(t,{t:()=>s});r(7881)},7568:(e,t,r)=>{"use strict";function i(e,t){const r=(0,s.k)(e,t);return void 0===r?void 0:r.end-t}r.d(t,{p:()=>i});r(7881);var s=r(5210)},1343:(e,t,r)=>{"use strict";function i(e){return e&&(0,s.G)(e)||window}r.d(t,{F:()=>i});var s=r(4769)},2786:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:r={}}=t;return Boolean(r.saveData)}r.d(t,{R:()=>i})},1091:(e,t,r)=>{"use strict";function i(e,t){return e===n.Ah?t?s.x.REGIONAL_LIMITATION_MANIFEST:s.x.REGIONAL_LIMITATION_SEGMENT:n.PO.includes(e)?t?s.x.SIGNATURE_EXPIRED_MANIFEST:s.x.SIGNATURE_EXPIRED_SEGMENT:e===n.RR?t?s.x.BANNED_MANIFEST:s.x.BANNED_SEGMENT:e===n.Vy&&t?s.x.MANIFEST_NOT_FOUND:void 0}r.d(t,{X:()=>i});var s=r(7985),n=r(6432)},9278:(e,t,r)=>{"use strict";function i(e){const t=e;return t.Ya||(t.Ya={}),t.Ya.streamPlayer||(t.Ya.streamPlayer={}),t.Ya.streamPlayer}r.d(t,{I:()=>i,f:()=>s});const s=i("object"===typeof self?self:window)},7675:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){return{error:String(e.error)||"",isFatal:Boolean(e.isFatal)}}function n(e){if("string"===typeof e)try{return s(JSON.parse(e))}catch(t){return i({},a,{error:e})}return"object"===typeof e?s(e):a}r.d(t,{P:()=>a,c:()=>n});const a={error:"",isFatal:!1}},2626:(e,t,r)=>{"use strict";function i(e,t){void 0===t&&(t={});let r=0;const i=[],l=(t,n)=>{i.push((0,s.O)(e,t,n,o)),clearTimeout(r)},d=()=>(0,n.p)(i),c=new Promise((i,s)=>{const n=t=>{e.paused&&s(t)},o=e.play();if(n(a.VideoTagPaused),l("durationchange",()=>n(a.VideoTagPausedAfterDurationChange)),l("error",()=>n(a.VideoTagPausedAfterError)),l("pause",()=>s(a.PauseEvent)),l("playing",()=>{i(a.PlayingEvent)}),o)t.useProgressEvent&&l("progress",()=>{i(a.ProgressEvent)}),o.then(()=>i(a.PromiseResolve)).catch(e=>s(function(e){return e?a.PromiseReject+"["+e.code+"]["+e.name+"]["+e.message+"]":a.PromiseReject}(e)));else{const{timeoutForNonPromisePlay:e}=t;"number"===typeof e&&e>0&&(r=window.setTimeout(()=>{s(a.Timeout)},t.timeoutForNonPromisePlay))}});return c.then(d,d),c}r.d(t,{b:()=>i});var s=r(3945),n=r(8692);let a;!function(e){e.VideoTagPaused="VideoTagPaused",e.VideoTagPausedAfterDurationChange="VideoTagPausedAfterDurationChange",e.VideoTagPausedAfterError="VideoTagPausedAfterError",e.PauseEvent="PauseEvent",e.ProgressEvent="ProgressEvent",e.PromiseResolve="PromiseResolve",e.PromiseReject="PromiseReject",e.PlayingEvent="PlayingEvent",e.Timeout="Timeout"}(a||(a={}));const o={once:!0,passive:!0}},532:(e,t,r)=>{"use strict";function i(e){const t=(0,s.I)(e);return t?()=>{(0,s.I)(e)!==t&&a()(e,t)}:o.Z}r.d(t,{n:()=>i});var s=r(3853),n=r(8139),a=r.n(n),o=r(55)},5690:(e,t,r)=>{"use strict";function i(e,t){const r=new Map;e.forEach((e,t)=>r.set(e,t)),e.sort((e,i)=>{const s=t(e,i);return 0!==s?s:Number(r.get(e))-Number(r.get(i))})}r.d(t,{X:()=>i})},4055:(e,t,r)=>{"use strict";r.d(t,{DZ:()=>n,OI:()=>a,dA:()=>s});var i=r(222);const s=e=>"m3u8"===(0,i.lm)(e.toLocaleLowerCase()),n=e=>"mpd"===(0,i.lm)(e.toLocaleLowerCase()),a=e=>"mp4"===(0,i.lm)(e.toLocaleLowerCase())},4980:(e,t,r)=>{"use strict";r.d(t,{$:()=>s});r(7881);var i=r(4513);class s extends i.M{constructor(e,t){super();let r={videoWidth:e.videoWidth,videoHeight:e.videoHeight};const i=()=>{const{videoWidth:i,videoHeight:s}=e;isNaN(i)||isNaN(s)||i<1||s<1||r.videoWidth===i&&r.videoHeight===s||(r={videoWidth:i,videoHeight:s},t({videoWidth:i,videoHeight:s}))};if("onresize"in e)e.addEventListener("resize",i),this.once("Destroy",()=>e.removeEventListener("resize",i));else{e.addEventListener("timeupdate",i),this.once("Destroy",()=>e.removeEventListener("timeupdate",i));const t=setInterval(i,1e3);this.once("Destroy",()=>clearInterval(t))}}}},1042:(e,t,r)=>{"use strict";function i(e,t){const{paused:r}=e,i=t();return r||(0,s.v)(e.play()),i}r.d(t,{s:()=>i});var s=r(4230)},4956:(e,t,r)=>{"use strict";r.d(t,{_:()=>i});const i=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]}]},7922:(e,t,r)=>{"use strict";r.d(t,{D:()=>s,Ql:()=>i,h9:()=>n,oo:()=>a,xE:()=>o});const i="com.widevine.alpha",s="com.apple.fairplay",n="com.apple.fps.1_0",a="com.apple.fps.2_0",o="com.microsoft.playready"},4834:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});r(7881);const i=5},4910:(e,t,r)=>{"use strict";function i(e){return void 0===e?"":e.replace(/#.+$/,"")}r.d(t,{H:()=>i})},2102:(e,t,r)=>{"use strict";function i(e,t){const r={audio_mbr:"1",mburl:"1"};return(0,a.RW)("web_yasp_cmaf")&&(r.drm_packager="1"),(e.startsWith("https://strm.yandex.ru/live/")||e.startsWith("https://streaming.tst.strm.yandex.net/live/"))&&(r.packager="1",r.lowlatency="1"),(0,s.Sr)((0,n.o)(e,t),r,{saveOriginalPath:!0})}r.d(t,{A:()=>i});var s=r(222),n=r(3133),a=r(5543)},418:(e,t,r)=>{"use strict";function i(e){switch(e.source){case"default":case"default-slow":case"cache":case"timing-api":case"network-api":case"ewma":case"hlsjs":case"yabro":case"shaka-default":case"shaka-network-api":case"external-yasp":return e;default:return{value:e.value,source:"external-yasp"}}}r.d(t,{S:()=>i})},1106:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{w:()=>n});var s=r(413);class n extends s.s{constructor(e,t){super(i({isFatal:!1},e),t),this.category=void 0,this.toJSON=void 0,this.category=(null==t?void 0:t.category)||e.category,this.toJSON=()=>({message:this.message,code:this.code,isFatal:this.isFatal,details:this.details,stack:this.stack,category:this.category})}}},5355:(e,t,r)=>{"use strict";function i(){return"media-track-"+E++}function s(e,t){if(void 0===t&&(t={bubbles:!1,cancelable:!1,detail:void 0}),"function"===typeof CustomEvent)return new CustomEvent(e,t);const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}function n(e,t){for(let r=0;r<e.length;r++)t.id!==e[r].id&&(e[r].enabled=!1)}function a(e){if(void 0!==e)for(;e.length>0;)e.removeTrack(e[0])}function o(e,t){for(let r=0;r<e.length;r++)Object.keys(e[r]).length&&t.id!==e[r].id&&(e[r].selected=!1)}function l(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(e,t,i){var s={};s[i]=[];var n=t.toString(),a=n.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||n.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!a)return s;for(var o,d=a[1],c=new RegExp("(\\\\n|\\W)"+l(d)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");o=c.exec(n);)"dll-reference"!==o[3]&&s[i].push(o[3]);for(c=new RegExp("\\("+l(d)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");o=c.exec(n);)e[o[2]]||(s[i].push(o[1]),e[o[2]]=r(o[1]).m),s[o[2]]=s[o[2]]||[],s[o[2]].push(o[4]);for(var u,h=Object.keys(s),p=0;p<h.length;p++)for(var f=0;f<s[h[p]].length;f++)u=s[h[p]][f],isNaN(1*u)||(s[h[p]][f]=1*s[h[p]][f]);return s}function c(e){return Object.keys(e).reduce((t,r)=>t||e[r].length>0,!1)}function u(e,t,r,i){let s=e[i].map(e=>'"'+e+'": '+t[i][e].toString()).join(","),n=N.toString().split("ENTRY_MODULE");return n[0]+"{"+s+"}"+n[1]+'"'+r+'"'+n[2]}function h(e,t){t=t||{};var i={main:r.m},s=t.all?{main:Object.keys(i.main)}:function(e,t){for(var r={main:[t]},i={main:[]},s={main:{}};c(r);)for(var n=Object.keys(r),a=0;a<n.length;a++){var o=n[a],l=r[o].pop();if(s[o]=s[o]||{},!s[o][l]&&e[o][l]){s[o][l]=!0,i[o]=i[o]||[],i[o].push(l);for(var u=d(e,e[o][l],o),h=Object.keys(u),p=0;p<h.length;p++)r[h[p]]=r[h[p]]||[],r[h[p]]=r[h[p]].concat(u[h[p]])}}return i}(i,e),n="";Object.keys(s).filter(e=>"main"!==e).forEach(e=>{for(var t=0;s[e][t];)t++;s[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",n=n+"var "+e+" = ("+u(s,i,t,modules)+")();\n"}),n=n+"var a = ("+u(s,i,e,"main")+");\ntry {\n    a();\n} catch(e) { console.warn(e); throw e }";var a=new window.Blob([n],{type:"text/javascript"});if(t.bare)return a;var o=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(a),l=new window.Worker(o);return l.objectURL=o,l}function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{e:()=>Te});var m=r(8139),g=r.n(m);class v extends HTMLVideoElement{constructor(){super(...arguments),this.yasp=void 0,this.error=void 0}}v.isSupported=void 0,v.attach=void 0,v.isYaspVideoElement=void 0,v.preloadSrc=void 0,v.releaseSrc=void 0,v.setVideoElementSizes=void 0,v.getStats=void 0,v.configure=void 0,v.messenger=void 0,v.destroy=void 0;var y=r(532);let E=0;class S{constructor(e){let{label:t="",language:r="",id:s=i(),sourceBuffer:n=null,props:a}=e;this.label=void 0,this.id=void 0,this.language=void 0,this.kind="",this.props=void 0,this.sourceBuffer=null,this.label=t,this.language=r,this.id=s,this.sourceBuffer=n,this.props=a}}const A=["enabled","bitrate"];class T extends S{constructor(e){let t=void 0===e?{}:e,{enabled:r=!1,bitrate:i}=t;super(function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(t,A)),this._enabled=!1,this.bitrate=void 0,this.onenabledchange=void 0,this._enabled=r,this.bitrate=i}_destroy(){delete this.onenabledchange}get enabled(){return this._enabled}set enabled(e){var t;"boolean"===typeof e&&e!==this._enabled&&(this._enabled=e,null==(t=this.onenabledchange)||t.call(this))}}var b=r(9840);class R extends b.Z{constructor(e){void 0===e&&(e=[]),super(),this.tracks=[],this._changing=!1;for(let t=0;t<e.length;t++)this.addTrack(e[t])}get length(){return this.tracks.length}addTrack(e){if(-1!==this.tracks.indexOf(e))return;const t=this.tracks.length;Object.defineProperty(this,t,{get:()=>this.tracks[t],enumerable:!1,configurable:!0}),this.tracks.push(e),this.dispatchTrackEvent("addtrack",e)}removeTrack(e){const t=this.tracks.indexOf(e);if(-1===t)return;null==e._destroy||e._destroy();const r=this.tracks.length-1;String(r)in this&&Object.defineProperty(this,r,{get:void 0,enumerable:!1,configurable:!0}),this.tracks.splice(t,1),this.dispatchTrackEvent("removetrack",e)}getTrackById(e){return this.tracks.find(t=>t.id===e)||null}item(e){return this.tracks[e]}dispatchTrackEvent(e,t){const r=s(e);r.track=t,this.dispatchEvent(r)}}class w extends R{constructor(e){void 0===e&&(e=[]);for(let t=e.length-1;t>=0;t--)if(e[t].enabled){n(e,e[t]);break}super(e),this.onaddtrack=void 0,this.onchange=void 0,this.onremovetrack=void 0,this.onaddtrack=null,this.onchange=null,this.onremovetrack=null,this.addEventListener("change",e=>{var t;return null==(t=this.onchange)?void 0:t.call(this,e)}),this.addEventListener("addtrack",e=>{var t;return null==(t=this.onaddtrack)?void 0:t.call(this,e)}),this.addEventListener("removetrack",e=>{var t;return null==(t=this.onremovetrack)?void 0:t.call(this,e)})}addTrack(e){e.enabled&&n(this,e),super.addTrack(e),e.onenabledchange=()=>{this._changing||(this._changing=!0,n(this,e),this._changing=!1,this.dispatchEvent(s("change")))}}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}}const _=["selected","width","height","bitrate"];class k extends S{constructor(e){let t=void 0===e?{}:e,{selected:r=!1,width:i,height:s,bitrate:n}=t;super(function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(t,_)),this._selected=!1,this.width=void 0,this.height=void 0,this.bitrate=void 0,this.onselectedchange=void 0,this.selected=r,this.bitrate=n,this.width=i,this.height=s}_destroy(){delete this.onselectedchange}get selected(){return this._selected}set selected(e){var t;"boolean"===typeof e&&e!==this._selected&&(this._selected=e,null==(t=this.onselectedchange)||t.call(this))}}class P extends R{constructor(e){void 0===e&&(e=[]);for(let t=e.length-1;t>=0;t--)if(e[t].selected){o(e,e[t]);break}super(e),this.onaddtrack=void 0,this.onchange=void 0,this.onremovetrack=void 0,this.onaddtrack=null,this.onchange=null,this.onremovetrack=null,this.addEventListener("change",e=>{var t;return null==(t=this.onchange)?void 0:t.call(this,e)}),this.addEventListener("addtrack",e=>{var t;return null==(t=this.onaddtrack)?void 0:t.call(this,e)}),this.addEventListener("removetrack",e=>{var t;return null==(t=this.onremovetrack)?void 0:t.call(this,e)})}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}get selectedIndex(){for(let e=0;e<this.length;e++)if(this[e].selected)return e;return-1}addTrack(e){e.selected&&o(this,e),super.addTrack(e),e.onselectedchange=()=>{this._changing||(this._changing=!0,o(this,e),this._changing=!1,this.dispatchEvent(s("change")))}}}var I=r(4055),C=r(1122),O=r(9111);class D{constructor(e,t){this.externalEventTarget=new b.Z,this.internalEventTarget=new b.Z,e({addEventListener:this.internalEventTarget.addEventListener.bind(this.internalEventTarget),removeEventListener:this.internalEventTarget.addEventListener.bind(this.internalEventTarget),postMessage:e=>{const t=new MessageEvent("message",{data:e});Promise.resolve().then(()=>this.externalEventTarget.dispatchEvent(t))}},t)}addEventListener(e,t,r){this.externalEventTarget.addEventListener(e,t,r)}removeEventListener(e,t,r){this.externalEventTarget.removeEventListener(e,t,r)}terminate(){}postMessage(e){this.internalEventTarget.dispatchEvent(new MessageEvent("message",{data:e}))}}const N=function(){function e(i){if(r[i])return r[i].exports;var s=r[i]={exports:{}};return t[i](s,s.exports,e),s.exports}var t=ENTRY_MODULE,r={};e.m=t,e.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},e.d=(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},e.g=function(){if("[object Object]"===Object.prototype.toString.call(globalThis))return globalThis;try{return this||new Function("return this")()}catch(e){if("[object Object]"===Object.prototype.toString.call(window))return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i=e(ENTRY_MODULE);return i.default||i};N.toString();var L=r(4230),M=r(931),x=r(1647);class V extends C.V{constructor(e){super(),this.workerPromise=void 0,this.workerPromise=function e(t){let r,{inline:i,path:s,workerInternal:n,initialConfig:a}=t;if(!i)try{r=h(s)}catch(c){i=!0}i&&(r=new D(n,a));const o=new M.A(e=>{r.postMessage(e,(0,x._)(e))});let l=!1;const d=new Promise((t,d)=>{const c=o.request({method:"initWorker",params:a}),u=o=>{l||i?console.error(o):(h(),r.terminate(),t(e({inline:!0,workerInternal:n,path:s,initialConfig:a})))},h=()=>{r.removeEventListener("error",u)};c.then(()=>{l=!0,h(),t({worker:r,rpc:o})}).catch(u),r.addEventListener("error",u),r.addEventListener("message",e=>{o.handleMessage(e)})});return(0,L.v)(d),d}({inline:!e.useWebWorker,path:9111,workerInternal:O.Z,initialConfig:e.initialConfig}),this.workerPromise.then(()=>{console.log("!!! YaspWorker ready")})}async postMessage(){const{worker:e}=await this.workerPromise;e.postMessage(...arguments)}request(e){let{method:t,params:r}=e;return this.workerPromise.then(e=>{let{rpc:i}=e;return i.request({method:t,params:r})})}registerRpcHandler(e,t){this.workerPromise.then(r=>{let{rpc:i}=r;return i.registerHandler(e,t)})}removeRpcHandler(e){this.workerPromise.then(t=>{let{rpc:r}=t;return r.removeHandler(e)})}replaceRpcHandler(e,t){this.workerPromise.then(r=>{let{rpc:i}=r;i.removeHandler(e),i.registerHandler(e,t)})}destroy(){super.destroy(),this.workerPromise.then(e=>{let{worker:t,rpc:r}=e;t.terminate(),r.destroy()})}}var F=r(4980);r(7881);const U={attributes:!0,childList:!1,subtree:!1,attributeFilter:["loop"]};class B{constructor(e,t){this.observer=void 0,this.observer=new MutationObserver((function(r){for(const i of r){if("attributes"!==i.type)return;const r=i.attributeName;t(r,e[r])}})),this.observer.observe(e,U)}destroy(){var e;null==(e=this.observer)||e.disconnect(),this.observer=null}}var H=r(55),j=r(4458);class Y{constructor(e,t){this.callback=void 0,this.intervalId=void 0,this.playbackQualityController=void 0,this.oldValues={},this.tick=()=>{var e;null==(e=this.playbackQualityController)||e.update();const t=this.getFramesValue();void 0!==t&&this.callback("frames",t);const r=this.getDevicePixelRatio();void 0!==r&&this.callback("devicePixelRatio",r)},this.callback=t,this.playbackQualityController=new j.Q(e),this.intervalId=null}getFramesValue(){var e,t;if(null===this.playbackQualityController||null===this.oldValues)return;const{droppedVideoFrames:r,totalVideoFrames:i}=this.playbackQualityController.getPlaybackQuality();return(null==(e=this.oldValues.frames)?void 0:e.dropped)!==r||(null==(t=this.oldValues.frames)?void 0:t.total)!==i?(this.oldValues.frames={dropped:Math.max(Math.floor(r)),total:Math.max(Math.floor(i))},this.oldValues.frames):void 0}getDevicePixelRatio(){if(null===this.oldValues)return;const e=(t="undefined"!==typeof globalThis?globalThis:window).devicePixelRatio||t.screen.deviceXDPI&&t.screen.deviceXDPI/t.screen.logicalXDPI||1;var t;return this.oldValues.devicePixelRatio!==e?(this.oldValues.devicePixelRatio=e,this.oldValues.devicePixelRatio):void 0}enable(){this.tick(),this.intervalId=setInterval(this.tick,250)}disable(){var e;null==(e=this.playbackQualityController)||e.persist(),clearInterval(this.intervalId)}destroy(){var e;this.disable(),null==(e=this.playbackQualityController)||e.destroy(),this.callback=H.Z,this.oldValues=null}}var W=r(8692),G=r(3945),K=r(2905),q=r(3211),z=r(5779);const X=K.w||q.$?(e,t)=>{let r=e.paused;return(0,z.X)(()=>{e.paused!==r&&(r=e.paused,t(r))})}:(e,t)=>{let r=e.paused;const i=e=>{const i="pause"===e.type;i!==r&&(r=i,t(r))},s=(0,G.O)(e,"pause",i,{passive:!0}),n=(0,G.O)(e,"playing",i,{passive:!0}),a=(0,G.O)(e,"play",i,{passive:!0});return()=>{s(),n(),a()}};class Q{constructor(e){this.unsubscribers=[],this.video=void 0,this.destroy=()=>{(0,W.p)(this.unsubscribers)},this.unsubscribers=[],this.video=e}observe(e){const t=X(this.video,e),r=()=>{t(),this.unsubscribers=this.unsubscribers.filter(e=>e!==r)};return this.unsubscribers.push(r),r}}var Z=r(8835);class J{constructor(e){this.unsubscribers=[],this.video=void 0,this.destroy=()=>{(0,W.p)(this.unsubscribers)},this.unsubscribers=[],this.video=e}observe(e){const t=(0,Z.C)(this.video,e),r=()=>{t(),this.unsubscribers=this.unsubscribers.filter(e=>e!==r)};return this.unsubscribers.push(r),r}}var $=r(1725);class ee{constructor(e,t){this.yaspVideoElement=void 0,this.notifyCallback=void 0,this.attributeObserver=null,this.intervalWatcher=null,this.videoSizeObserver=null,this.pausedObserver=null,this.bufferingObserver=null,this.videoSizeSensor=null,this.handleIntervalUpdate=(e,t)=>{switch(e){case"frames":return void this.handleFrames(t);case"devicePixelRatio":return void this.handleDevicePixelRatio(t)}},this.handleVideoResize=()=>{if(null===this.yaspVideoElement)throw new Error("Unexpected subscription call after destroy");this.notify("updateVideoSize",{height:Math.max(Math.floor(this.yaspVideoElement.videoHeight)),width:Math.max(Math.floor(this.yaspVideoElement.videoWidth))})},this.handleResize=(e,t)=>{if(null===this.yaspVideoElement)throw new Error("Unexpected subscription call after destroy");this.notify("updateContainerSize",{height:Math.max(Math.floor(t)),width:Math.max(Math.floor(e))})},this.handlePaused=e=>{this.notify("updatePaused",e)},this.handleBuffering=e=>{this.notify("updateBuffering",e)},this.handleBuffered=()=>{if(null===this.yaspVideoElement)throw new Error("Unexpected subscription call after destroy");const e=[],t=this.yaspVideoElement.buffered;for(let r=0;r<t.length;r++)e.push([t.start(r),t.end(r)]);this.notify("updateBuffered",e)},this.handleRatechange=()=>{if(null===this.yaspVideoElement)throw new Error("Unexpected subscription call after destroy");this.notify("updatePlaybackRate",this.yaspVideoElement.playbackRate)},this.handleTimeupdate=()=>{if(null===this.yaspVideoElement)throw new Error("Unexpected subscription call after destroy");this.notify("updateCurrentTime",Math.max(this.yaspVideoElement.currentTime,0))},this.handleDurationchange=()=>{if(null===this.yaspVideoElement)throw new Error("Unexpected subscription call after destroy");this.notify("updateDuration",Math.max(this.yaspVideoElement.duration,0))},this.notify=(e,t)=>{this.notifyCallback&&this.notifyCallback(e,t)},this.yaspVideoElement=e,this.notifyCallback=t,this.intervalWatcher=new Y(this.yaspVideoElement,this.handleIntervalUpdate)}enable(){var e;null!==this.yaspVideoElement&&null!==this.intervalWatcher&&(this.yaspVideoElement.addEventListener("ratechange",this.handleRatechange,{passive:!0}),this.yaspVideoElement.addEventListener("timeupdate",this.handleTimeupdate,{passive:!0}),this.yaspVideoElement.addEventListener("seeking",this.handleTimeupdate,{passive:!0}),this.yaspVideoElement.addEventListener("durationchange",this.handleDurationchange,{passive:!0}),this.yaspVideoElement.addEventListener("progress",this.handleBuffered,{passive:!0}),this.videoSizeObserver=new F.$(this.yaspVideoElement,this.handleVideoResize),this.videoSizeSensor=new $.b(this.yaspVideoElement),this.videoSizeSensor.onResize.add(e=>{let{width:t,height:r}=e;return this.handleResize(t,r)}),this.intervalWatcher.enable(),this.attributeObserver=new B(this.yaspVideoElement,(e,t)=>{"loop"===e&&this.handleLoop(null!=t&&t)}),this.pausedObserver=new Q(this.yaspVideoElement),this.bufferingObserver=new J(this.yaspVideoElement),this.pausedObserver.observe(this.handlePaused),this.bufferingObserver.observe(this.handleBuffering),this.handleLoop(null!=(e=this.yaspVideoElement.loop)&&e))}disable(){var e,t,r,i;null!==this.yaspVideoElement&&null!==this.intervalWatcher&&(this.yaspVideoElement.removeEventListener("ratechange",this.handleRatechange),this.yaspVideoElement.removeEventListener("timeupdate",this.handleTimeupdate),this.yaspVideoElement.removeEventListener("seeking",this.handleTimeupdate),this.yaspVideoElement.removeEventListener("durationchange",this.handleDurationchange),this.yaspVideoElement.removeEventListener("progress",this.handleBuffered),this.intervalWatcher.disable(),null==(e=this.videoSizeObserver)||e.destroy(),this.videoSizeObserver=null,null==(t=this.attributeObserver)||t.destroy(),this.attributeObserver=null,null==(r=this.pausedObserver)||r.destroy(),this.pausedObserver=null,null==(i=this.bufferingObserver)||i.destroy(),this.bufferingObserver=null)}destroy(){var e;this.disable(),null==(e=this.intervalWatcher)||e.destroy(),this.intervalWatcher=null,this.yaspVideoElement=null,this.notifyCallback=null}handleLoop(e){this.notify("updateLoop",e)}handleFrames(e){if(null===this.yaspVideoElement)throw new Error("Unexpected notification call after destroy");this.notify("updateFrames",e)}handleDevicePixelRatio(e){if(null===this.yaspVideoElement)throw new Error("Unexpected notification call after destroy");this.notify("updateDevicePixelRatio",e)}}var te=r(7469),re=r(4910),ie=r(7182),se=r(9329),ne=r(2818);class ae{constructor(e){this.onTick=void 0,this.ticker=void 0,this.onTick=e,this.ticker=null}tickNow(){return this.stop(),this.onTick(),this}tickAfter(e){return this.stop(),this.ticker=new oe(()=>{this.onTick()}).tickAfter(e),this}tickEvery(e){return this.stop(),this.ticker=new oe(()=>{var t;null==(t=this.ticker)||t.tickAfter(e),this.onTick()}).tickAfter(e),this}stop(){this.ticker&&(this.ticker.stop(),this.ticker=null)}}class oe{constructor(e){this.onTick=void 0,this.cancelPending=void 0,this.onTick=e,this.cancelPending=null}tickAfter(e){this.stop();let t=!0,r=null;this.cancelPending=()=>{window.clearTimeout(r),t=!1};return r=window.setTimeout(()=>{t&&this.onTick()},1e3*e),this}stop(){this.cancelPending&&(this.cancelPending(),this.cancelPending=null)}}class le{constructor(e,t,r,i,s){this.video=void 0,this.timeline=void 0,this.config=void 0,this.stallDetector=void 0,this.onEvent=void 0,this.unsubscribe=void 0,this.seekingEventReceived=void 0,this.prevReadyState=void 0,this.didFireLargeGap=void 0,this.hadSegmentAppended=void 0,this.gapJumpTimer=void 0,this.video=e,this.timeline=t,this.config=r,this.stallDetector=i,this.onEvent=s,this.seekingEventReceived=!1,this.prevReadyState=e.readyState,this.didFireLargeGap=!1,this.hadSegmentAppended=!1,this.unsubscribe=(0,G.O)(e,"waiting",()=>this.onPollGapJump(),!1),this.gapJumpTimer=new ae(()=>{this.onPollGapJump()}).tickEvery(.25)}release(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),null!==this.gapJumpTimer&&(this.gapJumpTimer.stop(),this.gapJumpTimer=null),this.stallDetector&&(this.stallDetector.release(),this.stallDetector=null),this.onEvent=null,this.timeline=null,this.video=null}configure(e){this.config=p({},this.config,e)}onSegmentAppended(){this.hadSegmentAppended=!0,this.onPollGapJump()}onSeeking(){this.seekingEventReceived=!0,this.hadSegmentAppended=!1,this.didFireLargeGap=!1}onPollGapJump(){var e,t,r,i,s;if(!this.video)return;if(0===this.video.readyState)return;if(this.video.seeking){if(!this.seekingEventReceived)return}else this.seekingEventReceived=!1;if(this.video.paused&&(null==(e=this.config)||!e.jumpOnPause))return;if(this.video.readyState!==this.prevReadyState&&(this.didFireLargeGap=!1,this.prevReadyState=this.video.readyState),null!=(t=this.stallDetector)&&t.poll())return;const n=(null==(r=this.config)?void 0:r.smallGapLimit)||.5,a=(null==(i=this.config)?void 0:i.largeGapLimit)||1/0;let o=this.video.currentTime,l=this.video.buffered,d=de(l,o);if(null===d)return;if(0===d&&!this.hadSegmentAppended)return;let c=l.start(d);if(c>=((null==(s=this.timeline)?void 0:s.getSeekRangeEnd())||0))return;let u=c-o,h=u<=n,p=!1;if(!(u<le.BROWSER_GAP_TOLERANCE)){if(!h&&!this.didFireLargeGap){var f,m;this.didFireLargeGap=!0;let e=new CustomEvent("largegap",{cancelable:!0,detail:{currentTime:o,gapSize:u}});null==(f=this.onEvent)||f.call(this,e),null!=(m=this.config)&&m.jumpLargeGaps&&!e.defaultPrevented&&u<a&&(p=!0)}(h||p)&&(this.video.currentTime=c)}}}le.BROWSER_GAP_TOLERANCE=void 0;const de=function(e,t){if(!e||!e.length)return null;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return null;for(let r=0;r<e.length;r++)if(e.start(r)>t&&(0===r||e.end(r-1)-t<=.1))return r;return null};var ce=r(1106),ue=r(418),he=r(7568);class pe{constructor(){this.retries=3,this.nudgeDelay=2e3,this.video=null,this.isBuffering=!1,this.currentRetries=0,this.timer=void 0}attach(e){this.video=e}detach(){this.clear(),this.video=null}handleBuffering(e){this.isBuffering=e,e?this.schedule():this.clear()}schedule(){this.timer||(this.currentRetries++,this.timer=self.setTimeout(()=>{this.timer=void 0,this.shouldNudge()&&(this.currentRetries>this.retries?this.onNudgeFailed():(this.nudge(),this.schedule()))},this.nudgeDelay))}clear(){this.currentRetries=0,self.clearTimeout(this.timer),this.timer=void 0}nudge(){this.video&&(this.logNudge(),this.video.currentTime+=.001)}shouldNudge(){return!(!this.video||!this.isBuffering)&&(this.video.readyState!==HTMLMediaElement.HAVE_NOTHING&&this.video.duration>0&&(this.video.currentTime>0&&this.getRemainingBufferedTime()>0))}getRemainingBufferedTime(){if(!this.video)return 0;const e=[];for(let t=0;t<this.video.buffered.length;t++)e.push({start:this.video.buffered.start(t),end:this.video.buffered.end(t)});return(0,he.p)(e,this.video.currentTime)||0}onNudgeFailed(){var e;null==(e=this.video)||e.yaspDispatchEvent("yasp-nudgefail")}logNudge(){var e;null==(e=this.video)||e.yaspDispatchEvent("yasp-nudge")}}var fe=r(5543),me=r(6971),ge=r(2843),ve=r(4343),ye=r(6610),Ee=r(6351),Se=r(8493),Ae=r(9583);class Te extends v{constructor(){super(...arguments),this.gapController=void 0,this.srcSetDeferred=void 0,this.shouldPlay=void 0,this.restorePrototype=void 0,this.videoTrackList=void 0,this.audioTrackList=void 0,this.yaspSrc=void 0,this.yaspError=null,this.error=null,this.videoStateNotifier=void 0,this.unsubscribeTextTracksChange=void 0,this.serverTimeInfo=void 0,this.isLowLatency=!1,this.stalledNudger=void 0,this.yaspSeekable=void 0,this.startTime=0}static isSupported(){try{return!0===(0,fe.RW)("web_yasp_enable")&&"function"===typeof MediaSource.isTypeSupported}catch(e){return!1}}static getDefaultBandwidthEstimate(){const e=Te.bandwidth;if(e)return(0,ue.S)(e);const t=(0,Ae.N)();return t?{value:t,source:"cache"}:{value:Se.S,source:"default"}}static attach(e,t){Te.setInitialConfig(t);const r=(0,y.n)(e);g()(e,Te.prototype);const i=e;return i.restorePrototype=r,i.initWorker(),i.initVideoTrackList(),i.initAudioTrackList(),i.initTextTrackList(),i.initErrorHandling(),i.initWatchdog(),i.initStalledNudger(),Te.instances.push(i),Te.initYaspSeekable(i),Te.attachErrorStore(i),i}static warmUp(){(0,H.Z)(Te.worker)}static async destroy(){var e;await Promise.all(Te.instances.map(e=>e.detach())),null==(e=Te.workerImpl)||e.destroy()}static attachErrorStore(e){Object.defineProperty(e,"error",{get(){const t=this;if(void 0!==t.yaspError)return t.yaspError;delete t.error;const{error:r}=t;return Te.attachErrorStore(e),r},configurable:!0})}static isYaspVideoElement(e){return!0===e.yasp}get videoTracks(){return this.videoTrackList}get audioTracks(){return this.audioTrackList}canPlayType(e){return"application/dash+xml"===e?"probably":super.canPlayType(e)}getAttribute(e){return"src"===e&&void 0!==this.yaspSrc?this.yaspSrc:super.getAttribute(e)}setAttribute(e,t){return"src"===e?this.setSrc(t):super.setAttribute(e,t)}removeAttribute(e){"src"===e&&this.setSrc(""),super.removeAttribute(e)}get src(){var e;return void 0===this.yaspSrc?null!=(e=HTMLVideoElement.prototype.getAttribute.call(this,"src"))?e:"":this.yaspSrc}set src(e){this.setSrc(e)}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}get yasp(){return!0}async yaspRequestDebugInfo(){return Te.worker.request({method:"requestDebugInfo",params:{source:this.yaspSrc}})}async detach(){var e,t,r,i,s;void 0!==this.yaspSrc&&await Te.worker.request({method:"detach",params:{source:this.yaspSrc}}),Te.worker.removeRpcHandler("setStartInfo"),Te.worker.removeRpcHandler("addAudioTrack"),Te.worker.removeRpcHandler("addVideoTrack"),Te.worker.removeRpcHandler("changeSelectedVideoTrack"),Te.worker.removeRpcHandler("changeSelectedAudioLanguage"),Te.worker.removeRpcHandler("flushMediaPipeline"),Te.worker.removeRpcHandler("updateBandwidthEstimate"),Te.worker.removeRpcHandler("updateMaxCapAllowedVideoTrack"),Te.worker.removeRpcHandler("addTextTrack"),Te.worker.removeRpcHandler("cuesAdded"),Te.worker.removeRpcHandler("applyDrmInfos"),Te.worker.removeRpcHandler("changeVideoType"),Te.worker.removeRpcHandler("logNetworkTrace"),Te.worker.removeRpcHandler("changeIsLowLatency"),Te.worker.removeRpcHandler("emsg"),Te.worker.removeRpcHandler("logSegmentLoaded"),Te.worker.removeRpcHandler("updateUtcStartTime"),Te.worker.removeRpcHandler("updateSeekableRange"),Te.worker.removeRpcHandler("updateServerTime"),Te.worker.replaceRpcHandler("error",Te.detachedErrorRpcHandler),null==(e=this.gapController)||e.release(),this.gapController=void 0,this.restore(),null==(t=this.stalledNudger)||t.detach(),this.removeEventListener("progress",this.onSegmentAppended),this.removeEventListener("seeking",this.onSeeking),this.removeEventListener("canplay",this.onCanPlay),null==(r=this.unsubscribeTextTracksChange)||r.call(this),this.unsubscribeTextTracksChange=void 0,this.removeAttribute("src"),null==(i=this.restorePrototype)||i.call(this),this.restorePrototype=void 0,delete this.error,delete this.seekable,Te.instances=Te.instances.filter(e=>e!==this),null==(s=this.videoStateNotifier)||s.disable()}static async preloadSrc(e,t){if(!Te.worker)throw new Error("Not implemented");await Te.worker.request({method:"load",params:{source:e}})}async yaspPreloadSrc(e,t){return Te.preloadSrc(e,t)}static async releaseSrc(e){if(!Te.worker)throw new Error("Not implemented");return Te.worker.request({method:"destroy",params:{source:e}}).catch(ie.Y.warn)}async yaspReleaseSrc(e){return Te.releaseSrc(e)}yaspSetVideoElementSizes(e){Te.setVideoElementSizes(this.src,e)}static setVideoElementSizes(e,t){Te.worker.request({method:"setVideoElementSizes",params:{source:e,videoSizes:t}})}yaspDispatchEvent(e,t){void 0===t&&(t={});const r=new CustomEvent(e,t);super.dispatchEvent(r)}static getStats(){return{bandwidth:Te.bandwidth,maxCapAllowedVideoTrack:Te.maxCapAllowedVideoTrack}}yaspConfigure(e){Te.configure(this.src,e)}static configure(e,t){const r=t.defaultBandwidthEstimate?(0,ue.S)(t.defaultBandwidthEstimate):void 0;void 0!==r&&(Te.shouldSaveBandwidth=!1),Te.worker.request({method:"configure",params:{source:e,config:f({},t,{defaultBandwidthEstimate:r})}})}static setInitialConfig(e){e&&(Te.initialConfig.skippableFragments=e.skippableFragments,Te.initialConfig.sourceLimit=e.sourceLimit)}static get worker(){if(void 0===Te.workerImpl){const r=!(!(0,fe.RW)("web_yasp_enable_worker",!1)||(e=MediaSource,t="canConstructInDedicatedWorker",!Object.prototype.hasOwnProperty.call(e,t)))&&(MediaSource.canConstructInDedicatedWorker&&Boolean(window.MediaSourceHandle));Te.workerImpl=new V({useWebWorker:r,initialConfig:f({},Te.initialConfig,{flags:(0,fe.qm)()})}),Te.workerImpl.registerRpcHandler("updateBufferedInfo",e=>{Te.messenger.emit("BufferedInfoChanged",e)}),Te.workerImpl.registerRpcHandler("logWorkerState",e=>{Te.messenger.emit("LogWorkerState",e)}),Te.workerImpl.registerRpcHandler("error",Te.detachedErrorRpcHandler),Te.workerImpl.registerRpcHandler("logAbrDecision",e=>{Te.messenger.emit("AbrDecisionChange",e)})}var e,t;return Te.workerImpl}initVideoTrackList(){if(void 0!==this.videoTrackList)return;const e=new P;e.addEventListener("change",()=>{const{id:t}=e[e.selectedIndex];Te.worker.request({method:"setVideoTrack",params:{source:this.yaspSrc,trackId:t}});const r=new Event("change");(0,ne.Y)(()=>{super.videoTracks.dispatchEvent(r)})}),this.videoTrackList=e}yaspSetAudioTrack(e){e&&Te.worker.request({method:"setAudioTrack",params:{source:this.yaspSrc,language:e}})}initAudioTrackList(){if(void 0!==this.audioTrackList)return;const e=new w;e.addEventListener("change",()=>{(0,te.w)(e).find(e=>{e.enabled&&Te.worker.request({method:"setAudioTrack",params:{source:this.yaspSrc,language:e.language}})});const t=new Event("change");(0,ne.Y)(()=>{super.audioTracks.dispatchEvent(t)})}),this.audioTrackList=e}static removeCues(e){if(!e.cues)return;let t=e.cues;for(let r=t.length-1;r>=0;r--){let i=t[r];i&&e.removeCue(i)}}initTextTrackList(){this.unsubscribeTextTracksChange=(0,G.O)(this.textTracks,"change",e=>{let{target:t}=e;const r={source:this.yaspSrc,track:void 0},i=t;for(let s=0;s<i.length;s++){const e=i[s];"disabled"!==e.mode&&(Te.removeCues(e),r.track={id:e.id,label:e.label,language:e.language,kind:e.kind})}Te.worker.request({method:"setTextTrack",params:r})})}initWorker(){Te.worker.registerRpcHandler("setStartInfo",e=>{var t,r;(0,re.H)(this.yaspSrc)===(0,re.H)(e.source)&&("string"===typeof e.objectUrl?HTMLVideoElement.prototype.setAttribute.call(this,"src",e.objectUrl):this.srcObject=e.objectUrl,this.currentTime=e.startPosition,this.readyState<HTMLMediaElement.HAVE_METADATA&&this.addEventListener("loadedmetadata",()=>{(0,re.H)(this.yaspSrc)===(0,re.H)(e.source)&&(this.currentTime=e.startPosition)},{once:!0}),null==(t=this.videoStateNotifier)||t.handleTimeupdate(),null==(r=this.srcSetDeferred)||r.resolve())}),Te.worker.registerRpcHandler("addAudioTrack",e=>{var t;null==(t=this.audioTrackList)||t.addTrack(new T({enabled:e.track.selected,label:e.track.label,language:e.track.language,id:e.track.id,kind:e.track.kind,bitrate:e.track.bitrate}))}),Te.worker.registerRpcHandler("addVideoTrack",e=>{var t,r,i;null==(t=this.videoTrackList)||t.addTrack(new k({selected:e.track.selected,width:e.track.width,height:e.track.height,bitrate:e.track.bitrate,label:e.track.label,language:null!=(r=e.track.language)?r:void 0,id:e.track.id,kind:e.track.kind})),e.length===(null==(i=this.videoTrackList)?void 0:i.length)&&this.yaspDispatchEvent("yasp-videotracksadded")}),Te.worker.registerRpcHandler("addTextTrack",e=>{const t=document.createElement("track");t.setAttribute("kind",e.track.kind),t.setAttribute("label",e.track.label),t.setAttribute("srclang",e.track.language),t.setAttribute("id",e.track.id),this.appendChild(t)}),Te.worker.registerRpcHandler("cuesAdded",e=>{let t,{cues:r,label:i}=e;for(let s=0;s<this.textTracks.length;s++)this.textTracks[s].label===i&&(t=this.textTracks[s]);t&&r.forEach(e=>{const r=new VTTCue(e.startTime,e.endTime,e.payload);t.addCue(r)})}),Te.worker.registerRpcHandler("changeSelectedVideoTrack",e=>{if(!this.videoTrackList)return;const t=this.videoTrackList.getTrackById(e.id);t&&(t.selected=!0)}),Te.worker.registerRpcHandler("changeSelectedAudioLanguage",e=>{if(this.audioTrackList)for(let t=0;t<this.audioTrackList.length;t++)this.audioTrackList[t].enabled=this.audioTrackList[t].language===e.language}),Te.worker.registerRpcHandler("updateBandwidthEstimate",e=>{Te.bandwidth=e.bandwidth,Te.shouldSaveBandwidth&&(0,Ae.J)(e.bandwidth)}),Te.worker.registerRpcHandler("updateMaxCapAllowedVideoTrack",e=>{Te.maxCapAllowedVideoTrack=e.maxCapAllowedVideoTrack}),Te.worker.registerRpcHandler("applyDrmInfos",e=>{this.yaspDispatchEvent("yasp-drmInfoReceived",{cancelable:!0,detail:e.drmInfos})}),Te.worker.registerRpcHandler("changeVideoType",e=>{this.yaspDispatchEvent("yasp-videoTypeChange",{cancelable:!0,detail:e.videoType})}),Te.worker.registerRpcHandler("logNetworkTrace",e=>{this.yaspDispatchEvent("yasp-networkTrace",{cancelable:!0,detail:e.bandwidthInfoBatch})}),Te.worker.registerRpcHandler("changeIsLowLatency",e=>{this.isLowLatency=e.isLowLatency}),Te.worker.registerRpcHandler("emsg",e=>{this.yaspDispatchEvent("yasp-emsg",{cancelable:!0,detail:e.emsg})}),Te.worker.registerRpcHandler("logSegmentLoaded",e=>{const t="[SegmentLoader] loaded type = "+e.info.type+", number = "+e.info.number+", cmaf = "+e.info.cmaf;this.yaspDispatchEvent("yasp-debug",{cancelable:!0,detail:t})}),Te.worker.registerRpcHandler("updateUtcStartTime",e=>{this.startTime=e.time}),Te.worker.registerRpcHandler("updateSeekableRange",e=>{this.yaspSeekable=e}),Te.worker.registerRpcHandler("flushMediaPipeline",()=>{0===this.buffered.length&&(this.currentTime-=.001)}),Te.worker.registerRpcHandler("updateServerTime",e=>{this.serverTimeInfo?(this.serverTimeInfo.time=e.time,this.serverTimeInfo.getTime=(0,ve.u)()):this.serverTimeInfo={time:e.time,getTime:(0,ve.u)()}});this.videoStateNotifier=new ee(this,(e,t)=>{var r;null!==this.yasp&&(Te.worker.postMessage({jsonrpc:"2.0",method:e,params:t}),"updateBuffering"===e&&(null==(r=this.stalledNudger)||r.handleBuffering(t)))}),this.videoStateNotifier.enable()}getServerTime(){if(this.serverTimeInfo&&this.serverTimeInfo.time)return(this.serverTimeInfo.time+this.serverTimeInfo.getTime())/1e3}isLowLatencyLive(){return this.isLowLatency}clearTextTrackList(){const e=this.getElementsByTagName("track");for(;e.length;)e[0].remove()}clearTrackLists(){a(this.videoTrackList),a(this.audioTrackList),this.clearTextTrackList()}createMediaError(e,t,r){let i=r;if(this.error)try{const e="string"===typeof(null==r?void 0:r.details)?f({},JSON.parse(r.details),{videoTagError:this.error}):f({},r.details,{videoTagError:this.error});i=new ce.w(f({},r,{details:e}))}catch(s){}return{code:e,message:t,yaspError:i}}static parseErrorString(e){try{return new ce.w(JSON.parse(e))}catch(t){return new ce.w({code:"YASP_PARSE_ERROR_EXCEPTION",details:{error:t,errorString:e},message:"Expect error to be serialized error.",isFatal:!0,category:me.q.EXCEPTION})}}initErrorHandling(){Te.worker.replaceRpcHandler("error",e=>{let{error:t}=e;const r=Te.parseErrorString(t);this.handleError(r)})}handleError(e){if(e.isFatal){const t=this.createMediaError(MediaError.MEDIA_ERR_NETWORK,e.message,e);this.yaspError=t,this.yaspDispatchEvent("error")}else this.yaspDispatchEvent("yasp-error",{cancelable:!0,detail:e})}initWatchdog(){this.gapController||(this.gapController=new le(this,{getSeekRangeEnd:()=>this.seekable.end(0)},{jumpLargeGaps:!0,jumpOnPause:!0,largeGapLimit:ge.D},null,e=>this.yaspDispatchEvent("yasp-largegap",{cancelable:!0,detail:e.detail})),this.addEventListener("seeking",this.onSeeking),this.addEventListener("progress",this.onSegmentAppended),this.addEventListener("canplay",this.onCanPlay))}onCanPlay(){var e;null==(e=this.gapController)||e.configure({jumpOnPause:!1})}onSegmentAppended(){var e;null==(e=this.gapController)||e.onSegmentAppended()}onSeeking(){var e;!class{static isBuffered(e,t,r){if(void 0===r&&(r=0),!e||!e.length)return!1;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return!1;if(t>e.end(e.length-1))return!1;for(let i=0;i<e.length;i++)if(t+r>=e.start(i)&&t-r<=e.end(i))return!0;return!1}}.isBuffered(this.buffered,this.currentTime,.5)&&this.yaspSrc?Te.worker.request({method:"clear",params:{source:this.yaspSrc}}).then(()=>{var e,t;(null==(e=this.gapController)||e.onSeeking(),q.$)&&Promise.resolve().then(null==(t=this.videoStateNotifier)?void 0:t.handleTimeupdate)}):null==(e=this.gapController)||e.onSeeking();Te.messenger.once("BufferedInfoChanged",()=>{this.yasp&&(0,Ee.m)(null==this?void 0:this.onSegmentAppended)&&this.onSegmentAppended()})}async play(){var e;(this.shouldPlay=!0,this.yaspSrc&&"none"===this.preload&&Te.worker.request({method:"load",params:{source:this.yaspSrc}}),HTMLVideoElement.prototype.getAttribute.call(this,"src")||this.srcObject)||await(null==(e=this.srcSetDeferred)?void 0:e.promise);if(this.shouldPlay)return this.shouldPlay=!1,this.handleLivePresentationWindowDropout(),super.play()}pause(){this.shouldPlay=!1,super.pause()}setSrc(e){var t,r;this.yaspSrc&&(Te.worker.request({method:"detach",params:{source:this.yaspSrc}}),this.yaspSrc=void 0,this.srcObject=null,this.srcSetDeferred=void 0,null==(t=this.videoStateNotifier)||t.disable(),this.clearTrackLists());if(this.srcSetDeferred=new ye.B,(0,I.DZ)(e))return this.yaspSrc=e,Te.worker.request({method:"attach",params:{source:e}}),null==(r=this.videoStateNotifier)||r.enable(),this.preload&&"none"!==this.preload&&Te.worker.request({method:"load",params:{source:e}}),void(Te.shouldSaveBandwidth&&Te.worker.request({method:"configure",params:{source:e,config:{defaultBandwidthEstimate:Te.getDefaultBandwidthEstimate()}}}));HTMLVideoElement.prototype.setAttribute.call(this,"src",e)}initStalledNudger(){this.stalledNudger||(this.stalledNudger=new pe),this.stalledNudger.attach(this)}static initYaspSeekable(e){Object.defineProperty(e,"seekable",{get(){if(this.yaspSeekable)return{start:e=>{if(e>this.length-1)throw new Error("Failed to execute 'start' on 'TimeRanges': The index provided ("+e+") is greater than the maximum bound ("+(this.length-1)+")");return this.yaspSeekable.start},end:e=>{if(e>this.length-1)throw new Error("Failed to execute 'end' on 'TimeRanges': The index provided ("+e+") is greater than the maximum bound ("+(this.length-1)+")");return this.yaspSeekable.end},length:1};delete this.seekable;const{seekable:t}=this;return Te.initYaspSeekable(e),t},configurable:!0})}restore(){this.startTime=0,this.serverTimeInfo=void 0,this.yaspSeekable=void 0,this.isLowLatency=!1}handleLivePresentationWindowDropout(){this.seekable.length&&(isFinite(this.duration)||this.currentTime<this.seekable.start(0)&&(this.currentTime=this.seekable.end(this.seekable.length-1)))}getStartDate(){return new Date(this.startTime)}}Te.instances=[],Te.shouldSaveBandwidth=!0,Te.bandwidth=void 0,Te.maxCapAllowedVideoTrack=void 0,Te.workerImpl=void 0,Te.messenger=new se.v,Te.initialConfig={},Te.detachedErrorRpcHandler=e=>{let{error:t}=e;const r=Te.parseErrorString(t),i=new ce.w(f({},r,{message:"Detached videoElement error: "+r.message}));Te.messenger.emit("yasp-error",i)}},1647:(e,t,r)=>{"use strict";function i(e,t){void 0===t&&(t=[]);for(const r in e)n.some(t=>{var i;return null!=(i=(0,s.Y)(()=>e[r]instanceof t))&&i})?t.push(e[r]):null!==e[r]&&"object"===typeof e[r]&&i(e[r],t);return t}r.d(t,{_:()=>i});var s=r(2818);const n=[..."undefined"!==typeof MediaSourceHandle?[MediaSourceHandle]:[]]},1494:(e,t,r)=>{"use strict";function i(){return new s.$W}r.d(t,{l:()=>i});var s=r(9304)},931:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var i=r(5442),s=r(45),n=r(9366),a=r(3770);class o{constructor(e){this.jsonRpcMessenger=void 0,this.handlers={};this.jsonRpcMessenger=new i.A({send:e,onRun:async(e,t)=>{if(!(e.method in this.handlers))return t(new n.l("Unknown method: "+e.method,s.v.METHOD_NOT_FOUND));try{return t(null,await this.handlers[e.method](e.params))}catch(r){return t(new n.l((0,a.K)(r)?r.message:"",s.v.INTERNAL_ERROR,(0,a.K)(r)?r.stack:""))}},serialize:e=>e,deserialize:e=>e}),this.jsonRpcMessenger.on("Warn",console.warn),this.jsonRpcMessenger.on("Error",console.error)}registerHandler(e,t){if(e in this.handlers)throw new Error("Can't register 2 handlers for 1 method "+e);this.handlers[e]=t}removeHandler(e){delete this.handlers[e]}request(e){let{method:t,params:r}=e;return this.jsonRpcMessenger.request({method:t,params:r})}sendEvent(e){let{method:t,params:r}=e;return this.jsonRpcMessenger.sendEvent({method:t,params:r})}destroy(){this.jsonRpcMessenger.destroy()}handleMessage(e){this.jsonRpcMessenger.handleMessage(e.data)}}},9111:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function a(e,t){return n({},t,{start:e.start,end:t.end})}function o(e){const t=[];return e.forEach(e=>{t.push(...e)}),function(e,t){void 0===t&&(t=a);const r=[...e];r.sort((e,t)=>e.start-t.start||e.end-t.end);for(let i=1;i<r.length;i++){const e=r[i],s=r[i-1];s.end>=e.start&&(r.splice(i,1),r[i-1]=t(s,e),i--)}return r}(t)}function l(e,t){const r=[];let i=0;return e.forEach(e=>{let{start:s,end:n}=e;for(let a=i;a<t.length;a++){if(t[a].start>n)return;i=a,t[a].end<s||r.push({start:Math.max(t[a].start,s),end:Math.min(t[a].end,n)})}}),r}function d(e){return(0,Fe.z)(e.reduce((e,t)=>(e[t.height]?t.bitrate>e[t.height].bitrate&&(e[t.height]=t):e[t.height]=t,e),{})).sort((e,t)=>t.bitrate-e.bitrate)}function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function u(e,t){var r,i;const s=parseInt(e.attributes.timescale||"1",10);if(isNaN(s))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected SegmentTemplate[timescale]",details:{node:e},category:He.q.MEDIA});const n=e.attributes.media;if(!n)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed SegmentTemplate[media]",details:{node:e},category:He.q.MEDIA});let a=Math.floor(Math.max(0,parseInt(e.attributes.startNumber||"1",10)));if(!Number.isFinite(a)||!Number.isInteger(a))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected SegmentTemplate[startNumber]",details:{node:e},category:He.q.MEDIA});const o=parseInt(e.attributes.presentationTimeOffset||"0",10),l=o;if(isNaN(l))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected SegmentTemplate[presentationTimeOffset]",details:{node:e},category:He.q.MEDIA});const d=e.attributes.availabilityTimeOffset?parseFloat(e.attributes.availabilityTimeOffset):0;t.availabilityTimeOffset=Math.min(t.availabilityTimeOffset,1e3*d);const c=e.children.find(e=>{let{tagName:t}=e;return"SegmentTimeline"===t}),u=[];let h=Math.max(Math.floor(0)),p=0,f=Math.max(Math.floor(0));if(c){const r=c.children.filter(e=>{let{tagName:t}=e;return"S"===t});for(let i=0;i<r.length;i++){var m;const n=r[i],l=u[u.length-1],d=parseInt(n.attributes.t,10),c=parseInt(n.attributes.d||e.attributes.duration,10);if("string"===typeof n.attributes.t&&isNaN(d))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected S[t]",details:{node:e},category:He.q.MEDIA});const p=d||(l?l.originalValues.time+l.originalValues.duration*l.count:0),f=1e3*d/s||(l?l.time+l.duration*l.count:0),g=1e3*c/s;t.maxSegmentDuration=t.maxSegmentDuration?Math.max(t.maxSegmentDuration,g):g;const v=Math.max(Math.floor(parseInt(n.attributes.r||"0",10)));if(isNaN(g))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected S[d]",details:{node:e},category:He.q.MEDIA});if(isNaN(v))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected S[r]",details:{node:e},category:He.q.MEDIA});const y=v+Math.max(Math.floor(1));h+=y;const E=a+Math.max(Math.floor(h-1)),S=f+g*y;t.maxSegmentEndTime=t.maxSegmentEndTime?Math.max(t.maxSegmentEndTime,S):S,t.minSegmentStartTime=Math.min(null!=(m=t.minSegmentStartTime)?m:1/0,f),t.minSegmentStartTime=t.minSegmentStartTime?Math.min(t.minSegmentStartTime,f):f,u.push({endNumber:E,time:f,duration:g,count:y,originalValues:{time:p,duration:c,trackPresentationTimeOffset:o}})}f=a+Math.max(Math.floor(h-1))}else{var g,v;if(null===t.duration&&!t.isDynamic)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Can't compute presentation duration",details:{node:e},category:He.q.MEDIA});let r=0;const i=1e3*parseInt(e.attributes.duration,10)/s;if(isNaN(i))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected S[d]",details:{node:e},category:He.q.MEDIA});let n=Math.abs(null!=(g=t.duration)?g:t.nowWithOffset);if(isFinite(t.segmentAvailabilityDuration)){const e=Math.max(t.nowWithOffset-t.segmentAvailabilityDuration,0),s=Math.ceil(e/i);a+=s,r=s*i,n=Math.max(t.nowWithOffset-r,0)}h=Math.floor(n/i),f=a+Math.max(Math.floor(h-1),0),p=f*i,t.maxSegmentEndTime=Math.max(t.maxSegmentEndTime||0,p),t.minSegmentStartTime=Math.min(null!=(v=t.minSegmentStartTime)?v:1/0,r),t.maxSegmentDuration=Math.max(t.maxSegmentDuration||0,i),u.push({endNumber:f,time:r,duration:i,count:h,originalValues:{time:r,duration:parseInt(e.attributes.duration,10),trackPresentationTimeOffset:o}});const l=t.duration?t.duration-p:0,d=Math.abs(Math.floor(1));l&&u.push({endNumber:f+d,time:p,duration:l,count:d,originalValues:{time:p,duration:l,trackPresentationTimeOffset:o}})}const y=u[u.length-1];return t.maxPresentationTimeOffset=void 0!==t.maxPresentationTimeOffset?Math.max(t.maxPresentationTimeOffset,l):t.maxPresentationTimeOffset,{timescale:s,initialization:null!=(r=null==(i=e.attributes.initialization)?void 0:i.replace(/&amp;/g,"&"))?r:null,media:n.replace(/&amp;/g,"&"),startNumber:a,startTime:u[0].time,endNumber:y.endNumber,endTime:y.time+y.duration*y.count,presentationTimeOffset:l,segmentSequences:u}}function h(e,t){const r=e.attributes.mimeType,i=e.attributes.contentType||(null==r?void 0:r.split("/")[0]);if(!i)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected empty AdaptationSet[contentType] and AdaptationSet[mimeType]",details:{node:e},category:He.q.MEDIA});t.maxHeight||(t.maxHeight=function(e){const t=e.find(e=>{var t;return"SupplementalProperty"===e.tagName&&"urn:mpeg:yandex:capping:maxheight"===(null==(t=e.attributes)?void 0:t.schemeIdUri)});return t?parseInt(t.attributes.value,10):null}(e.children));const s=e.children.filter(e=>"ContentProtection"===e.tagName);let n=new qe(t.parser).parse(s);const a="true"===e.attributes.segmentAlignment,o=e.children.find(e=>"SegmentTemplate"===e.tagName);return{type:i,segmentAlignment:a,segmentTemplate:o?u(o,t):void 0,mimeType:r,contentProtection:n}}function p(e,t,r){var i;const s=e.attributes.id;if(!s)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed id on Representation",details:{node:e},category:He.q.MEDIA});const n=null!=(i=e.attributes.codecs)?i:null;let a=parseInt(e.attributes.bandwidth,10);if(isNaN(a)||a<0){if("text"!==r)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation[bandwidth]",details:{node:e},category:He.q.MEDIA});a=10}const o=e.attributes.mimeType,l=e.children.find(e=>{let{tagName:t}=e;return"SegmentTemplate"===t}),d=l?u(l,t):void 0,c=e.children.filter(e=>{let{tagName:t}=e;return"InbandEventStream"===t});return"text"!==r&&c.forEach(e=>t.emsgSchemeIdUris[r].add(e.attributes.schemeIdUri)),{id:s,codecs:n,bandwidth:a,segmentTemplate:d,mimeType:o}}function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function m(e,t){const r=parseInt(e.attributes.width,10),i=parseInt(e.attributes.height,10),s=Math.max(parseFloat(e.attributes.frameRate),0);if(isNaN(r))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",details:{node:e},message:"Unexpected Representation[width]",isFatal:!0,category:He.q.MEDIA});if(isNaN(i))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",details:{node:e},message:"Unexpected Representation[height]",isFatal:!0,category:He.q.MEDIA});const n=p(e,t,"video"),a=n.codecs;if(!a)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",details:{node:e},message:"Unexpected missed codecs on Representation",isFatal:!0,category:He.q.MEDIA});return f({},n,s?{frameRate:s}:{},{codecs:a,width:r,height:i})}function g(e,t){return t.bandwidth-e.bandwidth}function v(e,t,r){const i=e.children.filter(e=>{let{tagName:t}=e;return"Representation"===t}),s=[];for(let n=0;n<i.length;n++){const e=i[n];s.push(t(e,r))}return s.sort(g)}function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function E(e,t,r){const{segmentTemplate:i,mimeType:s}=t,n=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(t,ze),a=parseInt(e.attributes.maxWidth,10),o=parseInt(e.attributes.maxHeight,10),l=Math.max(parseFloat(e.attributes.maxFrameRate),0),d=v(e,m,r).map(t=>{var r,n;const a=null!=(r=t.segmentTemplate)?r:i,o=null!=(n=t.mimeType)?n:s;if(!a)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation>SegmentTemplate",details:{node:e},category:He.q.MEDIA});if(!o)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation>mimeType",details:{node:e},category:He.q.MEDIA});return y({},t,{segmentTemplate:a,mimeType:o})});if(isNaN(a))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected AdaptationSet[maxWidth]",details:{node:e},category:He.q.MEDIA});if(isNaN(o))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected AdaptationSet[maxHeight]",details:{node:e},category:He.q.MEDIA});return y({},n,l?{maxFrameRate:l}:{},{maxWidth:a,maxHeight:o,representations:d,keyId:void 0,encrypted:t.contentProtection.drmInfos.length>0})}function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function A(e,t){const r=Math.max(parseFloat(e.attributes.audioSamplingRate),0);if(isNaN(r))throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected Representation[audioSamplingRate]",details:{node:e},category:He.q.MEDIA});const i=p(e,t,"audio"),s=i.codecs;if(!s)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed codecs on Representation",details:{node:e},category:He.q.MEDIA});return S({},i,{codecs:s,audioSamplingRate:r})}function T(){return(T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function b(e,t,r){var i,s;const{segmentTemplate:n,mimeType:a}=t,o=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(t,Xe),l=null!=(i=e.attributes.lang)?i:"und",d=null!=(s=e.attributes.label)?s:null;if(""===l)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected AdaptationSet[lang]",details:{node:e},category:He.q.MEDIA});const c=v(e,A,r).map(t=>{var r,i;const s=null!=(r=t.segmentTemplate)?r:n,o=null!=(i=t.mimeType)?i:a;if(!s)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation>SegmentTemplate",details:{node:e},category:He.q.MEDIA});if(!o)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation>mimeType",details:{node:e},category:He.q.MEDIA});return T({},t,{segmentTemplate:s,mimeType:o})});return T({},o,{lang:l,label:d,representations:c,keyId:void 0,encrypted:t.contentProtection.drmInfos.length>0})}function R(){return(R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function w(e,t){const r=p(e,t,"text"),i=[];return e.children.forEach(e=>{let{tagName:t,children:r}=e;"BaseURL"===t&&i.push(r[0])}),R({},r,{baseUrl:i[0]})}function _(){return(_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function k(e,t,r){var i,s,n,a;const{segmentTemplate:o,mimeType:l}=t,d=function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(t,Qe),c=e.children.find(e=>{let{tagName:t}=e;return"Role"===t}),u=null!=(i=e.attributes.lang)?i:"und",h=null!=(s=e.attributes.label)?s:null,p=v(e,w,r).map(e=>_({},e,{segmentTemplate:e.segmentTemplate||o,mimeType:e.mimeType||l}));return _({},d,{role:c?{schemeIdUri:null!=(n=c.attributes.schemeIdUri)?n:null,value:null!=(a=c.attributes.value)?a:null}:null,lang:u,label:h,representations:p,keyId:void 0,encrypted:t.contentProtection.drmInfos.length>0,segmentAlignment:!1})}function P(e,t){const r=h(e,t);switch(r.type){case"video":return E(e,r,t);case"audio":return b(e,r,t);case"text":return k(e,r,t);default:throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected AdaptationSet[contentType]",details:{node:e},category:He.q.MEDIA})}}function I(e,t){var r,i,s,n,a,o,l,d;const c=t.type.charCodeAt(0)-e.type.charCodeAt(0);if(0!==c)return c;switch(t.type){case"video":return t.maxHeight-e.maxHeight||(null!=(r=t.maxFrameRate)?r:0)-(null!=(i=e.maxFrameRate)?i:0)||(null!=(s=t.mimeType)?s:"").localeCompare(null!=(n=e.mimeType)?n:"");case"audio":return(null!=(a=t.mimeType)?a:"").localeCompare(null!=(o=e.mimeType)?o:"");case"text":return t.lang.localeCompare(e.lang)||(null!=(l=t.mimeType)?l:"").localeCompare(null!=(d=e.mimeType)?d:"")}return 0}function C(e,t){const r=e.children.filter(e=>{let{tagName:t}=e;return"AdaptationSet"===t}),i=[];for(let s=0;s<r.length;s++){const e=P(r[s],t);e&&i.push(e)}return i.sort(I)}function O(e){if(!e)return null;const t=new RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);if(!t)return null;const r=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null);return isFinite(r)?1e3*r:null}function D(e){if(!e)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z");let t=Date.parse(e);return isNaN(t)?null:Math.floor(t)}function N(e,t,r){var i,s,n;const a=e.find(e=>{let{tagName:t}=e;return"MPD"===t});if(void 0===a)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed MPD",details:{node:{tagName:"root",attributes:{},children:e}},category:He.q.MEDIA});const o={periods:[],baseUrls:[],maxHeight:null,isDynamic:"dynamic"===(null==(i=a.attributes)?void 0:i.type),videoType:Ze.Z.LIVE,updatePeriod:5e3,minBufferTime:0,presentationStartTime:null,segmentAvailabilityDuration:1/0,maxSegmentDuration:4e3,presentationDelay:0,availabilityTimeOffset:0,clockOffset:0,minSegmentStartTime:null,maxSegmentEndTime:null,presentationTimeOffset:0,publishTime:0,minPeriodStartTime:0,locationUrl:null},l=a.children.filter(e=>{let{tagName:t}=e;return"BaseURL"===t});for(let A=0;A<l.length;A++){const{children:e}=l[A];1===e.length&&o.baseUrls.push(e[0])}o.baseUrls.length||o.baseUrls.push(function(e){try{const t=new URL(e);t.search="";const r=t.pathname.split("/");return r[r.length-1]="",t.pathname=r.join("/"),t.href}catch(t){return""}}(t)||t);const d=a.children.filter(e=>{let{tagName:t}=e;return"Period"===t});if(void 0===d||0===d.length)throw new je.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Period",details:{node:a},category:He.q.MEDIA});if(o.isDynamic){var c,u,h,p,f;o.minBufferTime=O(null==(c=a.attributes)?void 0:c.minBufferTime)||o.minBufferTime,o.updatePeriod=O(null==(u=a.attributes)?void 0:u.minimumUpdatePeriod)||o.updatePeriod,o.presentationStartTime=D(null==(h=a.attributes)?void 0:h.availabilityStartTime),o.segmentAvailabilityDuration=O(null==(p=a.attributes)?void 0:p.timeShiftBufferDepth)||o.segmentAvailabilityDuration,o.maxSegmentDuration=O(null==(f=a.attributes)?void 0:f.maxSegmentDuration)||o.maxSegmentDuration;const e=O(a.attributes.suggestedPresentationDelay),t=Math.max(1e4,1.5*o.minBufferTime);o.presentationDelay=null!=e?e:t;const r=a.children.find(e=>{let{tagName:t}=e;return"UTCTiming"===t});o.clockOffset=function(e){if(!e)return 0;const t=e.attributes.schemeIdUri,r=e.attributes.value;switch(t){case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":{const e=Date.parse(r);return isNaN(e)?0:e-Date.now()}default:return 0}}(r)}const m={maxHeight:null,duration:O(null==a?void 0:a.attributes.mediaPresentationDuration),maxPresentationTimeOffset:0,minPeriodStartTime:1/0,segmentAvailabilityDuration:o.segmentAvailabilityDuration,nowWithOffset:Date.now()+o.clockOffset,parser:r,availabilityTimeOffset:1/0,isDynamic:o.isDynamic,emsgSchemeIdUris:{audio:new Set,video:new Set}};var g,v,y,E;(o.periods.push((g=d[0],(v=m).minPeriodStartTime=Math.min(O(g.attributes.start)||0,v.minPeriodStartTime),{adaptationSets:C(g,v)})),m.maxPresentationTimeOffset&&(o.segmentAvailabilityDuration=1/0,o.presentationTimeOffset=m.maxPresentationTimeOffset,o.videoType=Ze.Z.EVENT),m.maxSegmentDuration&&m.maxSegmentEndTime)&&(o.maxSegmentDuration=Math.max(m.maxSegmentDuration,o.maxSegmentDuration),o.minSegmentStartTime=null!=(y=m.minSegmentStartTime)?y:null,o.maxSegmentEndTime=null!=(E=m.maxSegmentEndTime)?E:null);m.maxHeight&&(o.maxHeight=m.maxHeight),isFinite(m.availabilityTimeOffset)&&(o.availabilityTimeOffset=m.availabilityTimeOffset),o.publishTime=D(null==(s=a.attributes)?void 0:s.publishTime)||o.publishTime,o.emsgSchemeIdUris=m.emsgSchemeIdUris;const S=a.children.find(e=>{let{tagName:t}=e;return"Location"===t});return S&&S.children.length&&(o.locationUrl=S.children[0].replace(/&(amp|quot|apos|lt|gt);/g,(e,t)=>{var r;return null!=(r=Je[t])?r:e})),o.minPeriodStartTime=isFinite(m.minPeriodStartTime)?m.minPeriodStartTime:null!=(n=m.minSegmentStartTime)?n:o.minPeriodStartTime,o}function L(e){try{const t=new XMLHttpRequest;return t.open("GET","https://yandex.ru"),t.responseType=e,t.responseType===e?e:""}catch(t){return""}}function M(){}function x(){return(x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function V(e,t){void 0===t&&(t=.5);return(e<10?2**e*100:6e4)*(1+(2*Math.random()-1)*t)}function F(){return(F=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function U(e){const t=e.mimeType+"; codecs="+JSON.stringify(e.codecs);return MediaSource.isTypeSupported(t)}function B(e){if(!e.length)return 1/0;let t=0;return e.forEach(e=>{t+=e.bandwidth}),t/e.length}function H(){return(H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function j(e,t){const r=[];return e.forEach(e=>{if("video"===e.type){const i=function(e){const t={};let r=0;e.filter(U).forEach(e=>{r=Math.max(r,e.height);const i=e.codecs.split(".")[0];t[i]?t[i].push(e):t[i]=[e]}),(0,vt.J)(t).forEach(e=>{let[i,s]=e;s.some(e=>e.height===r)||delete t[i]});const i=(0,yt.Z)(t);if(i.length)return i.length>1&&i.sort((e,r)=>B(t[e])-B(t[r])),t[i[0]]}(e.representations);if(!i)return void t.emit("Error",new je.w({code:"YASP_NO_CODECS",details:{type:"video"},isFatal:!0,category:He.q.NO_CODECS}));r.push(H({},e,{representations:i,maxHeight:i[0].height,maxWidth:i[0].width}))}else if("audio"===e.type){const i=function(e){const t={};e.filter(U).forEach(e=>{const r=e.codecs.split(".")[0];t[r]?t[r].push(e):t[r]=[e]});const r=(0,yt.Z)(t);if(r.length)return r.length>1&&r.sort((e,r)=>B(t[e])-B(t[r])),t[r[0]]}(e.representations);if(!i)return void t.emit("Error",new je.w({code:"YASP_NO_CODECS",details:{type:"audio"},isFatal:!0,category:He.q.NO_CODECS}));r.push(H({},e,{representations:i}))}else r.push(e)}),r}function Y(e){if(!(0,oe.K)(e))return!1;const t=e;return(0,At.H)(t.code)&&(0,At.H)(t.category)&&"boolean"===typeof t.isFatal}function W(e,t){let r,i=0;for(let s=0;s<e.buffered.length;s++){const n=e.buffered.start(s),a=e.buffered.end(s);if(!(a<t)){if(void 0!==r&&n-r>=.1)break;i+=a-Math.max(n,t),r=a}}return i}function G(){return(G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function K(e,t){const r={};return(0,yt.Z)(e).forEach(i=>{r[i]=t(e[i],i)}),r}function q(e,t,r){var i;return e.replace(/\$RepresentationID\$/g,t.id).replace(/\$Bandwidth\$/g,String(t.bitrate)).replace(/\$Number\$/g,String(null!=(i=null==r?void 0:r.number)?i:"")).replace(/\$Time\$/g,String((0,Ut.z)(null==r?void 0:r.originalStart)?r.originalStart:"")).replace(/\$\$/g,"$")}function z(){return(z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function X(e,t,r){const i=1e3*r;let s=t,n=!0,a=!1;for(;n;)n=!1,e.forEach(e=>{e.forEach(e=>{e.start<=s&&s<e.end&&(s=e.end,a=!0,n=!0)})});return s>=i&&a?-1:s}function Q(e){if(-1===e.indexOf("#"))return null;let t;if(e.split("#").pop().split("&").some(e=>{const[r,i]=e.split("=",2).map(decodeURIComponent);return"t"===r&&(t=i,!0)}),"string"!==typeof t)return null;const r=parseFloat(t);return isNaN(r)?null:r}function Z(){return(Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function J(e,t){return e.trace.map(e=>e.result.map(e=>e[t]).filter(Boolean).join("-")).filter(Boolean).join("_")}function $(e){const{watchedTime:t=0}=e;return t<15?15:_r()}function ee(e){const{currentTime:t=0,skippableFragments:r}=e;if(!r)return _r();const i=r.find(e=>t>=e.startTime&&t<e.endTime);if(i)return i.startTime,3;const s=r.find(e=>t<e.startTime);return s?s.startTime-t+wr.D:_r()}function te(){return(te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function re(){return(re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ie(){return(ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function se(e,t){void 0===e&&(e=self),function(e,t){function i(e){const t=new je.w({code:e.code===Dr.v.METHOD_NOT_FOUND?"YASP_UNKNOWN_METHOD":"YASP_UNKNOWN_ERROR",details:{error:e},isFatal:!1,category:He.q.EXCEPTION,message:e.message});a.request({method:"error",params:{error:JSON.stringify(t)}})}function s(e){var t;const r=null!=(t=o.takeSource(e))?t:(()=>{const t=new Ir(l,e,n);return t.on("Error",e=>{a.request({method:"error",params:{error:JSON.stringify(e)}})}),t.on("BufferedInfoChanged",t=>{a.request({method:"updateBufferedInfo",params:{bufferedInfo:t,source:e}}).catch(i)}),t.on("AbrDecisionChange",e=>{a.request({method:"logAbrDecision",params:{abrDecisionsLog:e}}).catch(i)}),t.on("NetworkTrace",e=>{a.request({method:"logNetworkTrace",params:{bandwidthInfoBatch:e}}).catch(i)}),t.on("VideoTypeChange",e=>{a.request({method:"changeVideoType",params:{videoType:e}}).catch(i)}),t.on("IsLowLatencyChange",e=>{a.request({method:"changeIsLowLatency",params:{isLowLatency:e}}).catch(i)}),t.on("EmsgDetected",e=>{a.request({method:"emsg",params:{emsg:e}}).catch(i)}),t.on("SegmentLoaded",e=>{a.request({method:"logSegmentLoaded",params:{info:e}}).catch(i)}),t.on("UtcStartTimeUpdate",e=>{a.request({method:"updateUtcStartTime",params:{time:e}}).catch(i)}),t.on("SeekableRangeUpdate",e=>{a.request({method:"updateSeekableRange",params:e}).catch(i)}),t.on("CuesAdded",t=>{let{cues:r,label:s}=t;a.request({method:"cuesAdded",params:{source:e,cues:r,label:s}}).catch(i)}),t})();return o.putSource(e,r),r}const n=(()=>{const t=new ae;return new le(e,t),t})(),a=new Or.A(t=>{e.postMessage(t,(0,Nr._)(t))}),o=new ce(null==t?void 0:t.sourceLimit),l=new Cr;if(l.start(),a.registerHandler("initWorker",e=>((0,he.Vc)(e),setTimeout(()=>{a.request({method:"logWorkerState",params:{enabled:"undefined"===typeof document}})}),"")),a.registerHandler("detach",e=>{let{source:t}=e;const r=o.takeSource(t);if(void 0===r)throw new Error("Unknown source "+t);r.off("VideoTrackChange"),r.off("AudioLanguageChange"),r.off("TextTrackChange"),r.off("BandwidthEstimateUpdate"),r.off("MaxCapAllowedVideoTrackUpdate"),r.off("ServerTimeChange"),r.detach()}),a.registerHandler("destroy",e=>{let{source:t}=e;if(void 0===o.takeSource(t))throw new Error("Unknown source "+t);o.removeSource(t)}),a.registerHandler("requestDebugInfo",e=>{let{source:t}=e;return{yaspSrc:null!=t?t:null,sources:o.getAllSources().map(e=>e.getDebugInfo())}}),a.registerHandler("setVideoTrack",e=>{let{source:t,trackId:r}=e;const i=o.takeSource(t);if(void 0===i)throw new Error("Unknown source "+t);i.setVideoTrack(r)}),a.registerHandler("setAudioTrack",e=>{let{source:t,language:r}=e;const i=o.takeSource(t);if(void 0===i)throw new Error("Unknown source "+t);i.setAudioTrack(r)}),a.registerHandler("setTextTrack",e=>{let{source:t,track:r}=e;const i=o.takeSource(t);if(void 0===i)throw new Error("Unknown source "+t);i.setTextTrack(r)}),a.registerHandler("setVideoElementSizes",e=>{let{source:t,videoSizes:r}=e;const i=o.takeSource(t);if(void 0===i)throw new Error("Unknown source "+t);i.setVideoElementSizes(r)}),a.registerHandler("configure",e=>{let{source:t,config:r}=e;const i=o.takeSource(t);if(void 0===i)throw new Error("Unknown source "+t);i.configure(r)}),a.registerHandler("attach",async e=>{let{source:t}=e;const r=s(t);r.on("VideoTrackChange",e=>{a.request({method:"changeSelectedVideoTrack",params:{id:e}}).catch(i)}),r.on("AudioLanguageChange",e=>{a.request({method:"changeSelectedAudioLanguage",params:{language:e}}).catch(i)}),r.on("BandwidthEstimateUpdate",e=>{a.request({method:"updateBandwidthEstimate",params:{bandwidth:e}}).catch(i)}),r.on("MaxCapAllowedVideoTrackUpdate",e=>{a.request({method:"updateMaxCapAllowedVideoTrack",params:{maxCapAllowedVideoTrack:e}}).catch(i)}),r.on("DrmInfoReceived",e=>{a.request({method:"applyDrmInfos",params:{drmInfos:e}}).catch(i)}),r.on("FlushMediaPipelineRequested",()=>{a.request({method:"flushMediaPipeline",params:{}}).catch(i)}),r.on("ServerTimeChange",e=>{a.request({method:"updateServerTime",params:{time:e}})});const n=await r.attach(t);a.request({method:"setStartInfo",params:{source:t,objectUrl:n,startPosition:r.getStartPosition()}}).catch(i),r.getVideoTracks().forEach((e,r,s)=>{a.request({method:"addVideoTrack",params:{source:t,track:ie({},e,{bitrate:e.bitrate?e.bitrate/1e3:void 0}),length:s.length}}).catch(i)}),r.getAudioTracks().forEach(e=>{a.request({method:"addAudioTrack",params:{source:t,track:ie({},e,{bitrate:e.bitrate?e.bitrate/1e3:void 0})}}).catch(i)}),r.getTextTracks().forEach(e=>{a.request({method:"addTextTrack",params:{source:t,track:{id:e.id,kind:e.kind,label:e.label,language:e.language||"unknown"}}}).catch(i)})}),a.registerHandler("load",e=>{let{source:t}=e;return s(t).load()}),a.registerHandler("clear",async e=>{let{source:t}=e;const r=s(t);await r.handleSeek(),r.abortMseFeeder()}),e.addEventListener("message",e=>{"object"===typeof e.data&&("string"!==typeof e.data.method||"object"===typeof e.data.params&&null!==e.data.params)&&a.handleMessage(e)}),"undefined"===typeof document)try{r(1494).l()}catch(d){console.warn(d)}Promise.resolve()}(e,t)}r.d(t,{Z:()=>Lr});r(7881);class ne{constructor(){this.timeRanges=[]}get length(){return this.timeRanges.length}start(e){if(this.timeRanges.length<=e)throw new Error("Failed to execute 'start' on 'TimeRanges': The index provided ("+e+") is greater than the maximum bound ("+this.timeRanges.length+").");return this.timeRanges[e][0]}end(e){if(this.timeRanges.length<=e)throw new Error("Failed to execute 'end' on 'TimeRanges': The index provided ("+e+") is greater than the maximum bound ("+this.timeRanges.length+").");return this.timeRanges[e][1]}update(e){this.timeRanges=e}}class ae{constructor(){this.currentTime=void 0,this.duration=void 0,this.videoSize=void 0,this.containerSize=void 0,this.devicePixelRatio=void 0,this.buffering=void 0,this.buffered=void 0,this.paused=void 0,this.loop=void 0,this.playbackRate=void 0,this.frames=void 0,this.currentTime=null,this.duration=Math.max(0,0),this.videoSize=null,this.containerSize=null,this.buffering=!0,this.buffered=new ne,this.paused=!0,this.loop=!1,this.devicePixelRatio=1,this.playbackRate=1,this.frames={total:Math.max(Math.floor(0)),dropped:Math.max(Math.floor(0))}}}var oe=r(3770);class le{constructor(e,t){this.videoState=void 0,this.worker=void 0,this.buffered=void 0,this.handleEvent=(e,t)=>{switch(e){case"updateBuffering":return void(this.videoState.buffering=t);case"updateCurrentTime":return void(this.videoState.currentTime=t);case"updateFrames":return void(this.videoState.frames=t);case"updateDevicePixelRatio":return void(this.videoState.devicePixelRatio=t);case"updateDuration":return void(this.videoState.duration=t);case"updateLoop":return void(this.videoState.loop=t);case"updatePaused":return void(this.videoState.paused=t);case"updatePlaybackRate":return void(this.videoState.playbackRate=t);case"updateVideoSize":return void(this.videoState.videoSize=t);case"updateBuffered":return void this.buffered.update(t);case"updateContainerSize":return void(this.videoState.containerSize=t)}},this.videoState=t,this.buffered=new ne,this.videoState.buffered=this.buffered,this.worker=e,this.worker.addEventListener("message",e=>{let{data:t}=e;(0,oe.K)(t)&&"string"===typeof t.method&&this.handleEvent(t.method,t.params)})}}var de=r(4910);class ce{constructor(e){void 0===e&&(e=1),this.limit=e,this.sources=new Map}takeSource(e){return this.sources.get((0,de.H)(e))}putSource(e,t){const r=(0,de.H)(e);for(this.sources.delete(r),this.sources.set(r,t);this.sources.size>this.limit;){const e=this.sources.entries().next().value;if(!e)break;const[t,r]=e;ce.destroySource(r),this.sources.delete(t)}}removeSource(e){const t=(0,de.H)(e),r=this.sources.get(t);return!!r&&(ce.destroySource(r),this.sources.delete(t))}getAllSources(){return Array.from(this.sources.values())}static destroySource(e){null==e||e.destroy()}}var ue=r(9329),he=r(5543);class pe extends ue.v{constructor(e){super(),this.id=void 0,this.bitrate=void 0,this.language=void 0,this.type=void 0,this.initialization=void 0,this.timescale=void 0,this.media=void 0,this.mimeType=void 0,this.startNumber=void 0,this.startTime=void 0,this.endNumber=void 0,this.endTime=void 0,this.presentationTimeOffset=void 0,this.segmentSequences=void 0,this.init=null,this.segmentRanges=[],this.segments=new Map,this.id=e.id,this.bitrate=e.bitrate,this.language=e.language,this.type=e.type,this.initialization=e.initialization,this.timescale=e.timescale,this.media=e.media,this.mimeType=e.mimeType,this.startNumber=e.startNumber,this.startTime=e.startTime,this.endNumber=e.endNumber,this.endTime=e.endTime,this.presentationTimeOffset=e.presentationTimeOffset,this.segmentSequences=e.segmentSequences}updateTrack(e){this.startNumber=e.startNumber,this.startTime=e.startTime,this.endNumber=e.endNumber,this.endTime=e.endTime,this.presentationTimeOffset=e.presentationTimeOffset,this.segmentSequences=e.segmentSequences}getFullMimeType(){return this.mimeType}appendInitSegment(e){this.init=e}clampSegmentRanges(){this.segmentRanges.sort((e,t)=>e.startNumber-t.startNumber||e.endNumber-t.endNumber);for(let e=1;e<this.segmentRanges.length;e++){const t=this.segmentRanges[e-1],r=this.segmentRanges[e];t.startNumber===r.startNumber?(this.segmentRanges.splice(e,1),e--,t.endNumber=Math.max(Math.floor(Math.max(t.endNumber,r.endNumber))),t.end=Math.max(Math.max(t.end,r.end),0)):t.endNumber===r.endNumber&&(this.segmentRanges.splice(e,1),e--,t.startNumber=Math.max(Math.floor(Math.min(t.startNumber,r.startNumber))),t.start=Math.max(Math.min(t.start,r.start),0)),t.endNumber+1===r.startNumber&&(this.segmentRanges.splice(e,1),e--,t.endNumber=r.endNumber,t.end=r.end)}}appendSegment(e){this.segments.set(e.number,e),e.finished?this.appendSegmentRange(e):((0,he.RW)("web_yasp_parallel_downloads")?(this.appendSegmentRange(e),e.once("Failed",()=>{this.clear(e.start,e.end)})):e.once("Finish",()=>{this.appendSegmentRange(e)}),e.once("Failed",()=>{this.segments.delete(e.number)}))}appendSegmentRange(e){this.segmentRanges.push({start:e.start,startNumber:e.number,end:e.end,endNumber:e.number}),this.clampSegmentRanges(),this.emit("BufferedInfoChanged"),this.parseSegment(e)}parseSegment(e){}hasSegment(e){return this.segments.has(e)}getInitSegment(){return this.init}getSegment(e){return function(e){const t=[];for(const r of e)t.push(r);return t}(this.segments.values()).find(t=>void 0!==t&&(e===this.endTime&&t.number===this.endNumber?t:t.start<=e&&e<t.end))||null}getBufferedRanges(){return this.segmentRanges.map(e=>{let{start:t,end:r}=e;return{start:t,end:r}})}getSeekableRanges(){return[{start:this.startTime-this.presentationTimeOffset,end:this.endTime-this.presentationTimeOffset}]}getDebugInfo(){return{id:this.id,bitrate:this.bitrate,language:this.language,type:this.type,initialization:this.initialization,timescale:this.timescale,media:this.media,mimeType:this.mimeType,startNumber:this.startNumber,startTime:this.startTime,endNumber:this.endNumber,endTime:this.endTime,presentationTimeOffset:this.presentationTimeOffset,segmentSequences:this.segmentSequences,seekableRanges:this.getSeekableRanges(),segmentRanges:this.segmentRanges,segments:Array.from(this.segments.entries()).reduce((e,t)=>(e[t[0]]=t[1].getDebugInfo(),e),{})}}clear(e,t){let r=!1;this.segmentRanges.forEach(i=>{let s=i.startNumber;for(;s===i.startNumber;){const n=this.segments.get(s);if(!(n.start>=e&&n.end<=t))break;if(r=!0,this.segments.delete(s),n.destroy(),i.start=n.end,i.startNumber===i.endNumber)return void this.segmentRanges.splice(this.segmentRanges.indexOf(i),1);s+=Math.max(Math.floor(1)),i.startNumber=s}for(s=i.endNumber;s===i.endNumber;){const n=this.segments.get(s);if(!(n.start>=e&&n.end<=t))break;if(r=!0,this.segments.delete(s),i.end=n.start,i.startNumber===i.endNumber)return void this.segmentRanges.splice(this.segmentRanges.indexOf(i),1);s=Math.max(0,s-Math.max(Math.floor(1))),i.endNumber=s}}),r&&this.emit("BufferedInfoChanged")}}class fe extends pe{constructor(e){super(e),this.type="audio",this.codecs=void 0,this.label=void 0,this.codecs=e.codecs,this.label=e.name}getFullMimeType(){return this.mimeType+"; codecs="+JSON.stringify(this.codecs)}}class me extends pe{constructor(e){super(e),this.height=void 0,this.width=void 0,this.type="video",this.codecs=void 0,this.label=void 0,this.height=e.height,this.width=e.width,this.codecs=e.codecs;const t=this.parseMediaAttribute(e.media||"");this.label=t.label||this.height+"p"}getDebugInfo(){return s({},super.getDebugInfo(),{height:this.height,width:this.width,codecs:this.codecs})}getFullMimeType(){return this.mimeType+"; codecs="+JSON.stringify(this.codecs)}parseMediaAttribute(e){const t={};return e.split(",").map(e=>{const r=e.split("=");r.length>0&&(t[r[0]]=r[1])}),t}}class ge{static defaultEquals(e,t){return!("number"!==typeof e||"number"!==typeof t||!isNaN(e)||!isNaN(t))||e===t}static equal(e,t,r){if(void 0===r&&(r=ge.defaultEquals),e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1;return!0}}class ve{constructor(e,t,r){this.startTime=void 0,this.endTime=void 0,this.payload=void 0,this.direction=Ae.HORIZONTAL_LEFT_TO_RIGHT,this.region=new Ce,this.position=null,this.positionAlign=ye.AUTO,this.size=0,this.textAlign=Ee.CENTER,this.writingMode=Te.HORIZONTAL_TOP_TO_BOTTOM,this.lineInterpretation=be.LINE_NUMBER,this.line=null,this.lineHeight="",this.lineAlign=Re.START,this.displayAlign=Se.AFTER,this.color="",this.backgroundColor="",this.backgroundImage="",this.fontSize="",this.fontWeight=we.NORMAL,this.fontStyle=_e.NORMAL,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1,this.startTime=e,this.endTime=t,this.payload=r}clone(){const e=new ve(0,0,"");for(const t in this)e[t]=this[t],e[t]&&e[t].constructor===Array&&(e[t]=e[t].slice());return e}static equal(e,t){for(const r in e)if("nestedCues"===r){if(!ge.equal(e.nestedCues,t.nestedCues,ve.equal))return!1}else if("region"===r||"cellResolution"===r){for(const i in e[r])if(e[r][i]!==t[r][i])return!1}else if(Array.isArray(e[r])){if(!ge.equal(e[r],t[r]))return!1}else if(e[r]!==t[r])return!1;return!0}}let ye,Ee,Se,Ae,Te,be,Re,we,_e,ke,Pe,Ie;!function(e){e.LEFT="line-left",e.RIGHT="line-right",e.CENTER="center",e.AUTO="auto"}(ye||(ye={})),function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.START="start",e.END="end"}(Ee||(Ee={})),function(e){e.BEFORE="before",e.CENTER="center",e.AFTER="after"}(Se||(Se={})),function(e){e.HORIZONTAL_LEFT_TO_RIGHT="ltr",e.HORIZONTAL_RIGHT_TO_LEFT="rtl"}(Ae||(Ae={})),function(e){e.HORIZONTAL_TOP_TO_BOTTOM="horizontal-tb",e.VERTICAL_LEFT_TO_RIGHT="vertical-lr",e.VERTICAL_RIGHT_TO_LEFT="vertical-rl"}(Te||(Te={})),function(e){e[e.LINE_NUMBER=0]="LINE_NUMBER",e[e.PERCENTAGE=1]="PERCENTAGE"}(be||(be={})),function(e){e.CENTER="center",e.START="start",e.END="end"}(Re||(Re={})),function(e){e[e.NORMAL=400]="NORMAL",e[e.BOLD=700]="BOLD"}(we||(we={})),function(e){e.NORMAL="normal",e.ITALIC="italic",e.OBLIQUE="oblique"}(_e||(_e={})),function(e){e.UNDERLINE="underline",e.LINE_THROUGH="lineThrough",e.OVERLINE="overline"}(ke||(ke={}));class Ce{constructor(){this.id="",this.viewportAnchorX=0,this.viewportAnchorY=0,this.regionAnchorX=0,this.regionAnchorY=0,this.width=100,this.height=100,this.heightUnits=Pe.PERCENTAGE,this.widthUnits=Pe.PERCENTAGE,this.viewportAnchorUnits=Pe.PERCENTAGE,this.scroll=Ie.NONE}}!function(e){e[e.PX=0]="PX",e[e.PERCENTAGE=1]="PERCENTAGE",e[e.LINES=2]="LINES"}(Pe||(Pe={})),function(e){e.NONE="",e.UP="up"}(Ie||(Ie={}));var Oe=r(9010);class De{constructor(e){this.data_=void 0,this.position_=void 0,this.data_=e,this.position_=0}atEnd(){return this.position_===this.data_.length}readLine(){return this.readRegexReturnCapture_(/(.*?)(\n|$)/gm,1)}readWord(){return this.readRegexReturnCapture_(/[^ \t\n]*/gm,0)}skipWhitespace(){this.readRegex(/[ \t]+/gm)}readRegex(e){let t=this.indexOf_(e);return this.atEnd()||null===t||t.position!==this.position_?null:(this.position_+=t.length,t.results)}readRegexReturnCapture_(e,t){if(this.atEnd())return null;let r=this.readRegex(e);return r?r[t]:null}indexOf_(e){e.lastIndex=this.position_;let t=e.exec(this.data_);return null===t?null:{position:t.index,length:t[0].length,results:t}}}class Ne extends class{parseInit(e){}parseMedia(e,t){return[]}}{constructor(){super()}parseInit(e){}parseMedia(e,t){let r=Oe.x.fromUTF8(e);r=r.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");let i=r.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(i[0]))throw new Error("INVALID_TEXT_HEADER");let s=t.segmentStart;if(null===s&&(s=0,i[0].includes("X-TIMESTAMP-MAP"))){const e=i[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),r=i[0].match(/MPEGTS:(\d+)/m);if(e&&r){const i=new De(e[1]),n=Ne.parseTime_(i);if(null===n)throw new Error("INVALID_TEXT_HEADER");const a=Number(r[1]),o=Ne.MPEG_TIMESCALE_;s=t.periodStart+(a/o-n)}}let n=[],a=i[0].split("\n");for(let l=1;l<a.length;l++)if(/^Region:/.test(a[l])){let e=Ne.parseRegion_(a[l]);n.push(e)}let o=[];for(let l=1;l<i.length;l++){a=i[l].split("\n");let e=Ne.parseCue_(a,s,n);e&&o.push(e)}return o}static parseRegion_(e){let t=new De(e),r=new Ce;t.readWord(),t.skipWhitespace();let i=t.readWord();for(;i;)Ne.parseRegionSetting_(r,i),t.skipWhitespace(),i=t.readWord();return r}static parseCue_(e,t,r){if(1===e.length&&!e[0])return null;if(/^NOTE($|[ \t])/.test(e[0]))return null;if("STYLE"===e[0])return null;let i=null;e[0].includes("--\x3e")||(i=e[0],e.splice(0,1));let s=new De(e[0]),n=Ne.parseTime_(s),a=s.readRegex(/[ \t]+-->[ \t]+/g),o=Ne.parseTime_(s);if(null===n||null===a||null===o)throw new Error("INVALID_TEXT_CUE");t&&(n+=t,o+=t);let l=e.slice(1).join("\n").trim(),d=new ve(n,o,l);s.skipWhitespace();let c=s.readWord();for(;c;)Ne.parseCueSetting(d,c,r),s.skipWhitespace(),c=s.readWord();return null!==i&&(d.id=i),d}static parseCueSetting(e,t,r){let i=null;if(i=/^align:(start|middle|center|end|left|right)$/.exec(t))Ne.setTextAlign_(e,i[1]);else if(i=/^vertical:(lr|rl)$/.exec(t))Ne.setVerticalWritingMode_(e,i[1]);else if(i=/^size:([\d.]+)%$/.exec(t))e.size=Number(i[1]);else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(i[1]),i[2]&&Ne.setPositionAlign_(e,i[2]);else{if(!(i=/^region:(.*)$/.exec(t)))return Ne.parsedLineValueAndInterpretation_(e,t);{let t=Ne.getRegionById_(r,i[1]);t&&(e.region=t)}}return!0}static getRegionById_(e,t){let r=e.filter((function(e){return e.id===t}));return r.length?r[0]:null}static parseRegionSetting_(e,t){let r=null;if(r=/^id=(.*)$/.exec(t))e.id=r[1];else if(r=/^width=(\d{1,2}|100)%$/.exec(t))e.width=Number(r[1]);else if(r=/^lines=(\d+)$/.exec(t))e.height=Number(r[1]),e.heightUnits=Pe.LINES;else if(r=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.regionAnchorX=Number(r[1]),e.regionAnchorY=Number(r[2]);else if(r=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.viewportAnchorX=Number(r[1]),e.viewportAnchorY=Number(r[2]);else{if(!(r=/^scroll=up$/.exec(t)))return!1;e.scroll=Ie.UP}return!0}static setTextAlign_(e,t){e.textAlign="middle"===t?Ee.CENTER:Ee[t.toUpperCase()]}static setPositionAlign_(e,t){e.positionAlign="line-left"===t||"start"===t?ye.LEFT:"line-right"===t||"end"===t?ye.RIGHT:ye.CENTER}static setVerticalWritingMode_(e,t){e.writingMode="lr"===t?Te.VERTICAL_LEFT_TO_RIGHT:Te.VERTICAL_RIGHT_TO_LEFT}static parsedLineValueAndInterpretation_(e,t){let r=null;if(r=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=be.PERCENTAGE,e.line=Number(r[1]),r[2]&&(e.lineAlign=Re[r[2].toUpperCase()]);else{if(!(r=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)))return!1;e.lineInterpretation=be.LINE_NUMBER,e.line=Number(r[1]),r[2]&&(e.lineAlign=Re[r[2].toUpperCase()])}return!0}static parseTime_(e){let t=e.readRegex(/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null===t)return null;let r=Number(t[1])||0,i=Number(t[2]),s=Number(t[3]),n=Number(t[4]);return i>59||s>59?null:n/1e3+s+60*i+3600*r}}Ne.MPEG_TIMESCALE_=9e4;class Le{constructor(){this.parser_=null,this.timestampOffset_=0,this.appendWindowStart_=0,this.appendWindowEnd_=1/0,this.bufferStart_=null,this.bufferEnd_=null,this.closedCaptionsMap_=new Map}static registerParser(e,t){Le.parserMap_[e]=t}static isTypeSupported(e){return!!Le.parserMap_[e]}destroy(){return this.parser_=null,this.closedCaptionsMap_.clear(),Promise.resolve()}initParser(e){if("application/cea-608"===e)return;let t=Le.parserMap_[e];this.parser_=new t}getStartTime(e){let t={periodStart:0,segmentStart:null,segmentEnd:0};try{var r;let i=null==(r=this.parser_)?void 0:r.parseMedia(new Uint8Array(e),t);return i?i[0].startTime:[]}catch(i){throw new Error("UNABLE_TO_EXTRACT_CUE_START_TIME: "+i)}}appendBuffer(e,t,r){return Promise.resolve().then(()=>{if(!this.parser_)return;if(null===t||null===r)return void this.parser_.parseInit(e);let i={periodStart:this.timestampOffset_,segmentStart:t,segmentEnd:r},s=this.parser_.parseMedia(e,i).filter(e=>e.startTime>=this.appendWindowStart_&&e.startTime<this.appendWindowEnd_);return null===this.bufferStart_&&(this.bufferStart_=Math.max(t,this.appendWindowStart_)),this.bufferEnd_=Math.min(r,this.appendWindowEnd_),s})}setTimestampOffset(e){this.timestampOffset_=e}setAppendWindow(e,t){this.appendWindowStart_=e,this.appendWindowEnd_=t}bufferStart(){return this.bufferStart_}bufferEnd(){return this.bufferEnd_}isBuffered(e){return null!==this.bufferStart_&&null!==this.bufferEnd_&&(e>=this.bufferStart_&&e<this.bufferEnd_)}bufferedAheadOf(e){return null===this.bufferEnd_||this.bufferEnd_<e?0:this.bufferEnd_-Math.max(e,this.bufferStart_)}}Le.parserMap_={},Le.unregisterParser=function(e){delete Le.parserMap_[e]},Le.registerParser("text/vtt",Ne),Le.registerParser('text/vtt; codecs="vtt"',Ne),Le.registerParser('text/vtt; codecs="wvtt"',Ne);class Me extends pe{constructor(e){super(e),this.kind=void 0,this.label=void 0,this.type="text",this.kind=Me.parseKind(e.kind),this.label=e.label||e.language||"Yasp Text Track"}static parseKind(e){switch(e){case"subtitle":return"subtitles";default:return e}}parseSegment(e){Me.textEngine.initParser(this.mimeType);const t=e.getChunks();let r=0;t.forEach(e=>{r+=e.length});const i=new Uint8Array(r);let s=0;t.forEach(e=>{i.set(e,s),s+=e.length}),Me.textEngine.appendBuffer(i,e.start,e.end).then(e=>{this.emit("CuesAdded",e)})}}Me.textEngine=new Le;var xe=r(942),Ve=r(8682),Fe=r(5269),Ue=r(4513);class Be extends Ue.M{constructor(){super(...arguments),this.audio=[],this.text=[],this.video=[],this.bufferedInfoChangedPromise=null,this.selectedVideoTrackHeight=void 0,this.selectedVideoTracks=[],this.selectedAudioLanguage=void 0,this.selectedTextTrack=void 0,this.targetLatency=7e3,this.mpd=void 0,this.externalPresentationDelay=void 0}setVideoTrack(e){const t=this.findTrackById(e,"video"),r=t?t.height:void 0;r!==this.selectedVideoTrackHeight&&(this.selectedVideoTrackHeight=r,this.updateSelectedVideoTracks(),this.emit("VideoTrackChange",t?e:"auto"))}updateSelectedVideoTracks(){this.selectedVideoTracks=this.selectedVideoTrackHeight?this.video.filter(e=>e.height===this.selectedVideoTrackHeight):d(this.video)}setAudioLanguage(e){const t=this.audio.find(t=>t.language===e)?e:this.selectedAudioLanguage;t!==this.selectedAudioLanguage&&(this.selectedAudioLanguage=t,this.emit("AudioLanguageChange",e))}setTextTrack(e){var t;if(this.selectedTextTrack&&this.selectedTextTrack.clear(0,1/0),!e)return void(this.selectedTextTrack=void 0);let r=this.text.find(t=>t.language===e.language);r&&(null==r?void 0:r.language)!==(null==(t=this.selectedTextTrack)?void 0:t.language)&&(this.selectedTextTrack=r||this.selectedTextTrack,this.emit("TextTrackChange",this.selectedTextTrack))}getVideoTracksInfo(){return[{id:Ve.A,selected:void 0===this.selectedVideoTrackHeight,kind:"main",language:"unknown",label:""},...d(this.video).map(e=>({selected:e.height===this.selectedVideoTrackHeight,width:e.width,height:e.height,bitrate:e.bitrate,label:e.label,language:e.language,id:e.id,kind:"main"}))]}getAudioTracksInfo(){const e={};return this.audio.forEach(t=>{const r=t.language;r&&(e[r]?t.bitrate>e[r].bitrate&&(e[r].bitrate=t.bitrate):e[r]={selected:r===this.selectedAudioLanguage,id:t.id,label:t.label||"",language:r,kind:"main",bitrate:t.bitrate})}),(0,Fe.z)(e)}getTextTracksInfo(){return this.text}getTracksMeta(e,t){if(null===e)return[];switch(t){case"video":return this.selectedVideoTracks.map(t=>{const r=this.getSegmentMeta(e,t);return r?c({},r,{width:t.width,height:t.height}):r}).filter(Boolean);case"audio":return this.audio.filter(e=>{var t;return e.language===(null!=(t=this.selectedAudioLanguage)?t:e.language)}).map(t=>this.getSegmentMeta(e,t)).filter(Boolean);case"text":return this.text.filter(e=>{var t,r;return e.label===(null==(t=this.selectedTextTrack)?void 0:t.label)||e.language===(null==(r=this.selectedTextTrack)?void 0:r.language)}).map(t=>this.getSegmentMeta(e,t)).filter(Boolean);default:return[]}}getSegmentMeta(e,t){if(t.endTime===e+t.presentationTimeOffset)return this.getLastSegmentMeta(t);let r=Math.max(Math.floor(0)),i=0;const s=t.segmentSequences.find((s,n)=>{i=n;const a=s.time-t.presentationTimeOffset,o=a+s.duration*s.count,l=a<=e&&e<o;return l||(r+=s.count),l});if(!s)return;const n=s.time-t.presentationTimeOffset,a=e-n,o=Math.max(0,Math.floor(a/s.duration+1e-4)),l=t.startNumber+(r+o),d=Math.max(n+s.duration*o,0),c=l===s.endNumber,u=t.segmentSequences[i+1],h=Math.max(c&&u?u.time-t.presentationTimeOffset:n+s.duration*(o+1),0),p=s.duration,f=t.bitrate,m=s.originalValues.time-s.originalValues.trackPresentationTimeOffset+s.originalValues.duration*o;return{start:d,end:h,duration:p,bitrate:f,trackId:t.id,number:l,originalStart:m}}clear(e,t){this.audio.forEach(r=>r.clear(e,t)),this.video.forEach(r=>r.clear(e,t)),this.text.forEach(r=>r.clear(e,t))}getDuration(){var e,t;const r=null!=(e=this.video[0])?e:this.audio[0];if(void 0!==r)return null!=(t=this.mpd)&&t.isDynamic?1/0:r.endTime-r.startTime}getMimeTypes(){return{audio:Array.from(new Set(this.audio.map(e=>e.getFullMimeType()))),video:Array.from(new Set(this.video.map(e=>e.getFullMimeType())))}}getBufferedRanges(){let e=this.audio,t=this.selectedVideoTracks,r=this.text;return this.selectedAudioLanguage&&(e=e.filter(e=>e.language===this.selectedAudioLanguage)),{audio:e.map(e=>e.getBufferedRanges()),video:t.map(e=>e.getBufferedRanges()),text:r.map(e=>e.getBufferedRanges())}}getSeekableRanges(){return[this.getSeekableRange()]}getSegment(e,t){const r=[];return("video"===e?this.selectedVideoTracks:this.audio.filter(e=>{var t;return e.language===(null!=(t=this.selectedAudioLanguage)?t:e.language)})).forEach(e=>{const i=e.getSegment(t);i&&r.push({track:e,segment:i})}),(0,xe.Y)(r,e=>{let{track:t}=e;return t.bitrate})||{track:void 0,segment:void 0}}getInitialSegment(e,t){const r=("video"===e?this.video:this.audio).find(e=>{let{id:r}=e;return r===t});return(null==r?void 0:r.getInitSegment())||void 0}obtainTimelineTrack(e){const t=this[e.type];"audio"===e.type&&(this.selectedAudioLanguage=this.selectedAudioLanguage||e.language||void 0);const r=t.find(t=>t.id===e.id);if(r)return r.updateTrack(e),r;const i=(e=>{switch(e.type){case"audio":return new fe(e);case"video":return new me(e);case"text":return new Me(e);default:throw new Error("Unexpected TimelineTrack#type="+e.type)}})(e);return t.push(i),i.on("BufferedInfoChanged",()=>this.emitBufferedInfoChanged()),"text"===i.type&&i.on("CuesAdded",e=>{this.emit("CuesAdded",{cues:e,label:i.label})}),i}findTrackById(e,t){return this[t].find(t=>t.id===e)}emitBufferedInfoChanged(){var e;this.bufferedInfoChangedPromise=null!=(e=this.bufferedInfoChangedPromise)?e:Promise.resolve().then(()=>{const e=this.getBufferedRanges(),t=o(e.video),r=o(e.audio);this.emit("BufferedInfoChanged",{video:t.map(e=>{let{start:t,end:r}=e;return{start:t/1e3,end:r/1e3}}),audio:r.map(e=>{let{start:t,end:r}=e;return{start:t/1e3,end:r/1e3}}),total:l(t,r).map(e=>{let{start:t,end:r}=e;return{start:t/1e3,end:r/1e3}})})}).then(()=>{this.bufferedInfoChangedPromise=null})}getLastSegmentMeta(e){const t=e.segmentSequences[e.segmentSequences.length-1];if(!t)return;const r=Math.max(0,t.time+t.duration*(t.count-1)),i=Math.max(r+t.duration,0),s=t.duration,n=e.bitrate,a=t.originalValues.time-t.originalValues.trackPresentationTimeOffset+t.originalValues.duration*(t.count-1);return{start:r,end:i,duration:s,bitrate:n,trackId:e.id,number:e.endNumber,originalStart:a}}getDebugInfo(){var e,t,r;return{audio:this.audio.map(e=>e.getDebugInfo()),video:this.video.map(e=>e.getDebugInfo()),text:this.text.map(e=>e.getDebugInfo()),selectedVideoTracks:this.selectedVideoTracks.map(e=>e.getDebugInfo()),selectedVideoTrackHeight:null!=(e=this.selectedVideoTrackHeight)?e:null,selectedAudioLanguage:null!=(t=this.selectedAudioLanguage)?t:null,selectedTextTrack:null!=(r=this.selectedTextTrack)?r:null}}applyMpd(e){var t;this.mpd=c({},e,{presentationDelay:null!=(t=this.externalPresentationDelay)?t:e.presentationDelay})}getIsDynamic(){var e;return(null==(e=this.mpd)?void 0:e.isDynamic)||!1}isLowLatencyLive(){var e;return this.getIsDynamic()&&0!==(null==(e=this.mpd)?void 0:e.availabilityTimeOffset)}getLiveEdge(){var e;if(null==(e=this.mpd)||!e.isDynamic)return this.getDuration()||0;if(null===this.mpd.presentationStartTime)throw new Error("Cannot compute live edge without presentationStartTime");return Date.now()+this.mpd.clockOffset-this.mpd.maxSegmentDuration-this.mpd.presentationStartTime}getSeekableRange(){return{start:this.getSeekRangeStart(),end:this.getSeekRangeEnd()}}getSeekRangeStart(){var e;if(null==(e=this.mpd)||!e.isDynamic)return 0;const t=this.mpd.minSegmentStartTime;if(!isFinite(this.mpd.segmentAvailabilityDuration))return t-this.mpd.publishTime;const r=this.getLiveEdge()+this.mpd.availabilityTimeOffset-this.mpd.segmentAvailabilityDuration+this.mpd.minBufferTime;return Math.max(t,r)}getSeekRangeEnd(){var e;if(null==(e=this.mpd)||!e.isDynamic)return this.getDuration()||0;const t=this.isLowLatencyLive()?0:this.mpd.presentationDelay,r=this.getLiveEdge()+this.mpd.availabilityTimeOffset-t;if(!this.isLowLatencyLive())return r;const i=r+this.mpd.presentationStartTime,s=Date.now()+this.mpd.clockOffset;return Math.min(i,s-this.targetLatency)-this.mpd.presentationStartTime}getUtcStartTime(){var e,t,r;return null!=(e=this.mpd)&&e.isDynamic?this.mpd.isDynamic&&!isFinite(this.mpd.segmentAvailabilityDuration)?this.mpd.publishTime:0:null!=(t=null==(r=this.mpd)?void 0:r.publishTime)?t:0}setPresentationDelay(e){this.externalPresentationDelay=e}getEmsgSchemeIdUris(){var e;return null==(e=this.mpd)?void 0:e.emsgSchemeIdUris}}var He=r(6971),je=r(1106),Ye=r(7922),We=r(1610);const Ge=(new Map).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",Ye.Ql).set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",Ye.xE).set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95",Ye.xE),Ke=(e,t)=>({keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:null!=t?t:[]});class qe{constructor(e){this.parser=e}parse(e){let t=this.parseElements(e),r=null,i=[],s=[];const n=new Set(t.map(e=>e.keyId).filter(e=>null!==e));if(n.size>1)throw new je.w({code:"YASP_DASH_CONFLICTING_KEY_IDS",isFatal:!0,message:"Dash manifest has conflicting ids: "+Array.from(n).join(","),details:{},category:He.q.DRM});s=t.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"!==e.schemeUri||(r=e.init||r,!1)})),s.length&&(i=this.convertElements(r,s));return{defaultKeyId:Array.from(n)[0]||null,defaultInit:r,drmInfos:i}}convertElements(e,t){const r=[];for(const i of t){const t=Ge.get(i.schemeUri);if(t){const s=this.getInitDataFromPro(i)||i.init||e,n=Ke(t,s);r.push(n)}}return r}parseElements(e){const t=[];for(const r of e){const e=this.parseElement(r);e&&t.push(e)}return t}getInitDataFromPro(e){const t=this.parser.findChildNS(e.node,"urn:microsoft:playready","pro");if(!t)return null;const r=this.parser.getContents(t);if(!r)return null;const i=We.P.fromBase64(r),s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),n=this.createPssh(i,s);return n?[{initData:n,initDataType:"cenc",keyId:e.keyId}]:null}createPssh(e,t){const r=e.length,i=12+t.length+4+r,s=new ArrayBuffer(i),n=new Uint8Array(s),a=new DataView(s);let o=0;return a.setUint32(o,i),o+=4,a.setUint32(o,1886614376),o+=4,a.setUint32(o,0),o+=4,n.set(t,o),o+=t.length,a.setUint32(o,r),o+=4,n.set(e,o),o+=r,o===i?We.P.toBase64(n):null}parseElement(e){let t=e.attributes.schemeIdUri,r=this.parser.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID");const i=this.parser.findChildrenNS(e,"urn:mpeg:cenc:2013","pssh").map(e=>this.parser.getContents(e));if(!t)return null;if(t=t.toLowerCase(),r&&(r=r.replace(/-/g,"").toLowerCase(),r.includes(" ")))throw new je.w({code:"YASP_DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED",isFatal:!0,message:"Representation with multiple keyIds is not supported: ("+r+")",details:{},category:He.q.DRM});const s=i.map(e=>({initDataType:"cenc",initData:e,keyId:null}));return{node:e,schemeUri:t,keyId:r,init:s.length>0?s:null}}}const ze=["segmentTemplate","mimeType"],Xe=["segmentTemplate","mimeType"],Qe=["segmentTemplate","mimeType"];var Ze=r(4651);const Je={amp:"&",quot:'"',apos:"'",lt:"<",gt:">"};class $e extends Ue.M{constructor(){super(),this.destroyed=!1,this.closing=!1,this.closed=!1,this.paused=!0,this.flushing=!1,this.buffer=[],this.flushBuffer=()=>{if(this.flushing)return;this.flushing=!0;let e=0;for(;!this.paused&&e<this.buffer.length;)this.emit("Data",this.buffer[e]),e++;this.buffer.splice(0,e),this.flushing=!1,e>0&&0===this.buffer.length&&this.emit("Drain")},this.on("Resume",this.flushBuffer),this.once("Destroy",()=>{this.destroyed=!0})}isClosing(){return this.closing&&!this.destroyed}isClosed(){return this.closed&&!this.destroyed}isDestroyed(){return this.destroyed}asWritable(){return this}asReadable(){return this}write(e){if(this.destroyed)throw new Error("Unexpected write after destroy");if(this.closing)throw new Error("Unexpected write after close");return this.buffer.push(e),this.flushBuffer(),!this.paused&&0===this.buffer.length}async read(){if(this.destroyed)throw new Error("Unexpected read after destroy");return this.closed?Promise.resolve({value:void 0,done:!0}):new Promise((e,t)=>{this.once("Data",t=>{this.pause(),e({value:t,done:!1})}),this.once("Destroy",()=>{t(new Error("Unexpected destroy while read"))}),this.once("Close",()=>{e({value:void 0,done:!0})}),this.resume()})}pause(){this.paused=!0,this.emit("Pause")}resume(){this.paused=!1,this.emit("Resume")}destroy(){this.buffer=[],super.destroy()}close(){this.closing||(this.closing=!0,this.buffer.length>0?this.once("Drain",()=>{this.closed=!0,this.emit("Close")}):(this.closed=!0,this.emit("Close")))}}var et=r(4230);class tt{constructor(e,t){this.body=void 0,this.status=void 0,this.headers=void 0,this.textPromise=void 0,this.body=t,this.status=e.status,this.headers=function(e){const t=[];return e.getAllResponseHeaders().trim().split("\r\n").forEach(e=>{const[r,...i]=e.split(":");t.push([i.join(":"),r])}),{forEach(e){t.forEach(t=>{let[r,i]=t;e(r,i)})}}}(e),this.textPromise=new Promise((t,r)=>{e.addEventListener("load",()=>{t(e.response)}),e.addEventListener("abort",()=>{const e=new Error("Stretch request aborted");e.name="AbortError",r(e)})}),(0,et.v)(this.textPromise)}text(){return this.textPromise}}const rt={done:!0,value:void 0};class it{constructor(e){this.dataStream=void 0,this.readRequest=void 0,this.storedError=void 0,this.onCancel=void 0,this.dataStream=new $e,this.readRequest=null,this.storedError=null,this.onCancel=e}read(){return new Promise((e,t)=>(this.readRequest={resolve:e,reject:t},this.dataStream.isDestroyed()?t(this.storedError||new Error("Unexpected read after stream destroy")):this.dataStream.isClosed()?e(rt):(this.dataStream.once("Data",t=>{this.dataStream.pause(),e({done:!1,value:t})}),void this.dataStream.resume())))}cancel(){this.dataStream.destroy(),this.onCancel()}throw(e){this.dataStream.isDestroyed()||this.dataStream.isClosing()||(this.storedError=e,this.dataStream.destroy(),this.readRequest&&(this.readRequest.reject(e),this.readRequest=null))}write(e){this.dataStream.isDestroyed()||this.dataStream.write(e)}close(){this.dataStream.close()}}const st="undefined"!==typeof fetch&&"undefined"!==typeof ReadableStream&&"undefined"!==typeof function(e,t){try{return e()}catch(r){"function"===typeof t&&t(r)}}(()=>new AbortController),nt=st?"arraybuffer":L("moz-chunked-arraybuffer")||L("ms-stream")||"arraybuffer";class at{constructor(e){this.readerInited=!1,this.reader=void 0,this.xhr=void 0,this.xhr=e,this.reader=new it(()=>e.abort())}throwReaderError(e){return this.reader.throw(e)}getReader(){return this.initReader(this.xhr,nt),this.reader}initReader(e,t){if(this.readerInited)throw new Error("Unexpected second call StretchBody#initReader()");switch(this.readerInited=!0,e.responseType=t,t){case"arraybuffer":e.addEventListener("load",()=>{e.response&&this.reader.write(new Uint8Array(e.response)),this.reader.close()});break;case"moz-chunked-arraybuffer":e.addEventListener("progress",()=>{this.reader.write(new Uint8Array(e.response))}),e.addEventListener("load",()=>{this.reader.close()});break;case"ms-stream":e.addEventListener("readystatechange",()=>{if(e.readyState!==XMLHttpRequest.LOADING)return;let t=0;const{MSStreamReader:r}=self,i=new r;i.onprogress=()=>{i.result.byteLength>t&&(this.reader.write(new Uint8Array(i.result,t)),t=i.result.byteLength)},i.onload=this.reader.close.bind(this.reader),i.readAsArrayBuffer(e.response)})}}}const ot=st?fetch:function(e,t){return void 0===t&&(t={}),new Promise((r,i)=>{const{method:s="GET",body:n=null}=t,a=new XMLHttpRequest;a.open(s,e);for(const e in t.headers)t.headers.hasOwnProperty(e)&&a.setRequestHeader(e,t.headers[e]);"include"===t.credentials&&(a.withCredentials=!0);const o=new at(a),l=()=>{a.readyState===XMLHttpRequest.HEADERS_RECEIVED&&(a.removeEventListener("readystatechange",l),r(new tt(a,o)))};a.addEventListener("readystatechange",l);const d=()=>{a.abort();const e=new Error("request aborted");e.name="AbortError",o.throwReaderError(e),i(e)};if(t.signal){if(t.signal.aborted)return void d();t.signal.addEventListener("abort",d)}a.addEventListener("error",()=>{const e=new Error("network error");o.throwReaderError(e),i(e)}),a.send(n)})};var lt=r(9840),dt=r(55);const ct={};class ut extends lt.Z{constructor(e){if(super(),this.aborted=void 0,this._onabort=dt.Z,e!==ct)throw new TypeError("Illegal constructor.");this.aborted=!1}set onabort(e){const t=this._onabort;t&&this.removeEventListener("abort",t),this._onabort=e,this.addEventListener("abort",e)}get onabort(){return this._onabort}}const ht="object"===typeof self?self:window,pt=st?ht.AbortController:class{constructor(){this._signal=void 0,this._signal=new ut(ct)}get signal(){return this._signal}abort(){const e=this.signal;e.aborted||(e.aborted=!0,e.dispatchEvent(new Event("abort")))}};var ft=r(4343),mt=r(5386);class gt extends Ue.M{setIsLL(e){this.lowLatency=e}isLL(){return this.lowLatency}constructor(e){void 0===e&&(e={}),super(),this.baseParams=void 0,this.lowLatency=!1,this.baseParams=e,(0,he.RW)("web_pass_credentials")&&(this.baseParams.credentials="include")}performRequest(e,t){const r=new pt,i=x({},this.baseParams,t,{headers:x({},this.baseParams.headers,t.headers),signal:r.signal}),s={canceled:!1,timeout:!1,downloadedBytes:0},n=(0,ft.u)(),a=ot(e,i).catch(e=>{if(s.canceled)throw new Error("Request canceled");if(s.timeout)throw new Error("Request timed out");throw e}),o="number"===typeof i.timeout?setTimeout(()=>{s.timeout=!0,r.abort()},i.timeout):void 0;return a.then(e=>{const t={};e.headers.forEach((e,r)=>{t[r]=e}),this.emit("RequestTtfb",n())}).catch(M),{abort:()=>{s.canceled=!0,o&&clearTimeout(o),r.abort()},responsePromise:a,timeoutId:o,requestState:s,signal:i.signal,getRtt:n}}parseServerTime(e,t){if(!e.date&&!e["x-server-time-ms"])return;let r=NaN;if(e["x-server-time-ms"]){r=new Date(parseInt(e["x-server-time-ms"],10)).getTime()}else if(e.date){r=new Date(e.date).getTime()}isFinite(r)&&this.emit("ServerTimeChange",r+t/2)}fetch(e,t){void 0===t&&(t={});const{abort:r,responsePromise:i,timeoutId:s,getRtt:n}=this.performRequest(e,t);return{abort:r,response:i.then(e=>{s&&clearTimeout(s);const t={};return e.headers.forEach((e,r)=>{t[r]=e}),this.parseServerTime(t,n()),{status:e.status,headers:t,body:e.text()}})}}progress(e,t,r){this.emit("Progress",{time:e,size:t,isLowLatency:r})}fetchDataStream(e,t){void 0===t&&(t={});const{abort:r,responsePromise:i,timeoutId:s,requestState:n,signal:a}=this.performRequest(e,t),o=new $e;a.addEventListener("abort",()=>{o.destroy()});let l=!1;const d=()=>{l=!0,r(),o.destroy()};return{requestState:n,abort:d,response:i.then(e=>{const t={};this.on("Destroy",d),e.headers.forEach((e,r)=>{t[r]=e});const r=e.body.getReader(),i=(0,mt.I)(()=>{this.off("Destroy",d),this.emit("ResponseEnd")});o.once("Destroy",i),o.once("Close",i),this.emit("ResponseStart");const a=()=>{l||r.read().then(e=>{let{done:t,value:r}=e;l||(void 0!==r&&(n.downloadedBytes+=r.length,o.write(r)),t?(o.close(),s&&clearTimeout(s)):a())}).catch(e=>{if("AbortError"!==(null==e?void 0:e.name)&&o.destroy(),"AbortError"!==(null==e?void 0:e.name)&&"network error"!==(null==e?void 0:e.message))throw e})};return a(),{status:e.status,headers:t,body:o}})}}getDebugInfo(){return{baseParams:this.baseParams}}}var vt=r(3222),yt=r(5999),Et=r(442),St=r(3564),At=r(8833),Tt=r(6377);const{parse:bt}=r(5154);class Rt{constructor(){this.namespaces={}}parse(e){const t=bt(e),r=Array.isArray(t)?t:[];return r.forEach(e=>{e.attributes&&Object.keys(e.attributes).forEach(t=>{if(t.startsWith("xmlns")){const[,r]=t.split(":");this.namespaces[e.attributes[t]]=r||"__global"}})}),r}getAttributeNS(e,t,r){const i=this.namespaces[t]+":"+r;return i in e.attributes?e.attributes[i]:null}findChildrenNS(e,t,r){return e.children.filter(e=>{const i=this.namespaces[t]+":"+r;return"string"!==typeof e&&e.tagName===i})}getContents(e){var t;return(0,At.H)(e)?e:e.children.every(At.H)&&null!=(t=e.children[0].trim())?t:null}findChildNS(e,t,r){let i=this.findChildrenNS(e,t,r);return 1!==i.length?null:i[0]}}class wt extends Ue.M{parse(e){return this.parser.parse(e)}isInitiallyLoaded(){return null!==this.mpd}constructor(e){super(),this.fetcher=new gt,this.url=void 0,this.timeline=void 0,this.parser=void 0,this.mpd=null,this.xml="",this.attempt=0,this.baseUrls=[],this.drmInfos=[],this.playlistCapHeight=null,this.lastUpdateDuration=0,this.aborted=!1,this.abortFn=null,this.url=e.url,this.timeline=e.timeline,this.parser=new Rt,this.fetcher.on("ServerTimeChange",e=>{this.emit("ServerTimeChange",e)})}getPlaylistCapHeight(){return this.playlistCapHeight}getProgramDateTime(){}isDynamicPlaylist(){var e;return(null==(e=this.mpd)?void 0:e.isDynamic)||!1}getVideoType(){if(this.mpd)return this.mpd.isDynamic?this.mpd.videoType:Ze.Z.VOD}getUpdatePeriod(){var e;return(null==(e=this.mpd)?void 0:e.updatePeriod)||null}getLastUpdateDuration(){return this.lastUpdateDuration}apply(e){this.xml=e;const t=this.parse(e);let r;try{r=N(t,this.url,this.parser)}catch(s){throw Y(s)&&"YASP_PARSE_MANIFEST_ERROR"===s.code&&(s.details.manifest=e),s}this.playlistCapHeight=r.maxHeight,this.baseUrls=r.baseUrls;const i=r.periods[0];return i.adaptationSets=j(i.adaptationSets,this),this.checkTracksLengthDifference(i.adaptationSets),this.checkDrm(i.adaptationSets),function(e,t){e.adaptationSets.forEach(e=>{e.representations.forEach(r=>{var i,s,n,a;switch(e.type){case"audio":t.obtainTimelineTrack(F({},r,r.segmentTemplate,{bitrate:r.bandwidth,language:e.lang,name:e.label,label:e.label,type:"audio"}));break;case"video":t.obtainTimelineTrack(F({},r,r.segmentTemplate,{bitrate:r.bandwidth,language:"unknown",type:"video"}));break;case"text":const o=t.getSeekableRange();t.obtainTimelineTrack(F({},r,{kind:(null==(i=e.role)?void 0:i.value)||"subtitles",label:e.label,language:e.lang,media:r.baseUrl,bitrate:r.bandwidth,type:"text",initialization:null,timescale:1,startNumber:Math.ceil(Math.abs(1)),endNumber:Math.ceil(Math.abs(1)),startTime:null!=(s=null==o?void 0:o.start)?s:0,endTime:null!=(n=null==o?void 0:o.end)?n:0,presentationTimeOffset:0,segmentSequences:[{time:0,duration:null!=(a=t.getDuration())?a:0,count:Math.ceil(Math.abs(1)),endNumber:Math.ceil(Math.abs(1)),originalValues:{time:0,duration:t.getDuration(),trackPresentationTimeOffset:0}}]}))}})}),t.updateSelectedVideoTracks()}(i,this.timeline),this.timeline.applyMpd(r),r}checkDrm(e){const t=e.find(e=>e.encrypted);t&&(this.drmInfos=t.contentProtection.drmInfos,this.mpd||this.emit("DrmInfoReceived",t.contentProtection.drmInfos))}getBaseUrls(){return this.baseUrls}getDrmInfos(){return this.drmInfos}getEmsgSchemeIdUris(){var e;return null==(e=this.mpd)?void 0:e.emsgSchemeIdUris}async update(){this.aborted=!1;const e=(0,St.c)(this.url),t=(0,ft.u)();try{const{response:r,abort:i}=this.fetcher.fetch(e,{timeout:Et.d4});this.abortFn=i;const{body:s,status:n}=await r;if(!(n>=200&&n<300||304===n)){const t=this.attempt>=10;throw 0===n?new je.w({code:"YASP_FETCH_MANIFEST_HTTP_ERROR",message:"Network Error",details:{url:e},category:He.q.NETWORK_MEDIA,isFatal:t}):new je.w({code:"YASP_FETCH_MANIFEST_BAD_HTTP_STATUS",message:"Error: "+n,details:{status:n,url:e},isFatal:t,category:He.q.NETWORK_MEDIA})}this.attempt=0;const a=await s;this.abortFn=null,this.mpd=this.apply(a),this.updateManifestUrl(),this.lastUpdateDuration=t(),this.emit("ManifestUpdate")}catch(i){let t;const s=this.attempt>=10;if(this.abortFn=null,(0,Tt.V)(i)){if("Request canceled"===i.message||"Abort error"===i.message)return;t=Y(i)?i:new je.w({code:"Request timed out"===i.message?"YASP_FETCH_MANIFEST_TIMEOUT":"YASP_FETCH_MANIFEST_HTTP_ERROR",details:{url:e},message:i.message,isFatal:s,category:He.q.NETWORK_MEDIA})}else t=new je.w({code:"YASP_UNKNOWN_ERROR",details:{url:e,error:i},message:"Unknown error. Expect error to be an instance of Error.",isFatal:s,category:He.q.NETWORK_MEDIA});if(this.emit("Error",t),s||t.isFatal)return;const n=(r=V(this.attempt++),new Promise(e=>setTimeout(e,r)));if(this.aborted)return;return n.then(()=>this.update())}var r}abort(){this.abortFn&&this.abortFn(),this.aborted=!0}destroy(){this.abort(),super.destroy()}getDebugInfo(){return{url:this.url,xml:this.xml,attempt:this.attempt,baseUrls:this.baseUrls}}checkTracksLengthDifference(e){if(!e.length)return;const t=new Set,r={};if(e.forEach(e=>{"text"!==e.type&&e.representations.forEach(e=>{r[e.id]=e.segmentTemplate.endTime,t.add(e.segmentTemplate.endTime)})}),1===t.size)return;const i=new je.w({code:"YASP_DIFFERENT_TRACKS_LENGTH",details:r,message:"Different track lengths detected",isFatal:!1,category:He.q.MEDIA});this.emit("Error",i)}updateManifestUrl(){var e,t;this.url=null!=(e=null==(t=this.mpd)?void 0:t.locationUrl)?e:this.url}}class _t{constructor(e){this.manifesto=e,this.processing=!1,this.promise=null,this.timer=0}async update(){if(this.processing)return this.promise;if(!this.shouldUpdate())return;this.processing=!0;return this.promise=this.manifesto.update().then(()=>{this.processing=!1;const e=this.getUpdatePeriod();e&&(this.timer=self.setTimeout(()=>{this.timer=0,this.update()},e))}).catch(dt.Z).then(()=>{this.promise=null}),this.promise}forceUpdate(){this.disableTimer(),this.update()}disable(){this.disableTimer(),this.manifesto.abort()}getDebugInfo(){return{processing:this.processing}}disableTimer(){self.clearTimeout(this.timer),this.timer=0}shouldUpdate(){return!this.timer&&(!this.manifesto.isInitiallyLoaded()||this.manifesto.isDynamicPlaylist())}getUpdatePeriod(){if(!this.manifesto.isDynamicPlaylist())return;const e=this.manifesto.getUpdatePeriod(),t=this.manifesto.getLastUpdateDuration();return e?Math.max(3e3,e-t):void 0}}const kt=(0,mt.I)(()=>(0,he.jS)("web_yasp_back_watch_mse")),Pt=(0,mt.I)(()=>45+kt()),It=(0,mt.I)(()=>Pt()+10),Ct={type:"video",state:"idle",fat:!1,currentTrack:void 0,time:null,previousBufferingTime:null,nextTimeToSet:null,streamIsFinished:!1,aborted:!1};class Ot extends Ue.M{constructor(e,t,r,i){var s,n,a;super(),this.timeline=e,this.videoState=t,this.mse=r,this.destroyed=!1,this.bufferGoal=void 0,this.totalBufferSoftCap=void 0,this.totalBufferHardCap=void 0,this.streams={},this.bufferGoal=null!=(s=null==i?void 0:i.bufferGoal)?s:30,this.totalBufferSoftCap=null!=(n=null==i?void 0:i.totalBufferSoftCap)?n:Pt(),this.totalBufferHardCap=null!=(a=null==i?void 0:i.totalBufferHardCap)?a:It();const{video:o,audio:l}=e.getMimeTypes();o.length&&(this.streams.video=G({},Ct,{type:"video"})),l.length&&(this.streams.audio=G({},Ct,{type:"audio"}))}destroy(){this.destroyed=!0}run(){this.destroyed||(this.streams.video&&this.runForStream(this.streams.video),this.streams.audio&&this.runForStream(this.streams.audio))}abort(){this.destroyed||(this.streams.video&&(this.streams.video.aborted=!0),this.streams.audio&&(this.streams.audio.aborted=!0))}checkIsAborted(e){e.aborted&&(e.aborted=!1,this.throwAbortError())}throwAbortError(){throw new je.w({code:"YASP_OPERATION_ABORTED",details:{},isFatal:!1,category:He.q.EXCEPTION,message:"AppendStream operation aborted"})}resetTime(e){const t=this.streams[e];if(!t)return;const{currentTime:r}=this.videoState;"append"===t.state?t.nextTimeToSet=null===r?null:1e3*r:t.time=null===r?null:1e3*r}runForStream(e){if("open"!==this.mse.getReadyState())return;if("append"===e.state)return;const{currentTime:t,buffering:r,duration:i}=this.videoState;if(null===t)return;const s=this.mse.getSourceBuffer(e.type);if(void 0===s)return;if(r?e.previousBufferingTime!==1e3*t&&(e.time=1e3*t,e.nextTimeToSet=null,e.previousBufferingTime=e.time):e.previousBufferingTime=null,!r){if(Math.min(this.bufferGoal,i-t)<=W(s,t))return;if(this.checkGorgedBuffer(e,s))return}const{track:n,segment:a}=this.timeline.getSegment(e.type,e.time);if(void 0===n)return;const{id:o,presentationTimeOffset:l}=n;if(o!==e.currentTrack)return this.mse.setTimestampOffset(e.type,l/1e3),void this.appendInitialSegment(e,o).catch(t=>{const r=Y(t)?t:new je.w({code:"YASP_UNKNOWN_ERROR",details:{},isFatal:!1,category:He.q.MEDIA,message:"Can not append initial Segment"});if("YASP_OPERATION_ABORTED"!==r.code)this.emit("Error",r);else{const{currentTime:t}=this.videoState;e.time=null===t?null:1e3*t}});void 0!==a&&(e.nextTimeToSet=a.end,this.appendStream(e,a.getChunkStream()).then(()=>{e.time=e.nextTimeToSet,e.streamIsFinished=n.endNumber===a.number,this.timeline.getIsDynamic()||(0,Fe.z)(this.streams).every(e=>Boolean(null==e?void 0:e.streamIsFinished))&&this.mse.endOfStream()}).catch(t=>{if("YASP_OPERATION_ABORTED"!==t.code)"YASP_QUOTA_EXCEEDED_ERROR"!==t.code&&this.emit("Error",t);else{const{currentTime:t}=this.videoState;e.time=null===t?null:1e3*t}}))}checkGorgedBuffer(e,t){const r=function(e){let t=0;for(let r=0;r<e.buffered.length;r++){const i=e.buffered.start(r);t+=e.buffered.end(r)-i}return t}(t),i=e.fat;return e.fat=r>=this.totalBufferSoftCap,!!e.fat&&(i||this.emit("FatBuffer",e.type),r>=this.totalBufferHardCap&&(this.emit("GorgedBuffer",e.type),!0))}async appendInitialSegment(e,t){const r=this.timeline.getInitialSegment(e.type,t);if(void 0===r)return;const i=r.getChunkStream();await this.appendStream(e,i),e.currentTrack=t}async appendChunk(e,t){try{if(await this.mse.appendBuffer(e.type,t),this.destroyed)return}catch(r){throw Y(r)?r:new je.w({code:"YASP_UNKNOWN_ERROR",details:{},isFatal:!1,category:He.q.MEDIA,message:"Can not append buffer"})}}async appendStream(e,t){e.state="append",e.streamIsFinished=!1;try{let{value:r,done:i}=await t.read();for(;!i;){if(this.destroyed)return;if(this.checkIsAborted(e),r&&await this.appendChunk(e,r),this.destroyed)return;this.checkIsAborted(e),({value:r,done:i}=await t.read())}}catch(r){if(!(0,oe.K)(r)||"Unexpected read after destroy"!==r.message&&"Unexpected destroy while read"!==r.message)throw Y(r)?r:new je.w({code:"YASP_UNKNOWN_ERROR",details:{},isFatal:!1,category:He.q.MEDIA,message:"Can not append buffer"});this.throwAbortError()}finally{e.state="idle"}}getDebugInfo(){return{bufferGoal:this.bufferGoal,totalBufferSoftCap:this.totalBufferSoftCap,totalBufferHardCap:this.totalBufferHardCap,streams:this.streams}}}var Dt=r(5636),Nt=r(9507);const Lt=["buffer","deferred"];class Mt extends Ue.M{constructor(e,t){void 0===t&&(t=dt.Z),super(),this.mimeTypes=e,this.onUnhandledError=t,this.destroyed=!1,this.mediaSource=void 0,this.mediaSourceOpenDeferred=new Dt.B,this.sourceBufferItems={},this.sourceBufferOperationQueues={},this.objectUrl=void 0,(0,et.v)(this.mediaSourceOpenDeferred.promise),this.mediaSource=new self.MediaSource;const r=()=>{try{(0,yt.Z)(e).forEach(e=>this.createSourceBufferItem(e))}catch(t){return this.mediaSourceOpenDeferred.reject(t),void this.destroy()}this.mediaSourceOpenDeferred.resolve()};this.once("Destroy",()=>{this.destroyed=!0,this.mediaSource.removeEventListener("sourceopen",r)}),"open"===this.mediaSource.readyState?r():this.mediaSource.addEventListener("sourceopen",r,{once:!0}),this.objectUrl=self.URL.createObjectURL(this.mediaSource)||this.mediaSource.handle}async clearBuffer(e,t,r){if(!this.getSourceBuffer(e))return;if(this.destroyed)throw new Error("Can not clearBuffer because CoreMediaSourceEngine is destroyed");"open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise;const i=new Dt.B;(0,et.v)(i.promise);const s=this.getSourceBufferOperationQueue(e);for(let n=1;n<s.length;n++)"append"===s[n].type&&(s[n].deferred.reject(new Error("abort")),s.splice(n,1),n--);return s.push({type:"remove",start:t,end:r,deferred:i}),this.processSourceBufferOperationQueue(e),i.promise}async appendBuffer(e,t){if(this.destroyed)throw new Error("Can not appendBuffer because CoreMediaSourceEngine is destroyed");"open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise;const r=new Dt.B;(0,et.v)(r.promise);return this.getSourceBufferOperationQueue(e).push({type:"append",buffer:t,deferred:r}),this.processSourceBufferOperationQueue(e),r.promise}getObjectUrl(){return this.objectUrl}getReadyState(){return this.mediaSource.readyState}endOfStream(){if("open"===this.mediaSource.readyState){for(let e in this.sourceBufferItems){const{sourceBuffer:t}=this.sourceBufferItems[e];if(t.updating)return}this.mediaSource.endOfStream()}}getSourceBuffer(e){var t;return null==(t=this.sourceBufferItems[e])?void 0:t.sourceBuffer}setDuration(e){const t=()=>this.mediaSource.duration=e;"open"!==this.mediaSource.readyState?this.mediaSourceOpenDeferred.promise.then(t):t()}getDuration(){return this.mediaSource.duration}async setLiveSeekableRange(e,t){if(this.destroyed)throw new Error("Can not setLiveSeekableRange because CoreMediaSourceEngine is destroyed");if(e<0)throw new Error("Can not setLiveSeekableRange because start value is negative");if(e>t)throw new Error("Can not setLiveSeekableRange because start value is greater then end value");"open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise,this.mediaSource.setLiveSeekableRange(e,t)}async setTimestampOffset(e,t){if(this.destroyed)throw new Error("Can not setTimestampOffset because CoreMediaSourceEngine is destroyed");"open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise;const r=new Dt.B;(0,et.v)(r.promise);return t>0&&(t-=.001),this.getSourceBufferOperationQueue(e).push({type:"setTimestampOffset",timestampOffset:-t,deferred:r}),this.processSourceBufferOperationQueue(e),r.promise}destroy(){if(!this.destroyed){super.destroy(),this.mediaSourceOpenDeferred.reject(new Error("Can not appendBuffer because CoreMediaSourceEngine is destroyed"));try{this.mediaSource.endOfStream()}catch(e){}(0,Fe.z)(this.sourceBufferItems).forEach(e=>{if(!e)return;const{sourceBuffer:t}=e;try{this.mediaSource.removeSourceBuffer(t)}catch(r){}}),(0,Fe.z)(this.sourceBufferOperationQueues).forEach(e=>{e&&(e.forEach(e=>{let{deferred:t}=e;return t.reject(new Error("Can not appendBuffer because CoreMediaSourceEngine is destroyed"))}),e.length=0)}),"string"===typeof this.objectUrl&&self.URL.revokeObjectURL(this.objectUrl)}}getSourceBufferOperationQueue(e){var t;const r=null!=(t=this.sourceBufferOperationQueues[e])?t:[];return this.sourceBufferOperationQueues[e]=r,r}processSourceBufferOperationQueue(e){if(this.destroyed)return;const t=this.sourceBufferItems[e];if(!t)return;const{sourceBuffer:r,onUpdateEnd:i}=t;if(r.updating)return void i(()=>this.processSourceBufferOperationQueue(e));const s=this.getSourceBufferOperationQueue(e);if(!s.length)return;const n=s.shift();i(()=>n.deferred.resolve());let a=!1;try{switch(n.type){case"append":r.appendBuffer(n.buffer);break;case"remove":r.remove(n.start,n.end);break;case"setTimestampOffset":r.timestampOffset!==n.timestampOffset?(r.timestampOffset=n.timestampOffset,n.deferred.resolve()):a=!0}}catch(o){const t=(0,Tt.V)(o)?o:new Error("CoreMediaSourceEngine: "+n.type+" error");if("append"===n.type){const r=new je.w({code:"YASP_QUOTA_EXCEEDED_ERROR",details:{type:e,rawErrorName:t.name},isFatal:!1,category:He.q.MEDIA,message:t.message});throw this.sourceBufferOperationQueues[e]=s.filter(e=>{let{type:t}=e;return"append"!==t}),n.deferred.reject(r),s.forEach(e=>{let{type:t,deferred:i}=e;return"append"===t&&i.reject(r)}),r}throw t}a&&this.processSourceBufferOperationQueue(e)}createSourceBufferItem(e){if(this.sourceBufferItems[e])return;const t=this.mimeTypes[e];if(!t)throw new je.w({code:"YASP_EMPTY_MIME",details:{},isFatal:!0,category:He.q.MEDIA});let r;try{r=this.mediaSource.addSourceBuffer(t)}catch(s){throw new je.w({code:"YASP_CANNOT_CREATE_SOURCE_BUFFER",details:{reason:s.name,mimeType:t},isFatal:!0,category:He.q.MEDIA})}let i=[];r.addEventListener("updateend",()=>{const e=i;i=[],e.forEach(e=>{try{e()}catch(s){this.onUnhandledError(new je.w({code:"YASP_MSE_UNKNOWN_ERROR",isFatal:!1,category:He.q.EXCEPTION,message:s.message,stack:s.stack,details:{error:s}}))}})}),r.addEventListener("error",()=>{const t=this.getSourceBufferOperationQueue(e)[0];this.onUnhandledError(new je.w({code:"YASP_MSE_FAILED_TO_EXECUTE_PROCEDURE",message:"Failed execute "+t.type,details:{operation:t.type},isFatal:!1,category:He.q.EXCEPTION}))}),this.sourceBufferItems[e]={sourceBuffer:r,onUpdateEnd:e=>{i.push(e)}}}getDebugInfo(){var e,t,r,i;return{sourceBufferOperationQueues:K(this.sourceBufferOperationQueues,e=>{var t;return null!=(t=null==e?void 0:e.map(e=>function(e,t){if(null==e)return{};var r,i,s={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,Lt)))?t:null}),readyState:this.getReadyState(),audio:null!=(e=this.sourceBufferItems)&&e.audio?(0,Nt.e)(null==(t=this.sourceBufferItems)?void 0:t.audio.sourceBuffer):null,video:null!=(r=this.sourceBufferItems)&&r.video?(0,Nt.e)(null==(i=this.sourceBufferItems)?void 0:i.video.sourceBuffer):null}}}var xt=r(4849);class Vt extends Ue.M{constructor(e){let{start:t,end:r,number:i,expectedSize:s,isInitSegment:n}=e;super(),this.chunks=[],this.start=0,this.end=0,this.duration=0,this.finishedSegment=!1,this.failedSegment=!1,this.number=void 0,this.isInitSegment=void 0,this.expectedSize=void 0,this.getLoadingDuration=null,this.loadedRawSize=0,this.chunkStream=null,this.start=t,this.end=r,this.duration=Math.max(r-t,0),this.number=i,this.expectedSize=s,this.isInitSegment=n,this.loadedRawSize=0}loadingStarted(){this.getLoadingDuration=function(e){void 0===e&&(e=xt.no);const t=e();return()=>Math.max(0,e()-t)}()}get finished(){return this.finishedSegment}get failed(){return this.failedSegment}append(e){var t;this.chunks.push(e),null==(t=this.chunkStream)||t.write(e)}finish(){var e;this.finishedSegment=!0,null==(e=this.chunkStream)||e.close(),this.chunkStream=null,this.emit("Finish")}fail(){this.failedSegment=!0,this.emit("Failed"),this.chunkStream&&this.chunkStream.destroy()}getExpectedTimeToLoad(){if(null===this.getLoadingDuration)return this.duration;const e=this.getLoadingDuration();return 0===this.loadedRawSize?this.duration:e*(Math.max(this.expectedSize,this.loadedRawSize)/this.loadedRawSize)-e}getChunkStream(){this.chunkStream||(this.chunkStream=new $e);const e=this.chunkStream;if(this.finished)if(this.chunks.length>0){const[t]=this.chunks,r="string"===typeof t?this.chunks.join(""):this.chunks.reduce((e,t)=>We.P.concat(e,t));e.write(r),e.close(),this.chunkStream=null}else t=new Error("Finished empty segment: "+this.number),setTimeout(()=>{throw t},0),e.close(),this.chunkStream=null;else this.chunks.forEach(t=>null==e?void 0:e.write(t));var t;return e.asReadable()}getChunks(){return this.chunks}getDebugInfo(){return{chunksCount:this.chunks.length,chunksSize:this.chunks.reduce((e,t)=>e+t.length,0),start:this.start,end:this.end,duration:this.duration,finishedSegment:this.finishedSegment,number:this.number,expectedSize:this.expectedSize,loadingDuration:this.getLoadingDuration?this.getLoadingDuration():null,hasChunkStream:null!==this.chunkStream}}}var Ft=r(4188),Ut=r(7187),Bt=r(7919),Ht=r(5690),jt=r(4886);const Yt=[429,500,502,503,504],Wt={start:Math.abs(0),end:Math.abs(0),number:Math.max(Math.floor(0)),duration:Math.abs(0),expectedSize:0,isInitSegment:!1},Gt=(0,mt.I)(()=>(0,he.r0)("web_yasp_timeout_buffer"));class Kt extends Ue.M{constructor(e){let{timeline:t,videoState:r,manifesto:i,abr:s,segmentFetcher:n,bufferGoal:a,bandwidthEstimator:o,ttfbEstimator:l}=e;super(),this.segmentFetcher=void 0,this.abr=void 0,this.timeline=void 0,this.videoState=void 0,this.manifesto=void 0,this.bandwidthEstimator=void 0,this.ttfbEstimator=void 0,this.bufferGoal=void 0,this.hostnameBlackList=new Ft.S,this.trackToFetchFailuresCount=new Map,this.locked=!1,this.lastNonBlockedBaseUrls=[],this.isDestroyed=!1,this.segmentsInProgress={video:[],audio:[],text:[]},this.timeline=t,this.videoState=r,this.manifesto=i,this.abr=s,this.segmentFetcher=n,this.bandwidthEstimator=o,this.ttfbEstimator=l,this.bufferGoal=1e3*a}abortUseless(){["video","audio","text"].forEach(e=>this.abortUselessForType(e))}abortUselessForType(e){const{currentTime:t}=this.videoState;if((0,he.RW)("web_yasp_clear_useless_on_seek")&&null!==t){const r=1e3*t;this.segmentsInProgress[e].forEach(e=>{let{abort:t,segment:i}=e;i.start<=r&&r<i.end||t()})}else this.segmentsInProgress[e].forEach(e=>e.abort()),this.segmentsInProgress[e]=[]}run(){if(this.locked&&!(0,he.RW)("web_yasp_parallel_downloads"))return;const e=[];try{this.runInternal(e)}finally{this.locked=!0,Promise.all(e.map(e=>e.catch(dt.Z))).then(()=>{this.locked=!1,e.length>0&&this.emit("BandwidthEstimateUpdate",this.bandwidthEstimator.getBandwidthEstimate())})}}setVideoState(e){this.videoState=e}setBufferGoal(e){this.bufferGoal=1e3*e}canStartDownload(){if(!(0,he.RW)("web_yasp_parallel_downloads"))return!0;const{audio:e,video:t,text:r}=this.segmentsInProgress,i=this.ttfbEstimator.getTtfbEstimate({value:0,source:"default"}),s=e.concat(t,r),n=(0,he.jS)("web_yasp_expected_time_to_load_multiplier");return s.every(e=>{let{segment:t}=e;return t.getExpectedTimeToLoad()*n<=i.value})}runInternal(e){const{currentTime:t,duration:r,buffering:i}=this.videoState;if(null===t)return;if(!this.canStartDownload())return;if(!i&&r<t+.1)return;const s=1e3*t,n=this.timeline.getBufferedRanges(),a=n.video,o=n.audio,l=n.text,d=this.defineTracksMeta(a,s,"video"),c=this.defineTracksMeta(o,s,"audio"),u=this.defineTracksMeta(l,s,"text");if(!d.length&&!c.length&&!u.length)return;const h=Kt.syncSelectedSegments(this.abr.filterSegments(c,d,u,this.videoState)),p=this.getBaseUrl();p?(0,vt.J)(h).forEach(t=>{let[r,i]=t;if(!i)return;const a=i.trackId,o=this.timeline.findTrackById(a,r);if(!o)return;let l=0;if(Number.isFinite(this.videoState.currentTime)){const e=X(n[r],s,this.videoState.duration);-1!==e&&(l=(0,Bt.R)((e-s)/1e3,3))}if(!o.getInitSegment()&&o.initialization){const t=o.initialization,i={baseUrl:p,pathname:q(t,o)},{segment:s,promise:n}=this.fetchSegment(i,a,r,z({},Wt,{isInitSegment:!0}),l);(0,he.RW)("web_yasp_parallel_downloads")&&o.appendInitSegment(s),e.push(n.then(()=>{(0,he.RW)("web_yasp_parallel_downloads")||o.appendInitSegment(s)}).catch(e=>{this.emit("Error",Y(e)?e:new je.w({code:"YASP_UNKNOWN_ERROR",details:{error:e,blacklist:this.hostnameBlackList.getBlacklist()},isFatal:!0,category:He.q.NETWORK_MEDIA}))}))}const d=o.media;if(!d)return;if(o.hasSegment(i.number))return;const c={baseUrl:p,pathname:q(d,o,i)},u={start:i.start,end:i.end,number:i.number,isInitSegment:!1,expectedSize:i.bitrate*(i.duration/1e3)/8,duration:i.duration},{segment:h,promise:f}=this.fetchSegment(c,a,r,u,l);o.appendSegment(h),e.push(f.catch(e=>{h.fail();const t=Y(e)?e:new je.w({code:"YASP_UNKNOWN_ERROR",details:{error:e,blacklist:this.hostnameBlackList.getBlacklist()},isFatal:!0,category:He.q.NETWORK_MEDIA});"YASP_OPERATION_ABORTED"!==t.code&&this.emit("Error",t)}))}):this.emit("Error",new je.w({code:"YASP_NO_BASEURLS",details:{},isFatal:!0,category:He.q.MEDIA}))}fetchSegment(e,t,r,i,s){void 0===i&&(i=Wt);const n=new Vt(i);this.handleInProgressSegment(r,n);const a=new Promise((a,o)=>{const l=t+"/"+i.number,d=this.trackToFetchFailuresCount.get(l)||0,c=new URL(e.pathname,e.baseUrl);s>=0&&(0,he.RW)("web_yasp_cmaf")&&c.searchParams.append("bufSize",String(s));let u;(0,jt._)(V(d)).then(()=>{if(this.isDestroyed)return;let t=0;"buffer"===Gt()?t=1e3*s:"buffer_subtract_segment"===Gt()?t=1e3*(s-5):"ttfb"===Gt()&&(t=Et.C+this.ttfbEstimator.getTtfbEstimate({value:1e3,source:"default"}).value);const i=(0,St.c)(c.toString()),h=this.hostnameBlackList.getBlacklist();this.segmentFetcher.fetchChunkStream(i,t,n,r).then(t=>{let{chunkStream:s,status:c,requestState:p,abort:f}=t;if(u=p,c>=200&&c<300||304===c){this.handleInProgressSegment(r,n,f),s.on("Data",e=>{n.append(e)}),s.on("Close",()=>{n.finish(),a()});const e=()=>{if(this.handleInProgressSegment(r,n),null!=p&&p.canceled)return n.fail(),a();if(!n.finished){const e=null!=p&&p.timeout?"YASP_FETCH_SEGMENT_TIMEOUT":"YASP_FETCH_SEGMENT_HTTP_ERROR",t=null!=p&&p.timeout?"Request timed out":"Network Error";o(new je.w({code:e,details:{url:i,blacklist:{before:h,after:this.hostnameBlackList.getBlacklist()},downloadedBytes:null!=p&&p.timeout?p.downloadedBytes:void 0},message:t,category:He.q.NETWORK_MEDIA,isFatal:!1}))}};return s.on("Destroy",e),s.resume(),this.trackToFetchFailuresCount.has(l)&&this.trackToFetchFailuresCount.delete(l),void(s.isDestroyed()&&e())}if(this.trackToFetchFailuresCount.set(l,d+1),Yt.includes(c))o(new je.w({code:"YASP_FETCH_SEGMENT_BAD_HTTP_STATUS",message:"Error: "+c,details:{url:i,status:c,blacklist:{before:h,after:this.hostnameBlackList.getBlacklist()}},category:He.q.NETWORK_MEDIA,isFatal:!1}));else{this.hostnameBlackList.addHostname(new URL(e.baseUrl).host);const t=d>=10;o(0===c?new je.w({code:"YASP_FETCH_SEGMENT_HTTP_ERROR",message:"Network Error",details:{url:i,blacklist:{before:h,after:this.hostnameBlackList.getBlacklist()}},category:He.q.NETWORK_MEDIA,isFatal:t}):new je.w({code:"YASP_FETCH_SEGMENT_BAD_HTTP_STATUS",message:"Error: "+c,details:{url:i,status:c,blacklist:{before:h,after:this.hostnameBlackList.getBlacklist()}},category:He.q.NETWORK_MEDIA,isFatal:t}))}}).catch(t=>{var r,s;if(null!=(r=u)&&r.canceled)return o(new je.w({code:"YASP_OPERATION_ABORTED",details:{url:i,blacklist:{before:h,after:this.hostnameBlackList.getBlacklist()}},message:t.message,category:He.q.NETWORK_MEDIA,isFatal:!1}));this.hostnameBlackList.addHostname(new URL(e.baseUrl).host),this.trackToFetchFailuresCount.set(l,d+1);const n="Request timed out"===t.message,a=!n&&d>=10;o(new je.w({code:n?"YASP_FETCH_SEGMENT_TIMEOUT":"YASP_FETCH_SEGMENT_HTTP_ERROR",details:{url:i,blacklist:{before:h,after:this.hostnameBlackList.getBlacklist()},downloadedBytes:n?(null==(s=u)?void 0:s.downloadedBytes)||0:void 0},message:t.message,category:He.q.NETWORK_MEDIA,isFatal:a}))})})});return{segment:n,promise:a}}handleInProgressSegment(e,t,r){if(void 0===r&&(r=dt.Z),t.isInitSegment||t.finished||t.failed)return;const i=this.segmentsInProgress[e].find(e=>e.segment.number===t.number)||(()=>{const i={abort:r,segment:t};this.segmentsInProgress[e].push(i);const s=()=>{this.segmentsInProgress[e]=this.segmentsInProgress[e].filter(e=>e!==i),t.off("Failed",s),t.off("Finish",s)};return t.once("Failed",s),t.once("Finish",s),i})();i.abort===dt.Z&&(i.abort=r)}defineTracksMeta(e,t,r){const{duration:i}=this.videoState,s=X(e,t,i);if(-1===s)return[];return s-t>this.bufferGoal?[]:this.timeline.getTracksMeta(s,r)}getDebugInfo(){return{bufferGoal:this.bufferGoal,hostnameBlackList:this.hostnameBlackList.getBlacklist(),trackToFetchFailuresCount:Array.from(this.trackToFetchFailuresCount.entries()).reduce((e,t)=>(e[t[0]]=e[t[1]],e),{}),segmentsInProgress:this.segmentsInProgress,locked:this.locked}}static syncSelectedSegments(e){return e.audio&&e.video?e.video.end<=e.audio.start?z({},e,{audio:void 0}):e.audio.end<=e.video.start?z({},e,{video:void 0}):e:e}getBaseUrl(){var e;const t=this.manifesto.getBaseUrls().filter(e=>!this.hostnameBlackList.isBlacklisted(new URL(e).host));return(0,Ht.X)(t,(e,t)=>{const r=this.lastNonBlockedBaseUrls.indexOf(e),i=this.lastNonBlockedBaseUrls.indexOf(t);return-1!==r&&-1!==i?r-i:-1!==r&&-1===i?-1:-1===r&&-1!==i?1:0}),this.lastNonBlockedBaseUrls=t,null!=(e=t[0])?e:this.manifesto.getBaseUrls()[0]}destroy(){this.isDestroyed=!0,super.destroy()}}class qt{constructor(e,t,r,i){this.timeline=e,this.videoState=t,this.backWatch=r,this.bufferGoal=i}setVideoState(e){this.videoState=e}run(){if(null===this.videoState.currentTime)return;const{currentTime:e}=this.videoState,{start:t,end:r}=this.timeline.getSeekableRange();this.timeline.clear(t,1e3*(e-this.backWatch)),this.timeline.clear(1e3*(e+this.bufferGoal),r)}getDebugInfo(){return{backWatch:this.backWatch,bufferGoal:this.bufferGoal}}}let zt,Xt;!function(e){e[e.BIG_ENDIAN=0]="BIG_ENDIAN",e[e.LITTLE_ENDIAN=1]="LITTLE_ENDIAN"}(zt||(zt={}));class Qt{constructor(e,t){this.dataView=e,this.littleEndian=void 0,this.position=0,this.littleEndian=t===zt.LITTLE_ENDIAN}getDataView(){return this.dataView}hasMoreData(){return this.position<this.dataView.byteLength}getPosition(){return this.position}getLength(){return this.dataView.byteLength}readUint8(){try{let e=this.dataView.getUint8(this.position);return this.position+=1,e}catch(e){throw this.throwOutOfBounds()}}readUint16(){try{let e=this.dataView.getUint16(this.position,this.littleEndian);return this.position+=2,e}catch(e){throw this.throwOutOfBounds()}}readUint32(){try{let e=this.dataView.getUint32(this.position,this.littleEndian);return this.position+=4,e}catch(e){throw this.throwOutOfBounds()}}readInt32(){try{let e=this.dataView.getInt32(this.position,this.littleEndian);return this.position+=4,e}catch(e){throw this.throwOutOfBounds()}}readUint64(){let e,t;try{this.littleEndian?(e=this.dataView.getUint32(this.position,!0),t=this.dataView.getUint32(this.position+4,!0)):(t=this.dataView.getUint32(this.position,!1),e=this.dataView.getUint32(this.position+4,!1))}catch(r){throw this.throwOutOfBounds()}if(t>2097151)throw new Error("JS_INTEGER_OVERFLOW");return this.position+=8,t*Math.pow(2,32)+e}readBytes(e){this.position+e>this.dataView.byteLength&&this.throwOutOfBounds();let t=new Uint8Array(this.dataView.buffer,this.dataView.byteOffset+this.position,e);return this.position+=e,t}skip(e){if(this.position+e>this.dataView.byteLength)throw this.throwOutOfBounds();this.position+=e}rewind(e){if(this.position<e)throw this.throwOutOfBounds();this.position-=e}seek(e){if(e<0||e>this.dataView.byteLength)throw this.throwOutOfBounds();this.position=e}readTerminatedString(){let e=this.position;for(;this.hasMoreData();){if(0===this.dataView.getUint8(this.position))break;this.position+=1}let t=new Uint8Array(this.dataView.buffer,this.dataView.byteOffset+e,this.position-e);return this.position+=1,Oe.x.fromUTF8(t)}throwOutOfBounds(){return new Error("BUFFER_READ_OUT_OF_BOUNDS")}readUUID(){const e=this.readBytes(16);return(Qt.byteToHex[e[0]]+Qt.byteToHex[e[1]]+Qt.byteToHex[e[2]]+Qt.byteToHex[e[3]]+"-"+Qt.byteToHex[e[4]]+Qt.byteToHex[e[5]]+"-"+Qt.byteToHex[e[6]]+Qt.byteToHex[e[7]]+"-"+Qt.byteToHex[e[8]]+Qt.byteToHex[e[9]]+"-"+Qt.byteToHex[e[10]]+Qt.byteToHex[e[11]]+Qt.byteToHex[e[12]]+Qt.byteToHex[e[13]]+Qt.byteToHex[e[14]]+Qt.byteToHex[e[15]]).toLowerCase()}}Qt.byteToHex=Array.from({length:256},(e,t)=>(t+256).toString(16).substr(1)),function(e){e[e.BASIC_BOX=0]="BASIC_BOX",e[e.FULL_BOX=1]="FULL_BOX"}(Xt||(Xt={}));class Zt{constructor(){this.headers=[],this.boxDefinitions=[],this.done=!1}box(e,t){let r=Zt.typeFromString(e);return this.headers[r]=Xt.BASIC_BOX,this.boxDefinitions[r]=t,this}fullBox(e,t){let r=Zt.typeFromString(e);return this.headers[r]=Xt.FULL_BOX,this.boxDefinitions[r]=t,this}stop(){this.done=!0}parse(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);let i=new Uint8Array(e),s=new Qt(new DataView(i.buffer,i.byteOffset,i.byteLength),zt.BIG_ENDIAN);for(this.done=!1;s.hasMoreData()&&!this.done;)this.parseNext(0,s,t,r)}parseNext(e,t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);let s=t.getPosition();if(i&&s+8>t.getLength())return void(this.done=!0);let n=t.readUint32(),a=t.readUint32();switch(n){case 0:n=t.getLength()-s;break;case 1:if(i&&t.getPosition()+8>t.getLength())return void(this.done=!0);n=t.readUint64()}let o=this.boxDefinitions[a];if(o){let l=null,d=null;if(this.headers[a]===Xt.FULL_BOX){let e=t.readUint32();l=e>>>24,d=16777215&e}let c=s+n,u=!0;if(r&&c>t.getLength()&&(c=t.getLength(),u=!1),i&&c>t.getLength())return void(this.done=!0);let h=c-t.getPosition(),p=h>0?t.readBytes(h):new Uint8Array(0);o({parser:this,partialOkay:r||!1,version:l,flags:d,reader:new Qt(new DataView(p.buffer,p.byteOffset,p.byteLength),zt.BIG_ENDIAN),size:n,loadedSize:t.getPosition()-s,start:s+e,isComplete:u})}else{const e=Math.min(s+n-t.getPosition(),t.getLength()-t.getPosition());t.skip(e)}}children(e){const t=null!==e.flags?12:8;for(;e.reader.hasMoreData()&&!e.parser.done;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)}sampleDescription(e){const t=null!==e.flags?12:8;for(let r=e.reader.readUint32();r>0&&!e.parser.done;r-=1)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)}allData(e){return function(t){const r=t.reader.getLength()-t.reader.getPosition();e(t.reader.readBytes(r))}}static typeFromString(e){let t=0;for(let r=0;r<e.length;r++)t=t<<8|e.charCodeAt(r);return t}static typeToString(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}}class Jt extends Ue.M{constructor(e){super(),this.fetcher=void 0,this.emsgSchemeIdUris={audio:new Set,video:new Set},this.fetcher=e}async fetchChunkStream(e,t,r,i){void 0===t&&(t=0);const{response:s,requestState:n,abort:a}=this.fetcher.fetchDataStream(e,{timeout:Math.max(Et.C,t)}),o=(0,ft.u)(),l=await s,d=new $e,[c]=(l.headers["content-type"]||"").split(";");if((0,he.RW)("web_yasp_parallel_downloads")){const e=parseInt(l.headers["content-length"]||"",10);r.expectedSize=e,r.loadingStarted()}switch(c.trim()){case"text/vtt":this.processVtt(l.body,d);break;case"audio/mp4":case"video/mp4":this.processMp4(l.body,d,o,r,i);break;default:switch((e=>{const t=(new URL(e).pathname.split("/").pop()||"").split(".");return t.length>1?t.pop():void 0})(e.toLocaleLowerCase())){case"vtt":this.processVtt(l.body,d);break;case"m4s":case"mp4":default:this.processMp4(l.body,d,o,r,i)}}return{status:l.status,chunkStream:d.asReadable(),requestState:n,abort:a}}processMp4(e,t,r,i,s){let n,a,o,l,d=new Uint8Array(0),c=0,u=0,h=!0,p=!0,f=0;const m=()=>{h||0===c||(this.fetcher.progress(c,u,!0),c=0,u=0)};let g=r,v=0,y=0;const E=e=>{if(h)if(v+=e.length,this.fetcher.isLL()){const e=g();(e>=100||v>=16e3)&&(this.fetcher.progress(e,v),g=(0,ft.u)(),v=0)}else if(v>0){const e=g();this.fetcher.progress(e,v),g=(0,ft.u)(),v=0}},S=(e,t)=>{d=We.P.concat(d,e);let r=!1,g=0;const v=e=>{g=e.size+e.start,r=!0,y++};if((new Zt).box("uuid",e=>{if(!e.isComplete)return;g=e.size+e.start,r=!0;const t=e.reader.readUUID(),i=e.reader.readUint64();if("c4eac1fc-0ad8-4676-9656-69552eb3252f"===t&&h)n=i,a=Date.now(),o=a,h=!1;else if("bcfca253-398b-4a5b-9a92-ec8f7d89e61d"===t){l=i-n,n=i}}).box("moov",e=>{e.isComplete&&(g=e.size+e.start,r=!0)}).box("moof",e=>{e.isComplete&&(u+=e.size)}).box("mdat",e=>{if(h){if(!e.isComplete)return;v(e)}else{if(p){p=!1,f=e.loadedSize;const t=Date.now(),r=t-o;o=t,r>=l?(c+=r-l,u+=e.loadedSize):l<50&&(c+=r,u+=e.loadedSize)}else{const t=Date.now()-a;c+=t;const r=e.loadedSize-f;f=e.loadedSize,u+=r}a=Date.now(),e.isComplete&&(p=!0,v(e))}}).fullBox("emsg",e=>{e.isComplete&&(this.parseEMSG(e,i,s),g=e.size+e.start,r=!0)}).parse(d,!0,!0),E(e),m(),!r)return;const S=d.subarray(0,g);d=d.subarray(g),t(S)};e.on("Data",e=>{(0,he.RW)("web_yasp_parallel_downloads")&&(i.loadedRawSize+=e.byteLength),S(e,e=>t.write(e))}),e.on("Close",()=>{t.close(),this.emitSegmentLoaded(s,i,y)}),e.on("Destroy",()=>{t.destroy()}),e.resume()}emitSegmentLoaded(e,t,r){"text"===e||t.isInitSegment||this.emit("SegmentLoaded",{type:e,cmaf:r>1,number:t.number})}processVtt(e,t){let r=new Uint8Array(0);e.on("Data",e=>{r=We.P.concat(r,e)}),e.on("Close",()=>{t.write(r),t.close()}),e.on("Destroy",()=>{t.destroy()}),e.resume()}setEmsgSchemeIdUris(e){this.emsgSchemeIdUris=null!=e?e:this.emsgSchemeIdUris}parseEMSG(e,t,r){if("text"===r)return;const i=t.start/1e3,s=e.reader.readTerminatedString(),n=e.reader.readTerminatedString(),a=e.reader.readUint32(),o=e.reader.readUint32(),l=e.reader.readUint32(),d=e.reader.readUint32(),c=e.reader.readBytes(e.reader.getLength()-e.reader.getPosition()),u=i+o/a,h=u+l/a,p=t.duration/1e3;if(this.emsgSchemeIdUris[r].has(s))if("urn:mpeg:dash:event:2012"===s)this.emit("ManifestUpdateRequired");else{const e={startTime:u,endTime:h,schemeIdUri:s,value:n,timescale:a,presentationTimeDelta:o,eventDuration:l,id:d,segmentDuration:p,messageData:c};this.emit("EmsgDetected",e)}}}class $t{constructor(e,t,r,i){this.mse=e,this.videoState=t,this.backWatch=r,this.bufferGoal=i,this.locked=!1}run(){this.locked||(this.locked=!0,this.runInternal().catch(dt.Z).then(()=>{this.locked=!1}))}async runInternal(){if("open"!==this.mse.getReadyState())return;const{currentTime:e}=this.videoState;if(null===e)return;const t=[this.clear(e+this.bufferGoal,this.videoState.duration)];return e>this.backWatch&&t.push(this.clear(0,e-this.backWatch)),Promise.all(t)}forceRun(e){return this.clear(0,this.videoState.duration,e)}clear(e,t,r){return e>=t?Promise.all([Promise.resolve()]):r?Promise.all([this.mse.clearBuffer(r,e,t)]):Promise.all([this.mse.clearBuffer("video",e,t),this.mse.clearBuffer("audio",e,t)])}getDebugInfo(){return{locked:this.locked}}}const er=(0,mt.I)(()=>(0,he.jS)("web_yasp_back_watch"));var tr=r(4834);class rr extends Ue.M{constructor(){super(),this.accumulatedSize=0,this.timer=null,this.parallelRequests=0,this.bandwidthInfoBatch=[],this.handleProgress=e=>{this.accumulatedSize=this.accumulatedSize+e.size},this.handleResponseStart=()=>{if(this.parallelRequests++,!this.timer){let e=(0,ft.u)();this.timer=setInterval(()=>{if(0===this.parallelRequests&&0===this.accumulatedSize)return clearInterval(this.timer),void(this.timer=null);const{accumulatedSize:t}=this;this.accumulatedSize=0;const r=e();e=(0,ft.u)(),this.emit("Progress",{time:r,size:t})},100)}},this.handleResponseEnd=()=>{this.parallelRequests=Math.max(this.parallelRequests-1,0)},(0,he.RW)("web_yasp_enable_network_traces")&&this.on("Progress",e=>{this.bandwidthInfoBatch.push(Z({},e,{clientTimestamp:(0,xt.no)()})),this.bandwidthInfoBatch.length>=30&&(this.emit("NetworkTrace",this.bandwidthInfoBatch),this.bandwidthInfoBatch=[])})}appendFetcher(e){e.on("Progress",this.handleProgress),e.on("ResponseStart",this.handleResponseStart),e.on("ResponseEnd",this.handleResponseEnd)}removeFetcher(e){e.off("Progress",this.handleProgress),e.off("ResponseStart",this.handleResponseStart),e.off("ResponseEnd",this.handleResponseEnd)}isLL(){return!1}}class ir{constructor(){this.trace=void 0,this.trace=[]}getTrace(){return this.trace}addDecision(e,t,r){const i=[];for(const a of t){var s,n;const e=null==(s=a.audio)?void 0:s.trackId,t=null==(n=a.video)?void 0:n.trackId;i.push({audio:e,video:t})}return r?this.trace.push({name:e,result:i,input:r}):this.trace.push({name:e,result:i}),this.trace}}var sr=r(8578),nr=r(2522);class ar extends Ue.M{constructor(e){let{rules:t=[]}=e;super(),this.rules=void 0,this.videoSizes=void 0,this.abrDecisionsHashCode={video:"",audio:""},this.rules=t}setVideoElementSizes(e){this.videoSizes=e}filterSegments(e,t,r,i){let s;const n=function(e,t,r){const i=(null==e?void 0:e.length)>0?e:[void 0],s=(null==t?void 0:t.length)>0?t:[void 0],n=(null==r?void 0:r.length)>0?r[0].bitrate:0,a=[];return i.forEach(e=>{s.forEach((t,r)=>{(0,sr.E)({width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0})>nr.v&&r>0||a.push({video:e,audio:t,bandwidth:((null==e?void 0:e.bitrate)||0)+(((null==t?void 0:t.bitrate)||0)+n)})})}),a}(t,e,r),a=function(e,t){const r={};for(const i of e)r[i.trackId]||(r[i.trackId]={type:"audio",bitrate:i.bitrate});for(const i of t)r[i.trackId]||(r[i.trackId]={type:"video",bitrate:i.bitrate,height:i.height,width:i.width});return r}(e,t),o=new ir,l=this.rules.reduce((e,t)=>{const r=t.filter(e,i,this.videoSizes);if(t.isCappingRule()){var a,l,d,c;const e=t.filter(n,i,this.videoSizes),r=e[e.length-1];s?null!=(a=s.video)&&a.height&&null!=(l=r.video)&&l.height&&(null==(d=s.video)?void 0:d.height)>(null==(c=r.video)?void 0:c.height)&&(s=r):s=r}let u;return"function"===typeof t.getInputData&&(u=t.getInputData()),o.addDecision(t.name,r,u),r},n.reverse())[0]||n[n.length-1],d={tracks:a,trace:o.getTrace()},c=J(d,"audio"),u={video:J(d,"video")||this.abrDecisionsHashCode.video,audio:c||this.abrDecisionsHashCode.audio};return this.abrDecisionsHashCode.audio===u.audio&&this.abrDecisionsHashCode.video===u.video||(this.emit("AbrDecisionChange",d),this.abrDecisionsHashCode=u),s&&this.emit("MaxCapAllowedVideoTrackUpdate",s),{audio:l.audio,video:l.video,text:null==r?void 0:r[0]}}getDebugInfo(){return{rules:this.rules.map(e=>e.getDebugInfo())}}}var or=r(8441);const lr=(0,mt.I)(()=>(0,he.jS)("web_yasp_fast_ewma_half_life")),dr=(0,mt.I)(()=>(0,he.jS)("web_yasp_slow_ewma_half_life")),cr=(0,mt.I)(()=>!!(0,he.RW)("web_yasp_override_ewma_half_life")&&(lr()>0&&dr()>0));class ur extends or.I{constructor(e){super(),this.fetchers=[],this.defaultEstimate={value:NaN,source:"default"},this.handleFetcherProgress=e=>{let{time:t,size:r,isLowLatency:i=!1}=e;return this.fetchers.some(e=>e.isLL())?this.sample(t,r,i):this.sample(t,r,!1,2e3)},this.destroy=()=>{this.fetchers.forEach(e=>{e.off("Progress",this.handleFetcherProgress)}),this.fetchers.length=0},e&&(this.defaultEstimate.value=e)}getBandwidthEstimate(){return super.getBandwidthEstimate(this.defaultEstimate)}setHalfLife(e){return super.setHalfLife(cr()?{fast:lr(),slow:dr()}:e)}appendFetcher(e){e.on("Progress",this.handleFetcherProgress),this.fetchers.push(e)}removeFetcher(e){e.off("Progress",this.handleFetcherProgress);for(let t=0;t<this.fetchers.length;t++)this.fetchers[t]===e&&(this.fetchers.splice(t,1),t--)}setDefaultEstimate(e){this.defaultEstimate=e}getDebugInfo(){return{fetchersCount:this.fetchers.length,defaultEstimate:this.defaultEstimate,estimate:this.getBandwidthEstimate().value,source:this.getBandwidthEstimate().source}}}class hr{constructor(){this.history=[],this.handleTtfb=e=>{isFinite(e)&&this.sample(e)}}appendFetcher(e){e.on("RequestTtfb",this.handleTtfb)}removeFetcher(e){e.off("RequestTtfb",this.handleTtfb)}sample(e){this.history.unshift(e),this.history.length=Math.min(this.history.length,20)}getTtfbEstimate(e){return this.hasGoodEstimate()?(0,he.RW)("web_yasp_min_ttfb")?{value:Math.min(...this.history),source:"min"}:{value:this.getCurrentEstimate(),source:"max"}:e}hasGoodEstimate(){return this.history.length>(0,he.jS)("web_yasp_ttfb_min_sample_count")}getCurrentEstimate(){return Math.max(...this.history)}getDebugInfo(){return{hasGood:this.hasGoodEstimate(),value:this.getCurrentEstimate(),history:[...this.history]}}}var pr=r(4508);class fr{constructor(e){this.bandwidthEstimator=e,this.name="BandwidthRule",this.inputData={bandwidth:0,playbackRate:0}}filter(e,t){if(e.length<=1)return e;const{value:r}=this.bandwidthEstimator.getBandwidthEstimate();return this.inputData.bandwidth=r,this.inputData.playbackRate=t.playbackRate,(0,pr.S)(e,r,t.playbackRate)}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!1}}class mr{constructor(e,t){this.bandwidthEstimator=e,this.ttfbEstimator=t,this.name="NetworkParamsRule",this.inputData={bandwidth:0,ttfb:0,playbackRate:0,bufferSize:0}}filter(e,t){var r;if(e.length<=1)return e;const{value:i}=this.bandwidthEstimator.getBandwidthEstimate(),s=null==(r=this.ttfbEstimator)?void 0:r.getTtfbEstimate({value:1e3,source:"default"}).value,n=null===t.currentTime?0:W(t,t.currentTime);this.inputData.bandwidth=i,this.inputData.ttfb=s,this.inputData.playbackRate=t.playbackRate,this.inputData.bufferSize=n;if(!(7.5>=n))return e;const a=Math.max(t.playbackRate,1),o=e.filter(e=>{var t,r,s,n;const o=Math.max(null!=(t=null==(r=e.video)?void 0:r.duration)?t:0,null!=(s=null==(n=e.audio)?void 0:n.duration)?s:0)/1e3,l=e.bandwidth*o;return i*(.75*o/a)>l});return 0===o.length?[e[0]]:o}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!1}}var gr=r(6095);class vr{constructor(){this.name="SwitchHistoryRule",this.rule=new gr.I}filter(e,t){return this.rule.filter(e)}getDebugInfo(){return{name:this.name}}isCappingRule(){return!1}}var yr=r(5060);const Er=Number.MAX_SAFE_INTEGER;class Sr{constructor(e,t){this.name="ResolutionRule",this.inputData={width:0,height:0,dpi:1,defaultQuality:Er,userQuality:{width:null,height:null}},this.getUserQuality=void 0,this.getDefaultQuality=void 0,this.getDefaultQuality=e,this.getUserQuality=t}filter(e,t,r){var i,s,n,a;const o=r||{width:null==(i=t.containerSize)?void 0:i.width,height:null==(s=t.containerSize)?void 0:s.height};return o.dpi=t.devicePixelRatio&&!(0,he.RW)("web_disable_dpi")?t.devicePixelRatio:1,this.inputData.width=null!=(n=o.width)?n:null,this.inputData.height=null!=(a=o.height)?a:null,this.inputData.dpi=o.dpi,this.inputData.userQuality=this.getUserQuality(),this.inputData.defaultQuality=this.getDefaultQuality(),(0,yr.i)(e,o,this.inputData.defaultQuality,this.inputData.userQuality)}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!0}}class Ar{constructor(){this.name="MaxBandwidthRule"}filter(e,t){const r=(0,xe.Y)(e.slice(0).reverse(),e=>{var t;return(null==e||null==(t=e.audio)?void 0:t.bitrate)||0});return r?[r]:e}getDebugInfo(){return{name:this.name}}isCappingRule(){return!1}}class Tr{constructor(e){this.getServerCapHeight=e,this.name="ServerRestrictionsRule",this.inputData={maxHeight:null}}filter(e){if(e.length<=1)return e;const t=this.getServerCapHeight();return this.inputData.maxHeight=t,null===t?e:function(e,t){const r=e.filter(yr.F);if(r.length<=1)return e;const i=[];for(let s=0;s<r.length;s++)r[s].video.height<=t&&i.push(r[s]);return 0===i.length?[r[0]]:i}(e,t)}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!0}}var br=r(5372);class Rr extends Ue.M{constructor(e){super(),this.videoState=e,this.watchedTimeCounter=void 0,this.watchedTimeCounter=new br.p}run(){this.videoState.currentTime&&(this.watchedTimeCounter.calc(this.videoState.currentTime,this.videoState.playbackRate,!0),this.emit("WatchedTimeUpdated",{watchedTime:this.watchedTimeCounter.get()}))}}var wr=r(2843);const _r=(0,mt.I)(()=>(0,he.jS)("web_yasp_buffer"));class kr{constructor(e){this.props=void 0,this.bufferGoalFilters=[$,ee],this.props=e}getBufferGoal(e){if((0,he.RW)("web_disable_dynamic_buffer"))return _r();const{watchedTime:t=0,currentTime:r=0}=e,i=te({},this.props,{watchedTime:t,currentTime:r});return this.bufferGoalFilters.reduce((e,t)=>Math.min(t(i),e),_r())}}class Pr extends Ue.M{constructor(e){super(),this.timeline=e}run(){this.timeline.getIsDynamic()&&this.update()}update(){const e=this.timeline.getSeekableRange(),t=e.start/1e3,r=e.end/1e3;this.emit("SeekableUpdate",{start:t,end:r})}destroy(){super.destroy()}}class Ir extends Ue.M{constructor(e,t,r,i){var s,n;super(),this.cron=e,this.url=t,this.videoState=r,this.initialConfig=i,this.abr=void 0,this.bandwidthEstimator=void 0,this.ttfbEstimator=void 0,this.manifesto=void 0,this.manifestUpdater=void 0,this.timeline=void 0,this.mse=void 0,this.mseFeeder=void 0,this.mseGc=void 0,this.timelineFiller=void 0,this.seekableUpdater=void 0,this.timelineGc=void 0,this.yaspWatchedTimeCollector=void 0,this.segmentFetcher=void 0,this.fetcher=void 0,this.fetcherProgressAccumulator=void 0,this.attached=!1,this.defaultEstimateValue=void 0,this.startPosition=null,this.destroyed=!1,this.performOnLoad=void 0,this.watchedTime=0,this.bufferGoalManager=void 0,this.timelineFillerBufferGoalInterval=void 0,this.videoType=void 0,this.userQuality={width:null,height:null},this.defaultQuality=Er,this.isLowLatency=!1,self.source=this,this.startPosition=Q(this.url),this.performOnLoad=function(e){function t(){if(0===r.length)return;const e=r.slice();r.length=0,e.forEach(e=>{let{task:t,onPromiseReject:r}=e;if(a)r(s);else try{t(i)}catch(n){}}),r.length>0&&t()}const r=[];let i,s,n=!1,a=!1;return e.then(e=>{i=e,n=!0,t()}),e.catch(e=>{s=e,a=!0,t()}),function(e,t){if(void 0===t&&(t=dt.Z),a)t(s);else if(!n||r.length>0)r.push({task:e,onPromiseReject:t});else try{e(i)}catch(o){}}}(new Promise(e=>{this.once("ManifestLoaded",e)})),this.timeline=this.createTimeline(),this.subscribeToTrackChanges(),this.bufferGoalManager=new kr({skippableFragments:null==(s=this.initialConfig)?void 0:s.skippableFragments});const{bandwidthEstimator:a,ttfbEstimator:o,abr:l}=function(e,t,r,i){const s=new ur(i),n=new hr;return{bandwidthEstimator:s,ttfbEstimator:n,abr:new ar({rules:[new Tr(e),new fr(s),new mr(s,n),new vr,new Sr(r,t),new Ar]})}}(()=>{var e,t;return null!=(e=null==(t=this.manifesto)?void 0:t.getPlaylistCapHeight())?e:null},()=>this.userQuality,()=>this.defaultQuality,null==(n=this.defaultEstimateValue)?void 0:n.value);this.bandwidthEstimator=a,this.ttfbEstimator=o,this.abr=l,this.abr.on("AbrDecisionChange",e=>{this.emit("AbrDecisionChange",{message:JSON.stringify(re({},e,{type:this.attached?"main":"preload"}))})}),this.abr.on("MaxCapAllowedVideoTrackUpdate",e=>{var t,r,i,s;e&&null!=(t=e.video)&&t.width&&null!=(r=e.video)&&r.height&&this.emit("MaxCapAllowedVideoTrackUpdate",{width:null==(i=e.video)?void 0:i.width,height:null==(s=e.video)?void 0:s.height})})}createTimeline(){if(this.timeline)return this.timeline;const e=new Be;return e.on("BufferedInfoChanged",e=>{this.emit("BufferedInfoChanged",e)}),e.on("CuesAdded",e=>{this.emit("CuesAdded",e)}),e}getStartPosition(){var e;return null!==this.startPosition&&Number.isFinite(this.startPosition)?this.startPosition:null!=(e=this.timeline)&&e.getIsDynamic()?Math.floor(this.timeline.getSeekableRange().end/1e3):this.timeline.getSeekableRange().start/1e3}setDurationByVideoType(){if(!this.mse||!this.videoType)return;const e=this.timeline.getDuration();void 0!==e&&this.mse.setDuration(e/1e3)}updateStreamingParameters(){if(this.manifesto){const e=this.manifesto.getDrmInfos();e.length>0&&this.emit("DrmInfoReceived",e)}this.emit("UtcStartTimeUpdate",this.timeline.getUtcStartTime());const e=this.timeline.getSeekableRange(),t=e.start/1e3,r=e.end/1e3;if("number"===typeof this.startPosition&&(this.startPosition=Math.min(Math.max(this.startPosition,t),r)),this.mse){this.timeline.getIsDynamic()&&this.mse.setLiveSeekableRange(t,r)}this.emit("SeekableRangeUpdate",{start:t,end:r}),this.videoType&&this.emit("VideoTypeChange",this.videoType),this.emit("IsLowLatencyChange",this.isLowLatency)}async load(){var e;if(this.manifesto||(this.manifesto=new wt({url:this.url,timeline:this.timeline}),this.manifesto.on("Error",e=>{this.emit("Error",e)}),this.manifesto.on("DrmInfoReceived",e=>{this.emit("DrmInfoReceived",e)}),this.manifesto.on("ServerTimeChange",e=>{this.emit("ServerTimeChange",e)}),this.manifesto.on("ManifestUpdate",()=>{var e,t,r,i;this.emit("UtcStartTimeUpdate",this.timeline.getUtcStartTime());const s=this.timeline.getSeekableRange(),n=s.start/1e3,a=s.end/1e3;null==(e=this.mse)||e.setLiveSeekableRange(n,a),this.emit("SeekableRangeUpdate",{start:n,end:a});const o=null==(t=this.manifesto)?void 0:t.getVideoType();this.videoType!==o&&(this.videoType=o,this.emit("VideoTypeChange",this.videoType),this.setDurationByVideoType());const l=this.timeline.isLowLatencyLive();this.isLowLatency!==l&&(this.isLowLatency=l,this.emit("IsLowLatencyChange",this.isLowLatency)),null==(r=this.segmentFetcher)||r.setEmsgSchemeIdUris(null==(i=this.manifesto)?void 0:i.getEmsgSchemeIdUris())})),this.manifestUpdater=null!=(e=this.manifestUpdater)?e:new _t(this.manifesto),this.manifesto.isInitiallyLoaded()?this.updateStreamingParameters():(await this.manifestUpdater.update(),this.emit("ManifestLoaded")),!this.destroyed){var t,r;if(!this.fetcher)this.fetcher=new gt,this.fetcher.setIsLL(this.timeline.isLowLatencyLive()),this.fetcher.isLL()?this.bandwidthEstimator.appendFetcher(this.fetcher):(this.fetcherProgressAccumulator=new rr,this.fetcherProgressAccumulator.on("NetworkTrace",e=>{this.emit("NetworkTrace",e)}),this.fetcherProgressAccumulator.appendFetcher(this.fetcher),this.bandwidthEstimator.appendFetcher(this.fetcherProgressAccumulator)),null==(t=this.ttfbEstimator)||t.appendFetcher(this.fetcher);if(!this.segmentFetcher)this.segmentFetcher=new Jt(this.fetcher),this.segmentFetcher.setEmsgSchemeIdUris(null==(r=this.manifesto)?void 0:r.getEmsgSchemeIdUris()),this.segmentFetcher.on("EmsgDetected",e=>{this.emit("EmsgDetected",e)}),this.segmentFetcher.on("ManifestUpdateRequired",()=>{var e;null==(e=this.manifestUpdater)||e.forceUpdate()}),this.segmentFetcher.on("SegmentLoaded",e=>{this.emit("SegmentLoaded",e)});return this.timelineFiller||(this.timelineFiller=new Kt({timeline:this.timeline,videoState:this.videoState,manifesto:this.manifesto,bufferGoal:this.bufferGoalManager.getBufferGoal({watchedTime:this.watchedTime,currentTime:this.videoState.currentTime||0}),abr:this.abr,segmentFetcher:this.segmentFetcher,bandwidthEstimator:this.bandwidthEstimator,ttfbEstimator:this.ttfbEstimator}),this.timelineFiller.on("Error",e=>{this.emit("Error",e)}),this.timelineFiller.on("BandwidthEstimateUpdate",e=>{this.emit("BandwidthEstimateUpdate",e)}),this.cron.plan(this.timelineFiller,100),this.initTimelineFillerBufferGoalAutoUpdate()),this.timelineGc||(this.timelineGc=new qt(this.timeline,this.videoState,er(),_r()+5),this.cron.plan(this.timelineGc,1e3)),this.yaspWatchedTimeCollector||(this.yaspWatchedTimeCollector=new Rr(this.videoState),this.yaspWatchedTimeCollector.on("WatchedTimeUpdated",e=>{let{watchedTime:t}=e;this.watchedTime=t}),this.cron.plan(this.yaspWatchedTimeCollector,100)),this.handleAttachedState(),{startPosition:this.startPosition}}}initTimelineFillerBufferGoalAutoUpdate(){this.stopTimelineFillerBufferGoalAutoUpdate(),this.timelineFillerBufferGoalInterval=setInterval(()=>{var e;const t=this.bufferGoalManager.getBufferGoal({watchedTime:this.watchedTime,currentTime:this.videoState.currentTime||0});null==(e=this.timelineFiller)||e.setBufferGoal(t)},1e3)}stopTimelineFillerBufferGoalAutoUpdate(){this.timelineFillerBufferGoalInterval&&clearInterval(this.timelineFillerBufferGoalInterval)}abortMseFeeder(){var e;return null==(e=this.mseFeeder)?void 0:e.abort()}handleSeek(){var e,t;return null==(e=this.timelineFiller)||e.abortUseless(),null==(t=this.mseGc)?void 0:t.forceRun()}handleAttachedState(){var e,t,r,s;const n=this.attached?this.videoState:function(e){const t=new ae;return i(t,e),t}({currentTime:Math.max(null!=(e=this.startPosition)?e:0,0),duration:this.timeline.getDuration()/1e3}),a=this.attached?this.bufferGoalManager.getBufferGoal({watchedTime:this.watchedTime,currentTime:this.videoState.currentTime||0}):tr.a;null==(t=this.timelineFiller)||t.setVideoState(n),null==(r=this.timelineFiller)||r.setBufferGoal(a),null==(s=this.timelineGc)||s.setVideoState(n)}handleSeekableUpdater(){if(!this.seekableUpdater&&this.attached)return this.seekableUpdater=new Pr(this.timeline),this.seekableUpdater.on("SeekableUpdate",e=>{this.emit("SeekableRangeUpdate",e)}),void this.cron.plan(this.seekableUpdater,100);this.seekableUpdater&&!this.attached&&(this.cron.cancel(this.seekableUpdater),this.seekableUpdater.destroy(),this.seekableUpdater=void 0)}attach(e){return new Promise(t=>{this.performOnLoad(()=>{var r,i,s,n;this.attached=!0,this.manifestUpdater&&this.manifestUpdater.update(),this.startPosition=null!=(r=this.startPosition)?r:Q(e),this.timelineGc&&this.cron.plan(this.timelineGc,1e3),this.handleAttachedState(),this.mse=null!=(i=this.mse)?i:new Mt(this.getMseConfig(),e=>this.emit("Error",e)),this.handleSeekableUpdater(),this.setDurationByVideoType(),this.updateStreamingParameters(),this.mseFeeder=null!=(s=this.mseFeeder)?s:new Ot(this.timeline,this.videoState,this.mse,{bufferGoal:30,totalBufferSoftCap:Pt(),totalBufferHardCap:It()}),this.mseFeeder.on("FatBuffer",e=>{this.mseGc&&this.mseGc.run()}),this.mseFeeder.on("GorgedBuffer",e=>{}),this.mseGc=null!=(n=this.mseGc)?n:new $t(this.mse,this.videoState,kt(),It()),this.mseFeeder.on("Error",e=>{this.emit("Error",e)}),this.cron.plan(this.mseFeeder,100),this.cron.plan(this.mseGc,1e4),t(this.mse.getObjectUrl())})})}setVideoTrack(e){this.timeline.setVideoTrack(e),void 0!==e&&this.handleSetTrack()}setAudioTrack(e){this.timeline.setAudioLanguage(e),void 0!==e&&this.handleSetTrack()}handleSetTrack(){var e;null==(e=this.mseGc)||e.forceRun().then(()=>{var e;null==(e=this.mseFeeder)||e.abort(),this.emit("FlushMediaPipelineRequested")})}setTextTrack(e){this.timeline.setTextTrack(e)}getVideoTracks(){return this.timeline.getVideoTracksInfo()}getAudioTracks(){return this.timeline.getAudioTracksInfo()}getTextTracks(){return this.timeline.getTextTracksInfo()}detach(){this.attached&&(this.attached=!1,this.timelineGc&&this.cron.cancel(this.timelineGc),this.manifestUpdater&&this.manifestUpdater.disable(),(0,he.RW)("web_yasp_use_currenttime_for_fake_videostate")&&(this.startPosition=this.videoState.currentTime),this.handleSeekableUpdater(),this.handleAttachedState(),this.mseFeeder&&(this.cron.cancel(this.mseFeeder),this.mseFeeder.destroy(),this.mseFeeder=void 0),this.mseGc&&(this.cron.cancel(this.mseGc),this.mseGc=void 0),this.mse&&(this.mse.destroy(),this.mse=void 0),this.yaspWatchedTimeCollector&&(this.cron.cancel(this.yaspWatchedTimeCollector),this.yaspWatchedTimeCollector.destroy(),this.yaspWatchedTimeCollector=void 0))}setVideoElementSizes(e){null!=e.width||(e.width=1/0),null!=e.height||(e.height=1/0),this.abr.setVideoElementSizes(e)}destroy(){var e,t,r,i;(this.manifestUpdater&&(this.manifestUpdater.disable(),this.manifestUpdater=void 0),this.mseFeeder&&(this.cron.cancel(this.mseFeeder),this.mseFeeder.destroy(),this.mseFeeder=void 0),this.mseGc&&(this.cron.cancel(this.mseGc),this.mseGc=void 0),this.mse&&(this.mse.destroy(),this.mse=void 0),this.timelineFiller&&(this.cron.cancel(this.timelineFiller),this.timelineFiller.destroy(),this.timelineFiller=void 0,this.stopTimelineFillerBufferGoalAutoUpdate()),this.segmentFetcher&&(this.segmentFetcher.destroy(),this.segmentFetcher=void 0),this.timelineGc&&(this.cron.cancel(this.timelineGc),this.timelineGc=void 0),this.manifesto&&(this.manifesto.destroy(),this.manifesto=void 0),this.fetcher)&&(null==(e=this.bandwidthEstimator)||e.removeFetcher(this.fetcher),null==(t=this.fetcherProgressAccumulator)||t.removeFetcher(this.fetcher),null==(r=this.ttfbEstimator)||r.removeFetcher(this.fetcher),this.fetcher.destroy(),this.fetcher=void 0);this.fetcherProgressAccumulator&&(this.fetcherProgressAccumulator.off("NetworkTrace"),null==(i=this.bandwidthEstimator)||i.removeFetcher(this.fetcherProgressAccumulator));this.yaspWatchedTimeCollector&&(this.cron.cancel(this.yaspWatchedTimeCollector),this.yaspWatchedTimeCollector.destroy(),this.yaspWatchedTimeCollector=void 0),this.fetcherProgressAccumulator=void 0,this.timeline.destroy(),this.abr.off("AbrDecisionChange"),this.destroyed=!0,super.destroy()}getMseConfig(){const e=this.timeline.getMimeTypes(),t=e.audio[0],r=e.video[0],i={};return t&&(i.audio=t),r&&(i.video=r),i}getDebugInfo(){var e,t,r,i,s,n,a,o,l,d,c,u,h,p,f,m,g,v;return{attached:this.attached,url:this.url,defaultEstimateValue:this.defaultEstimateValue,videoState:this.videoState,abr:this.abr.getDebugInfo(),bandwidthEstimator:this.bandwidthEstimator.getDebugInfo(),ttfbEstimator:null!=(e=null==(t=this.ttfbEstimator)?void 0:t.getDebugInfo())?e:null,manifesto:null!=(r=null==(i=this.manifesto)?void 0:i.getDebugInfo())?r:null,manifestUpdater:null!=(s=null==(n=this.manifestUpdater)?void 0:n.getDebugInfo())?s:null,mse:null!=(a=null==(o=this.mse)?void 0:o.getDebugInfo())?a:null,mseFeeder:null!=(l=null==(d=this.mseFeeder)?void 0:d.getDebugInfo())?l:null,mseGc:null!=(c=null==(u=this.mseGc)?void 0:u.getDebugInfo())?c:null,timeline:this.timeline.getDebugInfo(),timelineFiller:null!=(h=null==(p=this.timelineFiller)?void 0:p.getDebugInfo())?h:null,timelineGc:null!=(f=null==(m=this.timelineGc)?void 0:m.getDebugInfo())?f:null,fetcher:null!=(g=null==(v=this.fetcher)?void 0:v.getDebugInfo())?g:null}}getStats(){var e;return{bandwidth:null==(e=this.bandwidthEstimator)?void 0:e.getBandwidthEstimate()}}configure(e){var t,r;this.defaultEstimateValue=e.defaultBandwidthEstimate,this.bandwidthEstimator&&null!=(t=this.defaultEstimateValue)&&t.value&&this.bandwidthEstimator.setDefaultEstimate(this.defaultEstimateValue),this.userQuality=null!=(r=e.userQuality)?r:this.userQuality,this.defaultQuality=void 0!==e.defaultQuality?e.defaultQuality:this.defaultQuality,this.timeline.setPresentationDelay(e.presentationDelay)}subscribeToTrackChanges(){this.timeline.on("VideoTrackChange",e=>{this.emit("VideoTrackChange",e)}),this.timeline.on("AudioLanguageChange",e=>{this.emit("AudioLanguageChange",e)}),this.timeline.on("TextTrackChange",e=>{this.emit("TextTrackChange",e)})}}class Cr{constructor(){this.timesheet=[],this.started=!1,this.startTimesheetItem=e=>{clearInterval(e.intervalId),e.intervalId=self.setInterval(()=>{e.tasks.forEach(e=>{if(this.started)try{e.run()}catch(t){self.setTimeout(()=>{throw t})}})},e.interval)}}static stopTimesheetItem(e){clearInterval(e.intervalId),e.intervalId=void 0}obtainTimesheetItemByInterval(e){const t=this.timesheet.find(t=>t.interval===e);if(void 0!==t)return t;const r={interval:e,intervalId:void 0,tasks:[]};return this.started&&this.startTimesheetItem(r),this.timesheet.push(r),r}start(){this.started||(this.started=!0,this.timesheet.forEach(this.startTimesheetItem))}stop(){this.started&&(this.started=!1,this.timesheet.forEach(Cr.stopTimesheetItem))}plan(e,t){const r=this.obtainTimesheetItemByInterval(t);r.tasks.includes(e)||r.tasks.push(e)}cancel(e){for(let t=0;t<this.timesheet.length;t++){const r=this.timesheet[t],i=r.tasks.indexOf(e);-1!==i&&(r.tasks.splice(i,1),0===r.tasks.length&&(Cr.stopTimesheetItem(r),this.timesheet.splice(t,1),t-=1))}}destroy(){this.stop(),this.timesheet.length=0}}var Or=r(931),Dr=r(45),Nr=r(1647);const Lr=se;"object"!==typeof window&&(self.window=self,se())},6197:(e,t)=>{"use strict";t.Z=function(e,t,r){for(var i=e.length+t.length,s=new Array(i),n=0,a=0,o=0;o<i;){var l=n>=e.length,d=a>=t.length;!l&&(d||r(e[n],t[a])<0)?(s[o]=e[n],n++):(s[o]=t[a],a++),o++}return s}},5983:e=>{e.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r]);return e})},8162:(e,t,r)=>{"use strict";var i;r.d(t,{w:()=>i}),function(e){e.LOAD_SCRIPT_ERROR="LOAD_SCRIPT_ERROR",e.STATS_SENSOR_NAME_ERROR="STATS_SENSOR_NAME_ERROR",e.STATS_LABEL_KEY_ERROR="STATS_LABEL_KEY_ERROR",e.STATS_LABEL_VALUE_ERROR="STATS_LABEL_VALUE_ERROR"}(i||(i={}))},413:(e,t,r)=>{"use strict";r.d(t,{s:()=>o});var i=r(4006),s=r(4460),n=r(7880);const a=r(5983);class o extends Error{constructor(e,t){void 0===t&&(t={});const r="object"===typeof e?e:{message:String(e||n.J.message)};super(),a(this,o.prototype),this.message=t.message||r.message||n.J.message,this.code=t.code||r.code||r.id||n.J.code,this.isFatal=Boolean((0,i.d)([t.isFatal,r.isFatal,n.J.isFatal])),this.details=t.details||r.details||n.J.details;const l=t.stack||r.stack||function(e){const{url:t,line:r,col:i,fileName:s,columnNumber:n,lineNumber:a}=e;return(t||s||"?")+":"+(r||a||"?")+":"+(i||n||"?")}(r);let d=l===n.J.stack?this.stack:l;if(d&&d!==n.J.stack)this.stack=d;else if(!this.stack)try{throw new Error(this.message)}catch(c){this.stack=d=c.stack||n.J.stack}this.toString=()=>(0,s.Y)(this.toJSON()),this.toJSON=()=>({message:this.message,code:this.code,isFatal:this.isFatal,details:this.details,stack:d})}}},7880:(e,t,r)=>{"use strict";r.d(t,{J:()=>i});const i={message:"DEFAULT_ERROR_MESSAGE",code:0,details:"",stack:"?:?:?",isFatal:!0}},2447:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});const i=!(0,r(5638).E)(Math.random)||Math.random()===Math.random();var s=r(7293);let n=Date.now()*(0,s.no)()%2147483647;const a=i?function(){return n=16807*n%2147483647,(n-1)/2147483646}:function(){return Math.random()}},5638:(e,t,r)=>{"use strict";function i(e){if(!e||!e.toString)return!1;const t=e.toString();return/\[native code\]/.test(t)||/\/\* source code not available \*\//.test(t)}r.d(t,{E:()=>i})},6690:(e,t,r)=>{"use strict";function i(e){return void 0===e&&(e=window),void 0===o&&(o=function(e){void 0===e&&(e=window);return e.JSON&&(0,a.E)(e.JSON.stringify)&&(0,a.E)(e.JSON.parse)}(e)?e.JSON:{stringify:l("stringify"),parse:l("parse")}),o}r.d(t,{LA:()=>i});var s=r(4007),n=r(5587),a=r(5638);let o;const l=e=>t=>{const{JSON:r,clean:i}=function(e){void 0===e&&(e=document.body);const t=(0,s.$)(e);return{JSON:t.contentWindow.JSON,clean:()=>(0,n.Q)(t)}}();try{return r[e](t)}finally{i()}}},984:(e,t,r)=>{"use strict";function i(e,t){let r=e[t];if(!(0,s.E)(r)){const s=r;try{delete e[t];const i=e[t];"function"===typeof i&&(r=i),e[t]=s}catch(i){}}return r}r.d(t,{C:()=>i});var s=r(5638)},141:(e,t,r)=>{"use strict";function i(e,t,r){for(const i in e)(0,s.n)(e,i)&&t.call(r,e[i],i,e)}r.d(t,{M:()=>i});var s=r(8258)},3222:(e,t,r)=>{"use strict";function i(e){return"function"===typeof Object.entries?Object.entries(e):(0,s.Z)(e).map(t=>[t,e[t]])}r.d(t,{J:()=>i});var s=r(5999)},5999:(e,t,r)=>{"use strict";function i(e){if("function"===typeof Object.keys)return Object.keys(e);{const t=[];for(const r in e)(0,s.n)(e,r)&&t.push(r);return t}}r.d(t,{Z:()=>i});var s=r(8258)},5269:(e,t,r)=>{"use strict";function i(e){const t=Object.values;if("function"===typeof t)return t(e);{const t=[];for(const r in e)(0,s.n)(e,r)&&t.push(e[r]);return t}}r.d(t,{z:()=>i});var s=r(8258)},3853:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});const i=(0,r(5638).E)(Object.getPrototypeOf)?e=>Object.getPrototypeOf(e):e=>e.__proto__||Object.prototype},8258:(e,t,r)=>{"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.d(t,{n:()=>i})},3770:(e,t,r)=>{"use strict";function i(e){const t=typeof e;return Boolean(e)&&("object"===t||"function"===t)}r.d(t,{K:()=>i})},4963:(e,t,r)=>{"use strict";function i(e,t){(0,s.$)(e)?e.dispatch(t):e(t)}r.d(t,{p:()=>i});var s=r(7564)},6350:(e,t,r)=>{"use strict";function i(e,t){e.forEach(e=>{(0,s.p)(e,t)})}r.d(t,{k:()=>i});var s=r(4963)},4312:(e,t,r)=>{"use strict";r.d(t,{M:()=>s});var i=r(6350);class s{constructor(){this.on=[],this.once=[]}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.on.push(...t),()=>this.remove(...t)}addOne(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.once.push(...t),()=>this.remove(...t)}promise(){return new Promise(e=>this.addOne(e))}dispatch(e){const{once:t}=this;this.once=[],(0,i.k)(this.on,e),(0,i.k)(t,e)}removeAll(){this.on.length=0,this.once.length=0}remove(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.on=this.on.filter(e=>t.indexOf(e)<0),this.once=this.once.filter(e=>t.indexOf(e)<0)}}},7564:(e,t,r)=>{"use strict";function i(e){return"function"===typeof e.dispatch}r.d(t,{$:()=>i})},884:(e,t,r)=>{"use strict";function i(e,t,r){return void 0===r&&(r=s),Math.abs(e-t)<=r}r.d(t,{C:()=>i,I:()=>s});const s=Number.EPSILON||Math.pow(2,-52)},942:(e,t,r)=>{"use strict";function i(e,t){return(0,s.V)(e,t,(e,t)=>t-e)}r.d(t,{Y:()=>i});var s=r(4547)},5679:(e,t,r)=>{"use strict";function i(e,t){return(0,s.V)(e,t,(e,t)=>e-t)}r.d(t,{U:()=>i});var s=r(4547)},4547:(e,t,r)=>{"use strict";function i(e,t,r){if(e.length<1)return;let[i]=e,s=t(i);for(let n=1;n<e.length;n++){const a=e[n],o=t(a);r(o,s)<0&&(i=a,s=o)}return i}r.d(t,{V:()=>i})},2055:(e,t,r)=>{"use strict";r.d(t,{h:()=>i});const i=(e,t,r)=>{const i=[];for(let s=0;s<e.length;s++){const n=e[s];t.call(r,n,s,e)&&i.push(n)}return i}},3888:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});var i=r(5638);const s=[].find,n=(0,i.E)(s)?(e,t)=>s.call(e,t):(e,t)=>{for(let r=0;r<e.length;r++){const i=e[r];if(t(i,r,e))return i}}},4006:(e,t,r)=>{"use strict";function i(e){const[t]=(0,s.h)(e,e=>void 0!==e);return t}r.d(t,{d:()=>i});var s=r(2055)},5371:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});var i=r(8062);const s=(0,r(984).C)(Array,"isArray"),n=Boolean(s)?e=>s.call(Array,e):e=>"Array"===(0,i.M)(e)},2420:(e,t,r)=>{"use strict";function i(e,t,r){return e>r?r:e<t?t:e}r.d(t,{u:()=>i})},2553:(e,t,r)=>{"use strict";function i(e,t){let{content:r,size:i}=void 0===t?{}:t;const s=e.ownerDocument.createElement("iframe");s.scrolling="no",s.setAttribute("allowfullscreen",""),s.style.display="block",i&&(s.height=i.height,s.width=i.width),e.appendChild(s);const n=s.contentDocument;return n.open(),r&&n.write(r),n.close(),n.body.style.margin="0",s.style.borderWidth="0",s}r.d(t,{Q:()=>i})},9183:(e,t,r)=>{"use strict";r.d(t,{m:()=>s});var i=r(6351);const s=Date&&(0,i.m)(Date.now)?()=>Date.now():()=>(new Date).getTime()},3351:(e,t,r)=>{"use strict";r.d(t,{k:()=>i});const i=e=>"hidden"in e?"hidden":"webkitHidden"in e?"webkitHidden":void 0},2439:(e,t,r)=>{"use strict";function i(e,t){void 0===t&&(t=!0);const r=(0,s.k)(e);if(!r)return t;return!e[r]}r.d(t,{s:()=>i});var s=r(3351)},9738:(e,t,r)=>{"use strict";function i(e,t){const r=function(e){const t=(0,o.k)(e);if(t)return t.replace(/hidden/i,"visibilitychange")}(e);return r?(0,n.O)(e,r,()=>{t((0,a.s)(e))}):s.Z}r.d(t,{Y:()=>i});var s=r(6652),n=r(3945),a=r(2439),o=r(3351)},3945:(e,t,r)=>{"use strict";function i(e,t,r,i){const a=function(e){let t=!1,r=!1,i=!1;return!0===e?t=!0:"object"===typeof e&&(t=Boolean(e.capture),r=Boolean(e.passive),i=Boolean(e.once)),{capture:t,passive:r,once:i}}(i),o=n.FF?a:a.capture,l=a.once&&!n.vE?function(e){d(),r.call(this,e)}:r,d=()=>{(0,s.f)(e,t,l,o)};return(0,s.h)(e,t,l,o),d}r.d(t,{O:()=>i});var s=r(144),n=r(4679)},3424:(e,t,r)=>{"use strict";r.d(t,{T:()=>s});var i=r(2239);const s=e=>{const t=[];for(;e;)try{if((0,i.b)(e),t.push(e),e.parent===e)break;e=e.parent}catch(r){break}return t}},2440:(e,t,r)=>{"use strict";r.d(t,{B:()=>i});const i=(0,r(3424).T)(window)},4769:(e,t,r)=>{"use strict";function i(e){const{ownerDocument:t}=e;if(!t)return;const{defaultView:r}=t;return r||void 0}r.d(t,{G:()=>i})},144:(e,t,r)=>{"use strict";r.d(t,{f:()=>n,h:()=>s});var i=r(984);let s=function(e,t,r){e.attachEvent("on"+t,r)},n=function(e,t,r){e.detachEvent("on"+t,r)};(0,i.C)(document,"addEventListener")&&(0,i.C)(document,"removeEventListener")&&(s=function(e,t,r,s){const n=e&&(0,i.C)(e,"addEventListener");n&&n.call(e,t,r,s)},n=function(e,t,r,s){const n=e&&(0,i.C)(e,"removeEventListener");n&&n.call(e,t,r,s)})},4679:(e,t,r)=>{"use strict";r.d(t,{FF:()=>o,vE:()=>n});var i=r(6652),s=r(144);let n=!1,a=!1,o=!1;try{if(function(e){void 0===e&&(e=window);const t=e.Object;try{const e={};return t.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(r){return!1}}()){const e=document.createElement("div"),t={};Object.defineProperty(t,"once",{get:()=>n=!0}),Object.defineProperty(t,"passive",{get:()=>a=!0}),Object.defineProperty(t,"capture",{get:()=>o=!0}),(0,s.h)(e,"click",i.Z,t)}}catch(l){}},8692:(e,t,r)=>{"use strict";function i(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];(0,s.k)(e)&&e.forEach(e=>{"function"===typeof e&&e(...r)})}r.d(t,{p:()=>i});var s=r(5371)},6862:(e,t,r)=>{"use strict";r.d(t,{H:()=>s});class i{constructor(e){this.cache=e}get(e){return this.cache[e]}has(e){return e in this.cache}set(e,t){this.cache[e]=t}}const s=function(e,t,r){return void 0===t&&(t=e=>e),void 0===r&&(r=new i({})),function(){const i=t.apply(this,arguments);if(r.has(i))return r.get(i);const s=e.apply(this,arguments);return r.set(i,s),s}}},5386:(e,t,r)=>{"use strict";function i(e){let t=function(){t=()=>r;const r=e.apply(this,arguments);return r};return function(){return t.apply(this,arguments)}}r.d(t,{I:()=>i})},4392:(e,t,r)=>{"use strict";const i=(0,r(2930).P)();i&&i.src},2930:(e,t,r)=>{"use strict";function i(e,t){void 0===e&&(e=document);const r=e.currentScript;if(r)return r;{const r=e.getElementsByTagName("script"),i=[];for(let e=0;e<r.length;e++)i.push(r[e]);if("function"===typeof t){const e=i.filter(t);return e[e.length-1]}return i[i.length-1]}}r.d(t,{P:()=>i})},8194:(e,t,r)=>{"use strict";function i(e){const t=e.document;let r=t.getElementsByTagName("head")[0];return r||(r=t.createElement("head"),t.documentElement.appendChild(r)),r}r.d(t,{c:()=>i})},8062:(e,t,r)=>{"use strict";r.d(t,{M:()=>n});const i={}.toString,s=/\[object (\w+)\]/,n=e=>{const t=i.call(e);if(!t)return null;const r=t.match(s);if(!r)return null;const n=r[1];return n||null}},2239:(e,t,r)=>{"use strict";function i(e){if(e&&e.location){const{location:t}=e;return"function"===typeof t.toString?t.toString():t.href||""}return""}r.d(t,{b:()=>i})},3582:(e,t,r)=>{"use strict";r.d(t,{K:()=>i});r(8692);const i=r(6652).Z},3094:(e,t,r)=>{"use strict";r.d(t,{q:()=>i});const i=r(6652).Z},1409:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{n:()=>d});var s=r(3582),n=r(3094),a=r(8113),o=r(6741),l=r(9082);const d=e=>{let{win:t,propertyName:r}=e;return{call:e=>(0,s.K)(i({win:t,propertyName:r},e)),subscribe:e=>(0,a.T)(i({win:t,propertyName:r},e)),wait:e=>(0,o.E)(i({win:t,propertyName:r},e)),waitUntil:e=>(0,l.Q)(i({win:t,propertyName:r},e)),clear:e=>(0,n.q)(i({win:t,propertyName:r},e))}}},8113:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});const i=r(6652).Z},6741:(e,t,r)=>{"use strict";r.d(t,{E:()=>s});var i=r(8113);const s=e=>{let{propertyName:t,win:r}=e;return new Promise(e=>{(0,i.T)({callback:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e(r)},propertyName:t,win:r})})}},9082:(e,t,r)=>{"use strict";r.d(t,{Q:()=>s});var i=r(8113);const s=e=>{let{propertyName:t,win:r,comparator:s}=e;return new Promise(e=>{(0,i.T)({propertyName:t,win:r,callback:function(){s(...arguments)&&e()}})})}},6838:(e,t,r)=>{"use strict";function i(e){let t="";for(let r=0;r<e;r++)t+=(16*(0,s.M)()|0).toString(16);return t}r.d(t,{a:()=>i});var s=r(2447)},4007:(e,t,r)=>{"use strict";function i(e){const t=(0,s.Q)(e);return t.width="0",t.height="0",t.style.position="absolute",t}r.d(t,{$:()=>i});var s=r(2553)},5587:(e,t,r)=>{"use strict";function i(e){e.src="",(0,s.L)(e)}r.d(t,{Q:()=>i});var s=r(4532)},6377:(e,t,r)=>{"use strict";r.d(t,{V:()=>s});var i=r(8062);const s=e=>e instanceof Error||"Error"===(0,i.M)(e)},6351:(e,t,r)=>{"use strict";function i(e){return"function"===typeof e||"Function"===(0,s.M)(e)}r.d(t,{m:()=>i});var s=r(8062)},4460:(e,t,r)=>{"use strict";function i(e){return(0,a.LA)().stringify(e,function(){const e=[],t=function(){const e="undefined"!==typeof WeakMap?new WeakMap:void 0,t=[];return{set:(r,i)=>{if(void 0!==e)try{e.set(r,i)}catch(s){t.push({path:i,value:r})}else t.push({path:i,value:r})},get:r=>{const i=(0,s.s)(t,e=>e.value===r);return void 0!==e&&void 0===i?e.get(r):i?i.path:void 0}}}();return(r,i)=>{if((0,n.m)(i))return(0,l.H)(i.name)?i.name:"[Function]";if(!(0,o.K)(i))return i;const s=t.get(i);if(s)return"[Circular "+s+"]";for(;e.length>0&&e[e.length-1].value[r]!==i;)e.pop();const a=(e.length>0?e[e.length-1].path:"")+(r?"/"+r:"~");return e.push({path:a,value:i}),t.set(i,a),i}}())}r.d(t,{Y:()=>i});var s=r(3888),n=r(6351),a=r(6690),o=r(3770),l=r(8833)},7469:(e,t,r)=>{"use strict";function i(e){if(!e)return[];const t=[];for(let r=0;r<e.length;r++)t.push(e[r]);return t}r.d(t,{w:()=>i})},4230:(e,t,r)=>{"use strict";function i(e){e&&"function"===typeof e.catch&&e.catch(e=>{})}r.d(t,{v:()=>i})},874:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){const{method:t,url:r,async:d=!0,data:c,responseType:u="text",onBeforeSend:h=a.Z,onRetry:p=a.Z,checkStatus:f=(e=>l===e),headers:m={},xhrConstructor:g=XMLHttpRequest,retries:v=0,timeout:y=0,withCredentials:E,onAbort:S,onSetup:A}=e,T=e.onSuccess?(0,n.I)(e.onSuccess):a.Z,b=e.onError?(0,n.I)(e.onError):a.Z;let R,w=!1,_=0,k=e=>{w=!0,k=a.Z,R=e,P(new Error("Abort request")),"function"===typeof S&&S(e)};const P=t=>{I.onerror=null,I.onreadystatechange=null,_&&clearTimeout(_);if(_&&4!==I.readyState||w)try{I.abort()}catch(t){}if(!w)if(v>0){const r=p(t,I);if("boolean"!==typeof r||Boolean(r)||k(),w)return;s(i({},e,{onSetup:e=>{let{abort:t}=e;k=e=>t(e),w&&t(R)},retries:v-1}))}else k=a.Z,b(t,I)},I=new g;try{I.open(t,r,d)}catch(C){return void P(C)}if(I.responseType=u,I.withCredentials=Boolean(E),(0,o.M)(m,(e,t)=>{try{I.setRequestHeader(t,e)}catch(C){}}),y>0&&isFinite(y)&&(_=window.setTimeout(()=>{P(new Error("Request timeout, "+r))},y)),I.onerror=P,I.onreadystatechange=()=>{if(4===I.readyState){const{status:e}=I;f(e)?(k=a.Z,clearTimeout(_),T(I)):P(new Error("Invalid request status "+e+", "+r))}},("function"!==typeof A||(A({abort:e=>k(e)}),!w))&&(h(I,e),!w))try{I.send(c)}catch(C){P(C)}}r.d(t,{W:()=>s});var n=r(5386),a=r(6652),o=r(141);const l=200},897:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){return new Promise((t,r)=>{(0,n.W)(i({},e,{onSuccess:t,onError:r}))})}r.d(t,{W:()=>s});var n=r(874)},6652:(e,t,r)=>{"use strict";function i(){}r.d(t,{Z:()=>i})},1919:(e,t,r)=>{"use strict";function i(e,t){let r=e+(0,s.M)()*(t+1-e);return r=Math.floor(r),r}r.d(t,{X:()=>i});var s=r(2447)},7187:(e,t,r)=>{"use strict";function i(e){return"number"===typeof e&&isFinite(e)}r.d(t,{z:()=>i})},4343:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=s.no);const t=e();return()=>Math.max(0,e()-t)}r.d(t,{u:()=>i});var s=r(7293)},7293:(e,t,r)=>{"use strict";r.d(t,{no:()=>d});var i=r(9183),s=r(6351);const n="undefined"===typeof window?void 0:window.performance,a=n&&(0,s.m)(n.now),o=n&&n.timing&&n.timing.navigationStart?n.timing.navigationStart:(0,i.m)();let l=0;const d=a?()=>n.now():()=>(()=>{const e=(0,i.m)()-o;return l=Math.max(e,l),l})()},6610:(e,t,r)=>{"use strict";r.d(t,{B:()=>i});class i{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}},5595:(e,t,r)=>{"use strict";r.d(t,{n:()=>i});const i=e=>{let t=0;return{promise:new Promise(r=>{t=window.setTimeout(r,e)}),clear(){clearTimeout(t)},timeoutId:t}}},4886:(e,t,r)=>{"use strict";r.d(t,{_:()=>i});const i=async(e,t)=>{let r;try{await new Promise((i,s)=>{t&&t.then(i,s),r=window.setTimeout(i,e)})}finally{window.clearTimeout(r)}}},4532:(e,t,r)=>{"use strict";function i(e){if(!e)return;const{parentElement:t}=e;t&&t.removeChild(e)}r.d(t,{L:()=>i})},6794:(e,t,r)=>{"use strict";r.d(t,{j:()=>i});const i="utf-8"},8842:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){return new Promise((t,r)=>{(0,n.v)(i({},e,{onLoad:t,onError:r}))})}r.d(t,{v:()=>s});var n=r(4586)},4586:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){const{win:t=window,src:r,retries:s=0,onError:d=o.Z}=e,c=new a.s({id:n.w.LOAD_SCRIPT_ERROR,message:"Failed to load script ["+r+"]",details:{src:r,isSelfWindow:t===window,onBeforeLoad:Boolean(e.onBeforeLoad),retries:s}});(0,l.T)(i({},e,{win:t,onError:()=>d(c)}))}r.d(t,{v:()=>s});var n=r(8162),a=r(413),o=r(6652),l=r(9924)},9924:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){const{dropCacheOnRetry:t=!1,onBeforeLoad:r=a.Z,retries:s=0}=e;if(e.checkLoad&&e.checkLoad())return void(e.onLoad&&e.onLoad());let u=r,h=0;return t&&s>0&&(u=e=>{if(r(e),h>0){const t=-1===e.src.indexOf("?")?"?":"&",r=(0,l.z)(4);e.src+=t+r}h++}),function e(t){const{src:r,win:s=window,charset:l=d.j,async:u=!0,retries:h=0,onRetry:p=a.Z,retryDelay:f=0,checkLoad:m=c,onBeforeLoad:g=a.Z,onLoad:v=a.Z,onError:y=a.Z}=t,E=s.document.createElement("script"),S=s=>{h>0?(p(s),e(i({},t,{src:r,retries:h-1}))):y(s),(0,o.L)(E)};E.type="text/javascript",E.async=u,E.onload=()=>m(E)?v():S(new Error("checkLoad for "+r+" failed")),E.onerror=e=>{try{s.setTimeout(()=>{S(e)},f)}catch(e){}},E.src=r,E.charset=l,g(E),(0,n.c)(s).appendChild(E)}(i({},e,{onBeforeLoad:u}))}r.d(t,{T:()=>s});var n=r(8194),a=r(6652),o=r(4532),l=r(3741),d=r(6794);const c=e=>!0},7304:(e,t,r)=>{"use strict";function i(e,t){(0,s.Z)(t).forEach(r=>{const i=t[r];null===i?e.removeAttribute(r):e.setAttribute(r,i)})}r.d(t,{K:()=>i});var s=r(5999)},6474:(e,t,r)=>{"use strict";function i(e,t){void 0===e&&(e="a"),void 0===t&&(t="z");const r=(0,s.X)(e.charCodeAt(0),t.charCodeAt(0));return String.fromCharCode(r)}r.d(t,{N:()=>i});var s=r(1919)},3741:(e,t,r)=>{"use strict";function i(e){const t=[];for(let r=0;r<e;r++)t.push((0,s.N)());return t.join("")}r.d(t,{z:()=>i});var s=r(6474)},8833:(e,t,r)=>{"use strict";function i(e){return"string"===typeof e}r.d(t,{H:()=>i})},2818:(e,t,r)=>{"use strict";function i(e,t){try{return e()}catch(r){"function"===typeof t&&t(r)}}r.d(t,{Y:()=>i})},8333:(e,t,r)=>{"use strict";(0,r(1409).n)({propertyName:"YANDEX_DESTROYABLE_GLOBAL_CALLBACK_PROPERTY_NAME",win:window})},1122:(e,t,r)=>{"use strict";r.d(t,{V:()=>s});r(413),r(4392),r(6838);var i=r(6652);r(8333);class s{constructor(){this._isDestroyed=!1,this.destroyHandlers=[]}onDestroy(e){this._addDestroyHandler(e)}addDestroyListener(e){this._addDestroyHandler(e)}addDestroyHandler(e){this._addDestroyHandler(e)}destroy(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i]=t;this._isDestroyed||(this._isDestroyed=!0,this._destroyReason=i,this.destroyHandlers.forEach(e=>e(...t)),this.destroyHandlers.length=0)}getIsDestroyed(){return this._isDestroyed}get destroyReason(){return this._destroyReason}get isDestroyed(){return this._isDestroyed}ignoreAfterDestroy(e){var t=this;let r=e;return function(){t.isDestroyed&&(r=i.Z);for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];r.apply(t,s)}}_addDestroyHandler(e){this._isDestroyed?e(this._destroyReason):this.destroyHandlers.push(e)}}},1229:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});const i=document.createElement("a")},222:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){f.A.href=e;let t=f.A.pathname||"";"/"!==t.charAt(0)&&(t="/"+t);const r=(f.A.search||"")+(f.A.hash||""),n=e.lastIndexOf(r),a=-1===n?e:e.slice(0,n);if(m.test(e)){const t=s(e.replace(m,"https:"));return f.A.href=e,i({},t,{originalPath:a,protocol:e.slice(0,e.indexOf(":")+1),href:f.A.href})}const o=f.A.protocol&&/^[a-z\-]+:/i.test(f.A.protocol)?f.A.protocol:"";return{originalPath:a,href:f.A.href,protocol:o,host:f.A.host,hostname:f.A.hostname,port:f.A.port,pathname:t,search:f.A.search,hash:f.A.hash}}function n(e,t){if(void 0===t&&(t=!1),t){const t=e.originalPath,r="/"===e.pathname&&"/"!==t[t.length-1];return e.originalPath+(r?"/":"")+e.search+e.hash}const r="443"===e.port||"80"===e.port?e.hostname:e.host;return e.protocol+"//"+r+e.pathname+e.search+e.hash}function a(e){const t={},r=e.replace(/^[?#]+/,"").replace(/#.*$/,"").split("&");for(let i=0;i<r.length;i++){const e=r[i].indexOf("=");let s,n;if(-1===e?(s=g(r[i]),n=""):(s=g(r[i].slice(0,e)),n=r[i].slice(e+1)),s){const e=Boolean(/(\[\])$/.exec(s));s=s.replace(/\[\]$/,""),e?void 0===t[s]?t[s]=[g(n)]:t[s]=[].concat(t[s],g(n)):t[s]=g(n)}}return t}function o(e){const t=[];for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];(0,u.k)(i)?t.push(v(r,i)):void 0!==i&&t.push(r+"="+encodeURIComponent(i))}return"?"+t.join("&")}function l(e,t,r){if(void 0===r)return e;const l=s(e),d=a(l.search);return d[t]=r,n(i({},l,{search:o(d)}))}function d(e,t,r){let{override:l=!0,saveOriginalPath:d=!1}=void 0===r?{}:r;const c=s(e),u=a(c.search);(0,p.M)(t,(e,t)=>{(void 0===u[t]||l)&&(u[t]=e)});return n(i({},c,{search:o(u)}),d)}function c(e){const t=function(e){return s(e).pathname.split("/").pop()||""}(e).split(".");return t.length>1?t.pop():""}r.d(t,{Ou:()=>l,Sr:()=>d,dD:()=>a,en:()=>s,lm:()=>c});var u=r(5371),h=r(6862),p=r(141),f=r(1229);(0,h.H)(e=>i({},s(e)));const m=/^(android-app:|chrome-extension:)/,g=e=>{try{return decodeURIComponent(e)}catch(t){return e}},v=(e,t)=>t.map(t=>e+"[]="+encodeURIComponent(t)).join("&")},7554:(e,t,r)=>{"use strict";r.d(t,{a:()=>n,y:()=>i});var i,s=r(3770);!function(e){e[e.MEDIA_ERR_CUSTOM=0]="MEDIA_ERR_CUSTOM",e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED",e[e.MEDIA_ERR_ENCRYPTED=5]="MEDIA_ERR_ENCRYPTED"}(i||(i={}));class n{constructor(e){this.code=0,this.message="",this.details=void 0,"number"===typeof e?this.code=e:"string"===typeof e?this.message=e:(0,s.K)(e)&&("number"===typeof e.code&&(this.code=e.code),"string"===typeof e.message&&(this.message=e.message),this.details=e.details),this.message||(this.message=i[this.code]||"")}}},3821:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});const i=document.createElement("video")},6040:(e,t,r)=>{"use strict";r.d(t,{Xr:()=>i});const i=250},3974:(e,t,r)=>{"use strict";r.d(t,{N:()=>n});var i=r(4506),s=r(3821);const n=i.Y?function(e,t){return void 0===t&&(t=s.u),Boolean(t.canPlayType(e).replace(/no/,""))}:()=>!1},7018:(e,t,r)=>{"use strict";r.d(t,{x:()=>s});const i=function(e){void 0===e&&(e=window);const t=e.navigator.userAgent,r=t.indexOf("Android");return-1===r?-1:parseFloat(t.slice(r+8))}();const s=(0,r(3974).N)("application/vnd.apple.mpegurl")||i>=4.4},6567:(e,t,r)=>{"use strict";function i(e){const{error:t}=e;return new s.a(t)}r.d(t,{Q:()=>i});var s=r(7554)},4942:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e){if("function"===typeof e.getVideoPlaybackQuality){const{droppedVideoFrames:t,corruptedVideoFrames:r,totalVideoFrames:i}=e.getVideoPlaybackQuality();return{droppedVideoFrames:t,corruptedVideoFrames:r,totalVideoFrames:i}}const t=e;return"number"===typeof t.webkitDroppedFrameCount&&"number"===typeof t.webkitDecodedFrameCount?i({},n,{droppedVideoFrames:t.webkitDroppedFrameCount,totalVideoFrames:t.webkitDecodedFrameCount}):n}r.d(t,{cd:()=>s,oI:()=>n});const n={droppedVideoFrames:0,corruptedVideoFrames:0,totalVideoFrames:0}},4506:(e,t,r)=>{"use strict";r.d(t,{Y:()=>i});const i="function"===typeof r(3821).u.load},5779:(e,t,r)=>{"use strict";function i(e){return 0===a.length&&(n=window.setInterval(()=>{a.forEach(e=>e())},s.Xr)),a.push(e),()=>{const t=a.indexOf(e);t>-1&&a.splice(t,1),0===a.length&&clearInterval(n)}}r.d(t,{X:()=>i});var s=r(6040);let n=0;const a=[]},6260:()=>{!function(e){function t(e,t){if(e&&t){var r=[];for(var i in t)if(t.hasOwnProperty(i)){var s=t[i];"string"==typeof s&&(s=new RegExp(s)),s instanceof RegExp&&s.test(e)&&r.push(i)}return r.join("_")}}function r(e,r){var s,n=[];for(var a in i)i.hasOwnProperty(a)&&(s=t(e[a],r[a]))&&n.push(a+"~"+s);return n.join(";")}var i={url:{0:/(miscellaneous|extension)_bindings/,1:/^chrome:/,2:/kaspersky-labs\.com\//,3:/^(?:moz|chrome|safari)-extension:\/\//,4:/^file:/,5:/^resource:\/\//,6:/webnetc\.top/,7:/local\.adguard\.com/},message:{0:/__adgRemoveDirect/,1:/Content Security Policy/,2:/vid_mate_check/,3:/ucapi/,4:/Access is denied/i,5:/^Uncaught SecurityError/i,6:/__ybro/,7:/__show__deepen/,8:/ntp is not defined/,9:/Cannot set property 'install' of undefined/,10:/NS_ERROR/,11:/Error loading script/,12:/^TypeError: undefined is not a function$/,13:/__firefox__\.(?:favicons|metadata|reader|searchQueryForField|searchLoginField)/},stack:{0:/(?:moz|chrome|safari)-extension:\/\//,1:/adguard.*\.user\.js/i}};e._isExternalError=function(t,s,n){var a=e._errorSettings.filters||{},o={url:(t||"")+"",message:(s||"")+"",stack:(n||"")+""},l=r(o,i),d=r(o,a);return{common:l,custom:d,hasExternal:!(!l&&!d)}}}(Ya.Rum)},1917:()=>{!function(e,t){function r(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function i(e){return"boolean"==typeof e&&(e=+e),"number"==typeof e?e+"":null}var s={client:["690.2354",1e3,100,0],uncaught:["690.2361",100,10,0],external:["690.2854",100,10,0],script:["690.2609",100,10,0]},n={};t.ERROR_LEVEL={INFO:"info",DEBUG:"debug",WARN:"warn",ERROR:"error",FATAL:"fatal"},t._errorSettings={clck:"https://yandex.ru/clck/click",beacon:!0,project:"unknown",page:"",env:"",experiments:[],additional:{},platform:"",region:"",dc:"",host:"",service:"",level:"",version:"",yandexuid:"",loggedin:!1,coordinates_gp:"",referrer:!0,preventError:!1,unhandledRejection:!1,traceUnhandledRejection:!1,uncaughtException:!0,debug:!1,limits:{},silent:{},filters:{},pageMaxAge:864e6,initTimestamp:+new Date};var a=!1;t.initErrors=function(i){var s=r(t._errorSettings,i);a||(s.uncaughtException&&function(){var r=t._errorSettings;if(e.addEventListener)e.addEventListener("error",o),r.resourceFails&&e.addEventListener("error",l,!0),"Promise"in e&&r.unhandledRejection&&e.addEventListener("unhandledrejection",(function(e){var r,i,s=e.reason,n={};s&&(s.stack&&s.message?(r=s.message,i=s.stack):(r=String(s),i=t._parseTraceablePromiseStack(e.promise),"[object Event]"===r?r="event.type: "+s.type:"[object Object]"===r&&(n.unhandledObject=s)),s.target&&s.target.src&&(n.src=s.target.src),o({message:"Unhandled rejection: "+r,stack:i,additional:n}))}));else{var i=e.onerror;e.onerror=function(e,t,r,s,n){o({error:n||new Error(e||"Empty error"),message:e,lineno:r,colno:s,filename:t}),i&&i.apply(this,arguments)}}}(),s.unhandledRejection&&s.traceUnhandledRejection&&t._traceUnhandledRejection&&t._traceUnhandledRejection(),a=!0)},t.updateErrors=function(e){r(t._errorSettings,e)},t.updateAdditional=function(e){t._errorSettings.additional=r(t._errorSettings.additional||{},e)},t._handleError=function(e,i,a){var o,l,d=t._errorSettings;if(d.preventError&&e.preventDefault&&e.preventDefault(),i)o=e,l="client";else{o=t._normalizeError(e),l=o.type;var c=d.onError;"function"==typeof c&&c(o);var u=d.transform;if("function"==typeof u&&(o=u(o)),!o)return;o.settings&&(a=o.settings)}var h=+new Date,p=d.initTimestamp,f=d.pageMaxAge;if(!(-1!==f&&p&&p+f<h)){var m=s[l][1];"number"==typeof d.limits[l]&&(m=d.limits[l]);var g=s[l][2];"number"==typeof d.silent[l]&&(g=d.silent[l]);var v=s[l][3];if(v<m||-1===m){o.path=s[l][0];var y=t._getErrorData(o,{silent:v<g||-1===g?"no":"yes",isCustom:Boolean(i)},r(r({},d),a)),E=function(e){n[o.message]=!1,t._sendError(e.path,e.vars),s[l][3]++}.bind(this,y);if(void 0===d.throttleSend)E();else{if(n[o.message])return;n[o.message]=!0,setTimeout(E,d.throttleSend)}}}},t._getReferrer=function(t){var r=t.referrer,i=typeof r;return"function"===i?r():"string"===i&&r?r:!1!==r&&e.location?e.location.href:void 0},t.getErrorSetting=function(e){return t._errorSettings[e]},t._buildExperiments=function(e){return e instanceof Array?e.join(";"):""},t._buildAdditional=function(e,t){var i="";try{var s=r(r({},e),t);0!==Object.keys(s).length&&(i=JSON.stringify(s))}catch(e){}return i},t._getErrorData=function(r,s,n){s=s||{};var a=t._buildExperiments(n.experiments),o=t._buildAdditional(n.additional,r.additional),l={"-stack":r.stack,"-url":r.file,"-line":r.line,"-col":r.col,"-block":r.block,"-method":r.method,"-msg":r.message,"-env":n.env,"-external":r.external,"-externalCustom":r.externalCustom,"-project":n.project,"-service":r.service||n.service,"-page":r.page||n.page,"-platform":n.platform,"-level":r.level,"-experiments":a,"-version":n.version,"-region":n.region,"-dc":n.dc,"-host":n.host,"-yandexuid":n.yandexuid,"-loggedin":n.loggedin,"-coordinates_gp":r.coordinates_gp||n.coordinates_gp,"-referrer":t._getReferrer(n),"-source":r.source,"-sourceMethod":r.sourceMethod,"-type":s.isCustom?r.type:"","-additional":o,"-adb":i(Ya.blocker)||i(n.blocker),"-cdn":e.YaStaticRegion,"-ua":navigator.userAgent,"-silent":s.silent,"-ts":+new Date,"-init-ts":n.initTimestamp};return n.debug&&e.console&&console[console[r.level]?r.level:"error"]("[error-counter] "+r.message,l,r.stack),{path:r.path,vars:l}},t._baseNormalizeError=function(e){var t=(e=e||{}).error,r=e.filename||e.fileName||"",i=t&&t.stack||e.stack||"",s=e.message||"",n=t&&t.additional||e.additional;return{file:r,line:e.lineno||e.lineNumber,col:e.colno||e.colNumber,stack:i,message:s,additional:n}},t._normalizeError=function(e){var r=t._baseNormalizeError(e),i="uncaught",s=t._isExternalError(r.file,r.message,r.stack),n="",a="";return s.hasExternal?(i="external",n=s.common,a=s.custom):/^Script error\.?$/.test(r.message)&&(i="script"),r.external=n,r.externalCustom=a,r.type=i,r},t._createVarsString=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&(e[r]||0===e[r])&&t.push(r+"="+encodeURIComponent(e[r]).replace(/\*/g,"%2A"));return t.join(",")},t._sendError=function(e,r){t.send(null,e,t._createVarsString(r),null,null,null,null)};var o=function(e){t._handleError(e,!1)},l=function(e){var r=e.target;if(r){var i=r.srcset||r.src;if(i||(i=r.href),i){var s=r.tagName||"UNKNOWN";t.logError({message:s+" load error",additional:{src:i}})}}};t._parseTraceablePromiseStack=function(){}}("undefined"!=typeof self?self:window,Ya.Rum)},4491:()=>{!function(e){if(!("undefined"!=typeof self?self:window).Ya||!Ya.Rum)throw new Error("Rum: interface is not defined");var t=Ya.Rum;t.getSetting=function(e){var r=t._settings[e];return null===r?null:r||""}}()},2927:()=>{!function(){"use strict";var e;(e=Ya.Rum).logError=function(t,r,i){t=t||{},"string"!=typeof r&&void 0!==r||((r=new Error(r)).justCreated=!0);var s=t.message||"",n=e._baseNormalizeError(r);n.message&&!t.ignoreErrorMessage&&(s&&(s+="; "),s+=n.message),n.message=s||"Empty error";for(var a=["service","source","type","block","additional","level","page","method","sourceMethod","coordinates_gp"],o=0;o<a.length;o++){var l=a[o];t[l]?n[l]=t[l]:r&&r[l]&&(n[l]=r[l])}e._handleError(n,!0,i)}}()},6212:()=>{!function(){"use strict";var e,t;e=Ya.Rum,t="__RumTraceablePromise",e._parseTraceablePromiseStack=function(e){if(e&&e.__stack){for(var r=e.__stack.split("\n"),i=[],s=0;s<r.length;s++)-1===r[s].indexOf(t)&&i.push(r[s].trim());return i.join("\n")}},e._traceUnhandledRejection=function(){function e(e){var i,s,n=new r((function(e,t){i=e,s=t}));n.__stack=new Error(t).stack;try{e(i,s)}catch(r){s(r)}return n}if("Promise"in window&&window.Promise.name!==t){var r=window.Promise;try{e.prototype=r.prototype,e.prototype.constructor=e,Object.setPrototypeOf(e,r),Object.defineProperty(e,"name",{value:t}),window.Promise=e}catch(r){}}}}()},8533:function(e,t,r){"use strict";function i(e){return-1===["tr","id","fi","lt","pl","et","lv"].indexOf(e)?"ru":"en"}function s(e,t){for(var r=[],i=e.length,s=0;s<i;){var n=e.indexOf("{",s);if(-1===n)return r.push(e.substring(s)),r;var a=e.indexOf("}",n);if(-1===a)return r.push(e.substring(s)),r;r.push(e.substring(s,n),t[e.substring(n+1,a)]),s=a+1}return r}function n(e,t,r){void 0===r&&(r={});var n=function(e,t){var r,i,s;try{for(var n=a(D),o=n.next();!o.done;o=n.next()){if((s=e[o.value])&&t in s)return s[t]}}catch(l){r={error:l}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}return t}(e,t);return"string"===typeof n?s(n,r):function(e,t){var r=D.find((function(e){return Boolean(O[e])}))||i(D[0]);return s((0,O[r])(t.count,e),t)}(n,r)}var a=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.resolveI18nLang=t.getI18nLang=t.setI18nLang=t.i18nRaw=void 0;var l=o(r(6606)),d=o(r(701)),c=o(r(5480)),u=o(r(6587)),h=o(r(9753)),p=o(r(650)),f=o(r(205)),m=o(r(7228)),g=o(r(599)),v=o(r(8275)),y=o(r(2598)),E=o(r(7424)),S=o(r(3175)),A=o(r(6187)),T=o(r(4120)),b=o(r(4701)),R=o(r(9254)),w=o(r(9970)),_=o(r(3878)),k=o(r(3397)),P=o(r(1778)),I=o(r(3025)),C=o(r(4256)),O={be:l.default,en:d.default,id:c.default,kk:u.default,ru:h.default,tr:p.default,tt:f.default,uk:m.default,uz:g.default,de:v.default,es:y.default,hy:E.default,ka:S.default,ky:A.default,sr:T.default,fr:b.default,lv:R.default,lt:w.default,ro:_.default,fi:k.default,az:P.default,zh:I.default,he:C.default},D=["ru"];t.default=function(e){return function(t,r){return void 0===r&&(r={}),n(e,t,r).join("")}},t.i18nRaw=function(e){return function(t,r){return void 0===r&&(r={}),n(e,t,r)}},t.setI18nLang=function(e){D="string"===typeof e?[e,i(e),"ru"]:e},t.getI18nLang=function(){return D[0]},t.resolveI18nLang=function(e,t,r){var i=t;if(-1===e.indexOf(i))switch(r){case"com":i="en";break;case"com.tr":i="tr";break;default:i="ru"}return i}},1778:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(701));t.default=s.default},6606:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(9753));t.default=s.default},8275:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(701));t.default=s.default},701:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e?1===e?t.one:t.some:t.none||""}},2598:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(701));t.default=s.default},3397:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(701));t.default=s.default},4701:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(9753));t.default=s.default},4256:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(701));t.default=s.default},7424:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(701));t.default=s.default},5480:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e?t.some:t.none||""}},3175:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(701));t.default=s.default},6587:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>1&&r<5&&(i<10||i>20)?t.some:t.many||"":t.none||""}},6187:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(9753));t.default=s.default},9970:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(9753));t.default=s.default},9254:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(9753));t.default=s.default},3878:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(9753));t.default=s.default},9753:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>=2&&r<=4&&12!==i&&13!==i&&14!==i?t.some:t.many||"":t.none||""}},4120:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(9753));t.default=s.default},650:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>1&&r<5&&(i<10||i>20)?t.some:t.many||"":t.none||""}},205:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>1&&r<5&&(i<10||i>20)?t.some:t.many||"":t.none||""}},7228:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(9753));t.default=s.default},599:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>1&&r<5&&(i<10||i>20)?t.some:t.many||"":t.none||""}},3025:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(r(701));t.default=s.default},3106:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identity=void 0,t.identity=function(e){return e}},7881:(e,t,r)=>{"use strict";r(3850),r(4423),r(2968)},2968:(e,t)=>{"use strict"},6285:(e,t,r)=>{"use strict";function i(e){return Math.max(e,0)}function s(e){return Math.floor(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.toUnsignedInt=t.toUnsignedFloat=t.toInt=t.toUnsigned=t.toFloat=void 0;const n=r(3106);t.toFloat=n.identity,t.toUnsigned=i,t.toInt=s,t.toUnsignedFloat=function(e){return i((0,t.toFloat)(e))},t.toUnsignedInt=function(e){return i(s(e))}},3849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toTimestamp=t.toMilliseconds=t.toMbps=t.toMegaBitsPerSeconds=t.toKbps=t.toKiloBitsPerSeconds=t.toBps=t.toBitsPerSeconds=t.toMegabits=t.toKilobits=void 0;const i=r(3106),s=r(2008);t.toKilobits=i.identity,t.toMegabits=i.identity,t.toBitsPerSeconds=i.identity,t.toBps=t.toBitsPerSeconds,t.toKiloBitsPerSeconds=i.identity,t.toKbps=t.toKiloBitsPerSeconds,t.toMegaBitsPerSeconds=i.identity,t.toMbps=t.toMegaBitsPerSeconds,t.toMilliseconds=i.identity,t.toTimestamp=s.toMoment},2008:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toPixels=t.toPerSeconds=t.toPercent=t.toPortion=t.toDays=t.toHours=t.toMinutes=t.toSeconds=t.toDuration=t.toMoment=t.toBytes=t.toBits=void 0;const i=r(3106);t.toBits=i.identity,t.toBytes=i.identity,t.toMoment=i.identity,t.toDuration=i.identity,t.toSeconds=i.identity,t.toMinutes=i.identity,t.toHours=i.identity,t.toDays=i.identity,t.toPortion=i.identity,t.toPercent=i.identity,t.toPerSeconds=i.identity,t.toPixels=i.identity},4423:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(6285),t),s(r(2008),t),s(r(3849),t)},963:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2846:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4957:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3850:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(963),t),s(r(4957),t),s(r(2846),t)},5235:()=>{!function(e,t){function r(){_=e.getVarsList(),e.getSetting("sendClientUa")&&_.push("1042="+encodeURIComponent(navigator.userAgent))}function i(){k=_.concat(["143.2129="+G])}function s(e){function t(){removeEventListener("DOMContentLoaded",t),removeEventListener("load",t),e()}"loading"===document.readyState?(addEventListener("DOMContentLoaded",t),addEventListener("load",t)):e()}function n(){var t;e.getSetting("disableOnLoadTasks")||(removeEventListener("load",n),(t=e.getSetting("periodicStatsIntervalMs"))||null===t||(t=15e3),t&&(K=setInterval(h,t)),addEventListener("beforeunload",h),function(){if(L){p(M.getEntriesByType("navigation")),p(M.getEntriesByType("resource"));try{new L((function(e){p(e.getEntries())})).observe({entryTypes:["resource","navigation"]})}catch(e){}e._periodicTasks.push(m)}}(),function(){if(L)try{new L((function(e,t){var r=e.getEntries()[0];r&&(c("first-input",r.processingStart-r.startTime),t.disconnect())})).observe({type:"first-input",buffered:!0})}catch(e){}}(),function(){if(L){var e=new L((function(e){var t=e.getEntries();null==X&&(X=0);for(var r=0;r<t.length;r++){var i=t[r];i.hadRecentInput||(X+=i.value)}}));try{e.observe({type:"layout-shift",buffered:!0})}catch(e){}addEventListener("visibilitychange",(function t(){if("hidden"===document.visibilityState){removeEventListener("visibilitychange",t);try{"function"==typeof e.takeRecords&&e.takeRecords(),e.disconnect()}catch(e){}g()}})),addEventListener("beforeunload",g)}}(),function(){if(L&&(e.getSetting("forcePaintTimeSending")||!e.isVisibilityChanged())){var t=new L((function(e){for(var t=e.getEntries(),r=0;r<t.length;r++){var i=t[r];Z=i.renderTime||i.loadTime}J||(o("largest-loading-elem-paint",Z),J=!0)}));try{t.observe({type:"largest-contentful-paint",buffered:!0})}catch(e){}addEventListener("visibilitychange",(function e(){if("hidden"===document.visibilityState){removeEventListener("visibilitychange",e);try{"function"==typeof t.takeRecords&&t.takeRecords(),t.disconnect()}catch(e){}v()}})),addEventListener("beforeunload",v)}}())}function a(){var t=x.domContentLoadedEventStart,r=x.domContentLoadedEventEnd;if(0!==t||0!==r){var i=0===x.responseStart?G:x.responseStart,s=0===x.domainLookupStart?G:x.domainLookupStart,n=_.concat(["2129="+G,"1036="+(s-G),"1037="+(x.domainLookupEnd-x.domainLookupStart),"1038="+(x.connectEnd-x.connectStart),x.secureConnectionStart&&"1383="+(x.connectEnd-x.secureConnectionStart),"1039="+(x.responseStart-x.connectEnd),"1040="+(x.responseEnd-i),"1040.906="+(x.responseEnd-s),"1310.2084="+(x.domLoading-i),"1310.2085="+(x.domInteractive-i),"1310.1309="+(r-t),"1310.1007="+(t-i),navigator.deviceMemory&&"3140="+navigator.deviceMemory,navigator.hardwareConcurrency&&"3141="+navigator.hardwareConcurrency]);Object.keys(P).forEach((function(e){e in x&&x[e]&&n.push(P[e]+"="+R(x[e],G))})),e.vsStart?(n.push("1484="+(I[e.vsStart]||2771)),e.vsChanged&&n.push("1484.719=1")):n.push("1484="+I.visible),V&&(V.redirectCount&&n.push("1384.1385="+V.redirectCount),1!==V.type&&2!==V.type||n.push("770.76="+V.type)),E(n),w("690.1033",n)}else setTimeout(a,50)}function o(r,i,s,n){i===t&&(i=N()),s!==t&&!0!==s||e.mark(r,i);var a=T(r);if(a.push("207="+R(i)),l(a,n)){w("690.2096.207",a),U[r]=U[r]||[],U[r].push(i);var o=e._markListeners[r];o&&o.length&&o.forEach((function(e){e(i)}))}}function l(e,r){if(r){if(r.isCanceled&&r.isCanceled())return!1;var i=e.reduce((function(e,t,r){return"string"==typeof t&&(e[t.split("=")[0]]=r),e}),{});Object.keys(r).forEach((function(s){if("function"!=typeof r[s]){var n=i[s],a=s+"="+r[s];n===t?e.push(a):e[n]=a}}))}return!0}function d(e,t){var r=H[e];r&&0!==r.length&&(r.push(N(),t),c(e))}function c(r,i,s){var n,a,o,d=H[r];if(void 0!==i?n=(a=e.getTime())-i:d&&(n=d[0],a=d[1],o=d[2]),n!==t&&a!==t){var c=T(r);c.push("207.2154="+R(n),"207.1428="+R(a),"2877="+R(a-n)),l(c,s)&&l(c,o)&&(w("690.2096.2877",c),delete H[r])}}function u(t,r){S(r,(function(i){if(i){var s=T(t);e.getSetting("sendUrlInResTiming")&&s.push("13="+encodeURIComponent(r)),b(s,i[0]),w("690.2096.2044",s)}}))}function h(){var t=!1;e._periodicTasks.forEach((function(e){e()&&(t=!0)})),t||clearInterval(K)}function p(e){if(e&&e.length)for(var t=B,r=0;r<e.length;r++){var i=f(e[r]);if(i){var s=i.domain+"-"+i.extension,n=t[s]=t[s]||{count:0,size:0};n.count++,n.size+=i.size}}}function f(e){var t=e.transferSize;if(null!=t){Y.href=e.name;var r=Y.pathname;if(0!==r.indexOf("/clck")){var i=r.lastIndexOf("."),s="";return-1!=i&&r.lastIndexOf("/")<i&&r.length-i<=5&&(s=r.slice(i+1)),{size:t,domain:Y.hostname,extension:s}}}}function m(){var t=e.getSetting("maxTrafficCounters")||250;if(Q>=t)return!1;for(var r=Object.keys(B),i="",s=0;s<r.length;s++){var n=r[s],a=B[n];i+=encodeURIComponent(n)+"!"+a.count+"!"+a.size+";"}i.length&&(Q++,w("690.2096.361",_.concat(["d="+i,"t="+R(N())])));return B={},Q<t}function g(){if(null!=X){var e=Math.round(1e6*X)/1e6;w("690.2096.4004",_.concat("s="+e)),X=null}}function v(){null!=Z&&(o("largest-contentful-paint",Z),Z=null)}function y(t,r,i){if(e._tti){var s=N(),n=function(t,n,a){var l={2796.2797:A(a,r),689.2322:R(s)};i&&Object.keys(i).forEach((function(e){l[e]=i[e]})),o(t||"2795",n,!0,l),e._tti.fired=!0};!function i(){var a,o=r||s,l=N(),d=e._tti.events||[],c=d.length;0!==c&&(a=d[c-1],o=Math.max(o,Math.floor(a.startTime+a.duration))),l-o>=3e3?n(t,o,d):l-o>=2e4?n(t,(r||s)+2e4,d):setTimeout(i,1e3)}()}}function E(e){F&&e.push("2437="+(C[F.type]||2771),F.downlinkMax!==t&&"2439="+F.downlinkMax,F.effectiveType&&"2870="+F.effectiveType,F.rtt!==t&&"rtt="+F.rtt,F.downlink!==t&&"dwl="+F.downlink)}function S(e,t){if(!W)return t(null);j.href=e;var r=j.href,i=0,s=100;setTimeout((function e(){var n=M.getEntriesByName(r);if(n.length)return t(n);i++<10?(setTimeout(e,s),s+=s):t(null)}),0)}function A(e,t){return t=t||0,(e=e||[]).filter((function(e){return e.startTime-t>=-50})).map((function(e){var t=e.name?e.name.split("-").map((function(e){return e[0]})).join(""):"u",r=Math.floor(e.startTime);return t+"-"+r+"-"+Math.floor(r+e.duration)})).join(".")}function T(t){return k.concat(["1701="+t,e.ajaxStart&&"1201.2154="+R(e.ajaxStart),e.ajaxComplete&&"1201.2052="+R(e.ajaxComplete)])}function b(e,t){Object.keys(P).forEach((function(r){if(r in t){var i=t[r];(i||0===i)&&e.push(P[r]+"="+R(i))}}))}function R(e,t){return"string"==typeof e?encodeURIComponent(e):Math.round(1e3*(e-(t||0)))/1e3}function w(t,r){var i=encodeURIComponent(window.YaStaticRegion||"unknown");r.push("-cdn="+i);var s=r.filter(Boolean).join(",");e.send(null,t,s)}if(!e)throw new Error("Rum: interface is not included");if(!e.enabled)return e.getSetting=function(){return""},e.getVarsList=function(){return[]},void(e.getResourceTimings=e.pushConnectionTypeTo=e.pushTimingTo=e.normalize=e.sendCounter=e.sendDelta=e.sendTimeMark=e.sendResTiming=e.sendTTI=e.makeSubPage=e.sendHeroElement=e.onReady=function(){});e.getVarsList=function(){var t=e._vars;return Object.keys(t).map((function(e){return e+"="+encodeURIComponent(t[e]).replace(/\*/g,"%2A")}))},e.setVars=function(t){Object.keys(t).forEach((function(r){e._vars[r]=t[r]})),r(),i()};var _,k,P={connectEnd:2116,connectStart:2114,decodedBodySize:2886,domComplete:2124,domContentLoadedEventEnd:2131,domContentLoadedEventStart:2123,domInteractive:2770,domLoading:2769,domainLookupEnd:2113,domainLookupStart:2112,duration:2136,encodedBodySize:2887,entryType:2888,fetchStart:2111,initiatorType:2889,loadEventEnd:2126,loadEventStart:2125,nextHopProtocol:2890,redirectCount:1385,redirectEnd:2110,redirectStart:2109,requestStart:2117,responseEnd:2120,responseStart:2119,secureConnectionStart:2115,startTime:2322,transferSize:2323,type:76,unloadEventEnd:2128,unloadEventStart:2127,workerStart:2137},I={visible:1,hidden:2,prerender:3},C={bluetooth:2064,cellular:2065,ethernet:2066,none:1229,wifi:2067,wimax:2068,other:861,unknown:836,0:836,1:2066,2:2067,3:2070,4:2071,5:2768},O={"first-paint":2793,"first-contentful-paint":2794},D=Object.keys(O).length,N=e.getTime,L=window.PerformanceObserver,M=window.performance||{},x=M.timing||{},V=M.navigation||{},F=navigator.connection,U={},B={},H=e._deltaMarks,j=document.createElement("link"),Y=document.createElement("a"),W="function"==typeof M.getEntriesByType,G=x.navigationStart;if(r(),i(),e.ajaxStart=0,e.ajaxComplete=0,L)try{new L((function(e,t){var r=e.getEntriesByType("navigation")[0];if(r){t&&t.disconnect();var i=[];b(i,r),E(i),w("690.2096.2892",_.concat(i))}})).observe({entryTypes:["navigation"]})}catch(e){}s((function(){G&&setTimeout((function(){e.sendTimeMark=o,e.sendResTiming=u,e.timeEnd=d;for(var t=e._defRes;t.length;){var r=t.shift();u(r[0],r[1])}for(var i=e._defTimes;i.length;){var s=i.shift();o(s[0],s[1],!1,s[2])}Object.keys(H).forEach((function(e){c(e)})),a(),function t(){if(W&&(e.getSetting("forcePaintTimeSending")||!e.isVisibilityChanged())){for(var r=M.getEntriesByType("paint"),i=0;i<r.length;i++){var s=r[i],n=O[s.name];n&&!q[s.name]&&(q[s.name]=!0,z++,o("1926."+n,s.startTime))}if(z<D)try{new L((function(e,r){t(),r&&r.disconnect()})).observe({entryTypes:["paint"]})}catch(e){}}}(),e.getSetting("sendAutoElementTiming")&&$(),y(),"complete"===document.readyState?n():addEventListener("load",n)}),0)})),e._getCommonVars=function(){return _};var K,q={},z=0;e.getTimeMarks=function(){return U},e._periodicTasks=[];var X,Q=0,Z=null,J=!1,$=L?function(){if(e.getSetting("forcePaintTimeSending")||!e.isVisibilityChanged())try{new L((function(e){for(var t=e.getEntries(),r=0;r<t.length;r++){var i=t[r];o("element-timing."+i.identifier,i.startTime)}})).observe({type:"element",buffered:!0})}catch(e){}}:function(){};e.sendTTI=y,e.sendHeroElement=function(e){o("2876",e)},e._subpages={},e.makeSubPage=function(t,r){var i=e._subpages[t];e._subpages[t]=void 0===i?i=0:++i;var s=!1;return{689.2322:R(void 0!==r?r:N()),2924:t,2925:i,isCanceled:function(){return s},cancel:function(){s=!0}}},e._getLongtasksStringValue=A,e.getResourceTimings=S,e.pushConnectionTypeTo=E,e.pushTimingTo=b,e.normalize=R,e.sendCounter=w,e.sendDelta=c,e.sendTrafficData=m,e.finalizeLayoutShiftScore=g,e.finalizeLargestContentfulPaint=v,e.onReady=s}(Ya.Rum)},7873:()=>{Ya.Rum.enabled&&addEventListener("load",(function e(){removeEventListener("load",e);var t=Ya.Rum;if(t.sendTimeMark("1724"),t.getSetting("sendAutoResTiming"))for(var r=document.querySelectorAll("script[data-rCid], div[data-rCid]"),i=0,s=r.length;i<s;i++){var n=r[i],a=n.src;if(!a){var o=getComputedStyle(n).backgroundImage;if(o){var l=o.match(/^url\(["']?(.*?)["']?\)$/);l&&(a=l[1])}}a&&t.sendResTiming(n.getAttribute("data-rCid"),a)}}))},9418:()=>{!function(e){function t(e){for(var t=0,r=0;r<e.length;++r)t+=e[r]*e[r];return Math.sqrt(t/e.length)}var r,i,s,n=0,a=[],o=[];e.enabled&&(e.getSetting("longTaskMetric")&&e._tti&&e._periodicTasks.push((function(){if(!e._tti.fired)return!0;var t=e.getSetting("maxLongTaskCounters")||10;if(++n>t)return!1;if(e._tti.eventsAfterTTI.length){var r=e._getCommonVars().slice();r.push("2796.2797="+e._getLongtasksStringValue(e._tti.eventsAfterTTI)),r.push("689.2322="+e.normalize(e.getTime())),e.sendCounter("690.2096.2796",r),e._tti.eventsAfterTTI=[]}return!0})),e.getSetting("scrollMetric")&&(s=!1,e.getTime(),500,addEventListener("scroll",(function(){var t=e.getTime();s?a.push(t-r):(s=!0,e.getTime()),r=t,clearTimeout(i),i=setTimeout((function(){s=!1}),500)})),e._periodicTasks.push((function(){if(a.length){var r=e._getCommonVars().concat(["d="+t(a)]);e.sendCounter("690.2096.768",r),a=[]}return!0}))),e.getSetting("scrollLatencyMetric")&&function(){try{if(!window.PerformanceScrollUpdateLatency)return!1;new PerformanceObserver((function(e){e.getEntries().forEach((function(e){o.push(e.duration)}))})).observe({entryTypes:["scrollUpdateLatency"]})}catch(e){return!1}return!0}()&&e._periodicTasks.push((function(){if(o.length){var r=e._getCommonVars().concat(["d="+t(o)]);e.sendCounter("690.2096.768.2373",r),o=[]}return!0})))}(Ya.Rum)},8058:()=>{!function(){function e(){var e=Ya.Rum.getSetting("clck"),i=r.join("\r\n");if(r=[],t=null,e&&!(navigator.sendBeacon&&Ya.Rum.getSetting("beacon")&&navigator.sendBeacon(e,i))){var s=new XMLHttpRequest;s.open("POST",e),s.send(i)}}var t,r=[];Ya.Rum.send=function(i,s,n,a,o,l,d){clearTimeout(t);var c=Ya.Rum.getSetting("slots"),u=Ya.Rum.getSetting("experiments"),h=["/reqid="+Ya.Rum.getSetting("reqid"),d?"/"+d.join("/"):"",s?"/path="+s:"",o?"/events="+o:"",c?"/slots="+c.join(";"):"",u?"/experiments="+u.join(";"):"",n?"/vars="+n:"","/cts="+(new Date).getTime(),"/*"];r.push(h.join("")),r.length<42?t=setTimeout(e,15):e()}}()},7323:()=>{!function(e,t){if(e.Ya=e.Ya||{},Ya.Rum)throw new Error("Rum: interface is already defined");var r=e.performance,i=r&&r.timing&&r.timing.navigationStart||Ya.startPageLoad||+new Date,s=e.requestAnimationFrame;Ya.Rum={enabled:!!r,vsStart:document.visibilityState,vsChanged:!1,_defTimes:[],_defRes:[],_deltaMarks:{},_markListeners:{},_settings:{},_vars:{},init:function(e,t){this._settings=e,this._vars=t},getTime:r&&r.now?function(){return r.now()}:Date.now?function(){return Date.now()-i}:function(){return new Date-i},time:function(e){this._deltaMarks[e]=[this.getTime()]},timeEnd:function(e,t){var r=this._deltaMarks[e];r&&0!==r.length&&r.push(this.getTime(),t)},sendTimeMark:function(e,t,r,i){void 0===t&&(t=this.getTime()),this._defTimes.push([e,t,i]),this.mark(e,t)},sendResTiming:function(e,t){this._defRes.push([e,t])},sendRaf:function(e){var t=this.getSetting("forcePaintTimeSending");if(s&&(t||!this.isVisibilityChanged())){var r=this,i="2616."+e;s((function(){!t&&r.isVisibilityChanged()||(r.getSetting("sendFirstRaf")&&r.sendTimeMark(i+".205"),s((function(){!t&&r.isVisibilityChanged()||r.sendTimeMark(i+".1928")})))}))}},isVisibilityChanged:function(){return this.vsStart&&("visible"!==this.vsStart||this.vsChanged)},mark:r&&r.mark?function(e,t){r.mark(e+(t?": "+t:""))}:function(){},getSetting:function(e){var t=this._settings[e];return null===t?null:t||""},on:function(e,t){"function"==typeof t&&(this._markListeners[e]=this._markListeners[e]||[]).push(t)},sendTrafficData:function(){},finalizeLayoutShiftScore:function(){},finalizeLargestContentfulPaint:function(){}},document.addEventListener&&document.addEventListener("visibilitychange",(function e(){Ya.Rum.vsChanged=!0,document.removeEventListener("visibilitychange",e)}))}(window)},7790:()=>{!function(){if(window.PerformanceLongTaskTiming){var e=function(e,t){return(e=e.concat(t)).length>300&&(e=e.slice(e.length-300)),e},t=Ya.Rum._tti={events:[],eventsAfterTTI:[],fired:!1,observer:new PerformanceObserver((function(r){var i=r.getEntries();t.events=e(t.events,i),t.fired&&(t.eventsAfterTTI=e(t.eventsAfterTTI,i))}))};t.observer.observe({entryTypes:["longtask"]})}}()},1299:(e,t)=>{"use strict";function r(e,t){try{return t(e)}catch(r){return e}}t.parse=function(e,t){if("string"!==typeof e)throw new TypeError("argument str must be a string");for(var s={},a=t||{},o=e.split(n),l=a.decode||i,d=0;d<o.length;d++){var c=o[d],u=c.indexOf("=");if(!(u<0)){var h=c.substr(0,u).trim(),p=c.substr(++u,c.length).trim();'"'==p[0]&&(p=p.slice(1,-1)),void 0==s[h]&&(s[h]=r(p,l))}}return s},t.serialize=function(e,t,r){var i=r||{},n=i.encode||s;if("function"!==typeof n)throw new TypeError("option encode is invalid");if(!a.test(e))throw new TypeError("argument name is invalid");var o=n(t);if(o&&!a.test(o))throw new TypeError("argument val is invalid");var l=e+"="+o;if(null!=i.maxAge){var d=i.maxAge-0;if(isNaN(d))throw new Error("maxAge should be a Number");l+="; Max-Age="+Math.floor(d)}if(i.domain){if(!a.test(i.domain))throw new TypeError("option domain is invalid");l+="; Domain="+i.domain}if(i.path){if(!a.test(i.path))throw new TypeError("option path is invalid");l+="; Path="+i.path}if(i.expires){if("function"!==typeof i.expires.toUTCString)throw new TypeError("option expires is invalid");l+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(l+="; HttpOnly"),i.secure&&(l+="; Secure"),i.sameSite)switch("string"===typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"strict":l+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}return l};var i=decodeURIComponent,s=encodeURIComponent,n=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},870:e=>{function t(e,t){var r,i=e[1]||"",s=e[3];if(!s)return i;if(t&&"function"===typeof btoa){var n=(r=s,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),a=s.sources.map((function(e){return"/*# sourceURL="+s.sourceRoot+e+" */"}));return[i].concat(a).concat([n]).join("\n")}return[i].join("\n")}e.exports=function(e){var r=[];return r.toString=function(){return this.map((function(r){var i=t(r,e);return r[2]?"@media "+r[2]+"{"+i+"}":i})).join("")},r.i=function(e,t){"string"===typeof e&&(e=[[null,e,""]]);for(var i={},s=0;s<this.length;s++){var n=this[s][0];"number"===typeof n&&(i[n]=!0)}for(s=0;s<e.length;s++){var a=e[s];"number"===typeof a[0]&&i[a[0]]||(t&&!a[2]?a[2]=t:t&&(a[2]="("+a[2]+") and ("+t+")"),r.push(a))}},r}},6386:e=>{e.exports=function(e){e||(e=window);var t=e.navigator.userAgent,r=t.indexOf("MSIE ");if(r>0)return parseInt(t.substring(r+5,t.indexOf(".",r)),10);if(t.indexOf("Trident/")>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var s=t.indexOf("Edge/");return s>0&&parseInt(t.substring(s+5,t.indexOf(".",s)),10)}},6048:e=>{"use strict";var t=Array.isArray,r=Object.keys,i=Object.prototype.hasOwnProperty;e.exports=function e(s,n){if(s===n)return!0;if(s&&n&&"object"==typeof s&&"object"==typeof n){var a,o,l,d=t(s),c=t(n);if(d&&c){if((o=s.length)!=n.length)return!1;for(a=o;0!==a--;)if(!e(s[a],n[a]))return!1;return!0}if(d!=c)return!1;var u=s instanceof Date,h=n instanceof Date;if(u!=h)return!1;if(u&&h)return s.getTime()==n.getTime();var p=s instanceof RegExp,f=n instanceof RegExp;if(p!=f)return!1;if(p&&f)return s.toString()==n.toString();var m=r(s);if((o=m.length)!==r(n).length)return!1;for(a=o;0!==a--;)if(!i.call(n,m[a]))return!1;for(a=o;0!==a--;)if(!e(s[l=m[a]],n[l]))return!1;return!0}return s!==s&&n!==n}},6394:e=>{function t(){var e,t,r,i,s=document.createElement("canvas");try{e=s.getContext("webgl")||s.getContext("experimental-webgl")}catch(n){}return e&&(t=e.getExtension("WEBGL_debug_renderer_info"),r=e.getParameter(t.UNMASKED_VENDOR_WEBGL),i=e.getParameter(t.UNMASKED_RENDERER_WEBGL)),{debugInfo:t,vendor:r,renderer:i}}e.exports=t,e.exports.getGpu=t},7179:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ErrorDetails:()=>s,ErrorTypes:()=>i});const i={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},s={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},1673:(e,t,r)=>{"use strict";function i(){const e=function(){if("undefined"!==typeof window)return window.MediaSource||window.WebKitMediaSource}(),t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"===typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove;return!!r&&!!i}r.r(t),r.d(t,{isSupported:()=>i})},5508:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TALB:"album",TBPM:"bpm",TCOM:"composer",TCON:"genre",TCOP:"copyright",TDEN:"encoding-time",TDLY:"playlist-delay",TDOR:"original-release-time",TDRC:"recording-time",TDRL:"release-time",TDTG:"tagging-time",TENC:"encoder",TEXT:"writer",TFLT:"file-type",TIPL:"involved-people",TIT1:"content-group",TIT2:"title",TIT3:"subtitle",TKEY:"initial-key",TLAN:"language",TLEN:"length",TMCL:"credits",TMED:"media-type",TMOO:"mood",TOAL:"original-album",TOFN:"original-filename",TOLY:"original-writer",TOPE:"original-artist",TOWN:"owner",TPE1:"artist",TPE2:"band",TPE3:"conductor",TPE4:"remixer",TPOS:"set-part",TPRO:"produced-notice",TPUB:"publisher",TRCK:"track",TRSN:"radio-name",TRSO:"radio-owner",TSOA:"album-sort",TSOP:"performer-sort",TSOT:"title-sort",TSRC:"isrc",TSSE:"encoder-settings",TSST:"set-subtitle",TXXX:"user-defined-text-information",TYER:"year",WCOM:"url-commercial",WCOP:"url-legal",WOAF:"url-file",WOAR:"url-artist",WOAS:"url-source",WORS:"url-radio",WPAY:"url-payment",WPUB:"url-publisher",WAF:"url-file",WAR:"url-artist",WAS:"url-source",WCM:"url-commercial",WCP:"url-copyright",WPB:"url-publisher",COMM:"comments",USLT:"lyrics",APIC:"image",PIC:"image",IPLS:"involved-people-list",OWNE:"ownership"},t.FrameTypeValueMap={TXXX:"array",COMM:"array",USLT:"array"}},3940:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop / Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast  Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Rock/Pop"]},4053:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["other","file-icon","icon","cover-front","cover-back","leaflet","media","artist-lead","artist","conductor","band","composer","lyricist-writer","recording-location","during-recording","during-performance","screen","fish","illustration","logo-band","logo-publisher"]},6636:function(e,t,r){"use strict";var i=this&&this.__assign||Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},s=this&&this.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&(r[i[s]]=e[i[s]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var n=r(6449);t.parseV1Tag=n.default;var a=r(3796);t.parseV2Tag=a.default,r(1689).default(),t.parse=function(e){var t=n.default(e),r=a.default(e);if(!r&&!t)return!1;var o={version:!1},l=r||o,d=l.version,c=s(l,["version"]),u=t||o,h=u.version,p=s(u,["version"]),f=i({version:{v1:h,v2:d}},p,c);return p.comments&&(f.comments=[{value:p.comments}].concat(c&&c.comments?c.comments:[])),f}},6449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(3940),s=r(9107);t.default=function(e){if(!e||e.length<128)return!1;e=e.slice(e.length-128);var t={version:{major:1,minor:0}};if("TAG"!==s.readBytesToUTF8(e,3))return!1;var r=/(^[\s0]+|[\s0]+$)/;return t.title=s.readBytesToUTF8(e.slice(3),30).replace(r,""),t.artist=s.readBytesToUTF8(e.slice(33),30).replace(r,""),t.album=s.readBytesToUTF8(e.slice(63),30).replace(r,""),t.year=s.readBytesToUTF8(e.slice(93),4).replace(r,""),0===e[125]?(t.comments=s.readBytesToUTF8(e.slice(97),28).replace(r,""),t.version.minor=1,t.track=e[126]):t.comments=s.readBytesToUTF8(e.slice(97),30).replace(r,""),t.genre=i.default[e[127]]||"",t}},3796:(e,t,r)=>{"use strict";function i(e){return 2097152*(127&e[0])+16384*(127&e[1])+128*(127&e[2])+(127&e[3])}function s(e){return e.length<4?0:16777216*e[0]+65536*e[1]+256*e[2]+e[3]}function n(e,t,r){var i={id:null,tag:null,value:null},s={id:d.readBytesToUTF8(e,4),type:null,size:r,flags:[e[8],e[9]]};if(s.type=s.id[0],i.id=s.id,0!==s.flags[1])return i;if(!(s.id in a.default))return i;i.tag=a.default[s.id];var n=0,c=0,u=0,h=0;if("T"===s.type){if(n=e[10],"TXXX"===s.id){c=11,u=d.getEndpointOfBytes(e,n,c)-c;var p={description:d.readBytesToString(e.slice(c),n,u),value:""};c+=u+1,c=d.skipPaddingZeros(e,c),p.value=d.readBytesToString(e.slice(c),n),i.value=p}else if(i.value=d.readBytesToString(e.slice(11),n),"TCON"===s.id&&null!==i.value)if("("===i.value[0]){var f=i.value.match(/\(\d+\)/g);f&&(i.value=f.map((function(e){return o.default[+e.slice(1,-1)]})).join(","))}else{var m=parseInt(i.value,10);isNaN(m)||(i.value=o.default[m])}}else if("W"===s.type)"WXXX"===s.id&&0===e[10]?i.value=d.readBytesToISO8859(e.slice(11)):i.value=d.readBytesToISO8859(e.slice(10));else if("COMM"===s.id||"USLT"===s.id){n=e[10],c=14,u=0;var g=d.readBytesToISO8859(e.slice(11),3);u=d.getEndpointOfBytes(e,n,c)-c;var v=d.readBytesToString(e.slice(c),n,u);c=d.skipPaddingZeros(e,c+u+1),i.value={language:g,description:v,value:d.readBytesToString(e.slice(c),n)}}else if("APIC"===s.id){n=e[10];var y={type:null,mime:null,description:null,data:null};for(c=11,u=d.getEndpointOfBytes(e,0,c)-c,y.mime=d.readBytesToString(e.slice(c),0,u),y.type=l.default[e[c+u+1]]||"other",c+=u+2,u=0,h=c;;h++)if(0===e[h]){u=h-c;break}y.description=0===u?null:d.readBytesToString(e.slice(c),n,u),c=d.skipPaddingZeros(e,c+u+1),y.data=e.slice(c),i.value=y}else if("IPLS"===s.id)n=e[10],i.value=d.readBytesToString(e.slice(11),n);else if("OWNE"===s.id){n=e[10],c=11,u=d.getEndpointOfBytes(e,n,c);var E=d.readBytesToISO8859(e.slice(c),u);c+=u+1;var S=d.readBytesToISO8859(e.slice(c),8);c+=8,i.value={pricePayed:E,dateOfPurch:S,seller:d.readBytesToString(e.slice(c),n)}}return i}Object.defineProperty(t,"__esModule",{value:!0});var a=r(5508),o=r(3940),l=r(4053),d=r(9107);t.default=function(e){if(!e||e.length<20)return!1;var t=function(e){if(!e||e.length<10)return!1;if("ID3"!==d.readBytesToUTF8(e,3))return!1;var t=e[5];return{version:{major:2,minor:e[3],revision:e[4],flags:{unsync:0!==(128&t),xheader:0!==(64&t),experimental:0!==(32&t)}}}}(e.slice(0,10));if(!t)return!1;var r=t.version.flags;if(r.unsync)throw new Error("no support for unsynchronisation");var o=10;r.xheader&&(o+=i(e.slice(10,14)));var l=i(e.slice(6,10));return function(e,t){var r=0,i=t.version;for(;r<e.length;){var o=s(e.slice(r+4));if(0===o)break;var l=e.slice(r,r+10+o);if(!l.length)break;var d=n(l,i.minor,o);d.tag&&("array"===a.FrameTypeValueMap[d.id]?t[d.tag]?t[d.tag].push(d.value):t[d.tag]=[d.value]:t[d.tag]=d.value),r+=l.length}}(e.slice(o,l+o),t),t},t.calcTagSize=i,t.calcFrameSize=s},1689:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){"function"!==typeof Uint8Array||Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice})}},9107:(e,t)=>{"use strict";function r(e,t){t=null==t||t<0?e.length:Math.min(t,e.length);var r=0;239===e[0]&&187===e[1]&&191===e[2]&&(r=3);for(var i=[],s=0;r<t;s++){var a=e[r++],o=void 0,l=void 0,d=void 0;if(0===a)break;a<128?i[s]=n(a):a>=194&&a<224?(o=e[r++],i[s]=n(((31&a)<<6)+(63&o))):a>=224&&a<240?(o=e[r++],l=e[r++],i[s]=n(((15&a)<<12)+((63&o)<<6)+(63&l))):a>=240&&a<245&&(d=((7&a)<<18)+((63&(o=e[r++]))<<12)+((63&(l=e[r++]))<<6)+(63&e[r++])-65536,i[s]=n(55296+(d>>10),56320+(1023&d)))}return i.join("")}function i(e,t,r){r=null==r||r<0?e.length:Math.min(r,e.length);var i=0,s=1,a=0;254===e[0]&&255===e[1]?(t=!0,i=2):255===e[0]&&254===e[1]&&(t=!1,i=2),t&&(s=0,a=1);for(var o,l,d,c,u=[],h=0;i<r&&(o=e[i+s],l=e[i+a],i+=2,0!==(d=(o<<8)+l));h++)o<216||o>=224?u[h]=n(d):(c=(e[i+s]<<8)+e[i+a],i+=2,u[h]=n(d,c));return u.join("")}function s(e,t){t=null==t||t<0?e.length:Math.min(t,e.length);for(var r=[],i=0;i<t;i++)r.push(n(e[i]));return r.join("")}Object.defineProperty(t,"__esModule",{value:!0});var n=String.fromCharCode;t.readBytesToUTF8=r,t.readBytesToUTF16=i,t.readBytesToISO8859=s,t.readBytesToString=function(e,t,n){return 0===t?s(e,n):3===t?r(e,n):1===t||2===t?i(e,void 0,n):null},t.getEndpointOfBytes=function(e,t,r){void 0===r&&(r=0);for(var i=0===t?function(t){return 0===e[t]}:function(t){return 0===e[t]&&0===e[t+1]},s=r;s<e.length&&!i(s);s++);return s},t.skipPaddingZeros=function(e,t){for(var r=t;0===e[r];r++)t++;return t}},502:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.hasCookies=function(){var e=new c;try{e.setItem("__test","1");var t=e.getItem("__test");return e.removeItem("__test"),"1"===t}catch(r){return!1}};var a,o=r(1299),l=(a=o)&&a.__esModule?a:{default:a},d="lS_",c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e),this.cookieOptions=i({path:"/"},t),d=t.prefix||d}return n(e,[{key:"getItem",value:function(e){var t=l.default.parse(document.cookie);return t&&t.hasOwnProperty(d+e)?t[d+e]:null}},{key:"setItem",value:function(e,t){return document.cookie=l.default.serialize(d+e,t,this.cookieOptions),t}},{key:"removeItem",value:function(e){var t=i({},this.cookieOptions,{maxAge:-1});return document.cookie=l.default.serialize(d+e,"",t),null}},{key:"clear",value:function(){var e=l.default.parse(document.cookie);for(var t in e)0===t.indexOf(d)&&this.removeItem(t.substr(d.length));return null}}]),e}();t.default=c},4585:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return r(e,[{key:"getItem",value:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0}},{key:"setItem",value:function(e,t){return this._data[e]=String(t)}},{key:"removeItem",value:function(e){return delete this._data[e]}},{key:"clear",value:function(){return this._data={}}}]),e}();t.default=i},2741:(e,t,r)=>{"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=i(r(1402)),n=i(r(502)),a=i(r(4585)),o=null;o=(0,s.default)("localStorage")?window.localStorage:(0,s.default)("sessionStorage")?window.sessionStorage:(0,s.default)("cookieStorage")?new n.default:new a.default,t.ZP=o,s.default,n.default,a.default},1402:(e,t,r)=>{"use strict";function i(e){try{var t=window[e];return t.setItem("__test","1"),t.removeItem("__test"),!0}catch(r){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"localStorage",t=String(e).replace(/storage$/i,"").toLowerCase();if("local"===t)return i("localStorage");if("session"===t)return i("sessionStorage");if("cookie"===t)return(0,s.hasCookies)();if("memory"===t)return!0;throw new Error("Storage method `"+e+"` is not available.\n    Please use one of the following: localStorage, sessionStorage, cookieStorage, memoryStorage.")};var s=r(502)},8139:e=>{"use strict";e.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=t[r]);return e})},5154:function(e,t){!function(e){"use strict";function t(e,t){function s(t){for(var r=[];e[c];)if(e.charCodeAt(c)==p){if(e.charCodeAt(c+1)===g){var i=c+2;if(c=e.indexOf(">",c),-1==e.substring(i,c).indexOf(t)){var s=e.substring(0,c).split("\n");throw new Error("Unexpected close tag\nLine: "+(s.length-1)+"\nColumn: "+(s[s.length-1].length+1)+"\nChar: "+e[c])}return c+1&&(c+=1),r}if(e.charCodeAt(c+1)===v){if(e.charCodeAt(c+2)==m){const t=c;for(;-1!==c&&(e.charCodeAt(c)!==f||e.charCodeAt(c-1)!=m||e.charCodeAt(c-2)!=m||-1==c);)c=e.indexOf(">",c+1);-1===c&&(c=e.length),u&&r.push(e.substring(t,c+1))}else{if(e.charCodeAt(c+2)===S&&e.charCodeAt(c+8)===S&&"cdata"===e.substr(c+3,5).toLowerCase()){var a=e.indexOf("]]>",c);-1==a?(r.push(e.substr(c+9)),c=e.length):(r.push(e.substring(c+9,a)),c=a+3);continue}{const t=c+1;c+=2;for(var l=!1;(e.charCodeAt(c)!==f||!0===l)&&e[c];)e.charCodeAt(c)===S?l=!0:!0===l&&e.charCodeAt(c)===A&&(l=!1),c++;r.push(e.substring(t,c))}}c++;continue}var d=o();r.push(d),"?"===d.tagName[0]&&(r.push(...d.children),d.children=[])}else{var y=n();if(h)y.length>0&&r.push(y);else{var E=y.trim();E.length>0&&r.push(E)}c++}return r}function n(){var t=c;return-2===(c=e.indexOf("<",c)-1)&&(c=e.length),e.slice(t,c+1)}function a(){for(var t=c;-1==="\r\n\t>/= ".indexOf(e[c])&&e[c];)c++;return e.slice(t,c)}function o(){c++;const t=a(),r={};let i=[];for(;e.charCodeAt(c)!==f&&e[c];){var n=e.charCodeAt(c);if(n>64&&n<91||n>96&&n<123){for(var o=a(),d=e.charCodeAt(c);d&&d!==y&&d!==E&&!(d>64&&d<91||d>96&&d<123)&&d!==f;)c++,d=e.charCodeAt(c);if(d===y||d===E){var u=l();if(-1===c)return{tagName:t,attributes:r,children:i}}else u=null,c--;r[o]=u}c++}if(e.charCodeAt(c-1)!==g)if("script"==t){var h=c+1;c=e.indexOf("<\/script>",c),i=[e.slice(h,c)],c+=9}else"style"==t?(h=c+1,c=e.indexOf("</style>",c),i=[e.slice(h,c)],c+=8):-1===T.indexOf(t)?(c++,i=s(t)):c++;else c++;return{tagName:t,attributes:r,children:i}}function l(){var t=e[c],r=c+1;return c=e.indexOf(t,r),e.slice(r,c)}var d,c=(t=t||{}).pos||0,u=!!t.keepComments,h=!!t.keepWhitespace,p="<".charCodeAt(0),f=">".charCodeAt(0),m="-".charCodeAt(0),g="/".charCodeAt(0),v="!".charCodeAt(0),y="'".charCodeAt(0),E='"'.charCodeAt(0),S="[".charCodeAt(0),A="]".charCodeAt(0),T=t.noChildNodes||["img","br","input","meta","link","hr"],b=null;if(void 0!==t.attrValue)for(t.attrName=t.attrName||"id",b=[];-1!==(d=new RegExp("\\s"+t.attrName+"\\s*=['\"]"+t.attrValue+"['\"]").exec(e),c=d?d.index:-1);)-1!==(c=e.lastIndexOf("<",c))&&b.push(o()),e=e.substr(c),c=0;else b=t.parseNode?o():s("");return t.filter&&(b=i(b,t.filter)),t.simplify?r(Array.isArray(b)?b:[b]):(t.setPos&&(b.pos=c),b)}function r(e){var t={};if(!e.length)return"";if(1===e.length&&"string"==typeof e[0])return e[0];for(var i in e.forEach((function(e){if("object"==typeof e){t[e.tagName]||(t[e.tagName]=[]);var i=r(e.children);t[e.tagName].push(i),Object.keys(e.attributes).length&&"string"!=typeof i&&(i._attributes=e.attributes)}})),t)1==t[i].length&&(t[i]=t[i][0]);return t}function i(e,t,r,s){void 0===r&&(r=0),void 0===s&&(s="");var n=[];return e.forEach((function(e,a){if("object"==typeof e&&t(e,a,r,s)&&n.push(e),e.children){var o=i(e.children,t,r+1,(s?s+".":"")+a+"."+e.tagName);n=n.concat(o)}})),n}e.filter=i,e.getElementById=function(e,r,i){var s=t(e,{attrValue:r});return i?tXml.simplify(s):s[0]},e.getElementsByClassName=function(e,r,i){const s=t(e,{attrName:"class",attrValue:"[a-zA-Z0-9- ]*"+r+"[a-zA-Z0-9- ]*"});return i?tXml.simplify(s):s},e.parse=t,e.simplify=r,e.simplifyLostLess=function e(t,r){void 0===r&&(r={});var i={};return t.length?1===t.length&&"string"==typeof t[0]?Object.keys(r).length?{_attributes:r,value:t[0]}:t[0]:(t.forEach((function(t){if("object"==typeof t){i[t.tagName]||(i[t.tagName]=[]);var r=e(t.children||[],t.attributes);i[t.tagName].push(r),Object.keys(t.attributes).length&&(r._attributes=t.attributes)}})),i):i},e.stringify=function(e){function t(e){if(e)for(var t=0;t<e.length;t++)"string"==typeof e[t]?i+=e[t].trim():r(e[t])}function r(e){for(var r in i+="<"+e.tagName,e.attributes)null===e.attributes[r]?i+=" "+r:-1===e.attributes[r].indexOf('"')?i+=" "+r+'="'+e.attributes[r].trim()+'"':i+=" "+r+"='"+e.attributes[r].trim()+"'";"?"!==e.tagName[0]?(i+=">",t(e.children),i+="</"+e.tagName+">"):i+="?>"}var i="";return t(e),i},e.toContentString=function e(t){if(Array.isArray(t)){var r="";return t.forEach((function(t){r=(r+=" "+e(t)).trim()})),r}return"object"==typeof t?e(t.children):" "+t},Object.defineProperty(e,"__esModule",{value:!0})}(t)},866:(e,t,r)=>{(t=e.exports=r(870)(!1)).push([e.id,"video._20Eh5WL::-webkit-media-controls{display:none!important}video._1ll4Zna::-webkit-media-controls-current-time-display,video._1ll4Zna::-webkit-media-controls-time-remaining-display{visibility:hidden!important}video._3D52tih::-webkit-media-controls-timeline{visibility:hidden!important}video._2yNfXKt::-webkit-media-controls-toggle-closed-captions-button{display:none}",""]),t.locals={video_hiddenControls:"_20Eh5WL",videoHiddenControls:"_20Eh5WL",video_hiddenTime:"_1ll4Zna",videoHiddenTime:"_1ll4Zna",video_hiddenTimeline:"_3D52tih",videoHiddenTimeline:"_3D52tih",video_hiddenSubtitlesBtn:"_2yNfXKt",videoHiddenSubtitlesBtn:"_2yNfXKt"}},9840:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var i={};try{var s=(new EventTarget).constructor;class e extends s{}new e,i.EventTarget=(new EventTarget).constructor}catch(EventTarget){!function(e,t){function r(){t.set(this,a(null))}function s(e,t,r){o(e,t,{configurable:!0,writable:!0,value:r})}function n(e){var t=e.options;return t&&t.once&&e.target.removeEventListener(this.type,e.listener),"function"===typeof e.listener?e.listener.call(e.target,this):e.listener.handleEvent(this),this._stopImmediatePropagationFlag}var a=e.create,o=e.defineProperty,l=r.prototype;s(l,"addEventListener",(function(e,r,i){for(var s=t.get(this),n=s[e]||(s[e]=[]),a=0,o=n.length;a<o;a++)if(n[a].listener===r)return;n.push({target:this,listener:r,options:i})})),s(l,"dispatchEvent",(function(e){var r=t.get(this)[e.type];return r&&(s(e,"target",this),s(e,"currentTarget",this),r.slice(0).some(n,e),delete e.currentTarget,delete e.target),!0})),s(l,"removeEventListener",(function(e,r){for(var i=t.get(this),s=i[e]||(i[e]=[]),n=0,a=s.length;n<a;n++)if(s[n].listener===r)return void s.splice(n,1)})),i.EventTarget=r}(Object,new WeakMap)}const n=i.EventTarget}},r={};e.m=t,e.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},e.d=(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};e(1410)})();