<!DOCTYPE html>
<!-- saved from url=(0087)https://yastatic.net/s3/kinopoisk-frontend/external-scripts/release/1.3.0/embedded.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>KP External scripts</title>
    <script>var t,n,o;!function(t){t.Development="development",t.Production="production"}(t||(t={})),function(t){t.TnsCounter="tnsCounter"}(n||(n={})),function(t){t.Init="INIT",t.Execute="EXECUTE"}(o||(o={}));const e={[n.TnsCounter]:{default:"https://www.tns-counter.ru/tcounter.js"}};var i;!function(t){t.Default="Something went wrong",t.ControllerNotFound="Controller not found",t.ConfigNotFound="Config for namespace not found",t.EnvNotFound="Environment not found in config",t.MethodNotFound="This method not found in controller"}(i||(i={}));const r="default";var s;!function(t){t.InitialParamsNotProvided='You should provide initialParams in "options" argument',t.ParamsAreInvalid="TNSCounter params are invalid",t.CounterIsAlreadyExists="Such TNSCounter is already exists",t.CounterNotFound="TNSCounter with such name is not found",t.ApiHasNotInited="TNSCounter API has not initialized"}(s||(s={}));class a{constructor({name:t=r,account:n}){this.name=t,this.account=n,this.resolveFunctions=[]}}const c=new class extends class{main(t){const{namespace:n,type:e,options:i}=t;switch(e){case o.Init:this.init(n,i);break;case o.Execute:this.execute(i)}}init(t,n){const o=n?.env||"default",r=e[t];if(!r)throw new Error(i.ConfigNotFound);const s=r[o];if(!s)throw new Error(i.EnvNotFound);this.checkIfScriptExists(s)||this.addScriptToDocument(s)}checkIfScriptExists(t){const n=document.getElementsByTagName("script");return Array.from(n).some((n=>n.src===t))}addScriptToDocument(t){const n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,document.body.append(n)}execute(t){if(!t)return;const{method:n,params:o}=t;if(n&&!["init","main"].includes(n)){if(!this[n]||"function"!=typeof this[n])throw new Error(i.MethodNotFound);this[n](o)}}}{constructor(){super(),this.counters=[]}init(t,n){this.validateOptions(n),super.init(t,n);const{initialParams:o}=n;if(this.checkIfCounterExists(o))throw new Error(s.CounterIsAlreadyExists);this.counters.push(new a(o)),window.TNS?this.initTNSApi(o):(window.tnscounter_callback=window.tnscounter_callback||[]).push((()=>this.initTNSApi(o)))}hit(t){const{counter:n=r,tmsec:o}=t;this.getCounterApiByName(n).then((t=>{t.hit(o)})).catch((t=>{throw new Error(t.message)}))}validateOptions(t){if(!t.initialParams)throw new Error(s.InitialParamsNotProvided);const{account:n}=t.initialParams;if(!n)throw new Error(s.ParamsAreInvalid)}checkIfCounterExists({name:t,account:n}){const o=this.getCounterByName(t);return!!o&&o.account===n}initTNSApi(t){if(!window.TNS)return;const{name:n,account:o}=t,e=this.getCounterByName(n);if(!e)throw new Error(s.CounterNotFound);e.api=new window.TNS.TnsCounter({account:o}),e.resolveFunctions.forEach((t=>t(e.api)))}getCounterByName(t=r){return this.counters.find((n=>n.name===t))}getCounterApiByName(t=r){const n=this.getCounterByName(t);if(!n)throw new Error(s.CounterNotFound);return new Promise(((t,o)=>{n.api?t(n.api):n.resolveFunctions.push(t),setTimeout((()=>{o(new Error(s.ApiHasNotInited))}),5e3)}))}};var u=c.main.bind(c);const d={[n.TnsCounter]:u};window.addEventListener("message",(function(t){var e;if((e=t.origin).endsWith("kinopoisk.ru")||e.endsWith("kinopoisk.ru:3000"))try{const{data:e}=t,r=function(t){return"object"==typeof t&&Object.values(n).includes(t.namespace)&&Object.values(o).includes(t.type)}(e);if(!r)return;if(!d[e.namespace])throw new Error(i.ControllerNotFound);d[e.namespace](e)}catch(t){console.error(t.message||i.Default)}}));
</script>
</head>
<body>
<script type="text/javascript" async="" src="./tcounter.js.Без названия"></script></body></html>